var z2=e=>{throw TypeError(e)};var jv=(e,r,i)=>r.has(e)||z2("Cannot "+i);var Je=(e,r,i)=>(jv(e,r,"read from private field"),i?i.call(e):r.get(e)),fr=(e,r,i)=>r.has(e)?z2("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(e):r.set(e,i),Zt=(e,r,i,c)=>(jv(e,r,"write to private field"),c?c.call(e,i):r.set(e,i),i),ii=(e,r,i)=>(jv(e,r,"access private method"),i);var Km=(e,r,i,c)=>({set _(d){Zt(e,r,d,i)},get _(){return Je(e,r,c)}});function LR(e,r){for(var i=0;i<r.length;i++){const c=r[i];if(typeof c!="string"&&!Array.isArray(c)){for(const d in c)if(d!=="default"&&!(d in e)){const g=Object.getOwnPropertyDescriptor(c,d);g&&Object.defineProperty(e,d,g.get?g:{enumerable:!0,get:()=>c[d]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))c(d);new MutationObserver(d=>{for(const g of d)if(g.type==="childList")for(const m of g.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&c(m)}).observe(document,{childList:!0,subtree:!0});function i(d){const g={};return d.integrity&&(g.integrity=d.integrity),d.referrerPolicy&&(g.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?g.credentials="include":d.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function c(d){if(d.ep)return;d.ep=!0;const g=i(d);fetch(d.href,g)}})();var OR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yb(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var XC={exports:{}},j_={},KC={exports:{}},or={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cp=Symbol.for("react.element"),FR=Symbol.for("react.portal"),NR=Symbol.for("react.fragment"),BR=Symbol.for("react.strict_mode"),jR=Symbol.for("react.profiler"),$R=Symbol.for("react.provider"),UR=Symbol.for("react.context"),VR=Symbol.for("react.forward_ref"),ZR=Symbol.for("react.suspense"),GR=Symbol.for("react.memo"),HR=Symbol.for("react.lazy"),R2=Symbol.iterator;function WR(e){return e===null||typeof e!="object"?null:(e=R2&&e[R2]||e["@@iterator"],typeof e=="function"?e:null)}var YC={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},QC=Object.assign,JC={};function Gh(e,r,i){this.props=e,this.context=r,this.refs=JC,this.updater=i||YC}Gh.prototype.isReactComponent={};Gh.prototype.setState=function(e,r){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,r,"setState")};Gh.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function eP(){}eP.prototype=Gh.prototype;function vb(e,r,i){this.props=e,this.context=r,this.refs=JC,this.updater=i||YC}var xb=vb.prototype=new eP;xb.constructor=vb;QC(xb,Gh.prototype);xb.isPureReactComponent=!0;var D2=Array.isArray,tP=Object.prototype.hasOwnProperty,bb={current:null},rP={key:!0,ref:!0,__self:!0,__source:!0};function nP(e,r,i){var c,d={},g=null,m=null;if(r!=null)for(c in r.ref!==void 0&&(m=r.ref),r.key!==void 0&&(g=""+r.key),r)tP.call(r,c)&&!rP.hasOwnProperty(c)&&(d[c]=r[c]);var l=arguments.length-2;if(l===1)d.children=i;else if(1<l){for(var E=Array(l),P=0;P<l;P++)E[P]=arguments[P+2];d.children=E}if(e&&e.defaultProps)for(c in l=e.defaultProps,l)d[c]===void 0&&(d[c]=l[c]);return{$$typeof:Cp,type:e,key:g,ref:m,props:d,_owner:bb.current}}function qR(e,r){return{$$typeof:Cp,type:e.type,key:r,ref:e.ref,props:e.props,_owner:e._owner}}function wb(e){return typeof e=="object"&&e!==null&&e.$$typeof===Cp}function XR(e){var r={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(i){return r[i]})}var L2=/\/+/g;function $v(e,r){return typeof e=="object"&&e!==null&&e.key!=null?XR(""+e.key):r.toString(36)}function Ag(e,r,i,c,d){var g=typeof e;(g==="undefined"||g==="boolean")&&(e=null);var m=!1;if(e===null)m=!0;else switch(g){case"string":case"number":m=!0;break;case"object":switch(e.$$typeof){case Cp:case FR:m=!0}}if(m)return m=e,d=d(m),e=c===""?"."+$v(m,0):c,D2(d)?(i="",e!=null&&(i=e.replace(L2,"$&/")+"/"),Ag(d,r,i,"",function(P){return P})):d!=null&&(wb(d)&&(d=qR(d,i+(!d.key||m&&m.key===d.key?"":(""+d.key).replace(L2,"$&/")+"/")+e)),r.push(d)),1;if(m=0,c=c===""?".":c+":",D2(e))for(var l=0;l<e.length;l++){g=e[l];var E=c+$v(g,l);m+=Ag(g,r,i,E,d)}else if(E=WR(e),typeof E=="function")for(e=E.call(e),l=0;!(g=e.next()).done;)g=g.value,E=c+$v(g,l++),m+=Ag(g,r,i,E,d);else if(g==="object")throw r=String(e),Error("Objects are not valid as a React child (found: "+(r==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":r)+"). If you meant to render a collection of children, use an array instead.");return m}function Ym(e,r,i){if(e==null)return e;var c=[],d=0;return Ag(e,c,"","",function(g){return r.call(i,g,d++)}),c}function KR(e){if(e._status===-1){var r=e._result;r=r(),r.then(function(i){(e._status===0||e._status===-1)&&(e._status=1,e._result=i)},function(i){(e._status===0||e._status===-1)&&(e._status=2,e._result=i)}),e._status===-1&&(e._status=0,e._result=r)}if(e._status===1)return e._result.default;throw e._result}var bi={current:null},zg={transition:null},YR={ReactCurrentDispatcher:bi,ReactCurrentBatchConfig:zg,ReactCurrentOwner:bb};function iP(){throw Error("act(...) is not supported in production builds of React.")}or.Children={map:Ym,forEach:function(e,r,i){Ym(e,function(){r.apply(this,arguments)},i)},count:function(e){var r=0;return Ym(e,function(){r++}),r},toArray:function(e){return Ym(e,function(r){return r})||[]},only:function(e){if(!wb(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};or.Component=Gh;or.Fragment=NR;or.Profiler=jR;or.PureComponent=vb;or.StrictMode=BR;or.Suspense=ZR;or.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=YR;or.act=iP;or.cloneElement=function(e,r,i){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var c=QC({},e.props),d=e.key,g=e.ref,m=e._owner;if(r!=null){if(r.ref!==void 0&&(g=r.ref,m=bb.current),r.key!==void 0&&(d=""+r.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(E in r)tP.call(r,E)&&!rP.hasOwnProperty(E)&&(c[E]=r[E]===void 0&&l!==void 0?l[E]:r[E])}var E=arguments.length-2;if(E===1)c.children=i;else if(1<E){l=Array(E);for(var P=0;P<E;P++)l[P]=arguments[P+2];c.children=l}return{$$typeof:Cp,type:e.type,key:d,ref:g,props:c,_owner:m}};or.createContext=function(e){return e={$$typeof:UR,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:$R,_context:e},e.Consumer=e};or.createElement=nP;or.createFactory=function(e){var r=nP.bind(null,e);return r.type=e,r};or.createRef=function(){return{current:null}};or.forwardRef=function(e){return{$$typeof:VR,render:e}};or.isValidElement=wb;or.lazy=function(e){return{$$typeof:HR,_payload:{_status:-1,_result:e},_init:KR}};or.memo=function(e,r){return{$$typeof:GR,type:e,compare:r===void 0?null:r}};or.startTransition=function(e){var r=zg.transition;zg.transition={};try{e()}finally{zg.transition=r}};or.unstable_act=iP;or.useCallback=function(e,r){return bi.current.useCallback(e,r)};or.useContext=function(e){return bi.current.useContext(e)};or.useDebugValue=function(){};or.useDeferredValue=function(e){return bi.current.useDeferredValue(e)};or.useEffect=function(e,r){return bi.current.useEffect(e,r)};or.useId=function(){return bi.current.useId()};or.useImperativeHandle=function(e,r,i){return bi.current.useImperativeHandle(e,r,i)};or.useInsertionEffect=function(e,r){return bi.current.useInsertionEffect(e,r)};or.useLayoutEffect=function(e,r){return bi.current.useLayoutEffect(e,r)};or.useMemo=function(e,r){return bi.current.useMemo(e,r)};or.useReducer=function(e,r,i){return bi.current.useReducer(e,r,i)};or.useRef=function(e){return bi.current.useRef(e)};or.useState=function(e){return bi.current.useState(e)};or.useSyncExternalStore=function(e,r,i){return bi.current.useSyncExternalStore(e,r,i)};or.useTransition=function(){return bi.current.useTransition()};or.version="18.3.1";KC.exports=or;var Y=KC.exports;const ft=yb(Y),Sb=LR({__proto__:null,default:ft},[Y]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QR=Y,JR=Symbol.for("react.element"),eD=Symbol.for("react.fragment"),tD=Object.prototype.hasOwnProperty,rD=QR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,nD={key:!0,ref:!0,__self:!0,__source:!0};function oP(e,r,i){var c,d={},g=null,m=null;i!==void 0&&(g=""+i),r.key!==void 0&&(g=""+r.key),r.ref!==void 0&&(m=r.ref);for(c in r)tD.call(r,c)&&!nD.hasOwnProperty(c)&&(d[c]=r[c]);if(e&&e.defaultProps)for(c in r=e.defaultProps,r)d[c]===void 0&&(d[c]=r[c]);return{$$typeof:JR,type:e,key:g,ref:m,props:d,_owner:rD.current}}j_.Fragment=eD;j_.jsx=oP;j_.jsxs=oP;XC.exports=j_;var ye=XC.exports,sP={exports:{}},to={},aP={exports:{}},lP={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function r(Ze,He){var pt=Ze.length;Ze.push(He);e:for(;0<pt;){var Ct=pt-1>>>1,ut=Ze[Ct];if(0<d(ut,He))Ze[Ct]=He,Ze[pt]=ut,pt=Ct;else break e}}function i(Ze){return Ze.length===0?null:Ze[0]}function c(Ze){if(Ze.length===0)return null;var He=Ze[0],pt=Ze.pop();if(pt!==He){Ze[0]=pt;e:for(var Ct=0,ut=Ze.length,At=ut>>>1;Ct<At;){var kt=2*(Ct+1)-1,nr=Ze[kt],dr=kt+1,gt=Ze[dr];if(0>d(nr,pt))dr<ut&&0>d(gt,nr)?(Ze[Ct]=gt,Ze[dr]=pt,Ct=dr):(Ze[Ct]=nr,Ze[kt]=pt,Ct=kt);else if(dr<ut&&0>d(gt,pt))Ze[Ct]=gt,Ze[dr]=pt,Ct=dr;else break e}}return He}function d(Ze,He){var pt=Ze.sortIndex-He.sortIndex;return pt!==0?pt:Ze.id-He.id}if(typeof performance=="object"&&typeof performance.now=="function"){var g=performance;e.unstable_now=function(){return g.now()}}else{var m=Date,l=m.now();e.unstable_now=function(){return m.now()-l}}var E=[],P=[],R=1,N=null,F=3,A=!1,X=!1,Z=!1,ee=typeof setTimeout=="function"?setTimeout:null,H=typeof clearTimeout=="function"?clearTimeout:null,U=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function W(Ze){for(var He=i(P);He!==null;){if(He.callback===null)c(P);else if(He.startTime<=Ze)c(P),He.sortIndex=He.expirationTime,r(E,He);else break;He=i(P)}}function re(Ze){if(Z=!1,W(Ze),!X)if(i(E)!==null)X=!0,dt(ge);else{var He=i(P);He!==null&&wt(re,He.startTime-Ze)}}function ge(Ze,He){X=!1,Z&&(Z=!1,H(ze),ze=-1),A=!0;var pt=F;try{for(W(He),N=i(E);N!==null&&(!(N.expirationTime>He)||Ze&&!$e());){var Ct=N.callback;if(typeof Ct=="function"){N.callback=null,F=N.priorityLevel;var ut=Ct(N.expirationTime<=He);He=e.unstable_now(),typeof ut=="function"?N.callback=ut:N===i(E)&&c(E),W(He)}else c(E);N=i(E)}if(N!==null)var At=!0;else{var kt=i(P);kt!==null&&wt(re,kt.startTime-He),At=!1}return At}finally{N=null,F=pt,A=!1}}var Te=!1,xe=null,ze=-1,Ne=5,Ie=-1;function $e(){return!(e.unstable_now()-Ie<Ne)}function et(){if(xe!==null){var Ze=e.unstable_now();Ie=Ze;var He=!0;try{He=xe(!0,Ze)}finally{He?ot():(Te=!1,xe=null)}}else Te=!1}var ot;if(typeof U=="function")ot=function(){U(et)};else if(typeof MessageChannel<"u"){var qe=new MessageChannel,ht=qe.port2;qe.port1.onmessage=et,ot=function(){ht.postMessage(null)}}else ot=function(){ee(et,0)};function dt(Ze){xe=Ze,Te||(Te=!0,ot())}function wt(Ze,He){ze=ee(function(){Ze(e.unstable_now())},He)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Ze){Ze.callback=null},e.unstable_continueExecution=function(){X||A||(X=!0,dt(ge))},e.unstable_forceFrameRate=function(Ze){0>Ze||125<Ze?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ne=0<Ze?Math.floor(1e3/Ze):5},e.unstable_getCurrentPriorityLevel=function(){return F},e.unstable_getFirstCallbackNode=function(){return i(E)},e.unstable_next=function(Ze){switch(F){case 1:case 2:case 3:var He=3;break;default:He=F}var pt=F;F=He;try{return Ze()}finally{F=pt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Ze,He){switch(Ze){case 1:case 2:case 3:case 4:case 5:break;default:Ze=3}var pt=F;F=Ze;try{return He()}finally{F=pt}},e.unstable_scheduleCallback=function(Ze,He,pt){var Ct=e.unstable_now();switch(typeof pt=="object"&&pt!==null?(pt=pt.delay,pt=typeof pt=="number"&&0<pt?Ct+pt:Ct):pt=Ct,Ze){case 1:var ut=-1;break;case 2:ut=250;break;case 5:ut=1073741823;break;case 4:ut=1e4;break;default:ut=5e3}return ut=pt+ut,Ze={id:R++,callback:He,priorityLevel:Ze,startTime:pt,expirationTime:ut,sortIndex:-1},pt>Ct?(Ze.sortIndex=pt,r(P,Ze),i(E)===null&&Ze===i(P)&&(Z?(H(ze),ze=-1):Z=!0,wt(re,pt-Ct))):(Ze.sortIndex=ut,r(E,Ze),X||A||(X=!0,dt(ge))),Ze},e.unstable_shouldYield=$e,e.unstable_wrapCallback=function(Ze){var He=F;return function(){var pt=F;F=He;try{return Ze.apply(this,arguments)}finally{F=pt}}}})(lP);aP.exports=lP;var iD=aP.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oD=Y,eo=iD;function lt(e){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)r+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var cP=new Set,Zf={};function qc(e,r){Rh(e,r),Rh(e+"Capture",r)}function Rh(e,r){for(Zf[e]=r,e=0;e<r.length;e++)cP.add(r[e])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Z0=Object.prototype.hasOwnProperty,sD=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,O2={},F2={};function aD(e){return Z0.call(F2,e)?!0:Z0.call(O2,e)?!1:sD.test(e)?F2[e]=!0:(O2[e]=!0,!1)}function lD(e,r,i,c){if(i!==null&&i.type===0)return!1;switch(typeof r){case"function":case"symbol":return!0;case"boolean":return c?!1:i!==null?!i.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function cD(e,r,i,c){if(r===null||typeof r>"u"||lD(e,r,i,c))return!0;if(c)return!1;if(i!==null)switch(i.type){case 3:return!r;case 4:return r===!1;case 5:return isNaN(r);case 6:return isNaN(r)||1>r}return!1}function wi(e,r,i,c,d,g,m){this.acceptsBooleans=r===2||r===3||r===4,this.attributeName=c,this.attributeNamespace=d,this.mustUseProperty=i,this.propertyName=e,this.type=r,this.sanitizeURL=g,this.removeEmptyString=m}var Xn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Xn[e]=new wi(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var r=e[0];Xn[r]=new wi(r,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Xn[e]=new wi(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Xn[e]=new wi(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Xn[e]=new wi(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Xn[e]=new wi(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Xn[e]=new wi(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Xn[e]=new wi(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Xn[e]=new wi(e,5,!1,e.toLowerCase(),null,!1,!1)});var Tb=/[\-:]([a-z])/g;function Cb(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var r=e.replace(Tb,Cb);Xn[r]=new wi(r,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var r=e.replace(Tb,Cb);Xn[r]=new wi(r,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var r=e.replace(Tb,Cb);Xn[r]=new wi(r,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Xn[e]=new wi(e,1,!1,e.toLowerCase(),null,!1,!1)});Xn.xlinkHref=new wi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Xn[e]=new wi(e,1,!1,e.toLowerCase(),null,!0,!0)});function Pb(e,r,i,c){var d=Xn.hasOwnProperty(r)?Xn[r]:null;(d!==null?d.type!==0:c||!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(cD(r,i,d,c)&&(i=null),c||d===null?aD(r)&&(i===null?e.removeAttribute(r):e.setAttribute(r,""+i)):d.mustUseProperty?e[d.propertyName]=i===null?d.type===3?!1:"":i:(r=d.attributeName,c=d.attributeNamespace,i===null?e.removeAttribute(r):(d=d.type,i=d===3||d===4&&i===!0?"":""+i,c?e.setAttributeNS(c,r,i):e.setAttribute(r,i))))}var ua=oD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Qm=Symbol.for("react.element"),eh=Symbol.for("react.portal"),th=Symbol.for("react.fragment"),Eb=Symbol.for("react.strict_mode"),G0=Symbol.for("react.profiler"),uP=Symbol.for("react.provider"),hP=Symbol.for("react.context"),Mb=Symbol.for("react.forward_ref"),H0=Symbol.for("react.suspense"),W0=Symbol.for("react.suspense_list"),kb=Symbol.for("react.memo"),qa=Symbol.for("react.lazy"),dP=Symbol.for("react.offscreen"),N2=Symbol.iterator;function ff(e){return e===null||typeof e!="object"?null:(e=N2&&e[N2]||e["@@iterator"],typeof e=="function"?e:null)}var Xr=Object.assign,Uv;function Tf(e){if(Uv===void 0)try{throw Error()}catch(i){var r=i.stack.trim().match(/\n( *(at )?)/);Uv=r&&r[1]||""}return`
`+Uv+e}var Vv=!1;function Zv(e,r){if(!e||Vv)return"";Vv=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error()},Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(P){var c=P}Reflect.construct(e,[],r)}else{try{r.call()}catch(P){c=P}e.call(r.prototype)}else{try{throw Error()}catch(P){c=P}e()}}catch(P){if(P&&c&&typeof P.stack=="string"){for(var d=P.stack.split(`
`),g=c.stack.split(`
`),m=d.length-1,l=g.length-1;1<=m&&0<=l&&d[m]!==g[l];)l--;for(;1<=m&&0<=l;m--,l--)if(d[m]!==g[l]){if(m!==1||l!==1)do if(m--,l--,0>l||d[m]!==g[l]){var E=`
`+d[m].replace(" at new "," at ");return e.displayName&&E.includes("<anonymous>")&&(E=E.replace("<anonymous>",e.displayName)),E}while(1<=m&&0<=l);break}}}finally{Vv=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?Tf(e):""}function uD(e){switch(e.tag){case 5:return Tf(e.type);case 16:return Tf("Lazy");case 13:return Tf("Suspense");case 19:return Tf("SuspenseList");case 0:case 2:case 15:return e=Zv(e.type,!1),e;case 11:return e=Zv(e.type.render,!1),e;case 1:return e=Zv(e.type,!0),e;default:return""}}function q0(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case th:return"Fragment";case eh:return"Portal";case G0:return"Profiler";case Eb:return"StrictMode";case H0:return"Suspense";case W0:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case hP:return(e.displayName||"Context")+".Consumer";case uP:return(e._context.displayName||"Context")+".Provider";case Mb:var r=e.render;return e=e.displayName,e||(e=r.displayName||r.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case kb:return r=e.displayName||null,r!==null?r:q0(e.type)||"Memo";case qa:r=e._payload,e=e._init;try{return q0(e(r))}catch{}}return null}function hD(e){var r=e.type;switch(e.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=r.render,e=e.displayName||e.name||"",r.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return q0(r);case 8:return r===Eb?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r}return null}function vl(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function fP(e){var r=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function dD(e){var r=fP(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,r),c=""+e[r];if(!e.hasOwnProperty(r)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var d=i.get,g=i.set;return Object.defineProperty(e,r,{configurable:!0,get:function(){return d.call(this)},set:function(m){c=""+m,g.call(this,m)}}),Object.defineProperty(e,r,{enumerable:i.enumerable}),{getValue:function(){return c},setValue:function(m){c=""+m},stopTracking:function(){e._valueTracker=null,delete e[r]}}}}function Jm(e){e._valueTracker||(e._valueTracker=dD(e))}function pP(e){if(!e)return!1;var r=e._valueTracker;if(!r)return!0;var i=r.getValue(),c="";return e&&(c=fP(e)?e.checked?"true":"false":e.value),e=c,e!==i?(r.setValue(e),!0):!1}function Qg(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function X0(e,r){var i=r.checked;return Xr({},r,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??e._wrapperState.initialChecked})}function B2(e,r){var i=r.defaultValue==null?"":r.defaultValue,c=r.checked!=null?r.checked:r.defaultChecked;i=vl(r.value!=null?r.value:i),e._wrapperState={initialChecked:c,initialValue:i,controlled:r.type==="checkbox"||r.type==="radio"?r.checked!=null:r.value!=null}}function mP(e,r){r=r.checked,r!=null&&Pb(e,"checked",r,!1)}function K0(e,r){mP(e,r);var i=vl(r.value),c=r.type;if(i!=null)c==="number"?(i===0&&e.value===""||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if(c==="submit"||c==="reset"){e.removeAttribute("value");return}r.hasOwnProperty("value")?Y0(e,r.type,i):r.hasOwnProperty("defaultValue")&&Y0(e,r.type,vl(r.defaultValue)),r.checked==null&&r.defaultChecked!=null&&(e.defaultChecked=!!r.defaultChecked)}function j2(e,r,i){if(r.hasOwnProperty("value")||r.hasOwnProperty("defaultValue")){var c=r.type;if(!(c!=="submit"&&c!=="reset"||r.value!==void 0&&r.value!==null))return;r=""+e._wrapperState.initialValue,i||r===e.value||(e.value=r),e.defaultValue=r}i=e.name,i!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,i!==""&&(e.name=i)}function Y0(e,r,i){(r!=="number"||Qg(e.ownerDocument)!==e)&&(i==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var Cf=Array.isArray;function fh(e,r,i,c){if(e=e.options,r){r={};for(var d=0;d<i.length;d++)r["$"+i[d]]=!0;for(i=0;i<e.length;i++)d=r.hasOwnProperty("$"+e[i].value),e[i].selected!==d&&(e[i].selected=d),d&&c&&(e[i].defaultSelected=!0)}else{for(i=""+vl(i),r=null,d=0;d<e.length;d++){if(e[d].value===i){e[d].selected=!0,c&&(e[d].defaultSelected=!0);return}r!==null||e[d].disabled||(r=e[d])}r!==null&&(r.selected=!0)}}function Q0(e,r){if(r.dangerouslySetInnerHTML!=null)throw Error(lt(91));return Xr({},r,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function $2(e,r){var i=r.value;if(i==null){if(i=r.children,r=r.defaultValue,i!=null){if(r!=null)throw Error(lt(92));if(Cf(i)){if(1<i.length)throw Error(lt(93));i=i[0]}r=i}r==null&&(r=""),i=r}e._wrapperState={initialValue:vl(i)}}function gP(e,r){var i=vl(r.value),c=vl(r.defaultValue);i!=null&&(i=""+i,i!==e.value&&(e.value=i),r.defaultValue==null&&e.defaultValue!==i&&(e.defaultValue=i)),c!=null&&(e.defaultValue=""+c)}function U2(e){var r=e.textContent;r===e._wrapperState.initialValue&&r!==""&&r!==null&&(e.value=r)}function _P(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function J0(e,r){return e==null||e==="http://www.w3.org/1999/xhtml"?_P(r):e==="http://www.w3.org/2000/svg"&&r==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var eg,yP=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(r,i,c,d){MSApp.execUnsafeLocalFunction(function(){return e(r,i,c,d)})}:e}(function(e,r){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=r;else{for(eg=eg||document.createElement("div"),eg.innerHTML="<svg>"+r.valueOf().toString()+"</svg>",r=eg.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;r.firstChild;)e.appendChild(r.firstChild)}});function Gf(e,r){if(r){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=r;return}}e.textContent=r}var Af={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fD=["Webkit","ms","Moz","O"];Object.keys(Af).forEach(function(e){fD.forEach(function(r){r=r+e.charAt(0).toUpperCase()+e.substring(1),Af[r]=Af[e]})});function vP(e,r,i){return r==null||typeof r=="boolean"||r===""?"":i||typeof r!="number"||r===0||Af.hasOwnProperty(e)&&Af[e]?(""+r).trim():r+"px"}function xP(e,r){e=e.style;for(var i in r)if(r.hasOwnProperty(i)){var c=i.indexOf("--")===0,d=vP(i,r[i],c);i==="float"&&(i="cssFloat"),c?e.setProperty(i,d):e[i]=d}}var pD=Xr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ex(e,r){if(r){if(pD[e]&&(r.children!=null||r.dangerouslySetInnerHTML!=null))throw Error(lt(137,e));if(r.dangerouslySetInnerHTML!=null){if(r.children!=null)throw Error(lt(60));if(typeof r.dangerouslySetInnerHTML!="object"||!("__html"in r.dangerouslySetInnerHTML))throw Error(lt(61))}if(r.style!=null&&typeof r.style!="object")throw Error(lt(62))}}function tx(e,r){if(e.indexOf("-")===-1)return typeof r.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rx=null;function Ib(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var nx=null,ph=null,mh=null;function V2(e){if(e=Mp(e)){if(typeof nx!="function")throw Error(lt(280));var r=e.stateNode;r&&(r=G_(r),nx(e.stateNode,e.type,r))}}function bP(e){ph?mh?mh.push(e):mh=[e]:ph=e}function wP(){if(ph){var e=ph,r=mh;if(mh=ph=null,V2(e),r)for(e=0;e<r.length;e++)V2(r[e])}}function SP(e,r){return e(r)}function TP(){}var Gv=!1;function CP(e,r,i){if(Gv)return e(r,i);Gv=!0;try{return SP(e,r,i)}finally{Gv=!1,(ph!==null||mh!==null)&&(TP(),wP())}}function Hf(e,r){var i=e.stateNode;if(i===null)return null;var c=G_(i);if(c===null)return null;i=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(e=e.type,c=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!c;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(lt(231,r,typeof i));return i}var ix=!1;if(ia)try{var pf={};Object.defineProperty(pf,"passive",{get:function(){ix=!0}}),window.addEventListener("test",pf,pf),window.removeEventListener("test",pf,pf)}catch{ix=!1}function mD(e,r,i,c,d,g,m,l,E){var P=Array.prototype.slice.call(arguments,3);try{r.apply(i,P)}catch(R){this.onError(R)}}var zf=!1,Jg=null,e_=!1,ox=null,gD={onError:function(e){zf=!0,Jg=e}};function _D(e,r,i,c,d,g,m,l,E){zf=!1,Jg=null,mD.apply(gD,arguments)}function yD(e,r,i,c,d,g,m,l,E){if(_D.apply(this,arguments),zf){if(zf){var P=Jg;zf=!1,Jg=null}else throw Error(lt(198));e_||(e_=!0,ox=P)}}function Xc(e){var r=e,i=e;if(e.alternate)for(;r.return;)r=r.return;else{e=r;do r=e,r.flags&4098&&(i=r.return),e=r.return;while(e)}return r.tag===3?i:null}function PP(e){if(e.tag===13){var r=e.memoizedState;if(r===null&&(e=e.alternate,e!==null&&(r=e.memoizedState)),r!==null)return r.dehydrated}return null}function Z2(e){if(Xc(e)!==e)throw Error(lt(188))}function vD(e){var r=e.alternate;if(!r){if(r=Xc(e),r===null)throw Error(lt(188));return r!==e?null:e}for(var i=e,c=r;;){var d=i.return;if(d===null)break;var g=d.alternate;if(g===null){if(c=d.return,c!==null){i=c;continue}break}if(d.child===g.child){for(g=d.child;g;){if(g===i)return Z2(d),e;if(g===c)return Z2(d),r;g=g.sibling}throw Error(lt(188))}if(i.return!==c.return)i=d,c=g;else{for(var m=!1,l=d.child;l;){if(l===i){m=!0,i=d,c=g;break}if(l===c){m=!0,c=d,i=g;break}l=l.sibling}if(!m){for(l=g.child;l;){if(l===i){m=!0,i=g,c=d;break}if(l===c){m=!0,c=g,i=d;break}l=l.sibling}if(!m)throw Error(lt(189))}}if(i.alternate!==c)throw Error(lt(190))}if(i.tag!==3)throw Error(lt(188));return i.stateNode.current===i?e:r}function EP(e){return e=vD(e),e!==null?MP(e):null}function MP(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var r=MP(e);if(r!==null)return r;e=e.sibling}return null}var kP=eo.unstable_scheduleCallback,G2=eo.unstable_cancelCallback,xD=eo.unstable_shouldYield,bD=eo.unstable_requestPaint,un=eo.unstable_now,wD=eo.unstable_getCurrentPriorityLevel,Ab=eo.unstable_ImmediatePriority,IP=eo.unstable_UserBlockingPriority,t_=eo.unstable_NormalPriority,SD=eo.unstable_LowPriority,AP=eo.unstable_IdlePriority,$_=null,ws=null;function TD(e){if(ws&&typeof ws.onCommitFiberRoot=="function")try{ws.onCommitFiberRoot($_,e,void 0,(e.current.flags&128)===128)}catch{}}var Go=Math.clz32?Math.clz32:ED,CD=Math.log,PD=Math.LN2;function ED(e){return e>>>=0,e===0?32:31-(CD(e)/PD|0)|0}var tg=64,rg=4194304;function Pf(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function r_(e,r){var i=e.pendingLanes;if(i===0)return 0;var c=0,d=e.suspendedLanes,g=e.pingedLanes,m=i&268435455;if(m!==0){var l=m&~d;l!==0?c=Pf(l):(g&=m,g!==0&&(c=Pf(g)))}else m=i&~d,m!==0?c=Pf(m):g!==0&&(c=Pf(g));if(c===0)return 0;if(r!==0&&r!==c&&!(r&d)&&(d=c&-c,g=r&-r,d>=g||d===16&&(g&4194240)!==0))return r;if(c&4&&(c|=i&16),r=e.entangledLanes,r!==0)for(e=e.entanglements,r&=c;0<r;)i=31-Go(r),d=1<<i,c|=e[i],r&=~d;return c}function MD(e,r){switch(e){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function kD(e,r){for(var i=e.suspendedLanes,c=e.pingedLanes,d=e.expirationTimes,g=e.pendingLanes;0<g;){var m=31-Go(g),l=1<<m,E=d[m];E===-1?(!(l&i)||l&c)&&(d[m]=MD(l,r)):E<=r&&(e.expiredLanes|=l),g&=~l}}function sx(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function zP(){var e=tg;return tg<<=1,!(tg&4194240)&&(tg=64),e}function Hv(e){for(var r=[],i=0;31>i;i++)r.push(e);return r}function Pp(e,r,i){e.pendingLanes|=r,r!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,r=31-Go(r),e[r]=i}function ID(e,r){var i=e.pendingLanes&~r;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=r,e.mutableReadLanes&=r,e.entangledLanes&=r,r=e.entanglements;var c=e.eventTimes;for(e=e.expirationTimes;0<i;){var d=31-Go(i),g=1<<d;r[d]=0,c[d]=-1,e[d]=-1,i&=~g}}function zb(e,r){var i=e.entangledLanes|=r;for(e=e.entanglements;i;){var c=31-Go(i),d=1<<c;d&r|e[c]&r&&(e[c]|=r),i&=~d}}var vr=0;function RP(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var DP,Rb,LP,OP,FP,ax=!1,ng=[],ll=null,cl=null,ul=null,Wf=new Map,qf=new Map,Ka=[],AD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function H2(e,r){switch(e){case"focusin":case"focusout":ll=null;break;case"dragenter":case"dragleave":cl=null;break;case"mouseover":case"mouseout":ul=null;break;case"pointerover":case"pointerout":Wf.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":qf.delete(r.pointerId)}}function mf(e,r,i,c,d,g){return e===null||e.nativeEvent!==g?(e={blockedOn:r,domEventName:i,eventSystemFlags:c,nativeEvent:g,targetContainers:[d]},r!==null&&(r=Mp(r),r!==null&&Rb(r)),e):(e.eventSystemFlags|=c,r=e.targetContainers,d!==null&&r.indexOf(d)===-1&&r.push(d),e)}function zD(e,r,i,c,d){switch(r){case"focusin":return ll=mf(ll,e,r,i,c,d),!0;case"dragenter":return cl=mf(cl,e,r,i,c,d),!0;case"mouseover":return ul=mf(ul,e,r,i,c,d),!0;case"pointerover":var g=d.pointerId;return Wf.set(g,mf(Wf.get(g)||null,e,r,i,c,d)),!0;case"gotpointercapture":return g=d.pointerId,qf.set(g,mf(qf.get(g)||null,e,r,i,c,d)),!0}return!1}function NP(e){var r=bc(e.target);if(r!==null){var i=Xc(r);if(i!==null){if(r=i.tag,r===13){if(r=PP(i),r!==null){e.blockedOn=r,FP(e.priority,function(){LP(i)});return}}else if(r===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Rg(e){if(e.blockedOn!==null)return!1;for(var r=e.targetContainers;0<r.length;){var i=lx(e.domEventName,e.eventSystemFlags,r[0],e.nativeEvent);if(i===null){i=e.nativeEvent;var c=new i.constructor(i.type,i);rx=c,i.target.dispatchEvent(c),rx=null}else return r=Mp(i),r!==null&&Rb(r),e.blockedOn=i,!1;r.shift()}return!0}function W2(e,r,i){Rg(e)&&i.delete(r)}function RD(){ax=!1,ll!==null&&Rg(ll)&&(ll=null),cl!==null&&Rg(cl)&&(cl=null),ul!==null&&Rg(ul)&&(ul=null),Wf.forEach(W2),qf.forEach(W2)}function gf(e,r){e.blockedOn===r&&(e.blockedOn=null,ax||(ax=!0,eo.unstable_scheduleCallback(eo.unstable_NormalPriority,RD)))}function Xf(e){function r(d){return gf(d,e)}if(0<ng.length){gf(ng[0],e);for(var i=1;i<ng.length;i++){var c=ng[i];c.blockedOn===e&&(c.blockedOn=null)}}for(ll!==null&&gf(ll,e),cl!==null&&gf(cl,e),ul!==null&&gf(ul,e),Wf.forEach(r),qf.forEach(r),i=0;i<Ka.length;i++)c=Ka[i],c.blockedOn===e&&(c.blockedOn=null);for(;0<Ka.length&&(i=Ka[0],i.blockedOn===null);)NP(i),i.blockedOn===null&&Ka.shift()}var gh=ua.ReactCurrentBatchConfig,n_=!0;function DD(e,r,i,c){var d=vr,g=gh.transition;gh.transition=null;try{vr=1,Db(e,r,i,c)}finally{vr=d,gh.transition=g}}function LD(e,r,i,c){var d=vr,g=gh.transition;gh.transition=null;try{vr=4,Db(e,r,i,c)}finally{vr=d,gh.transition=g}}function Db(e,r,i,c){if(n_){var d=lx(e,r,i,c);if(d===null)r0(e,r,c,i_,i),H2(e,c);else if(zD(d,e,r,i,c))c.stopPropagation();else if(H2(e,c),r&4&&-1<AD.indexOf(e)){for(;d!==null;){var g=Mp(d);if(g!==null&&DP(g),g=lx(e,r,i,c),g===null&&r0(e,r,c,i_,i),g===d)break;d=g}d!==null&&c.stopPropagation()}else r0(e,r,c,null,i)}}var i_=null;function lx(e,r,i,c){if(i_=null,e=Ib(c),e=bc(e),e!==null)if(r=Xc(e),r===null)e=null;else if(i=r.tag,i===13){if(e=PP(r),e!==null)return e;e=null}else if(i===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;e=null}else r!==e&&(e=null);return i_=e,null}function BP(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(wD()){case Ab:return 1;case IP:return 4;case t_:case SD:return 16;case AP:return 536870912;default:return 16}default:return 16}}var il=null,Lb=null,Dg=null;function jP(){if(Dg)return Dg;var e,r=Lb,i=r.length,c,d="value"in il?il.value:il.textContent,g=d.length;for(e=0;e<i&&r[e]===d[e];e++);var m=i-e;for(c=1;c<=m&&r[i-c]===d[g-c];c++);return Dg=d.slice(e,1<c?1-c:void 0)}function Lg(e){var r=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&r===13&&(e=13)):e=r,e===10&&(e=13),32<=e||e===13?e:0}function ig(){return!0}function q2(){return!1}function ro(e){function r(i,c,d,g,m){this._reactName=i,this._targetInst=d,this.type=c,this.nativeEvent=g,this.target=m,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(i=e[l],this[l]=i?i(g):g[l]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?ig:q2,this.isPropagationStopped=q2,this}return Xr(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=ig)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=ig)},persist:function(){},isPersistent:ig}),r}var Hh={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ob=ro(Hh),Ep=Xr({},Hh,{view:0,detail:0}),OD=ro(Ep),Wv,qv,_f,U_=Xr({},Ep,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Fb,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==_f&&(_f&&e.type==="mousemove"?(Wv=e.screenX-_f.screenX,qv=e.screenY-_f.screenY):qv=Wv=0,_f=e),Wv)},movementY:function(e){return"movementY"in e?e.movementY:qv}}),X2=ro(U_),FD=Xr({},U_,{dataTransfer:0}),ND=ro(FD),BD=Xr({},Ep,{relatedTarget:0}),Xv=ro(BD),jD=Xr({},Hh,{animationName:0,elapsedTime:0,pseudoElement:0}),$D=ro(jD),UD=Xr({},Hh,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),VD=ro(UD),ZD=Xr({},Hh,{data:0}),K2=ro(ZD),GD={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},HD={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},WD={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qD(e){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(e):(e=WD[e])?!!r[e]:!1}function Fb(){return qD}var XD=Xr({},Ep,{key:function(e){if(e.key){var r=GD[e.key]||e.key;if(r!=="Unidentified")return r}return e.type==="keypress"?(e=Lg(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?HD[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Fb,charCode:function(e){return e.type==="keypress"?Lg(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Lg(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),KD=ro(XD),YD=Xr({},U_,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Y2=ro(YD),QD=Xr({},Ep,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Fb}),JD=ro(QD),eL=Xr({},Hh,{propertyName:0,elapsedTime:0,pseudoElement:0}),tL=ro(eL),rL=Xr({},U_,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),nL=ro(rL),iL=[9,13,27,32],Nb=ia&&"CompositionEvent"in window,Rf=null;ia&&"documentMode"in document&&(Rf=document.documentMode);var oL=ia&&"TextEvent"in window&&!Rf,$P=ia&&(!Nb||Rf&&8<Rf&&11>=Rf),Q2=" ",J2=!1;function UP(e,r){switch(e){case"keyup":return iL.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function VP(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var rh=!1;function sL(e,r){switch(e){case"compositionend":return VP(r);case"keypress":return r.which!==32?null:(J2=!0,Q2);case"textInput":return e=r.data,e===Q2&&J2?null:e;default:return null}}function aL(e,r){if(rh)return e==="compositionend"||!Nb&&UP(e,r)?(e=jP(),Dg=Lb=il=null,rh=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return $P&&r.locale!=="ko"?null:r.data;default:return null}}var lL={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function eS(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r==="input"?!!lL[e.type]:r==="textarea"}function ZP(e,r,i,c){bP(c),r=o_(r,"onChange"),0<r.length&&(i=new Ob("onChange","change",null,i,c),e.push({event:i,listeners:r}))}var Df=null,Kf=null;function cL(e){tE(e,0)}function V_(e){var r=oh(e);if(pP(r))return e}function uL(e,r){if(e==="change")return r}var GP=!1;if(ia){var Kv;if(ia){var Yv="oninput"in document;if(!Yv){var tS=document.createElement("div");tS.setAttribute("oninput","return;"),Yv=typeof tS.oninput=="function"}Kv=Yv}else Kv=!1;GP=Kv&&(!document.documentMode||9<document.documentMode)}function rS(){Df&&(Df.detachEvent("onpropertychange",HP),Kf=Df=null)}function HP(e){if(e.propertyName==="value"&&V_(Kf)){var r=[];ZP(r,Kf,e,Ib(e)),CP(cL,r)}}function hL(e,r,i){e==="focusin"?(rS(),Df=r,Kf=i,Df.attachEvent("onpropertychange",HP)):e==="focusout"&&rS()}function dL(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return V_(Kf)}function fL(e,r){if(e==="click")return V_(r)}function pL(e,r){if(e==="input"||e==="change")return V_(r)}function mL(e,r){return e===r&&(e!==0||1/e===1/r)||e!==e&&r!==r}var Wo=typeof Object.is=="function"?Object.is:mL;function Yf(e,r){if(Wo(e,r))return!0;if(typeof e!="object"||e===null||typeof r!="object"||r===null)return!1;var i=Object.keys(e),c=Object.keys(r);if(i.length!==c.length)return!1;for(c=0;c<i.length;c++){var d=i[c];if(!Z0.call(r,d)||!Wo(e[d],r[d]))return!1}return!0}function nS(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function iS(e,r){var i=nS(e);e=0;for(var c;i;){if(i.nodeType===3){if(c=e+i.textContent.length,e<=r&&c>=r)return{node:i,offset:r-e};e=c}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=nS(i)}}function WP(e,r){return e&&r?e===r?!0:e&&e.nodeType===3?!1:r&&r.nodeType===3?WP(e,r.parentNode):"contains"in e?e.contains(r):e.compareDocumentPosition?!!(e.compareDocumentPosition(r)&16):!1:!1}function qP(){for(var e=window,r=Qg();r instanceof e.HTMLIFrameElement;){try{var i=typeof r.contentWindow.location.href=="string"}catch{i=!1}if(i)e=r.contentWindow;else break;r=Qg(e.document)}return r}function Bb(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r&&(r==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||r==="textarea"||e.contentEditable==="true")}function gL(e){var r=qP(),i=e.focusedElem,c=e.selectionRange;if(r!==i&&i&&i.ownerDocument&&WP(i.ownerDocument.documentElement,i)){if(c!==null&&Bb(i)){if(r=c.start,e=c.end,e===void 0&&(e=r),"selectionStart"in i)i.selectionStart=r,i.selectionEnd=Math.min(e,i.value.length);else if(e=(r=i.ownerDocument||document)&&r.defaultView||window,e.getSelection){e=e.getSelection();var d=i.textContent.length,g=Math.min(c.start,d);c=c.end===void 0?g:Math.min(c.end,d),!e.extend&&g>c&&(d=c,c=g,g=d),d=iS(i,g);var m=iS(i,c);d&&m&&(e.rangeCount!==1||e.anchorNode!==d.node||e.anchorOffset!==d.offset||e.focusNode!==m.node||e.focusOffset!==m.offset)&&(r=r.createRange(),r.setStart(d.node,d.offset),e.removeAllRanges(),g>c?(e.addRange(r),e.extend(m.node,m.offset)):(r.setEnd(m.node,m.offset),e.addRange(r)))}}for(r=[],e=i;e=e.parentNode;)e.nodeType===1&&r.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<r.length;i++)e=r[i],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var _L=ia&&"documentMode"in document&&11>=document.documentMode,nh=null,cx=null,Lf=null,ux=!1;function oS(e,r,i){var c=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;ux||nh==null||nh!==Qg(c)||(c=nh,"selectionStart"in c&&Bb(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Lf&&Yf(Lf,c)||(Lf=c,c=o_(cx,"onSelect"),0<c.length&&(r=new Ob("onSelect","select",null,r,i),e.push({event:r,listeners:c}),r.target=nh)))}function og(e,r){var i={};return i[e.toLowerCase()]=r.toLowerCase(),i["Webkit"+e]="webkit"+r,i["Moz"+e]="moz"+r,i}var ih={animationend:og("Animation","AnimationEnd"),animationiteration:og("Animation","AnimationIteration"),animationstart:og("Animation","AnimationStart"),transitionend:og("Transition","TransitionEnd")},Qv={},XP={};ia&&(XP=document.createElement("div").style,"AnimationEvent"in window||(delete ih.animationend.animation,delete ih.animationiteration.animation,delete ih.animationstart.animation),"TransitionEvent"in window||delete ih.transitionend.transition);function Z_(e){if(Qv[e])return Qv[e];if(!ih[e])return e;var r=ih[e],i;for(i in r)if(r.hasOwnProperty(i)&&i in XP)return Qv[e]=r[i];return e}var KP=Z_("animationend"),YP=Z_("animationiteration"),QP=Z_("animationstart"),JP=Z_("transitionend"),eE=new Map,sS="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Sl(e,r){eE.set(e,r),qc(r,[e])}for(var Jv=0;Jv<sS.length;Jv++){var e0=sS[Jv],yL=e0.toLowerCase(),vL=e0[0].toUpperCase()+e0.slice(1);Sl(yL,"on"+vL)}Sl(KP,"onAnimationEnd");Sl(YP,"onAnimationIteration");Sl(QP,"onAnimationStart");Sl("dblclick","onDoubleClick");Sl("focusin","onFocus");Sl("focusout","onBlur");Sl(JP,"onTransitionEnd");Rh("onMouseEnter",["mouseout","mouseover"]);Rh("onMouseLeave",["mouseout","mouseover"]);Rh("onPointerEnter",["pointerout","pointerover"]);Rh("onPointerLeave",["pointerout","pointerover"]);qc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));qc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));qc("onBeforeInput",["compositionend","keypress","textInput","paste"]);qc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));qc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));qc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ef="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xL=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ef));function aS(e,r,i){var c=e.type||"unknown-event";e.currentTarget=i,yD(c,r,void 0,e),e.currentTarget=null}function tE(e,r){r=(r&4)!==0;for(var i=0;i<e.length;i++){var c=e[i],d=c.event;c=c.listeners;e:{var g=void 0;if(r)for(var m=c.length-1;0<=m;m--){var l=c[m],E=l.instance,P=l.currentTarget;if(l=l.listener,E!==g&&d.isPropagationStopped())break e;aS(d,l,P),g=E}else for(m=0;m<c.length;m++){if(l=c[m],E=l.instance,P=l.currentTarget,l=l.listener,E!==g&&d.isPropagationStopped())break e;aS(d,l,P),g=E}}}if(e_)throw e=ox,e_=!1,ox=null,e}function Nr(e,r){var i=r[mx];i===void 0&&(i=r[mx]=new Set);var c=e+"__bubble";i.has(c)||(rE(r,e,2,!1),i.add(c))}function t0(e,r,i){var c=0;r&&(c|=4),rE(i,e,c,r)}var sg="_reactListening"+Math.random().toString(36).slice(2);function Qf(e){if(!e[sg]){e[sg]=!0,cP.forEach(function(i){i!=="selectionchange"&&(xL.has(i)||t0(i,!1,e),t0(i,!0,e))});var r=e.nodeType===9?e:e.ownerDocument;r===null||r[sg]||(r[sg]=!0,t0("selectionchange",!1,r))}}function rE(e,r,i,c){switch(BP(r)){case 1:var d=DD;break;case 4:d=LD;break;default:d=Db}i=d.bind(null,r,i,e),d=void 0,!ix||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(d=!0),c?d!==void 0?e.addEventListener(r,i,{capture:!0,passive:d}):e.addEventListener(r,i,!0):d!==void 0?e.addEventListener(r,i,{passive:d}):e.addEventListener(r,i,!1)}function r0(e,r,i,c,d){var g=c;if(!(r&1)&&!(r&2)&&c!==null)e:for(;;){if(c===null)return;var m=c.tag;if(m===3||m===4){var l=c.stateNode.containerInfo;if(l===d||l.nodeType===8&&l.parentNode===d)break;if(m===4)for(m=c.return;m!==null;){var E=m.tag;if((E===3||E===4)&&(E=m.stateNode.containerInfo,E===d||E.nodeType===8&&E.parentNode===d))return;m=m.return}for(;l!==null;){if(m=bc(l),m===null)return;if(E=m.tag,E===5||E===6){c=g=m;continue e}l=l.parentNode}}c=c.return}CP(function(){var P=g,R=Ib(i),N=[];e:{var F=eE.get(e);if(F!==void 0){var A=Ob,X=e;switch(e){case"keypress":if(Lg(i)===0)break e;case"keydown":case"keyup":A=KD;break;case"focusin":X="focus",A=Xv;break;case"focusout":X="blur",A=Xv;break;case"beforeblur":case"afterblur":A=Xv;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":A=X2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":A=ND;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":A=JD;break;case KP:case YP:case QP:A=$D;break;case JP:A=tL;break;case"scroll":A=OD;break;case"wheel":A=nL;break;case"copy":case"cut":case"paste":A=VD;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":A=Y2}var Z=(r&4)!==0,ee=!Z&&e==="scroll",H=Z?F!==null?F+"Capture":null:F;Z=[];for(var U=P,W;U!==null;){W=U;var re=W.stateNode;if(W.tag===5&&re!==null&&(W=re,H!==null&&(re=Hf(U,H),re!=null&&Z.push(Jf(U,re,W)))),ee)break;U=U.return}0<Z.length&&(F=new A(F,X,null,i,R),N.push({event:F,listeners:Z}))}}if(!(r&7)){e:{if(F=e==="mouseover"||e==="pointerover",A=e==="mouseout"||e==="pointerout",F&&i!==rx&&(X=i.relatedTarget||i.fromElement)&&(bc(X)||X[oa]))break e;if((A||F)&&(F=R.window===R?R:(F=R.ownerDocument)?F.defaultView||F.parentWindow:window,A?(X=i.relatedTarget||i.toElement,A=P,X=X?bc(X):null,X!==null&&(ee=Xc(X),X!==ee||X.tag!==5&&X.tag!==6)&&(X=null)):(A=null,X=P),A!==X)){if(Z=X2,re="onMouseLeave",H="onMouseEnter",U="mouse",(e==="pointerout"||e==="pointerover")&&(Z=Y2,re="onPointerLeave",H="onPointerEnter",U="pointer"),ee=A==null?F:oh(A),W=X==null?F:oh(X),F=new Z(re,U+"leave",A,i,R),F.target=ee,F.relatedTarget=W,re=null,bc(R)===P&&(Z=new Z(H,U+"enter",X,i,R),Z.target=W,Z.relatedTarget=ee,re=Z),ee=re,A&&X)t:{for(Z=A,H=X,U=0,W=Z;W;W=qu(W))U++;for(W=0,re=H;re;re=qu(re))W++;for(;0<U-W;)Z=qu(Z),U--;for(;0<W-U;)H=qu(H),W--;for(;U--;){if(Z===H||H!==null&&Z===H.alternate)break t;Z=qu(Z),H=qu(H)}Z=null}else Z=null;A!==null&&lS(N,F,A,Z,!1),X!==null&&ee!==null&&lS(N,ee,X,Z,!0)}}e:{if(F=P?oh(P):window,A=F.nodeName&&F.nodeName.toLowerCase(),A==="select"||A==="input"&&F.type==="file")var ge=uL;else if(eS(F))if(GP)ge=pL;else{ge=dL;var Te=hL}else(A=F.nodeName)&&A.toLowerCase()==="input"&&(F.type==="checkbox"||F.type==="radio")&&(ge=fL);if(ge&&(ge=ge(e,P))){ZP(N,ge,i,R);break e}Te&&Te(e,F,P),e==="focusout"&&(Te=F._wrapperState)&&Te.controlled&&F.type==="number"&&Y0(F,"number",F.value)}switch(Te=P?oh(P):window,e){case"focusin":(eS(Te)||Te.contentEditable==="true")&&(nh=Te,cx=P,Lf=null);break;case"focusout":Lf=cx=nh=null;break;case"mousedown":ux=!0;break;case"contextmenu":case"mouseup":case"dragend":ux=!1,oS(N,i,R);break;case"selectionchange":if(_L)break;case"keydown":case"keyup":oS(N,i,R)}var xe;if(Nb)e:{switch(e){case"compositionstart":var ze="onCompositionStart";break e;case"compositionend":ze="onCompositionEnd";break e;case"compositionupdate":ze="onCompositionUpdate";break e}ze=void 0}else rh?UP(e,i)&&(ze="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(ze="onCompositionStart");ze&&($P&&i.locale!=="ko"&&(rh||ze!=="onCompositionStart"?ze==="onCompositionEnd"&&rh&&(xe=jP()):(il=R,Lb="value"in il?il.value:il.textContent,rh=!0)),Te=o_(P,ze),0<Te.length&&(ze=new K2(ze,e,null,i,R),N.push({event:ze,listeners:Te}),xe?ze.data=xe:(xe=VP(i),xe!==null&&(ze.data=xe)))),(xe=oL?sL(e,i):aL(e,i))&&(P=o_(P,"onBeforeInput"),0<P.length&&(R=new K2("onBeforeInput","beforeinput",null,i,R),N.push({event:R,listeners:P}),R.data=xe))}tE(N,r)})}function Jf(e,r,i){return{instance:e,listener:r,currentTarget:i}}function o_(e,r){for(var i=r+"Capture",c=[];e!==null;){var d=e,g=d.stateNode;d.tag===5&&g!==null&&(d=g,g=Hf(e,i),g!=null&&c.unshift(Jf(e,g,d)),g=Hf(e,r),g!=null&&c.push(Jf(e,g,d))),e=e.return}return c}function qu(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function lS(e,r,i,c,d){for(var g=r._reactName,m=[];i!==null&&i!==c;){var l=i,E=l.alternate,P=l.stateNode;if(E!==null&&E===c)break;l.tag===5&&P!==null&&(l=P,d?(E=Hf(i,g),E!=null&&m.unshift(Jf(i,E,l))):d||(E=Hf(i,g),E!=null&&m.push(Jf(i,E,l)))),i=i.return}m.length!==0&&e.push({event:r,listeners:m})}var bL=/\r\n?/g,wL=/\u0000|\uFFFD/g;function cS(e){return(typeof e=="string"?e:""+e).replace(bL,`
`).replace(wL,"")}function ag(e,r,i){if(r=cS(r),cS(e)!==r&&i)throw Error(lt(425))}function s_(){}var hx=null,dx=null;function fx(e,r){return e==="textarea"||e==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var px=typeof setTimeout=="function"?setTimeout:void 0,SL=typeof clearTimeout=="function"?clearTimeout:void 0,uS=typeof Promise=="function"?Promise:void 0,TL=typeof queueMicrotask=="function"?queueMicrotask:typeof uS<"u"?function(e){return uS.resolve(null).then(e).catch(CL)}:px;function CL(e){setTimeout(function(){throw e})}function n0(e,r){var i=r,c=0;do{var d=i.nextSibling;if(e.removeChild(i),d&&d.nodeType===8)if(i=d.data,i==="/$"){if(c===0){e.removeChild(d),Xf(r);return}c--}else i!=="$"&&i!=="$?"&&i!=="$!"||c++;i=d}while(i);Xf(r)}function hl(e){for(;e!=null;e=e.nextSibling){var r=e.nodeType;if(r===1||r===3)break;if(r===8){if(r=e.data,r==="$"||r==="$!"||r==="$?")break;if(r==="/$")return null}}return e}function hS(e){e=e.previousSibling;for(var r=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"){if(r===0)return e;r--}else i==="/$"&&r++}e=e.previousSibling}return null}var Wh=Math.random().toString(36).slice(2),ys="__reactFiber$"+Wh,ep="__reactProps$"+Wh,oa="__reactContainer$"+Wh,mx="__reactEvents$"+Wh,PL="__reactListeners$"+Wh,EL="__reactHandles$"+Wh;function bc(e){var r=e[ys];if(r)return r;for(var i=e.parentNode;i;){if(r=i[oa]||i[ys]){if(i=r.alternate,r.child!==null||i!==null&&i.child!==null)for(e=hS(e);e!==null;){if(i=e[ys])return i;e=hS(e)}return r}e=i,i=e.parentNode}return null}function Mp(e){return e=e[ys]||e[oa],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function oh(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(lt(33))}function G_(e){return e[ep]||null}var gx=[],sh=-1;function Tl(e){return{current:e}}function Br(e){0>sh||(e.current=gx[sh],gx[sh]=null,sh--)}function zr(e,r){sh++,gx[sh]=e.current,e.current=r}var xl={},ci=Tl(xl),Ri=Tl(!1),Fc=xl;function Dh(e,r){var i=e.type.contextTypes;if(!i)return xl;var c=e.stateNode;if(c&&c.__reactInternalMemoizedUnmaskedChildContext===r)return c.__reactInternalMemoizedMaskedChildContext;var d={},g;for(g in i)d[g]=r[g];return c&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=d),d}function Di(e){return e=e.childContextTypes,e!=null}function a_(){Br(Ri),Br(ci)}function dS(e,r,i){if(ci.current!==xl)throw Error(lt(168));zr(ci,r),zr(Ri,i)}function nE(e,r,i){var c=e.stateNode;if(r=r.childContextTypes,typeof c.getChildContext!="function")return i;c=c.getChildContext();for(var d in c)if(!(d in r))throw Error(lt(108,hD(e)||"Unknown",d));return Xr({},i,c)}function l_(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||xl,Fc=ci.current,zr(ci,e),zr(Ri,Ri.current),!0}function fS(e,r,i){var c=e.stateNode;if(!c)throw Error(lt(169));i?(e=nE(e,r,Fc),c.__reactInternalMemoizedMergedChildContext=e,Br(Ri),Br(ci),zr(ci,e)):Br(Ri),zr(Ri,i)}var Ys=null,H_=!1,i0=!1;function iE(e){Ys===null?Ys=[e]:Ys.push(e)}function ML(e){H_=!0,iE(e)}function Cl(){if(!i0&&Ys!==null){i0=!0;var e=0,r=vr;try{var i=Ys;for(vr=1;e<i.length;e++){var c=i[e];do c=c(!0);while(c!==null)}Ys=null,H_=!1}catch(d){throw Ys!==null&&(Ys=Ys.slice(e+1)),kP(Ab,Cl),d}finally{vr=r,i0=!1}}return null}var ah=[],lh=0,c_=null,u_=0,fo=[],po=0,Nc=null,ta=1,ra="";function vc(e,r){ah[lh++]=u_,ah[lh++]=c_,c_=e,u_=r}function oE(e,r,i){fo[po++]=ta,fo[po++]=ra,fo[po++]=Nc,Nc=e;var c=ta;e=ra;var d=32-Go(c)-1;c&=~(1<<d),i+=1;var g=32-Go(r)+d;if(30<g){var m=d-d%5;g=(c&(1<<m)-1).toString(32),c>>=m,d-=m,ta=1<<32-Go(r)+d|i<<d|c,ra=g+e}else ta=1<<g|i<<d|c,ra=e}function jb(e){e.return!==null&&(vc(e,1),oE(e,1,0))}function $b(e){for(;e===c_;)c_=ah[--lh],ah[lh]=null,u_=ah[--lh],ah[lh]=null;for(;e===Nc;)Nc=fo[--po],fo[po]=null,ra=fo[--po],fo[po]=null,ta=fo[--po],fo[po]=null}var Qi=null,Ki=null,Vr=!1,Vo=null;function sE(e,r){var i=go(5,null,null,0);i.elementType="DELETED",i.stateNode=r,i.return=e,r=e.deletions,r===null?(e.deletions=[i],e.flags|=16):r.push(i)}function pS(e,r){switch(e.tag){case 5:var i=e.type;return r=r.nodeType!==1||i.toLowerCase()!==r.nodeName.toLowerCase()?null:r,r!==null?(e.stateNode=r,Qi=e,Ki=hl(r.firstChild),!0):!1;case 6:return r=e.pendingProps===""||r.nodeType!==3?null:r,r!==null?(e.stateNode=r,Qi=e,Ki=null,!0):!1;case 13:return r=r.nodeType!==8?null:r,r!==null?(i=Nc!==null?{id:ta,overflow:ra}:null,e.memoizedState={dehydrated:r,treeContext:i,retryLane:1073741824},i=go(18,null,null,0),i.stateNode=r,i.return=e,e.child=i,Qi=e,Ki=null,!0):!1;default:return!1}}function _x(e){return(e.mode&1)!==0&&(e.flags&128)===0}function yx(e){if(Vr){var r=Ki;if(r){var i=r;if(!pS(e,r)){if(_x(e))throw Error(lt(418));r=hl(i.nextSibling);var c=Qi;r&&pS(e,r)?sE(c,i):(e.flags=e.flags&-4097|2,Vr=!1,Qi=e)}}else{if(_x(e))throw Error(lt(418));e.flags=e.flags&-4097|2,Vr=!1,Qi=e}}}function mS(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Qi=e}function lg(e){if(e!==Qi)return!1;if(!Vr)return mS(e),Vr=!0,!1;var r;if((r=e.tag!==3)&&!(r=e.tag!==5)&&(r=e.type,r=r!=="head"&&r!=="body"&&!fx(e.type,e.memoizedProps)),r&&(r=Ki)){if(_x(e))throw aE(),Error(lt(418));for(;r;)sE(e,r),r=hl(r.nextSibling)}if(mS(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(lt(317));e:{for(e=e.nextSibling,r=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"){if(r===0){Ki=hl(e.nextSibling);break e}r--}else i!=="$"&&i!=="$!"&&i!=="$?"||r++}e=e.nextSibling}Ki=null}}else Ki=Qi?hl(e.stateNode.nextSibling):null;return!0}function aE(){for(var e=Ki;e;)e=hl(e.nextSibling)}function Lh(){Ki=Qi=null,Vr=!1}function Ub(e){Vo===null?Vo=[e]:Vo.push(e)}var kL=ua.ReactCurrentBatchConfig;function yf(e,r,i){if(e=i.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(lt(309));var c=i.stateNode}if(!c)throw Error(lt(147,e));var d=c,g=""+e;return r!==null&&r.ref!==null&&typeof r.ref=="function"&&r.ref._stringRef===g?r.ref:(r=function(m){var l=d.refs;m===null?delete l[g]:l[g]=m},r._stringRef=g,r)}if(typeof e!="string")throw Error(lt(284));if(!i._owner)throw Error(lt(290,e))}return e}function cg(e,r){throw e=Object.prototype.toString.call(r),Error(lt(31,e==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":e))}function gS(e){var r=e._init;return r(e._payload)}function lE(e){function r(H,U){if(e){var W=H.deletions;W===null?(H.deletions=[U],H.flags|=16):W.push(U)}}function i(H,U){if(!e)return null;for(;U!==null;)r(H,U),U=U.sibling;return null}function c(H,U){for(H=new Map;U!==null;)U.key!==null?H.set(U.key,U):H.set(U.index,U),U=U.sibling;return H}function d(H,U){return H=ml(H,U),H.index=0,H.sibling=null,H}function g(H,U,W){return H.index=W,e?(W=H.alternate,W!==null?(W=W.index,W<U?(H.flags|=2,U):W):(H.flags|=2,U)):(H.flags|=1048576,U)}function m(H){return e&&H.alternate===null&&(H.flags|=2),H}function l(H,U,W,re){return U===null||U.tag!==6?(U=h0(W,H.mode,re),U.return=H,U):(U=d(U,W),U.return=H,U)}function E(H,U,W,re){var ge=W.type;return ge===th?R(H,U,W.props.children,re,W.key):U!==null&&(U.elementType===ge||typeof ge=="object"&&ge!==null&&ge.$$typeof===qa&&gS(ge)===U.type)?(re=d(U,W.props),re.ref=yf(H,U,W),re.return=H,re):(re=Ug(W.type,W.key,W.props,null,H.mode,re),re.ref=yf(H,U,W),re.return=H,re)}function P(H,U,W,re){return U===null||U.tag!==4||U.stateNode.containerInfo!==W.containerInfo||U.stateNode.implementation!==W.implementation?(U=d0(W,H.mode,re),U.return=H,U):(U=d(U,W.children||[]),U.return=H,U)}function R(H,U,W,re,ge){return U===null||U.tag!==7?(U=Lc(W,H.mode,re,ge),U.return=H,U):(U=d(U,W),U.return=H,U)}function N(H,U,W){if(typeof U=="string"&&U!==""||typeof U=="number")return U=h0(""+U,H.mode,W),U.return=H,U;if(typeof U=="object"&&U!==null){switch(U.$$typeof){case Qm:return W=Ug(U.type,U.key,U.props,null,H.mode,W),W.ref=yf(H,null,U),W.return=H,W;case eh:return U=d0(U,H.mode,W),U.return=H,U;case qa:var re=U._init;return N(H,re(U._payload),W)}if(Cf(U)||ff(U))return U=Lc(U,H.mode,W,null),U.return=H,U;cg(H,U)}return null}function F(H,U,W,re){var ge=U!==null?U.key:null;if(typeof W=="string"&&W!==""||typeof W=="number")return ge!==null?null:l(H,U,""+W,re);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case Qm:return W.key===ge?E(H,U,W,re):null;case eh:return W.key===ge?P(H,U,W,re):null;case qa:return ge=W._init,F(H,U,ge(W._payload),re)}if(Cf(W)||ff(W))return ge!==null?null:R(H,U,W,re,null);cg(H,W)}return null}function A(H,U,W,re,ge){if(typeof re=="string"&&re!==""||typeof re=="number")return H=H.get(W)||null,l(U,H,""+re,ge);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case Qm:return H=H.get(re.key===null?W:re.key)||null,E(U,H,re,ge);case eh:return H=H.get(re.key===null?W:re.key)||null,P(U,H,re,ge);case qa:var Te=re._init;return A(H,U,W,Te(re._payload),ge)}if(Cf(re)||ff(re))return H=H.get(W)||null,R(U,H,re,ge,null);cg(U,re)}return null}function X(H,U,W,re){for(var ge=null,Te=null,xe=U,ze=U=0,Ne=null;xe!==null&&ze<W.length;ze++){xe.index>ze?(Ne=xe,xe=null):Ne=xe.sibling;var Ie=F(H,xe,W[ze],re);if(Ie===null){xe===null&&(xe=Ne);break}e&&xe&&Ie.alternate===null&&r(H,xe),U=g(Ie,U,ze),Te===null?ge=Ie:Te.sibling=Ie,Te=Ie,xe=Ne}if(ze===W.length)return i(H,xe),Vr&&vc(H,ze),ge;if(xe===null){for(;ze<W.length;ze++)xe=N(H,W[ze],re),xe!==null&&(U=g(xe,U,ze),Te===null?ge=xe:Te.sibling=xe,Te=xe);return Vr&&vc(H,ze),ge}for(xe=c(H,xe);ze<W.length;ze++)Ne=A(xe,H,ze,W[ze],re),Ne!==null&&(e&&Ne.alternate!==null&&xe.delete(Ne.key===null?ze:Ne.key),U=g(Ne,U,ze),Te===null?ge=Ne:Te.sibling=Ne,Te=Ne);return e&&xe.forEach(function($e){return r(H,$e)}),Vr&&vc(H,ze),ge}function Z(H,U,W,re){var ge=ff(W);if(typeof ge!="function")throw Error(lt(150));if(W=ge.call(W),W==null)throw Error(lt(151));for(var Te=ge=null,xe=U,ze=U=0,Ne=null,Ie=W.next();xe!==null&&!Ie.done;ze++,Ie=W.next()){xe.index>ze?(Ne=xe,xe=null):Ne=xe.sibling;var $e=F(H,xe,Ie.value,re);if($e===null){xe===null&&(xe=Ne);break}e&&xe&&$e.alternate===null&&r(H,xe),U=g($e,U,ze),Te===null?ge=$e:Te.sibling=$e,Te=$e,xe=Ne}if(Ie.done)return i(H,xe),Vr&&vc(H,ze),ge;if(xe===null){for(;!Ie.done;ze++,Ie=W.next())Ie=N(H,Ie.value,re),Ie!==null&&(U=g(Ie,U,ze),Te===null?ge=Ie:Te.sibling=Ie,Te=Ie);return Vr&&vc(H,ze),ge}for(xe=c(H,xe);!Ie.done;ze++,Ie=W.next())Ie=A(xe,H,ze,Ie.value,re),Ie!==null&&(e&&Ie.alternate!==null&&xe.delete(Ie.key===null?ze:Ie.key),U=g(Ie,U,ze),Te===null?ge=Ie:Te.sibling=Ie,Te=Ie);return e&&xe.forEach(function(et){return r(H,et)}),Vr&&vc(H,ze),ge}function ee(H,U,W,re){if(typeof W=="object"&&W!==null&&W.type===th&&W.key===null&&(W=W.props.children),typeof W=="object"&&W!==null){switch(W.$$typeof){case Qm:e:{for(var ge=W.key,Te=U;Te!==null;){if(Te.key===ge){if(ge=W.type,ge===th){if(Te.tag===7){i(H,Te.sibling),U=d(Te,W.props.children),U.return=H,H=U;break e}}else if(Te.elementType===ge||typeof ge=="object"&&ge!==null&&ge.$$typeof===qa&&gS(ge)===Te.type){i(H,Te.sibling),U=d(Te,W.props),U.ref=yf(H,Te,W),U.return=H,H=U;break e}i(H,Te);break}else r(H,Te);Te=Te.sibling}W.type===th?(U=Lc(W.props.children,H.mode,re,W.key),U.return=H,H=U):(re=Ug(W.type,W.key,W.props,null,H.mode,re),re.ref=yf(H,U,W),re.return=H,H=re)}return m(H);case eh:e:{for(Te=W.key;U!==null;){if(U.key===Te)if(U.tag===4&&U.stateNode.containerInfo===W.containerInfo&&U.stateNode.implementation===W.implementation){i(H,U.sibling),U=d(U,W.children||[]),U.return=H,H=U;break e}else{i(H,U);break}else r(H,U);U=U.sibling}U=d0(W,H.mode,re),U.return=H,H=U}return m(H);case qa:return Te=W._init,ee(H,U,Te(W._payload),re)}if(Cf(W))return X(H,U,W,re);if(ff(W))return Z(H,U,W,re);cg(H,W)}return typeof W=="string"&&W!==""||typeof W=="number"?(W=""+W,U!==null&&U.tag===6?(i(H,U.sibling),U=d(U,W),U.return=H,H=U):(i(H,U),U=h0(W,H.mode,re),U.return=H,H=U),m(H)):i(H,U)}return ee}var Oh=lE(!0),cE=lE(!1),h_=Tl(null),d_=null,ch=null,Vb=null;function Zb(){Vb=ch=d_=null}function Gb(e){var r=h_.current;Br(h_),e._currentValue=r}function vx(e,r,i){for(;e!==null;){var c=e.alternate;if((e.childLanes&r)!==r?(e.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),e===i)break;e=e.return}}function _h(e,r){d_=e,Vb=ch=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&r&&(Ii=!0),e.firstContext=null)}function yo(e){var r=e._currentValue;if(Vb!==e)if(e={context:e,memoizedValue:r,next:null},ch===null){if(d_===null)throw Error(lt(308));ch=e,d_.dependencies={lanes:0,firstContext:e}}else ch=ch.next=e;return r}var wc=null;function Hb(e){wc===null?wc=[e]:wc.push(e)}function uE(e,r,i,c){var d=r.interleaved;return d===null?(i.next=i,Hb(r)):(i.next=d.next,d.next=i),r.interleaved=i,sa(e,c)}function sa(e,r){e.lanes|=r;var i=e.alternate;for(i!==null&&(i.lanes|=r),i=e,e=e.return;e!==null;)e.childLanes|=r,i=e.alternate,i!==null&&(i.childLanes|=r),i=e,e=e.return;return i.tag===3?i.stateNode:null}var Xa=!1;function Wb(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function hE(e,r){e=e.updateQueue,r.updateQueue===e&&(r.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function na(e,r){return{eventTime:e,lane:r,tag:0,payload:null,callback:null,next:null}}function dl(e,r,i){var c=e.updateQueue;if(c===null)return null;if(c=c.shared,hr&2){var d=c.pending;return d===null?r.next=r:(r.next=d.next,d.next=r),c.pending=r,sa(e,i)}return d=c.interleaved,d===null?(r.next=r,Hb(c)):(r.next=d.next,d.next=r),c.interleaved=r,sa(e,i)}function Og(e,r,i){if(r=r.updateQueue,r!==null&&(r=r.shared,(i&4194240)!==0)){var c=r.lanes;c&=e.pendingLanes,i|=c,r.lanes=i,zb(e,i)}}function _S(e,r){var i=e.updateQueue,c=e.alternate;if(c!==null&&(c=c.updateQueue,i===c)){var d=null,g=null;if(i=i.firstBaseUpdate,i!==null){do{var m={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};g===null?d=g=m:g=g.next=m,i=i.next}while(i!==null);g===null?d=g=r:g=g.next=r}else d=g=r;i={baseState:c.baseState,firstBaseUpdate:d,lastBaseUpdate:g,shared:c.shared,effects:c.effects},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=r:e.next=r,i.lastBaseUpdate=r}function f_(e,r,i,c){var d=e.updateQueue;Xa=!1;var g=d.firstBaseUpdate,m=d.lastBaseUpdate,l=d.shared.pending;if(l!==null){d.shared.pending=null;var E=l,P=E.next;E.next=null,m===null?g=P:m.next=P,m=E;var R=e.alternate;R!==null&&(R=R.updateQueue,l=R.lastBaseUpdate,l!==m&&(l===null?R.firstBaseUpdate=P:l.next=P,R.lastBaseUpdate=E))}if(g!==null){var N=d.baseState;m=0,R=P=E=null,l=g;do{var F=l.lane,A=l.eventTime;if((c&F)===F){R!==null&&(R=R.next={eventTime:A,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var X=e,Z=l;switch(F=r,A=i,Z.tag){case 1:if(X=Z.payload,typeof X=="function"){N=X.call(A,N,F);break e}N=X;break e;case 3:X.flags=X.flags&-65537|128;case 0:if(X=Z.payload,F=typeof X=="function"?X.call(A,N,F):X,F==null)break e;N=Xr({},N,F);break e;case 2:Xa=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,F=d.effects,F===null?d.effects=[l]:F.push(l))}else A={eventTime:A,lane:F,tag:l.tag,payload:l.payload,callback:l.callback,next:null},R===null?(P=R=A,E=N):R=R.next=A,m|=F;if(l=l.next,l===null){if(l=d.shared.pending,l===null)break;F=l,l=F.next,F.next=null,d.lastBaseUpdate=F,d.shared.pending=null}}while(!0);if(R===null&&(E=N),d.baseState=E,d.firstBaseUpdate=P,d.lastBaseUpdate=R,r=d.shared.interleaved,r!==null){d=r;do m|=d.lane,d=d.next;while(d!==r)}else g===null&&(d.shared.lanes=0);jc|=m,e.lanes=m,e.memoizedState=N}}function yS(e,r,i){if(e=r.effects,r.effects=null,e!==null)for(r=0;r<e.length;r++){var c=e[r],d=c.callback;if(d!==null){if(c.callback=null,c=i,typeof d!="function")throw Error(lt(191,d));d.call(c)}}}var kp={},Ss=Tl(kp),tp=Tl(kp),rp=Tl(kp);function Sc(e){if(e===kp)throw Error(lt(174));return e}function qb(e,r){switch(zr(rp,r),zr(tp,e),zr(Ss,kp),e=r.nodeType,e){case 9:case 11:r=(r=r.documentElement)?r.namespaceURI:J0(null,"");break;default:e=e===8?r.parentNode:r,r=e.namespaceURI||null,e=e.tagName,r=J0(r,e)}Br(Ss),zr(Ss,r)}function Fh(){Br(Ss),Br(tp),Br(rp)}function dE(e){Sc(rp.current);var r=Sc(Ss.current),i=J0(r,e.type);r!==i&&(zr(tp,e),zr(Ss,i))}function Xb(e){tp.current===e&&(Br(Ss),Br(tp))}var Wr=Tl(0);function p_(e){for(var r=e;r!==null;){if(r.tag===13){var i=r.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if(r.flags&128)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var o0=[];function Kb(){for(var e=0;e<o0.length;e++)o0[e]._workInProgressVersionPrimary=null;o0.length=0}var Fg=ua.ReactCurrentDispatcher,s0=ua.ReactCurrentBatchConfig,Bc=0,qr=null,kn=null,On=null,m_=!1,Of=!1,np=0,IL=0;function oi(){throw Error(lt(321))}function Yb(e,r){if(r===null)return!1;for(var i=0;i<r.length&&i<e.length;i++)if(!Wo(e[i],r[i]))return!1;return!0}function Qb(e,r,i,c,d,g){if(Bc=g,qr=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,Fg.current=e===null||e.memoizedState===null?DL:LL,e=i(c,d),Of){g=0;do{if(Of=!1,np=0,25<=g)throw Error(lt(301));g+=1,On=kn=null,r.updateQueue=null,Fg.current=OL,e=i(c,d)}while(Of)}if(Fg.current=g_,r=kn!==null&&kn.next!==null,Bc=0,On=kn=qr=null,m_=!1,r)throw Error(lt(300));return e}function Jb(){var e=np!==0;return np=0,e}function ps(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return On===null?qr.memoizedState=On=e:On=On.next=e,On}function vo(){if(kn===null){var e=qr.alternate;e=e!==null?e.memoizedState:null}else e=kn.next;var r=On===null?qr.memoizedState:On.next;if(r!==null)On=r,kn=e;else{if(e===null)throw Error(lt(310));kn=e,e={memoizedState:kn.memoizedState,baseState:kn.baseState,baseQueue:kn.baseQueue,queue:kn.queue,next:null},On===null?qr.memoizedState=On=e:On=On.next=e}return On}function ip(e,r){return typeof r=="function"?r(e):r}function a0(e){var r=vo(),i=r.queue;if(i===null)throw Error(lt(311));i.lastRenderedReducer=e;var c=kn,d=c.baseQueue,g=i.pending;if(g!==null){if(d!==null){var m=d.next;d.next=g.next,g.next=m}c.baseQueue=d=g,i.pending=null}if(d!==null){g=d.next,c=c.baseState;var l=m=null,E=null,P=g;do{var R=P.lane;if((Bc&R)===R)E!==null&&(E=E.next={lane:0,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null}),c=P.hasEagerState?P.eagerState:e(c,P.action);else{var N={lane:R,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null};E===null?(l=E=N,m=c):E=E.next=N,qr.lanes|=R,jc|=R}P=P.next}while(P!==null&&P!==g);E===null?m=c:E.next=l,Wo(c,r.memoizedState)||(Ii=!0),r.memoizedState=c,r.baseState=m,r.baseQueue=E,i.lastRenderedState=c}if(e=i.interleaved,e!==null){d=e;do g=d.lane,qr.lanes|=g,jc|=g,d=d.next;while(d!==e)}else d===null&&(i.lanes=0);return[r.memoizedState,i.dispatch]}function l0(e){var r=vo(),i=r.queue;if(i===null)throw Error(lt(311));i.lastRenderedReducer=e;var c=i.dispatch,d=i.pending,g=r.memoizedState;if(d!==null){i.pending=null;var m=d=d.next;do g=e(g,m.action),m=m.next;while(m!==d);Wo(g,r.memoizedState)||(Ii=!0),r.memoizedState=g,r.baseQueue===null&&(r.baseState=g),i.lastRenderedState=g}return[g,c]}function fE(){}function pE(e,r){var i=qr,c=vo(),d=r(),g=!Wo(c.memoizedState,d);if(g&&(c.memoizedState=d,Ii=!0),c=c.queue,ew(_E.bind(null,i,c,e),[e]),c.getSnapshot!==r||g||On!==null&&On.memoizedState.tag&1){if(i.flags|=2048,op(9,gE.bind(null,i,c,d,r),void 0,null),Fn===null)throw Error(lt(349));Bc&30||mE(i,r,d)}return d}function mE(e,r,i){e.flags|=16384,e={getSnapshot:r,value:i},r=qr.updateQueue,r===null?(r={lastEffect:null,stores:null},qr.updateQueue=r,r.stores=[e]):(i=r.stores,i===null?r.stores=[e]:i.push(e))}function gE(e,r,i,c){r.value=i,r.getSnapshot=c,yE(r)&&vE(e)}function _E(e,r,i){return i(function(){yE(r)&&vE(e)})}function yE(e){var r=e.getSnapshot;e=e.value;try{var i=r();return!Wo(e,i)}catch{return!0}}function vE(e){var r=sa(e,1);r!==null&&Ho(r,e,1,-1)}function vS(e){var r=ps();return typeof e=="function"&&(e=e()),r.memoizedState=r.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ip,lastRenderedState:e},r.queue=e,e=e.dispatch=RL.bind(null,qr,e),[r.memoizedState,e]}function op(e,r,i,c){return e={tag:e,create:r,destroy:i,deps:c,next:null},r=qr.updateQueue,r===null?(r={lastEffect:null,stores:null},qr.updateQueue=r,r.lastEffect=e.next=e):(i=r.lastEffect,i===null?r.lastEffect=e.next=e:(c=i.next,i.next=e,e.next=c,r.lastEffect=e)),e}function xE(){return vo().memoizedState}function Ng(e,r,i,c){var d=ps();qr.flags|=e,d.memoizedState=op(1|r,i,void 0,c===void 0?null:c)}function W_(e,r,i,c){var d=vo();c=c===void 0?null:c;var g=void 0;if(kn!==null){var m=kn.memoizedState;if(g=m.destroy,c!==null&&Yb(c,m.deps)){d.memoizedState=op(r,i,g,c);return}}qr.flags|=e,d.memoizedState=op(1|r,i,g,c)}function xS(e,r){return Ng(8390656,8,e,r)}function ew(e,r){return W_(2048,8,e,r)}function bE(e,r){return W_(4,2,e,r)}function wE(e,r){return W_(4,4,e,r)}function SE(e,r){if(typeof r=="function")return e=e(),r(e),function(){r(null)};if(r!=null)return e=e(),r.current=e,function(){r.current=null}}function TE(e,r,i){return i=i!=null?i.concat([e]):null,W_(4,4,SE.bind(null,r,e),i)}function tw(){}function CE(e,r){var i=vo();r=r===void 0?null:r;var c=i.memoizedState;return c!==null&&r!==null&&Yb(r,c[1])?c[0]:(i.memoizedState=[e,r],e)}function PE(e,r){var i=vo();r=r===void 0?null:r;var c=i.memoizedState;return c!==null&&r!==null&&Yb(r,c[1])?c[0]:(e=e(),i.memoizedState=[e,r],e)}function EE(e,r,i){return Bc&21?(Wo(i,r)||(i=zP(),qr.lanes|=i,jc|=i,e.baseState=!0),r):(e.baseState&&(e.baseState=!1,Ii=!0),e.memoizedState=i)}function AL(e,r){var i=vr;vr=i!==0&&4>i?i:4,e(!0);var c=s0.transition;s0.transition={};try{e(!1),r()}finally{vr=i,s0.transition=c}}function ME(){return vo().memoizedState}function zL(e,r,i){var c=pl(e);if(i={lane:c,action:i,hasEagerState:!1,eagerState:null,next:null},kE(e))IE(r,i);else if(i=uE(e,r,i,c),i!==null){var d=xi();Ho(i,e,c,d),AE(i,r,c)}}function RL(e,r,i){var c=pl(e),d={lane:c,action:i,hasEagerState:!1,eagerState:null,next:null};if(kE(e))IE(r,d);else{var g=e.alternate;if(e.lanes===0&&(g===null||g.lanes===0)&&(g=r.lastRenderedReducer,g!==null))try{var m=r.lastRenderedState,l=g(m,i);if(d.hasEagerState=!0,d.eagerState=l,Wo(l,m)){var E=r.interleaved;E===null?(d.next=d,Hb(r)):(d.next=E.next,E.next=d),r.interleaved=d;return}}catch{}finally{}i=uE(e,r,d,c),i!==null&&(d=xi(),Ho(i,e,c,d),AE(i,r,c))}}function kE(e){var r=e.alternate;return e===qr||r!==null&&r===qr}function IE(e,r){Of=m_=!0;var i=e.pending;i===null?r.next=r:(r.next=i.next,i.next=r),e.pending=r}function AE(e,r,i){if(i&4194240){var c=r.lanes;c&=e.pendingLanes,i|=c,r.lanes=i,zb(e,i)}}var g_={readContext:yo,useCallback:oi,useContext:oi,useEffect:oi,useImperativeHandle:oi,useInsertionEffect:oi,useLayoutEffect:oi,useMemo:oi,useReducer:oi,useRef:oi,useState:oi,useDebugValue:oi,useDeferredValue:oi,useTransition:oi,useMutableSource:oi,useSyncExternalStore:oi,useId:oi,unstable_isNewReconciler:!1},DL={readContext:yo,useCallback:function(e,r){return ps().memoizedState=[e,r===void 0?null:r],e},useContext:yo,useEffect:xS,useImperativeHandle:function(e,r,i){return i=i!=null?i.concat([e]):null,Ng(4194308,4,SE.bind(null,r,e),i)},useLayoutEffect:function(e,r){return Ng(4194308,4,e,r)},useInsertionEffect:function(e,r){return Ng(4,2,e,r)},useMemo:function(e,r){var i=ps();return r=r===void 0?null:r,e=e(),i.memoizedState=[e,r],e},useReducer:function(e,r,i){var c=ps();return r=i!==void 0?i(r):r,c.memoizedState=c.baseState=r,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},c.queue=e,e=e.dispatch=zL.bind(null,qr,e),[c.memoizedState,e]},useRef:function(e){var r=ps();return e={current:e},r.memoizedState=e},useState:vS,useDebugValue:tw,useDeferredValue:function(e){return ps().memoizedState=e},useTransition:function(){var e=vS(!1),r=e[0];return e=AL.bind(null,e[1]),ps().memoizedState=e,[r,e]},useMutableSource:function(){},useSyncExternalStore:function(e,r,i){var c=qr,d=ps();if(Vr){if(i===void 0)throw Error(lt(407));i=i()}else{if(i=r(),Fn===null)throw Error(lt(349));Bc&30||mE(c,r,i)}d.memoizedState=i;var g={value:i,getSnapshot:r};return d.queue=g,xS(_E.bind(null,c,g,e),[e]),c.flags|=2048,op(9,gE.bind(null,c,g,i,r),void 0,null),i},useId:function(){var e=ps(),r=Fn.identifierPrefix;if(Vr){var i=ra,c=ta;i=(c&~(1<<32-Go(c)-1)).toString(32)+i,r=":"+r+"R"+i,i=np++,0<i&&(r+="H"+i.toString(32)),r+=":"}else i=IL++,r=":"+r+"r"+i.toString(32)+":";return e.memoizedState=r},unstable_isNewReconciler:!1},LL={readContext:yo,useCallback:CE,useContext:yo,useEffect:ew,useImperativeHandle:TE,useInsertionEffect:bE,useLayoutEffect:wE,useMemo:PE,useReducer:a0,useRef:xE,useState:function(){return a0(ip)},useDebugValue:tw,useDeferredValue:function(e){var r=vo();return EE(r,kn.memoizedState,e)},useTransition:function(){var e=a0(ip)[0],r=vo().memoizedState;return[e,r]},useMutableSource:fE,useSyncExternalStore:pE,useId:ME,unstable_isNewReconciler:!1},OL={readContext:yo,useCallback:CE,useContext:yo,useEffect:ew,useImperativeHandle:TE,useInsertionEffect:bE,useLayoutEffect:wE,useMemo:PE,useReducer:l0,useRef:xE,useState:function(){return l0(ip)},useDebugValue:tw,useDeferredValue:function(e){var r=vo();return kn===null?r.memoizedState=e:EE(r,kn.memoizedState,e)},useTransition:function(){var e=l0(ip)[0],r=vo().memoizedState;return[e,r]},useMutableSource:fE,useSyncExternalStore:pE,useId:ME,unstable_isNewReconciler:!1};function No(e,r){if(e&&e.defaultProps){r=Xr({},r),e=e.defaultProps;for(var i in e)r[i]===void 0&&(r[i]=e[i]);return r}return r}function xx(e,r,i,c){r=e.memoizedState,i=i(c,r),i=i==null?r:Xr({},r,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var q_={isMounted:function(e){return(e=e._reactInternals)?Xc(e)===e:!1},enqueueSetState:function(e,r,i){e=e._reactInternals;var c=xi(),d=pl(e),g=na(c,d);g.payload=r,i!=null&&(g.callback=i),r=dl(e,g,d),r!==null&&(Ho(r,e,d,c),Og(r,e,d))},enqueueReplaceState:function(e,r,i){e=e._reactInternals;var c=xi(),d=pl(e),g=na(c,d);g.tag=1,g.payload=r,i!=null&&(g.callback=i),r=dl(e,g,d),r!==null&&(Ho(r,e,d,c),Og(r,e,d))},enqueueForceUpdate:function(e,r){e=e._reactInternals;var i=xi(),c=pl(e),d=na(i,c);d.tag=2,r!=null&&(d.callback=r),r=dl(e,d,c),r!==null&&(Ho(r,e,c,i),Og(r,e,c))}};function bS(e,r,i,c,d,g,m){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(c,g,m):r.prototype&&r.prototype.isPureReactComponent?!Yf(i,c)||!Yf(d,g):!0}function zE(e,r,i){var c=!1,d=xl,g=r.contextType;return typeof g=="object"&&g!==null?g=yo(g):(d=Di(r)?Fc:ci.current,c=r.contextTypes,g=(c=c!=null)?Dh(e,d):xl),r=new r(i,g),e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=q_,e.stateNode=r,r._reactInternals=e,c&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=d,e.__reactInternalMemoizedMaskedChildContext=g),r}function wS(e,r,i,c){e=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(i,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(i,c),r.state!==e&&q_.enqueueReplaceState(r,r.state,null)}function bx(e,r,i,c){var d=e.stateNode;d.props=i,d.state=e.memoizedState,d.refs={},Wb(e);var g=r.contextType;typeof g=="object"&&g!==null?d.context=yo(g):(g=Di(r)?Fc:ci.current,d.context=Dh(e,g)),d.state=e.memoizedState,g=r.getDerivedStateFromProps,typeof g=="function"&&(xx(e,r,g,i),d.state=e.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof d.getSnapshotBeforeUpdate=="function"||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(r=d.state,typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount(),r!==d.state&&q_.enqueueReplaceState(d,d.state,null),f_(e,i,d,c),d.state=e.memoizedState),typeof d.componentDidMount=="function"&&(e.flags|=4194308)}function Nh(e,r){try{var i="",c=r;do i+=uD(c),c=c.return;while(c);var d=i}catch(g){d=`
Error generating stack: `+g.message+`
`+g.stack}return{value:e,source:r,stack:d,digest:null}}function c0(e,r,i){return{value:e,source:null,stack:i??null,digest:r??null}}function wx(e,r){try{console.error(r.value)}catch(i){setTimeout(function(){throw i})}}var FL=typeof WeakMap=="function"?WeakMap:Map;function RE(e,r,i){i=na(-1,i),i.tag=3,i.payload={element:null};var c=r.value;return i.callback=function(){y_||(y_=!0,zx=c),wx(e,r)},i}function DE(e,r,i){i=na(-1,i),i.tag=3;var c=e.type.getDerivedStateFromError;if(typeof c=="function"){var d=r.value;i.payload=function(){return c(d)},i.callback=function(){wx(e,r)}}var g=e.stateNode;return g!==null&&typeof g.componentDidCatch=="function"&&(i.callback=function(){wx(e,r),typeof c!="function"&&(fl===null?fl=new Set([this]):fl.add(this));var m=r.stack;this.componentDidCatch(r.value,{componentStack:m!==null?m:""})}),i}function SS(e,r,i){var c=e.pingCache;if(c===null){c=e.pingCache=new FL;var d=new Set;c.set(r,d)}else d=c.get(r),d===void 0&&(d=new Set,c.set(r,d));d.has(i)||(d.add(i),e=YL.bind(null,e,r,i),r.then(e,e))}function TS(e){do{var r;if((r=e.tag===13)&&(r=e.memoizedState,r=r!==null?r.dehydrated!==null:!0),r)return e;e=e.return}while(e!==null);return null}function CS(e,r,i,c,d){return e.mode&1?(e.flags|=65536,e.lanes=d,e):(e===r?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(r=na(-1,1),r.tag=2,dl(i,r,1))),i.lanes|=1),e)}var NL=ua.ReactCurrentOwner,Ii=!1;function _i(e,r,i,c){r.child=e===null?cE(r,null,i,c):Oh(r,e.child,i,c)}function PS(e,r,i,c,d){i=i.render;var g=r.ref;return _h(r,d),c=Qb(e,r,i,c,g,d),i=Jb(),e!==null&&!Ii?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~d,aa(e,r,d)):(Vr&&i&&jb(r),r.flags|=1,_i(e,r,c,d),r.child)}function ES(e,r,i,c,d){if(e===null){var g=i.type;return typeof g=="function"&&!cw(g)&&g.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(r.tag=15,r.type=g,LE(e,r,g,c,d)):(e=Ug(i.type,null,c,r,r.mode,d),e.ref=r.ref,e.return=r,r.child=e)}if(g=e.child,!(e.lanes&d)){var m=g.memoizedProps;if(i=i.compare,i=i!==null?i:Yf,i(m,c)&&e.ref===r.ref)return aa(e,r,d)}return r.flags|=1,e=ml(g,c),e.ref=r.ref,e.return=r,r.child=e}function LE(e,r,i,c,d){if(e!==null){var g=e.memoizedProps;if(Yf(g,c)&&e.ref===r.ref)if(Ii=!1,r.pendingProps=c=g,(e.lanes&d)!==0)e.flags&131072&&(Ii=!0);else return r.lanes=e.lanes,aa(e,r,d)}return Sx(e,r,i,c,d)}function OE(e,r,i){var c=r.pendingProps,d=c.children,g=e!==null?e.memoizedState:null;if(c.mode==="hidden")if(!(r.mode&1))r.memoizedState={baseLanes:0,cachePool:null,transitions:null},zr(hh,qi),qi|=i;else{if(!(i&1073741824))return e=g!==null?g.baseLanes|i:i,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:e,cachePool:null,transitions:null},r.updateQueue=null,zr(hh,qi),qi|=e,null;r.memoizedState={baseLanes:0,cachePool:null,transitions:null},c=g!==null?g.baseLanes:i,zr(hh,qi),qi|=c}else g!==null?(c=g.baseLanes|i,r.memoizedState=null):c=i,zr(hh,qi),qi|=c;return _i(e,r,d,i),r.child}function FE(e,r){var i=r.ref;(e===null&&i!==null||e!==null&&e.ref!==i)&&(r.flags|=512,r.flags|=2097152)}function Sx(e,r,i,c,d){var g=Di(i)?Fc:ci.current;return g=Dh(r,g),_h(r,d),i=Qb(e,r,i,c,g,d),c=Jb(),e!==null&&!Ii?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~d,aa(e,r,d)):(Vr&&c&&jb(r),r.flags|=1,_i(e,r,i,d),r.child)}function MS(e,r,i,c,d){if(Di(i)){var g=!0;l_(r)}else g=!1;if(_h(r,d),r.stateNode===null)Bg(e,r),zE(r,i,c),bx(r,i,c,d),c=!0;else if(e===null){var m=r.stateNode,l=r.memoizedProps;m.props=l;var E=m.context,P=i.contextType;typeof P=="object"&&P!==null?P=yo(P):(P=Di(i)?Fc:ci.current,P=Dh(r,P));var R=i.getDerivedStateFromProps,N=typeof R=="function"||typeof m.getSnapshotBeforeUpdate=="function";N||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(l!==c||E!==P)&&wS(r,m,c,P),Xa=!1;var F=r.memoizedState;m.state=F,f_(r,c,m,d),E=r.memoizedState,l!==c||F!==E||Ri.current||Xa?(typeof R=="function"&&(xx(r,i,R,c),E=r.memoizedState),(l=Xa||bS(r,i,l,c,F,E,P))?(N||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(r.flags|=4194308)):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=E),m.props=c,m.state=E,m.context=P,c=l):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{m=r.stateNode,hE(e,r),l=r.memoizedProps,P=r.type===r.elementType?l:No(r.type,l),m.props=P,N=r.pendingProps,F=m.context,E=i.contextType,typeof E=="object"&&E!==null?E=yo(E):(E=Di(i)?Fc:ci.current,E=Dh(r,E));var A=i.getDerivedStateFromProps;(R=typeof A=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(l!==N||F!==E)&&wS(r,m,c,E),Xa=!1,F=r.memoizedState,m.state=F,f_(r,c,m,d);var X=r.memoizedState;l!==N||F!==X||Ri.current||Xa?(typeof A=="function"&&(xx(r,i,A,c),X=r.memoizedState),(P=Xa||bS(r,i,P,c,F,X,E)||!1)?(R||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(c,X,E),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(c,X,E)),typeof m.componentDidUpdate=="function"&&(r.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof m.componentDidUpdate!="function"||l===e.memoizedProps&&F===e.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&F===e.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=X),m.props=c,m.state=X,m.context=E,c=P):(typeof m.componentDidUpdate!="function"||l===e.memoizedProps&&F===e.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&F===e.memoizedState||(r.flags|=1024),c=!1)}return Tx(e,r,i,c,g,d)}function Tx(e,r,i,c,d,g){FE(e,r);var m=(r.flags&128)!==0;if(!c&&!m)return d&&fS(r,i,!1),aa(e,r,g);c=r.stateNode,NL.current=r;var l=m&&typeof i.getDerivedStateFromError!="function"?null:c.render();return r.flags|=1,e!==null&&m?(r.child=Oh(r,e.child,null,g),r.child=Oh(r,null,l,g)):_i(e,r,l,g),r.memoizedState=c.state,d&&fS(r,i,!0),r.child}function NE(e){var r=e.stateNode;r.pendingContext?dS(e,r.pendingContext,r.pendingContext!==r.context):r.context&&dS(e,r.context,!1),qb(e,r.containerInfo)}function kS(e,r,i,c,d){return Lh(),Ub(d),r.flags|=256,_i(e,r,i,c),r.child}var Cx={dehydrated:null,treeContext:null,retryLane:0};function Px(e){return{baseLanes:e,cachePool:null,transitions:null}}function BE(e,r,i){var c=r.pendingProps,d=Wr.current,g=!1,m=(r.flags&128)!==0,l;if((l=m)||(l=e!==null&&e.memoizedState===null?!1:(d&2)!==0),l?(g=!0,r.flags&=-129):(e===null||e.memoizedState!==null)&&(d|=1),zr(Wr,d&1),e===null)return yx(r),e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(r.mode&1?e.data==="$!"?r.lanes=8:r.lanes=1073741824:r.lanes=1,null):(m=c.children,e=c.fallback,g?(c=r.mode,g=r.child,m={mode:"hidden",children:m},!(c&1)&&g!==null?(g.childLanes=0,g.pendingProps=m):g=Y_(m,c,0,null),e=Lc(e,c,i,null),g.return=r,e.return=r,g.sibling=e,r.child=g,r.child.memoizedState=Px(i),r.memoizedState=Cx,e):rw(r,m));if(d=e.memoizedState,d!==null&&(l=d.dehydrated,l!==null))return BL(e,r,m,c,l,d,i);if(g){g=c.fallback,m=r.mode,d=e.child,l=d.sibling;var E={mode:"hidden",children:c.children};return!(m&1)&&r.child!==d?(c=r.child,c.childLanes=0,c.pendingProps=E,r.deletions=null):(c=ml(d,E),c.subtreeFlags=d.subtreeFlags&14680064),l!==null?g=ml(l,g):(g=Lc(g,m,i,null),g.flags|=2),g.return=r,c.return=r,c.sibling=g,r.child=c,c=g,g=r.child,m=e.child.memoizedState,m=m===null?Px(i):{baseLanes:m.baseLanes|i,cachePool:null,transitions:m.transitions},g.memoizedState=m,g.childLanes=e.childLanes&~i,r.memoizedState=Cx,c}return g=e.child,e=g.sibling,c=ml(g,{mode:"visible",children:c.children}),!(r.mode&1)&&(c.lanes=i),c.return=r,c.sibling=null,e!==null&&(i=r.deletions,i===null?(r.deletions=[e],r.flags|=16):i.push(e)),r.child=c,r.memoizedState=null,c}function rw(e,r){return r=Y_({mode:"visible",children:r},e.mode,0,null),r.return=e,e.child=r}function ug(e,r,i,c){return c!==null&&Ub(c),Oh(r,e.child,null,i),e=rw(r,r.pendingProps.children),e.flags|=2,r.memoizedState=null,e}function BL(e,r,i,c,d,g,m){if(i)return r.flags&256?(r.flags&=-257,c=c0(Error(lt(422))),ug(e,r,m,c)):r.memoizedState!==null?(r.child=e.child,r.flags|=128,null):(g=c.fallback,d=r.mode,c=Y_({mode:"visible",children:c.children},d,0,null),g=Lc(g,d,m,null),g.flags|=2,c.return=r,g.return=r,c.sibling=g,r.child=c,r.mode&1&&Oh(r,e.child,null,m),r.child.memoizedState=Px(m),r.memoizedState=Cx,g);if(!(r.mode&1))return ug(e,r,m,null);if(d.data==="$!"){if(c=d.nextSibling&&d.nextSibling.dataset,c)var l=c.dgst;return c=l,g=Error(lt(419)),c=c0(g,c,void 0),ug(e,r,m,c)}if(l=(m&e.childLanes)!==0,Ii||l){if(c=Fn,c!==null){switch(m&-m){case 4:d=2;break;case 16:d=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:d=32;break;case 536870912:d=268435456;break;default:d=0}d=d&(c.suspendedLanes|m)?0:d,d!==0&&d!==g.retryLane&&(g.retryLane=d,sa(e,d),Ho(c,e,d,-1))}return lw(),c=c0(Error(lt(421))),ug(e,r,m,c)}return d.data==="$?"?(r.flags|=128,r.child=e.child,r=QL.bind(null,e),d._reactRetry=r,null):(e=g.treeContext,Ki=hl(d.nextSibling),Qi=r,Vr=!0,Vo=null,e!==null&&(fo[po++]=ta,fo[po++]=ra,fo[po++]=Nc,ta=e.id,ra=e.overflow,Nc=r),r=rw(r,c.children),r.flags|=4096,r)}function IS(e,r,i){e.lanes|=r;var c=e.alternate;c!==null&&(c.lanes|=r),vx(e.return,r,i)}function u0(e,r,i,c,d){var g=e.memoizedState;g===null?e.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:i,tailMode:d}:(g.isBackwards=r,g.rendering=null,g.renderingStartTime=0,g.last=c,g.tail=i,g.tailMode=d)}function jE(e,r,i){var c=r.pendingProps,d=c.revealOrder,g=c.tail;if(_i(e,r,c.children,i),c=Wr.current,c&2)c=c&1|2,r.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=r.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&IS(e,i,r);else if(e.tag===19)IS(e,i,r);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===r)break e;for(;e.sibling===null;){if(e.return===null||e.return===r)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}c&=1}if(zr(Wr,c),!(r.mode&1))r.memoizedState=null;else switch(d){case"forwards":for(i=r.child,d=null;i!==null;)e=i.alternate,e!==null&&p_(e)===null&&(d=i),i=i.sibling;i=d,i===null?(d=r.child,r.child=null):(d=i.sibling,i.sibling=null),u0(r,!1,d,i,g);break;case"backwards":for(i=null,d=r.child,r.child=null;d!==null;){if(e=d.alternate,e!==null&&p_(e)===null){r.child=d;break}e=d.sibling,d.sibling=i,i=d,d=e}u0(r,!0,i,null,g);break;case"together":u0(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function Bg(e,r){!(r.mode&1)&&e!==null&&(e.alternate=null,r.alternate=null,r.flags|=2)}function aa(e,r,i){if(e!==null&&(r.dependencies=e.dependencies),jc|=r.lanes,!(i&r.childLanes))return null;if(e!==null&&r.child!==e.child)throw Error(lt(153));if(r.child!==null){for(e=r.child,i=ml(e,e.pendingProps),r.child=i,i.return=r;e.sibling!==null;)e=e.sibling,i=i.sibling=ml(e,e.pendingProps),i.return=r;i.sibling=null}return r.child}function jL(e,r,i){switch(r.tag){case 3:NE(r),Lh();break;case 5:dE(r);break;case 1:Di(r.type)&&l_(r);break;case 4:qb(r,r.stateNode.containerInfo);break;case 10:var c=r.type._context,d=r.memoizedProps.value;zr(h_,c._currentValue),c._currentValue=d;break;case 13:if(c=r.memoizedState,c!==null)return c.dehydrated!==null?(zr(Wr,Wr.current&1),r.flags|=128,null):i&r.child.childLanes?BE(e,r,i):(zr(Wr,Wr.current&1),e=aa(e,r,i),e!==null?e.sibling:null);zr(Wr,Wr.current&1);break;case 19:if(c=(i&r.childLanes)!==0,e.flags&128){if(c)return jE(e,r,i);r.flags|=128}if(d=r.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),zr(Wr,Wr.current),c)break;return null;case 22:case 23:return r.lanes=0,OE(e,r,i)}return aa(e,r,i)}var $E,Ex,UE,VE;$E=function(e,r){for(var i=r.child;i!==null;){if(i.tag===5||i.tag===6)e.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};Ex=function(){};UE=function(e,r,i,c){var d=e.memoizedProps;if(d!==c){e=r.stateNode,Sc(Ss.current);var g=null;switch(i){case"input":d=X0(e,d),c=X0(e,c),g=[];break;case"select":d=Xr({},d,{value:void 0}),c=Xr({},c,{value:void 0}),g=[];break;case"textarea":d=Q0(e,d),c=Q0(e,c),g=[];break;default:typeof d.onClick!="function"&&typeof c.onClick=="function"&&(e.onclick=s_)}ex(i,c);var m;i=null;for(P in d)if(!c.hasOwnProperty(P)&&d.hasOwnProperty(P)&&d[P]!=null)if(P==="style"){var l=d[P];for(m in l)l.hasOwnProperty(m)&&(i||(i={}),i[m]="")}else P!=="dangerouslySetInnerHTML"&&P!=="children"&&P!=="suppressContentEditableWarning"&&P!=="suppressHydrationWarning"&&P!=="autoFocus"&&(Zf.hasOwnProperty(P)?g||(g=[]):(g=g||[]).push(P,null));for(P in c){var E=c[P];if(l=d!=null?d[P]:void 0,c.hasOwnProperty(P)&&E!==l&&(E!=null||l!=null))if(P==="style")if(l){for(m in l)!l.hasOwnProperty(m)||E&&E.hasOwnProperty(m)||(i||(i={}),i[m]="");for(m in E)E.hasOwnProperty(m)&&l[m]!==E[m]&&(i||(i={}),i[m]=E[m])}else i||(g||(g=[]),g.push(P,i)),i=E;else P==="dangerouslySetInnerHTML"?(E=E?E.__html:void 0,l=l?l.__html:void 0,E!=null&&l!==E&&(g=g||[]).push(P,E)):P==="children"?typeof E!="string"&&typeof E!="number"||(g=g||[]).push(P,""+E):P!=="suppressContentEditableWarning"&&P!=="suppressHydrationWarning"&&(Zf.hasOwnProperty(P)?(E!=null&&P==="onScroll"&&Nr("scroll",e),g||l===E||(g=[])):(g=g||[]).push(P,E))}i&&(g=g||[]).push("style",i);var P=g;(r.updateQueue=P)&&(r.flags|=4)}};VE=function(e,r,i,c){i!==c&&(r.flags|=4)};function vf(e,r){if(!Vr)switch(e.tailMode){case"hidden":r=e.tail;for(var i=null;r!==null;)r.alternate!==null&&(i=r),r=r.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?r||e.tail===null?e.tail=null:e.tail.sibling=null:c.sibling=null}}function si(e){var r=e.alternate!==null&&e.alternate.child===e.child,i=0,c=0;if(r)for(var d=e.child;d!==null;)i|=d.lanes|d.childLanes,c|=d.subtreeFlags&14680064,c|=d.flags&14680064,d.return=e,d=d.sibling;else for(d=e.child;d!==null;)i|=d.lanes|d.childLanes,c|=d.subtreeFlags,c|=d.flags,d.return=e,d=d.sibling;return e.subtreeFlags|=c,e.childLanes=i,r}function $L(e,r,i){var c=r.pendingProps;switch($b(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return si(r),null;case 1:return Di(r.type)&&a_(),si(r),null;case 3:return c=r.stateNode,Fh(),Br(Ri),Br(ci),Kb(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(e===null||e.child===null)&&(lg(r)?r.flags|=4:e===null||e.memoizedState.isDehydrated&&!(r.flags&256)||(r.flags|=1024,Vo!==null&&(Lx(Vo),Vo=null))),Ex(e,r),si(r),null;case 5:Xb(r);var d=Sc(rp.current);if(i=r.type,e!==null&&r.stateNode!=null)UE(e,r,i,c,d),e.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!c){if(r.stateNode===null)throw Error(lt(166));return si(r),null}if(e=Sc(Ss.current),lg(r)){c=r.stateNode,i=r.type;var g=r.memoizedProps;switch(c[ys]=r,c[ep]=g,e=(r.mode&1)!==0,i){case"dialog":Nr("cancel",c),Nr("close",c);break;case"iframe":case"object":case"embed":Nr("load",c);break;case"video":case"audio":for(d=0;d<Ef.length;d++)Nr(Ef[d],c);break;case"source":Nr("error",c);break;case"img":case"image":case"link":Nr("error",c),Nr("load",c);break;case"details":Nr("toggle",c);break;case"input":B2(c,g),Nr("invalid",c);break;case"select":c._wrapperState={wasMultiple:!!g.multiple},Nr("invalid",c);break;case"textarea":$2(c,g),Nr("invalid",c)}ex(i,g),d=null;for(var m in g)if(g.hasOwnProperty(m)){var l=g[m];m==="children"?typeof l=="string"?c.textContent!==l&&(g.suppressHydrationWarning!==!0&&ag(c.textContent,l,e),d=["children",l]):typeof l=="number"&&c.textContent!==""+l&&(g.suppressHydrationWarning!==!0&&ag(c.textContent,l,e),d=["children",""+l]):Zf.hasOwnProperty(m)&&l!=null&&m==="onScroll"&&Nr("scroll",c)}switch(i){case"input":Jm(c),j2(c,g,!0);break;case"textarea":Jm(c),U2(c);break;case"select":case"option":break;default:typeof g.onClick=="function"&&(c.onclick=s_)}c=d,r.updateQueue=c,c!==null&&(r.flags|=4)}else{m=d.nodeType===9?d:d.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=_P(i)),e==="http://www.w3.org/1999/xhtml"?i==="script"?(e=m.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof c.is=="string"?e=m.createElement(i,{is:c.is}):(e=m.createElement(i),i==="select"&&(m=e,c.multiple?m.multiple=!0:c.size&&(m.size=c.size))):e=m.createElementNS(e,i),e[ys]=r,e[ep]=c,$E(e,r,!1,!1),r.stateNode=e;e:{switch(m=tx(i,c),i){case"dialog":Nr("cancel",e),Nr("close",e),d=c;break;case"iframe":case"object":case"embed":Nr("load",e),d=c;break;case"video":case"audio":for(d=0;d<Ef.length;d++)Nr(Ef[d],e);d=c;break;case"source":Nr("error",e),d=c;break;case"img":case"image":case"link":Nr("error",e),Nr("load",e),d=c;break;case"details":Nr("toggle",e),d=c;break;case"input":B2(e,c),d=X0(e,c),Nr("invalid",e);break;case"option":d=c;break;case"select":e._wrapperState={wasMultiple:!!c.multiple},d=Xr({},c,{value:void 0}),Nr("invalid",e);break;case"textarea":$2(e,c),d=Q0(e,c),Nr("invalid",e);break;default:d=c}ex(i,d),l=d;for(g in l)if(l.hasOwnProperty(g)){var E=l[g];g==="style"?xP(e,E):g==="dangerouslySetInnerHTML"?(E=E?E.__html:void 0,E!=null&&yP(e,E)):g==="children"?typeof E=="string"?(i!=="textarea"||E!=="")&&Gf(e,E):typeof E=="number"&&Gf(e,""+E):g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&g!=="autoFocus"&&(Zf.hasOwnProperty(g)?E!=null&&g==="onScroll"&&Nr("scroll",e):E!=null&&Pb(e,g,E,m))}switch(i){case"input":Jm(e),j2(e,c,!1);break;case"textarea":Jm(e),U2(e);break;case"option":c.value!=null&&e.setAttribute("value",""+vl(c.value));break;case"select":e.multiple=!!c.multiple,g=c.value,g!=null?fh(e,!!c.multiple,g,!1):c.defaultValue!=null&&fh(e,!!c.multiple,c.defaultValue,!0);break;default:typeof d.onClick=="function"&&(e.onclick=s_)}switch(i){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}}c&&(r.flags|=4)}r.ref!==null&&(r.flags|=512,r.flags|=2097152)}return si(r),null;case 6:if(e&&r.stateNode!=null)VE(e,r,e.memoizedProps,c);else{if(typeof c!="string"&&r.stateNode===null)throw Error(lt(166));if(i=Sc(rp.current),Sc(Ss.current),lg(r)){if(c=r.stateNode,i=r.memoizedProps,c[ys]=r,(g=c.nodeValue!==i)&&(e=Qi,e!==null))switch(e.tag){case 3:ag(c.nodeValue,i,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ag(c.nodeValue,i,(e.mode&1)!==0)}g&&(r.flags|=4)}else c=(i.nodeType===9?i:i.ownerDocument).createTextNode(c),c[ys]=r,r.stateNode=c}return si(r),null;case 13:if(Br(Wr),c=r.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Vr&&Ki!==null&&r.mode&1&&!(r.flags&128))aE(),Lh(),r.flags|=98560,g=!1;else if(g=lg(r),c!==null&&c.dehydrated!==null){if(e===null){if(!g)throw Error(lt(318));if(g=r.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(lt(317));g[ys]=r}else Lh(),!(r.flags&128)&&(r.memoizedState=null),r.flags|=4;si(r),g=!1}else Vo!==null&&(Lx(Vo),Vo=null),g=!0;if(!g)return r.flags&65536?r:null}return r.flags&128?(r.lanes=i,r):(c=c!==null,c!==(e!==null&&e.memoizedState!==null)&&c&&(r.child.flags|=8192,r.mode&1&&(e===null||Wr.current&1?In===0&&(In=3):lw())),r.updateQueue!==null&&(r.flags|=4),si(r),null);case 4:return Fh(),Ex(e,r),e===null&&Qf(r.stateNode.containerInfo),si(r),null;case 10:return Gb(r.type._context),si(r),null;case 17:return Di(r.type)&&a_(),si(r),null;case 19:if(Br(Wr),g=r.memoizedState,g===null)return si(r),null;if(c=(r.flags&128)!==0,m=g.rendering,m===null)if(c)vf(g,!1);else{if(In!==0||e!==null&&e.flags&128)for(e=r.child;e!==null;){if(m=p_(e),m!==null){for(r.flags|=128,vf(g,!1),c=m.updateQueue,c!==null&&(r.updateQueue=c,r.flags|=4),r.subtreeFlags=0,c=i,i=r.child;i!==null;)g=i,e=c,g.flags&=14680066,m=g.alternate,m===null?(g.childLanes=0,g.lanes=e,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=m.childLanes,g.lanes=m.lanes,g.child=m.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=m.memoizedProps,g.memoizedState=m.memoizedState,g.updateQueue=m.updateQueue,g.type=m.type,e=m.dependencies,g.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return zr(Wr,Wr.current&1|2),r.child}e=e.sibling}g.tail!==null&&un()>Bh&&(r.flags|=128,c=!0,vf(g,!1),r.lanes=4194304)}else{if(!c)if(e=p_(m),e!==null){if(r.flags|=128,c=!0,i=e.updateQueue,i!==null&&(r.updateQueue=i,r.flags|=4),vf(g,!0),g.tail===null&&g.tailMode==="hidden"&&!m.alternate&&!Vr)return si(r),null}else 2*un()-g.renderingStartTime>Bh&&i!==1073741824&&(r.flags|=128,c=!0,vf(g,!1),r.lanes=4194304);g.isBackwards?(m.sibling=r.child,r.child=m):(i=g.last,i!==null?i.sibling=m:r.child=m,g.last=m)}return g.tail!==null?(r=g.tail,g.rendering=r,g.tail=r.sibling,g.renderingStartTime=un(),r.sibling=null,i=Wr.current,zr(Wr,c?i&1|2:i&1),r):(si(r),null);case 22:case 23:return aw(),c=r.memoizedState!==null,e!==null&&e.memoizedState!==null!==c&&(r.flags|=8192),c&&r.mode&1?qi&1073741824&&(si(r),r.subtreeFlags&6&&(r.flags|=8192)):si(r),null;case 24:return null;case 25:return null}throw Error(lt(156,r.tag))}function UL(e,r){switch($b(r),r.tag){case 1:return Di(r.type)&&a_(),e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 3:return Fh(),Br(Ri),Br(ci),Kb(),e=r.flags,e&65536&&!(e&128)?(r.flags=e&-65537|128,r):null;case 5:return Xb(r),null;case 13:if(Br(Wr),e=r.memoizedState,e!==null&&e.dehydrated!==null){if(r.alternate===null)throw Error(lt(340));Lh()}return e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 19:return Br(Wr),null;case 4:return Fh(),null;case 10:return Gb(r.type._context),null;case 22:case 23:return aw(),null;case 24:return null;default:return null}}var hg=!1,li=!1,VL=typeof WeakSet=="function"?WeakSet:Set,Tt=null;function uh(e,r){var i=e.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(c){nn(e,r,c)}else i.current=null}function Mx(e,r,i){try{i()}catch(c){nn(e,r,c)}}var AS=!1;function ZL(e,r){if(hx=n_,e=qP(),Bb(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var c=i.getSelection&&i.getSelection();if(c&&c.rangeCount!==0){i=c.anchorNode;var d=c.anchorOffset,g=c.focusNode;c=c.focusOffset;try{i.nodeType,g.nodeType}catch{i=null;break e}var m=0,l=-1,E=-1,P=0,R=0,N=e,F=null;t:for(;;){for(var A;N!==i||d!==0&&N.nodeType!==3||(l=m+d),N!==g||c!==0&&N.nodeType!==3||(E=m+c),N.nodeType===3&&(m+=N.nodeValue.length),(A=N.firstChild)!==null;)F=N,N=A;for(;;){if(N===e)break t;if(F===i&&++P===d&&(l=m),F===g&&++R===c&&(E=m),(A=N.nextSibling)!==null)break;N=F,F=N.parentNode}N=A}i=l===-1||E===-1?null:{start:l,end:E}}else i=null}i=i||{start:0,end:0}}else i=null;for(dx={focusedElem:e,selectionRange:i},n_=!1,Tt=r;Tt!==null;)if(r=Tt,e=r.child,(r.subtreeFlags&1028)!==0&&e!==null)e.return=r,Tt=e;else for(;Tt!==null;){r=Tt;try{var X=r.alternate;if(r.flags&1024)switch(r.tag){case 0:case 11:case 15:break;case 1:if(X!==null){var Z=X.memoizedProps,ee=X.memoizedState,H=r.stateNode,U=H.getSnapshotBeforeUpdate(r.elementType===r.type?Z:No(r.type,Z),ee);H.__reactInternalSnapshotBeforeUpdate=U}break;case 3:var W=r.stateNode.containerInfo;W.nodeType===1?W.textContent="":W.nodeType===9&&W.documentElement&&W.removeChild(W.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(lt(163))}}catch(re){nn(r,r.return,re)}if(e=r.sibling,e!==null){e.return=r.return,Tt=e;break}Tt=r.return}return X=AS,AS=!1,X}function Ff(e,r,i){var c=r.updateQueue;if(c=c!==null?c.lastEffect:null,c!==null){var d=c=c.next;do{if((d.tag&e)===e){var g=d.destroy;d.destroy=void 0,g!==void 0&&Mx(r,i,g)}d=d.next}while(d!==c)}}function X_(e,r){if(r=r.updateQueue,r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var c=i.create;i.destroy=c()}i=i.next}while(i!==r)}}function kx(e){var r=e.ref;if(r!==null){var i=e.stateNode;switch(e.tag){case 5:e=i;break;default:e=i}typeof r=="function"?r(e):r.current=e}}function ZE(e){var r=e.alternate;r!==null&&(e.alternate=null,ZE(r)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(r=e.stateNode,r!==null&&(delete r[ys],delete r[ep],delete r[mx],delete r[PL],delete r[EL])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function GE(e){return e.tag===5||e.tag===3||e.tag===4}function zS(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||GE(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ix(e,r,i){var c=e.tag;if(c===5||c===6)e=e.stateNode,r?i.nodeType===8?i.parentNode.insertBefore(e,r):i.insertBefore(e,r):(i.nodeType===8?(r=i.parentNode,r.insertBefore(e,i)):(r=i,r.appendChild(e)),i=i._reactRootContainer,i!=null||r.onclick!==null||(r.onclick=s_));else if(c!==4&&(e=e.child,e!==null))for(Ix(e,r,i),e=e.sibling;e!==null;)Ix(e,r,i),e=e.sibling}function Ax(e,r,i){var c=e.tag;if(c===5||c===6)e=e.stateNode,r?i.insertBefore(e,r):i.appendChild(e);else if(c!==4&&(e=e.child,e!==null))for(Ax(e,r,i),e=e.sibling;e!==null;)Ax(e,r,i),e=e.sibling}var Hn=null,Uo=!1;function Va(e,r,i){for(i=i.child;i!==null;)HE(e,r,i),i=i.sibling}function HE(e,r,i){if(ws&&typeof ws.onCommitFiberUnmount=="function")try{ws.onCommitFiberUnmount($_,i)}catch{}switch(i.tag){case 5:li||uh(i,r);case 6:var c=Hn,d=Uo;Hn=null,Va(e,r,i),Hn=c,Uo=d,Hn!==null&&(Uo?(e=Hn,i=i.stateNode,e.nodeType===8?e.parentNode.removeChild(i):e.removeChild(i)):Hn.removeChild(i.stateNode));break;case 18:Hn!==null&&(Uo?(e=Hn,i=i.stateNode,e.nodeType===8?n0(e.parentNode,i):e.nodeType===1&&n0(e,i),Xf(e)):n0(Hn,i.stateNode));break;case 4:c=Hn,d=Uo,Hn=i.stateNode.containerInfo,Uo=!0,Va(e,r,i),Hn=c,Uo=d;break;case 0:case 11:case 14:case 15:if(!li&&(c=i.updateQueue,c!==null&&(c=c.lastEffect,c!==null))){d=c=c.next;do{var g=d,m=g.destroy;g=g.tag,m!==void 0&&(g&2||g&4)&&Mx(i,r,m),d=d.next}while(d!==c)}Va(e,r,i);break;case 1:if(!li&&(uh(i,r),c=i.stateNode,typeof c.componentWillUnmount=="function"))try{c.props=i.memoizedProps,c.state=i.memoizedState,c.componentWillUnmount()}catch(l){nn(i,r,l)}Va(e,r,i);break;case 21:Va(e,r,i);break;case 22:i.mode&1?(li=(c=li)||i.memoizedState!==null,Va(e,r,i),li=c):Va(e,r,i);break;default:Va(e,r,i)}}function RS(e){var r=e.updateQueue;if(r!==null){e.updateQueue=null;var i=e.stateNode;i===null&&(i=e.stateNode=new VL),r.forEach(function(c){var d=JL.bind(null,e,c);i.has(c)||(i.add(c),c.then(d,d))})}}function Lo(e,r){var i=r.deletions;if(i!==null)for(var c=0;c<i.length;c++){var d=i[c];try{var g=e,m=r,l=m;e:for(;l!==null;){switch(l.tag){case 5:Hn=l.stateNode,Uo=!1;break e;case 3:Hn=l.stateNode.containerInfo,Uo=!0;break e;case 4:Hn=l.stateNode.containerInfo,Uo=!0;break e}l=l.return}if(Hn===null)throw Error(lt(160));HE(g,m,d),Hn=null,Uo=!1;var E=d.alternate;E!==null&&(E.return=null),d.return=null}catch(P){nn(d,r,P)}}if(r.subtreeFlags&12854)for(r=r.child;r!==null;)WE(r,e),r=r.sibling}function WE(e,r){var i=e.alternate,c=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Lo(r,e),ds(e),c&4){try{Ff(3,e,e.return),X_(3,e)}catch(Z){nn(e,e.return,Z)}try{Ff(5,e,e.return)}catch(Z){nn(e,e.return,Z)}}break;case 1:Lo(r,e),ds(e),c&512&&i!==null&&uh(i,i.return);break;case 5:if(Lo(r,e),ds(e),c&512&&i!==null&&uh(i,i.return),e.flags&32){var d=e.stateNode;try{Gf(d,"")}catch(Z){nn(e,e.return,Z)}}if(c&4&&(d=e.stateNode,d!=null)){var g=e.memoizedProps,m=i!==null?i.memoizedProps:g,l=e.type,E=e.updateQueue;if(e.updateQueue=null,E!==null)try{l==="input"&&g.type==="radio"&&g.name!=null&&mP(d,g),tx(l,m);var P=tx(l,g);for(m=0;m<E.length;m+=2){var R=E[m],N=E[m+1];R==="style"?xP(d,N):R==="dangerouslySetInnerHTML"?yP(d,N):R==="children"?Gf(d,N):Pb(d,R,N,P)}switch(l){case"input":K0(d,g);break;case"textarea":gP(d,g);break;case"select":var F=d._wrapperState.wasMultiple;d._wrapperState.wasMultiple=!!g.multiple;var A=g.value;A!=null?fh(d,!!g.multiple,A,!1):F!==!!g.multiple&&(g.defaultValue!=null?fh(d,!!g.multiple,g.defaultValue,!0):fh(d,!!g.multiple,g.multiple?[]:"",!1))}d[ep]=g}catch(Z){nn(e,e.return,Z)}}break;case 6:if(Lo(r,e),ds(e),c&4){if(e.stateNode===null)throw Error(lt(162));d=e.stateNode,g=e.memoizedProps;try{d.nodeValue=g}catch(Z){nn(e,e.return,Z)}}break;case 3:if(Lo(r,e),ds(e),c&4&&i!==null&&i.memoizedState.isDehydrated)try{Xf(r.containerInfo)}catch(Z){nn(e,e.return,Z)}break;case 4:Lo(r,e),ds(e);break;case 13:Lo(r,e),ds(e),d=e.child,d.flags&8192&&(g=d.memoizedState!==null,d.stateNode.isHidden=g,!g||d.alternate!==null&&d.alternate.memoizedState!==null||(ow=un())),c&4&&RS(e);break;case 22:if(R=i!==null&&i.memoizedState!==null,e.mode&1?(li=(P=li)||R,Lo(r,e),li=P):Lo(r,e),ds(e),c&8192){if(P=e.memoizedState!==null,(e.stateNode.isHidden=P)&&!R&&e.mode&1)for(Tt=e,R=e.child;R!==null;){for(N=Tt=R;Tt!==null;){switch(F=Tt,A=F.child,F.tag){case 0:case 11:case 14:case 15:Ff(4,F,F.return);break;case 1:uh(F,F.return);var X=F.stateNode;if(typeof X.componentWillUnmount=="function"){c=F,i=F.return;try{r=c,X.props=r.memoizedProps,X.state=r.memoizedState,X.componentWillUnmount()}catch(Z){nn(c,i,Z)}}break;case 5:uh(F,F.return);break;case 22:if(F.memoizedState!==null){LS(N);continue}}A!==null?(A.return=F,Tt=A):LS(N)}R=R.sibling}e:for(R=null,N=e;;){if(N.tag===5){if(R===null){R=N;try{d=N.stateNode,P?(g=d.style,typeof g.setProperty=="function"?g.setProperty("display","none","important"):g.display="none"):(l=N.stateNode,E=N.memoizedProps.style,m=E!=null&&E.hasOwnProperty("display")?E.display:null,l.style.display=vP("display",m))}catch(Z){nn(e,e.return,Z)}}}else if(N.tag===6){if(R===null)try{N.stateNode.nodeValue=P?"":N.memoizedProps}catch(Z){nn(e,e.return,Z)}}else if((N.tag!==22&&N.tag!==23||N.memoizedState===null||N===e)&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===e)break e;for(;N.sibling===null;){if(N.return===null||N.return===e)break e;R===N&&(R=null),N=N.return}R===N&&(R=null),N.sibling.return=N.return,N=N.sibling}}break;case 19:Lo(r,e),ds(e),c&4&&RS(e);break;case 21:break;default:Lo(r,e),ds(e)}}function ds(e){var r=e.flags;if(r&2){try{e:{for(var i=e.return;i!==null;){if(GE(i)){var c=i;break e}i=i.return}throw Error(lt(160))}switch(c.tag){case 5:var d=c.stateNode;c.flags&32&&(Gf(d,""),c.flags&=-33);var g=zS(e);Ax(e,g,d);break;case 3:case 4:var m=c.stateNode.containerInfo,l=zS(e);Ix(e,l,m);break;default:throw Error(lt(161))}}catch(E){nn(e,e.return,E)}e.flags&=-3}r&4096&&(e.flags&=-4097)}function GL(e,r,i){Tt=e,qE(e)}function qE(e,r,i){for(var c=(e.mode&1)!==0;Tt!==null;){var d=Tt,g=d.child;if(d.tag===22&&c){var m=d.memoizedState!==null||hg;if(!m){var l=d.alternate,E=l!==null&&l.memoizedState!==null||li;l=hg;var P=li;if(hg=m,(li=E)&&!P)for(Tt=d;Tt!==null;)m=Tt,E=m.child,m.tag===22&&m.memoizedState!==null?OS(d):E!==null?(E.return=m,Tt=E):OS(d);for(;g!==null;)Tt=g,qE(g),g=g.sibling;Tt=d,hg=l,li=P}DS(e)}else d.subtreeFlags&8772&&g!==null?(g.return=d,Tt=g):DS(e)}}function DS(e){for(;Tt!==null;){var r=Tt;if(r.flags&8772){var i=r.alternate;try{if(r.flags&8772)switch(r.tag){case 0:case 11:case 15:li||X_(5,r);break;case 1:var c=r.stateNode;if(r.flags&4&&!li)if(i===null)c.componentDidMount();else{var d=r.elementType===r.type?i.memoizedProps:No(r.type,i.memoizedProps);c.componentDidUpdate(d,i.memoizedState,c.__reactInternalSnapshotBeforeUpdate)}var g=r.updateQueue;g!==null&&yS(r,g,c);break;case 3:var m=r.updateQueue;if(m!==null){if(i=null,r.child!==null)switch(r.child.tag){case 5:i=r.child.stateNode;break;case 1:i=r.child.stateNode}yS(r,m,i)}break;case 5:var l=r.stateNode;if(i===null&&r.flags&4){i=l;var E=r.memoizedProps;switch(r.type){case"button":case"input":case"select":case"textarea":E.autoFocus&&i.focus();break;case"img":E.src&&(i.src=E.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(r.memoizedState===null){var P=r.alternate;if(P!==null){var R=P.memoizedState;if(R!==null){var N=R.dehydrated;N!==null&&Xf(N)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(lt(163))}li||r.flags&512&&kx(r)}catch(F){nn(r,r.return,F)}}if(r===e){Tt=null;break}if(i=r.sibling,i!==null){i.return=r.return,Tt=i;break}Tt=r.return}}function LS(e){for(;Tt!==null;){var r=Tt;if(r===e){Tt=null;break}var i=r.sibling;if(i!==null){i.return=r.return,Tt=i;break}Tt=r.return}}function OS(e){for(;Tt!==null;){var r=Tt;try{switch(r.tag){case 0:case 11:case 15:var i=r.return;try{X_(4,r)}catch(E){nn(r,i,E)}break;case 1:var c=r.stateNode;if(typeof c.componentDidMount=="function"){var d=r.return;try{c.componentDidMount()}catch(E){nn(r,d,E)}}var g=r.return;try{kx(r)}catch(E){nn(r,g,E)}break;case 5:var m=r.return;try{kx(r)}catch(E){nn(r,m,E)}}}catch(E){nn(r,r.return,E)}if(r===e){Tt=null;break}var l=r.sibling;if(l!==null){l.return=r.return,Tt=l;break}Tt=r.return}}var HL=Math.ceil,__=ua.ReactCurrentDispatcher,nw=ua.ReactCurrentOwner,_o=ua.ReactCurrentBatchConfig,hr=0,Fn=null,xn=null,qn=0,qi=0,hh=Tl(0),In=0,sp=null,jc=0,K_=0,iw=0,Nf=null,ki=null,ow=0,Bh=1/0,Ks=null,y_=!1,zx=null,fl=null,dg=!1,ol=null,v_=0,Bf=0,Rx=null,jg=-1,$g=0;function xi(){return hr&6?un():jg!==-1?jg:jg=un()}function pl(e){return e.mode&1?hr&2&&qn!==0?qn&-qn:kL.transition!==null?($g===0&&($g=zP()),$g):(e=vr,e!==0||(e=window.event,e=e===void 0?16:BP(e.type)),e):1}function Ho(e,r,i,c){if(50<Bf)throw Bf=0,Rx=null,Error(lt(185));Pp(e,i,c),(!(hr&2)||e!==Fn)&&(e===Fn&&(!(hr&2)&&(K_|=i),In===4&&Ya(e,qn)),Li(e,c),i===1&&hr===0&&!(r.mode&1)&&(Bh=un()+500,H_&&Cl()))}function Li(e,r){var i=e.callbackNode;kD(e,r);var c=r_(e,e===Fn?qn:0);if(c===0)i!==null&&G2(i),e.callbackNode=null,e.callbackPriority=0;else if(r=c&-c,e.callbackPriority!==r){if(i!=null&&G2(i),r===1)e.tag===0?ML(FS.bind(null,e)):iE(FS.bind(null,e)),TL(function(){!(hr&6)&&Cl()}),i=null;else{switch(RP(c)){case 1:i=Ab;break;case 4:i=IP;break;case 16:i=t_;break;case 536870912:i=AP;break;default:i=t_}i=rM(i,XE.bind(null,e))}e.callbackPriority=r,e.callbackNode=i}}function XE(e,r){if(jg=-1,$g=0,hr&6)throw Error(lt(327));var i=e.callbackNode;if(yh()&&e.callbackNode!==i)return null;var c=r_(e,e===Fn?qn:0);if(c===0)return null;if(c&30||c&e.expiredLanes||r)r=x_(e,c);else{r=c;var d=hr;hr|=2;var g=YE();(Fn!==e||qn!==r)&&(Ks=null,Bh=un()+500,Dc(e,r));do try{XL();break}catch(l){KE(e,l)}while(!0);Zb(),__.current=g,hr=d,xn!==null?r=0:(Fn=null,qn=0,r=In)}if(r!==0){if(r===2&&(d=sx(e),d!==0&&(c=d,r=Dx(e,d))),r===1)throw i=sp,Dc(e,0),Ya(e,c),Li(e,un()),i;if(r===6)Ya(e,c);else{if(d=e.current.alternate,!(c&30)&&!WL(d)&&(r=x_(e,c),r===2&&(g=sx(e),g!==0&&(c=g,r=Dx(e,g))),r===1))throw i=sp,Dc(e,0),Ya(e,c),Li(e,un()),i;switch(e.finishedWork=d,e.finishedLanes=c,r){case 0:case 1:throw Error(lt(345));case 2:xc(e,ki,Ks);break;case 3:if(Ya(e,c),(c&130023424)===c&&(r=ow+500-un(),10<r)){if(r_(e,0)!==0)break;if(d=e.suspendedLanes,(d&c)!==c){xi(),e.pingedLanes|=e.suspendedLanes&d;break}e.timeoutHandle=px(xc.bind(null,e,ki,Ks),r);break}xc(e,ki,Ks);break;case 4:if(Ya(e,c),(c&4194240)===c)break;for(r=e.eventTimes,d=-1;0<c;){var m=31-Go(c);g=1<<m,m=r[m],m>d&&(d=m),c&=~g}if(c=d,c=un()-c,c=(120>c?120:480>c?480:1080>c?1080:1920>c?1920:3e3>c?3e3:4320>c?4320:1960*HL(c/1960))-c,10<c){e.timeoutHandle=px(xc.bind(null,e,ki,Ks),c);break}xc(e,ki,Ks);break;case 5:xc(e,ki,Ks);break;default:throw Error(lt(329))}}}return Li(e,un()),e.callbackNode===i?XE.bind(null,e):null}function Dx(e,r){var i=Nf;return e.current.memoizedState.isDehydrated&&(Dc(e,r).flags|=256),e=x_(e,r),e!==2&&(r=ki,ki=i,r!==null&&Lx(r)),e}function Lx(e){ki===null?ki=e:ki.push.apply(ki,e)}function WL(e){for(var r=e;;){if(r.flags&16384){var i=r.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var c=0;c<i.length;c++){var d=i[c],g=d.getSnapshot;d=d.value;try{if(!Wo(g(),d))return!1}catch{return!1}}}if(i=r.child,r.subtreeFlags&16384&&i!==null)i.return=r,r=i;else{if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Ya(e,r){for(r&=~iw,r&=~K_,e.suspendedLanes|=r,e.pingedLanes&=~r,e=e.expirationTimes;0<r;){var i=31-Go(r),c=1<<i;e[i]=-1,r&=~c}}function FS(e){if(hr&6)throw Error(lt(327));yh();var r=r_(e,0);if(!(r&1))return Li(e,un()),null;var i=x_(e,r);if(e.tag!==0&&i===2){var c=sx(e);c!==0&&(r=c,i=Dx(e,c))}if(i===1)throw i=sp,Dc(e,0),Ya(e,r),Li(e,un()),i;if(i===6)throw Error(lt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=r,xc(e,ki,Ks),Li(e,un()),null}function sw(e,r){var i=hr;hr|=1;try{return e(r)}finally{hr=i,hr===0&&(Bh=un()+500,H_&&Cl())}}function $c(e){ol!==null&&ol.tag===0&&!(hr&6)&&yh();var r=hr;hr|=1;var i=_o.transition,c=vr;try{if(_o.transition=null,vr=1,e)return e()}finally{vr=c,_o.transition=i,hr=r,!(hr&6)&&Cl()}}function aw(){qi=hh.current,Br(hh)}function Dc(e,r){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(i!==-1&&(e.timeoutHandle=-1,SL(i)),xn!==null)for(i=xn.return;i!==null;){var c=i;switch($b(c),c.tag){case 1:c=c.type.childContextTypes,c!=null&&a_();break;case 3:Fh(),Br(Ri),Br(ci),Kb();break;case 5:Xb(c);break;case 4:Fh();break;case 13:Br(Wr);break;case 19:Br(Wr);break;case 10:Gb(c.type._context);break;case 22:case 23:aw()}i=i.return}if(Fn=e,xn=e=ml(e.current,null),qn=qi=r,In=0,sp=null,iw=K_=jc=0,ki=Nf=null,wc!==null){for(r=0;r<wc.length;r++)if(i=wc[r],c=i.interleaved,c!==null){i.interleaved=null;var d=c.next,g=i.pending;if(g!==null){var m=g.next;g.next=d,c.next=m}i.pending=c}wc=null}return e}function KE(e,r){do{var i=xn;try{if(Zb(),Fg.current=g_,m_){for(var c=qr.memoizedState;c!==null;){var d=c.queue;d!==null&&(d.pending=null),c=c.next}m_=!1}if(Bc=0,On=kn=qr=null,Of=!1,np=0,nw.current=null,i===null||i.return===null){In=1,sp=r,xn=null;break}e:{var g=e,m=i.return,l=i,E=r;if(r=qn,l.flags|=32768,E!==null&&typeof E=="object"&&typeof E.then=="function"){var P=E,R=l,N=R.tag;if(!(R.mode&1)&&(N===0||N===11||N===15)){var F=R.alternate;F?(R.updateQueue=F.updateQueue,R.memoizedState=F.memoizedState,R.lanes=F.lanes):(R.updateQueue=null,R.memoizedState=null)}var A=TS(m);if(A!==null){A.flags&=-257,CS(A,m,l,g,r),A.mode&1&&SS(g,P,r),r=A,E=P;var X=r.updateQueue;if(X===null){var Z=new Set;Z.add(E),r.updateQueue=Z}else X.add(E);break e}else{if(!(r&1)){SS(g,P,r),lw();break e}E=Error(lt(426))}}else if(Vr&&l.mode&1){var ee=TS(m);if(ee!==null){!(ee.flags&65536)&&(ee.flags|=256),CS(ee,m,l,g,r),Ub(Nh(E,l));break e}}g=E=Nh(E,l),In!==4&&(In=2),Nf===null?Nf=[g]:Nf.push(g),g=m;do{switch(g.tag){case 3:g.flags|=65536,r&=-r,g.lanes|=r;var H=RE(g,E,r);_S(g,H);break e;case 1:l=E;var U=g.type,W=g.stateNode;if(!(g.flags&128)&&(typeof U.getDerivedStateFromError=="function"||W!==null&&typeof W.componentDidCatch=="function"&&(fl===null||!fl.has(W)))){g.flags|=65536,r&=-r,g.lanes|=r;var re=DE(g,l,r);_S(g,re);break e}}g=g.return}while(g!==null)}JE(i)}catch(ge){r=ge,xn===i&&i!==null&&(xn=i=i.return);continue}break}while(!0)}function YE(){var e=__.current;return __.current=g_,e===null?g_:e}function lw(){(In===0||In===3||In===2)&&(In=4),Fn===null||!(jc&268435455)&&!(K_&268435455)||Ya(Fn,qn)}function x_(e,r){var i=hr;hr|=2;var c=YE();(Fn!==e||qn!==r)&&(Ks=null,Dc(e,r));do try{qL();break}catch(d){KE(e,d)}while(!0);if(Zb(),hr=i,__.current=c,xn!==null)throw Error(lt(261));return Fn=null,qn=0,In}function qL(){for(;xn!==null;)QE(xn)}function XL(){for(;xn!==null&&!xD();)QE(xn)}function QE(e){var r=tM(e.alternate,e,qi);e.memoizedProps=e.pendingProps,r===null?JE(e):xn=r,nw.current=null}function JE(e){var r=e;do{var i=r.alternate;if(e=r.return,r.flags&32768){if(i=UL(i,r),i!==null){i.flags&=32767,xn=i;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{In=6,xn=null;return}}else if(i=$L(i,r,qi),i!==null){xn=i;return}if(r=r.sibling,r!==null){xn=r;return}xn=r=e}while(r!==null);In===0&&(In=5)}function xc(e,r,i){var c=vr,d=_o.transition;try{_o.transition=null,vr=1,KL(e,r,i,c)}finally{_o.transition=d,vr=c}return null}function KL(e,r,i,c){do yh();while(ol!==null);if(hr&6)throw Error(lt(327));i=e.finishedWork;var d=e.finishedLanes;if(i===null)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(lt(177));e.callbackNode=null,e.callbackPriority=0;var g=i.lanes|i.childLanes;if(ID(e,g),e===Fn&&(xn=Fn=null,qn=0),!(i.subtreeFlags&2064)&&!(i.flags&2064)||dg||(dg=!0,rM(t_,function(){return yh(),null})),g=(i.flags&15990)!==0,i.subtreeFlags&15990||g){g=_o.transition,_o.transition=null;var m=vr;vr=1;var l=hr;hr|=4,nw.current=null,ZL(e,i),WE(i,e),gL(dx),n_=!!hx,dx=hx=null,e.current=i,GL(i),bD(),hr=l,vr=m,_o.transition=g}else e.current=i;if(dg&&(dg=!1,ol=e,v_=d),g=e.pendingLanes,g===0&&(fl=null),TD(i.stateNode),Li(e,un()),r!==null)for(c=e.onRecoverableError,i=0;i<r.length;i++)d=r[i],c(d.value,{componentStack:d.stack,digest:d.digest});if(y_)throw y_=!1,e=zx,zx=null,e;return v_&1&&e.tag!==0&&yh(),g=e.pendingLanes,g&1?e===Rx?Bf++:(Bf=0,Rx=e):Bf=0,Cl(),null}function yh(){if(ol!==null){var e=RP(v_),r=_o.transition,i=vr;try{if(_o.transition=null,vr=16>e?16:e,ol===null)var c=!1;else{if(e=ol,ol=null,v_=0,hr&6)throw Error(lt(331));var d=hr;for(hr|=4,Tt=e.current;Tt!==null;){var g=Tt,m=g.child;if(Tt.flags&16){var l=g.deletions;if(l!==null){for(var E=0;E<l.length;E++){var P=l[E];for(Tt=P;Tt!==null;){var R=Tt;switch(R.tag){case 0:case 11:case 15:Ff(8,R,g)}var N=R.child;if(N!==null)N.return=R,Tt=N;else for(;Tt!==null;){R=Tt;var F=R.sibling,A=R.return;if(ZE(R),R===P){Tt=null;break}if(F!==null){F.return=A,Tt=F;break}Tt=A}}}var X=g.alternate;if(X!==null){var Z=X.child;if(Z!==null){X.child=null;do{var ee=Z.sibling;Z.sibling=null,Z=ee}while(Z!==null)}}Tt=g}}if(g.subtreeFlags&2064&&m!==null)m.return=g,Tt=m;else e:for(;Tt!==null;){if(g=Tt,g.flags&2048)switch(g.tag){case 0:case 11:case 15:Ff(9,g,g.return)}var H=g.sibling;if(H!==null){H.return=g.return,Tt=H;break e}Tt=g.return}}var U=e.current;for(Tt=U;Tt!==null;){m=Tt;var W=m.child;if(m.subtreeFlags&2064&&W!==null)W.return=m,Tt=W;else e:for(m=U;Tt!==null;){if(l=Tt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:X_(9,l)}}catch(ge){nn(l,l.return,ge)}if(l===m){Tt=null;break e}var re=l.sibling;if(re!==null){re.return=l.return,Tt=re;break e}Tt=l.return}}if(hr=d,Cl(),ws&&typeof ws.onPostCommitFiberRoot=="function")try{ws.onPostCommitFiberRoot($_,e)}catch{}c=!0}return c}finally{vr=i,_o.transition=r}}return!1}function NS(e,r,i){r=Nh(i,r),r=RE(e,r,1),e=dl(e,r,1),r=xi(),e!==null&&(Pp(e,1,r),Li(e,r))}function nn(e,r,i){if(e.tag===3)NS(e,e,i);else for(;r!==null;){if(r.tag===3){NS(r,e,i);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(fl===null||!fl.has(c))){e=Nh(i,e),e=DE(r,e,1),r=dl(r,e,1),e=xi(),r!==null&&(Pp(r,1,e),Li(r,e));break}}r=r.return}}function YL(e,r,i){var c=e.pingCache;c!==null&&c.delete(r),r=xi(),e.pingedLanes|=e.suspendedLanes&i,Fn===e&&(qn&i)===i&&(In===4||In===3&&(qn&130023424)===qn&&500>un()-ow?Dc(e,0):iw|=i),Li(e,r)}function eM(e,r){r===0&&(e.mode&1?(r=rg,rg<<=1,!(rg&130023424)&&(rg=4194304)):r=1);var i=xi();e=sa(e,r),e!==null&&(Pp(e,r,i),Li(e,i))}function QL(e){var r=e.memoizedState,i=0;r!==null&&(i=r.retryLane),eM(e,i)}function JL(e,r){var i=0;switch(e.tag){case 13:var c=e.stateNode,d=e.memoizedState;d!==null&&(i=d.retryLane);break;case 19:c=e.stateNode;break;default:throw Error(lt(314))}c!==null&&c.delete(r),eM(e,i)}var tM;tM=function(e,r,i){if(e!==null)if(e.memoizedProps!==r.pendingProps||Ri.current)Ii=!0;else{if(!(e.lanes&i)&&!(r.flags&128))return Ii=!1,jL(e,r,i);Ii=!!(e.flags&131072)}else Ii=!1,Vr&&r.flags&1048576&&oE(r,u_,r.index);switch(r.lanes=0,r.tag){case 2:var c=r.type;Bg(e,r),e=r.pendingProps;var d=Dh(r,ci.current);_h(r,i),d=Qb(null,r,c,e,d,i);var g=Jb();return r.flags|=1,typeof d=="object"&&d!==null&&typeof d.render=="function"&&d.$$typeof===void 0?(r.tag=1,r.memoizedState=null,r.updateQueue=null,Di(c)?(g=!0,l_(r)):g=!1,r.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,Wb(r),d.updater=q_,r.stateNode=d,d._reactInternals=r,bx(r,c,e,i),r=Tx(null,r,c,!0,g,i)):(r.tag=0,Vr&&g&&jb(r),_i(null,r,d,i),r=r.child),r;case 16:c=r.elementType;e:{switch(Bg(e,r),e=r.pendingProps,d=c._init,c=d(c._payload),r.type=c,d=r.tag=t3(c),e=No(c,e),d){case 0:r=Sx(null,r,c,e,i);break e;case 1:r=MS(null,r,c,e,i);break e;case 11:r=PS(null,r,c,e,i);break e;case 14:r=ES(null,r,c,No(c.type,e),i);break e}throw Error(lt(306,c,""))}return r;case 0:return c=r.type,d=r.pendingProps,d=r.elementType===c?d:No(c,d),Sx(e,r,c,d,i);case 1:return c=r.type,d=r.pendingProps,d=r.elementType===c?d:No(c,d),MS(e,r,c,d,i);case 3:e:{if(NE(r),e===null)throw Error(lt(387));c=r.pendingProps,g=r.memoizedState,d=g.element,hE(e,r),f_(r,c,null,i);var m=r.memoizedState;if(c=m.element,g.isDehydrated)if(g={element:c,isDehydrated:!1,cache:m.cache,pendingSuspenseBoundaries:m.pendingSuspenseBoundaries,transitions:m.transitions},r.updateQueue.baseState=g,r.memoizedState=g,r.flags&256){d=Nh(Error(lt(423)),r),r=kS(e,r,c,i,d);break e}else if(c!==d){d=Nh(Error(lt(424)),r),r=kS(e,r,c,i,d);break e}else for(Ki=hl(r.stateNode.containerInfo.firstChild),Qi=r,Vr=!0,Vo=null,i=cE(r,null,c,i),r.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(Lh(),c===d){r=aa(e,r,i);break e}_i(e,r,c,i)}r=r.child}return r;case 5:return dE(r),e===null&&yx(r),c=r.type,d=r.pendingProps,g=e!==null?e.memoizedProps:null,m=d.children,fx(c,d)?m=null:g!==null&&fx(c,g)&&(r.flags|=32),FE(e,r),_i(e,r,m,i),r.child;case 6:return e===null&&yx(r),null;case 13:return BE(e,r,i);case 4:return qb(r,r.stateNode.containerInfo),c=r.pendingProps,e===null?r.child=Oh(r,null,c,i):_i(e,r,c,i),r.child;case 11:return c=r.type,d=r.pendingProps,d=r.elementType===c?d:No(c,d),PS(e,r,c,d,i);case 7:return _i(e,r,r.pendingProps,i),r.child;case 8:return _i(e,r,r.pendingProps.children,i),r.child;case 12:return _i(e,r,r.pendingProps.children,i),r.child;case 10:e:{if(c=r.type._context,d=r.pendingProps,g=r.memoizedProps,m=d.value,zr(h_,c._currentValue),c._currentValue=m,g!==null)if(Wo(g.value,m)){if(g.children===d.children&&!Ri.current){r=aa(e,r,i);break e}}else for(g=r.child,g!==null&&(g.return=r);g!==null;){var l=g.dependencies;if(l!==null){m=g.child;for(var E=l.firstContext;E!==null;){if(E.context===c){if(g.tag===1){E=na(-1,i&-i),E.tag=2;var P=g.updateQueue;if(P!==null){P=P.shared;var R=P.pending;R===null?E.next=E:(E.next=R.next,R.next=E),P.pending=E}}g.lanes|=i,E=g.alternate,E!==null&&(E.lanes|=i),vx(g.return,i,r),l.lanes|=i;break}E=E.next}}else if(g.tag===10)m=g.type===r.type?null:g.child;else if(g.tag===18){if(m=g.return,m===null)throw Error(lt(341));m.lanes|=i,l=m.alternate,l!==null&&(l.lanes|=i),vx(m,i,r),m=g.sibling}else m=g.child;if(m!==null)m.return=g;else for(m=g;m!==null;){if(m===r){m=null;break}if(g=m.sibling,g!==null){g.return=m.return,m=g;break}m=m.return}g=m}_i(e,r,d.children,i),r=r.child}return r;case 9:return d=r.type,c=r.pendingProps.children,_h(r,i),d=yo(d),c=c(d),r.flags|=1,_i(e,r,c,i),r.child;case 14:return c=r.type,d=No(c,r.pendingProps),d=No(c.type,d),ES(e,r,c,d,i);case 15:return LE(e,r,r.type,r.pendingProps,i);case 17:return c=r.type,d=r.pendingProps,d=r.elementType===c?d:No(c,d),Bg(e,r),r.tag=1,Di(c)?(e=!0,l_(r)):e=!1,_h(r,i),zE(r,c,d),bx(r,c,d,i),Tx(null,r,c,!0,e,i);case 19:return jE(e,r,i);case 22:return OE(e,r,i)}throw Error(lt(156,r.tag))};function rM(e,r){return kP(e,r)}function e3(e,r,i,c){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function go(e,r,i,c){return new e3(e,r,i,c)}function cw(e){return e=e.prototype,!(!e||!e.isReactComponent)}function t3(e){if(typeof e=="function")return cw(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Mb)return 11;if(e===kb)return 14}return 2}function ml(e,r){var i=e.alternate;return i===null?(i=go(e.tag,r,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=r,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&14680064,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,r=e.dependencies,i.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function Ug(e,r,i,c,d,g){var m=2;if(c=e,typeof e=="function")cw(e)&&(m=1);else if(typeof e=="string")m=5;else e:switch(e){case th:return Lc(i.children,d,g,r);case Eb:m=8,d|=8;break;case G0:return e=go(12,i,r,d|2),e.elementType=G0,e.lanes=g,e;case H0:return e=go(13,i,r,d),e.elementType=H0,e.lanes=g,e;case W0:return e=go(19,i,r,d),e.elementType=W0,e.lanes=g,e;case dP:return Y_(i,d,g,r);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case uP:m=10;break e;case hP:m=9;break e;case Mb:m=11;break e;case kb:m=14;break e;case qa:m=16,c=null;break e}throw Error(lt(130,e==null?e:typeof e,""))}return r=go(m,i,r,d),r.elementType=e,r.type=c,r.lanes=g,r}function Lc(e,r,i,c){return e=go(7,e,c,r),e.lanes=i,e}function Y_(e,r,i,c){return e=go(22,e,c,r),e.elementType=dP,e.lanes=i,e.stateNode={isHidden:!1},e}function h0(e,r,i){return e=go(6,e,null,r),e.lanes=i,e}function d0(e,r,i){return r=go(4,e.children!==null?e.children:[],e.key,r),r.lanes=i,r.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},r}function r3(e,r,i,c,d){this.tag=r,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Hv(0),this.expirationTimes=Hv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Hv(0),this.identifierPrefix=c,this.onRecoverableError=d,this.mutableSourceEagerHydrationData=null}function uw(e,r,i,c,d,g,m,l,E){return e=new r3(e,r,i,l,E),r===1?(r=1,g===!0&&(r|=8)):r=0,g=go(3,null,null,r),e.current=g,g.stateNode=e,g.memoizedState={element:c,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},Wb(g),e}function n3(e,r,i){var c=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:eh,key:c==null?null:""+c,children:e,containerInfo:r,implementation:i}}function nM(e){if(!e)return xl;e=e._reactInternals;e:{if(Xc(e)!==e||e.tag!==1)throw Error(lt(170));var r=e;do{switch(r.tag){case 3:r=r.stateNode.context;break e;case 1:if(Di(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break e}}r=r.return}while(r!==null);throw Error(lt(171))}if(e.tag===1){var i=e.type;if(Di(i))return nE(e,i,r)}return r}function iM(e,r,i,c,d,g,m,l,E){return e=uw(i,c,!0,e,d,g,m,l,E),e.context=nM(null),i=e.current,c=xi(),d=pl(i),g=na(c,d),g.callback=r??null,dl(i,g,d),e.current.lanes=d,Pp(e,d,c),Li(e,c),e}function Q_(e,r,i,c){var d=r.current,g=xi(),m=pl(d);return i=nM(i),r.context===null?r.context=i:r.pendingContext=i,r=na(g,m),r.payload={element:e},c=c===void 0?null:c,c!==null&&(r.callback=c),e=dl(d,r,m),e!==null&&(Ho(e,d,m,g),Og(e,d,m)),m}function b_(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function BS(e,r){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<r?i:r}}function hw(e,r){BS(e,r),(e=e.alternate)&&BS(e,r)}function i3(){return null}var oM=typeof reportError=="function"?reportError:function(e){console.error(e)};function dw(e){this._internalRoot=e}J_.prototype.render=dw.prototype.render=function(e){var r=this._internalRoot;if(r===null)throw Error(lt(409));Q_(e,r,null,null)};J_.prototype.unmount=dw.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var r=e.containerInfo;$c(function(){Q_(null,e,null,null)}),r[oa]=null}};function J_(e){this._internalRoot=e}J_.prototype.unstable_scheduleHydration=function(e){if(e){var r=OP();e={blockedOn:null,target:e,priority:r};for(var i=0;i<Ka.length&&r!==0&&r<Ka[i].priority;i++);Ka.splice(i,0,e),i===0&&NP(e)}};function fw(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ey(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function jS(){}function o3(e,r,i,c,d){if(d){if(typeof c=="function"){var g=c;c=function(){var P=b_(m);g.call(P)}}var m=iM(r,c,e,0,null,!1,!1,"",jS);return e._reactRootContainer=m,e[oa]=m.current,Qf(e.nodeType===8?e.parentNode:e),$c(),m}for(;d=e.lastChild;)e.removeChild(d);if(typeof c=="function"){var l=c;c=function(){var P=b_(E);l.call(P)}}var E=uw(e,0,!1,null,null,!1,!1,"",jS);return e._reactRootContainer=E,e[oa]=E.current,Qf(e.nodeType===8?e.parentNode:e),$c(function(){Q_(r,E,i,c)}),E}function ty(e,r,i,c,d){var g=i._reactRootContainer;if(g){var m=g;if(typeof d=="function"){var l=d;d=function(){var E=b_(m);l.call(E)}}Q_(r,m,e,d)}else m=o3(i,r,e,d,c);return b_(m)}DP=function(e){switch(e.tag){case 3:var r=e.stateNode;if(r.current.memoizedState.isDehydrated){var i=Pf(r.pendingLanes);i!==0&&(zb(r,i|1),Li(r,un()),!(hr&6)&&(Bh=un()+500,Cl()))}break;case 13:$c(function(){var c=sa(e,1);if(c!==null){var d=xi();Ho(c,e,1,d)}}),hw(e,1)}};Rb=function(e){if(e.tag===13){var r=sa(e,134217728);if(r!==null){var i=xi();Ho(r,e,134217728,i)}hw(e,134217728)}};LP=function(e){if(e.tag===13){var r=pl(e),i=sa(e,r);if(i!==null){var c=xi();Ho(i,e,r,c)}hw(e,r)}};OP=function(){return vr};FP=function(e,r){var i=vr;try{return vr=e,r()}finally{vr=i}};nx=function(e,r,i){switch(r){case"input":if(K0(e,i),r=i.name,i.type==="radio"&&r!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]'),r=0;r<i.length;r++){var c=i[r];if(c!==e&&c.form===e.form){var d=G_(c);if(!d)throw Error(lt(90));pP(c),K0(c,d)}}}break;case"textarea":gP(e,i);break;case"select":r=i.value,r!=null&&fh(e,!!i.multiple,r,!1)}};SP=sw;TP=$c;var s3={usingClientEntryPoint:!1,Events:[Mp,oh,G_,bP,wP,sw]},xf={findFiberByHostInstance:bc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},a3={bundleType:xf.bundleType,version:xf.version,rendererPackageName:xf.rendererPackageName,rendererConfig:xf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=EP(e),e===null?null:e.stateNode},findFiberByHostInstance:xf.findFiberByHostInstance||i3,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var fg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!fg.isDisabled&&fg.supportsFiber)try{$_=fg.inject(a3),ws=fg}catch{}}to.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=s3;to.createPortal=function(e,r){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!fw(r))throw Error(lt(200));return n3(e,r,null,i)};to.createRoot=function(e,r){if(!fw(e))throw Error(lt(299));var i=!1,c="",d=oM;return r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onRecoverableError!==void 0&&(d=r.onRecoverableError)),r=uw(e,1,!1,null,null,i,!1,c,d),e[oa]=r.current,Qf(e.nodeType===8?e.parentNode:e),new dw(r)};to.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var r=e._reactInternals;if(r===void 0)throw typeof e.render=="function"?Error(lt(188)):(e=Object.keys(e).join(","),Error(lt(268,e)));return e=EP(r),e=e===null?null:e.stateNode,e};to.flushSync=function(e){return $c(e)};to.hydrate=function(e,r,i){if(!ey(r))throw Error(lt(200));return ty(null,e,r,!0,i)};to.hydrateRoot=function(e,r,i){if(!fw(e))throw Error(lt(405));var c=i!=null&&i.hydratedSources||null,d=!1,g="",m=oM;if(i!=null&&(i.unstable_strictMode===!0&&(d=!0),i.identifierPrefix!==void 0&&(g=i.identifierPrefix),i.onRecoverableError!==void 0&&(m=i.onRecoverableError)),r=iM(r,null,e,1,i??null,d,!1,g,m),e[oa]=r.current,Qf(e),c)for(e=0;e<c.length;e++)i=c[e],d=i._getVersion,d=d(i._source),r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[i,d]:r.mutableSourceEagerHydrationData.push(i,d);return new J_(r)};to.render=function(e,r,i){if(!ey(r))throw Error(lt(200));return ty(null,e,r,!1,i)};to.unmountComponentAtNode=function(e){if(!ey(e))throw Error(lt(40));return e._reactRootContainer?($c(function(){ty(null,null,e,!1,function(){e._reactRootContainer=null,e[oa]=null})}),!0):!1};to.unstable_batchedUpdates=sw;to.unstable_renderSubtreeIntoContainer=function(e,r,i,c){if(!ey(i))throw Error(lt(200));if(e==null||e._reactInternals===void 0)throw Error(lt(38));return ty(e,r,i,!1,c)};to.version="18.3.1-next-f1338f8080-20240426";function sM(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(sM)}catch(e){console.error(e)}}sM(),sP.exports=to;var Kc=sP.exports;const aM=yb(Kc);var lM,$S=Kc;lM=$S.createRoot,$S.hydrateRoot;const l3=1,c3=1e6;let f0=0;function u3(){return f0=(f0+1)%Number.MAX_SAFE_INTEGER,f0.toString()}const p0=new Map,US=e=>{if(p0.has(e))return;const r=setTimeout(()=>{p0.delete(e),jf({type:"REMOVE_TOAST",toastId:e})},c3);p0.set(e,r)},h3=(e,r)=>{switch(r.type){case"ADD_TOAST":return{...e,toasts:[r.toast,...e.toasts].slice(0,l3)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(i=>i.id===r.toast.id?{...i,...r.toast}:i)};case"DISMISS_TOAST":{const{toastId:i}=r;return i?US(i):e.toasts.forEach(c=>{US(c.id)}),{...e,toasts:e.toasts.map(c=>c.id===i||i===void 0?{...c,open:!1}:c)}}case"REMOVE_TOAST":return r.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(i=>i.id!==r.toastId)}}},Vg=[];let Zg={toasts:[]};function jf(e){Zg=h3(Zg,e),Vg.forEach(r=>{r(Zg)})}function d3({...e}){const r=u3(),i=d=>jf({type:"UPDATE_TOAST",toast:{...d,id:r}}),c=()=>jf({type:"DISMISS_TOAST",toastId:r});return jf({type:"ADD_TOAST",toast:{...e,id:r,open:!0,onOpenChange:d=>{d||c()}}}),{id:r,dismiss:c,update:i}}function f3(){const[e,r]=Y.useState(Zg);return Y.useEffect(()=>(Vg.push(r),()=>{const i=Vg.indexOf(r);i>-1&&Vg.splice(i,1)}),[e]),{...e,toast:d3,dismiss:i=>jf({type:"DISMISS_TOAST",toastId:i})}}function ar(e,r,{checkForDefaultPrevented:i=!0}={}){return function(d){if(e==null||e(d),i===!1||!d.defaultPrevented)return r==null?void 0:r(d)}}function VS(e,r){if(typeof e=="function")return e(r);e!=null&&(e.current=r)}function cM(...e){return r=>{let i=!1;const c=e.map(d=>{const g=VS(d,r);return!i&&typeof g=="function"&&(i=!0),g});if(i)return()=>{for(let d=0;d<c.length;d++){const g=c[d];typeof g=="function"?g():VS(e[d],null)}}}}function on(...e){return Y.useCallback(cM(...e),e)}function Ip(e,r=[]){let i=[];function c(g,m){const l=Y.createContext(m),E=i.length;i=[...i,m];const P=N=>{var H;const{scope:F,children:A,...X}=N,Z=((H=F==null?void 0:F[e])==null?void 0:H[E])||l,ee=Y.useMemo(()=>X,Object.values(X));return ye.jsx(Z.Provider,{value:ee,children:A})};P.displayName=g+"Provider";function R(N,F){var Z;const A=((Z=F==null?void 0:F[e])==null?void 0:Z[E])||l,X=Y.useContext(A);if(X)return X;if(m!==void 0)return m;throw new Error(`\`${N}\` must be used within \`${g}\``)}return[P,R]}const d=()=>{const g=i.map(m=>Y.createContext(m));return function(l){const E=(l==null?void 0:l[e])||g;return Y.useMemo(()=>({[`__scope${e}`]:{...l,[e]:E}}),[l,E])}};return d.scopeName=e,[c,p3(d,...r)]}function p3(...e){const r=e[0];if(e.length===1)return r;const i=()=>{const c=e.map(d=>({useScope:d(),scopeName:d.scopeName}));return function(g){const m=c.reduce((l,{useScope:E,scopeName:P})=>{const N=E(g)[`__scope${P}`];return{...l,...N}},{});return Y.useMemo(()=>({[`__scope${r.scopeName}`]:m}),[m])}};return i.scopeName=r.scopeName,i}function ap(e){const r=g3(e),i=Y.forwardRef((c,d)=>{const{children:g,...m}=c,l=Y.Children.toArray(g),E=l.find(y3);if(E){const P=E.props.children,R=l.map(N=>N===E?Y.Children.count(P)>1?Y.Children.only(null):Y.isValidElement(P)?P.props.children:null:N);return ye.jsx(r,{...m,ref:d,children:Y.isValidElement(P)?Y.cloneElement(P,void 0,R):null})}return ye.jsx(r,{...m,ref:d,children:g})});return i.displayName=`${e}.Slot`,i}var m3=ap("Slot");function g3(e){const r=Y.forwardRef((i,c)=>{const{children:d,...g}=i;if(Y.isValidElement(d)){const m=x3(d),l=v3(g,d.props);return d.type!==Y.Fragment&&(l.ref=c?cM(c,m):m),Y.cloneElement(d,l)}return Y.Children.count(d)>1?Y.Children.only(null):null});return r.displayName=`${e}.SlotClone`,r}var uM=Symbol("radix.slottable");function _3(e){const r=({children:i})=>ye.jsx(ye.Fragment,{children:i});return r.displayName=`${e}.Slottable`,r.__radixId=uM,r}function y3(e){return Y.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===uM}function v3(e,r){const i={...r};for(const c in r){const d=e[c],g=r[c];/^on[A-Z]/.test(c)?d&&g?i[c]=(...l)=>{const E=g(...l);return d(...l),E}:d&&(i[c]=d):c==="style"?i[c]={...d,...g}:c==="className"&&(i[c]=[d,g].filter(Boolean).join(" "))}return{...e,...i}}function x3(e){var c,d;let r=(c=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:c.get,i=r&&"isReactWarning"in r&&r.isReactWarning;return i?e.ref:(r=(d=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:d.get,i=r&&"isReactWarning"in r&&r.isReactWarning,i?e.props.ref:e.props.ref||e.ref)}function hM(e){const r=e+"CollectionProvider",[i,c]=Ip(r),[d,g]=i(r,{collectionRef:{current:null},itemMap:new Map}),m=Z=>{const{scope:ee,children:H}=Z,U=ft.useRef(null),W=ft.useRef(new Map).current;return ye.jsx(d,{scope:ee,itemMap:W,collectionRef:U,children:H})};m.displayName=r;const l=e+"CollectionSlot",E=ap(l),P=ft.forwardRef((Z,ee)=>{const{scope:H,children:U}=Z,W=g(l,H),re=on(ee,W.collectionRef);return ye.jsx(E,{ref:re,children:U})});P.displayName=l;const R=e+"CollectionItemSlot",N="data-radix-collection-item",F=ap(R),A=ft.forwardRef((Z,ee)=>{const{scope:H,children:U,...W}=Z,re=ft.useRef(null),ge=on(ee,re),Te=g(R,H);return ft.useEffect(()=>(Te.itemMap.set(re,{ref:re,...W}),()=>void Te.itemMap.delete(re))),ye.jsx(F,{[N]:"",ref:ge,children:U})});A.displayName=R;function X(Z){const ee=g(e+"CollectionConsumer",Z);return ft.useCallback(()=>{const U=ee.collectionRef.current;if(!U)return[];const W=Array.from(U.querySelectorAll(`[${N}]`));return Array.from(ee.itemMap.values()).sort((Te,xe)=>W.indexOf(Te.ref.current)-W.indexOf(xe.ref.current))},[ee.collectionRef,ee.itemMap])}return[{Provider:m,Slot:P,ItemSlot:A},X,c]}var b3=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],wr=b3.reduce((e,r)=>{const i=ap(`Primitive.${r}`),c=Y.forwardRef((d,g)=>{const{asChild:m,...l}=d,E=m?i:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),ye.jsx(E,{...l,ref:g})});return c.displayName=`Primitive.${r}`,{...e,[r]:c}},{});function dM(e,r){e&&Kc.flushSync(()=>e.dispatchEvent(r))}function qo(e){const r=Y.useRef(e);return Y.useEffect(()=>{r.current=e}),Y.useMemo(()=>(...i)=>{var c;return(c=r.current)==null?void 0:c.call(r,...i)},[])}function w3(e,r=globalThis==null?void 0:globalThis.document){const i=qo(e);Y.useEffect(()=>{const c=d=>{d.key==="Escape"&&i(d)};return r.addEventListener("keydown",c,{capture:!0}),()=>r.removeEventListener("keydown",c,{capture:!0})},[i,r])}var S3="DismissableLayer",Ox="dismissableLayer.update",T3="dismissableLayer.pointerDownOutside",C3="dismissableLayer.focusOutside",ZS,fM=Y.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),ry=Y.forwardRef((e,r)=>{const{disableOutsidePointerEvents:i=!1,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:g,onInteractOutside:m,onDismiss:l,...E}=e,P=Y.useContext(fM),[R,N]=Y.useState(null),F=(R==null?void 0:R.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,A]=Y.useState({}),X=on(r,xe=>N(xe)),Z=Array.from(P.layers),[ee]=[...P.layersWithOutsidePointerEventsDisabled].slice(-1),H=Z.indexOf(ee),U=R?Z.indexOf(R):-1,W=P.layersWithOutsidePointerEventsDisabled.size>0,re=U>=H,ge=E3(xe=>{const ze=xe.target,Ne=[...P.branches].some(Ie=>Ie.contains(ze));!re||Ne||(d==null||d(xe),m==null||m(xe),xe.defaultPrevented||l==null||l())},F),Te=M3(xe=>{const ze=xe.target;[...P.branches].some(Ie=>Ie.contains(ze))||(g==null||g(xe),m==null||m(xe),xe.defaultPrevented||l==null||l())},F);return w3(xe=>{U===P.layers.size-1&&(c==null||c(xe),!xe.defaultPrevented&&l&&(xe.preventDefault(),l()))},F),Y.useEffect(()=>{if(R)return i&&(P.layersWithOutsidePointerEventsDisabled.size===0&&(ZS=F.body.style.pointerEvents,F.body.style.pointerEvents="none"),P.layersWithOutsidePointerEventsDisabled.add(R)),P.layers.add(R),GS(),()=>{i&&P.layersWithOutsidePointerEventsDisabled.size===1&&(F.body.style.pointerEvents=ZS)}},[R,F,i,P]),Y.useEffect(()=>()=>{R&&(P.layers.delete(R),P.layersWithOutsidePointerEventsDisabled.delete(R),GS())},[R,P]),Y.useEffect(()=>{const xe=()=>A({});return document.addEventListener(Ox,xe),()=>document.removeEventListener(Ox,xe)},[]),ye.jsx(wr.div,{...E,ref:X,style:{pointerEvents:W?re?"auto":"none":void 0,...e.style},onFocusCapture:ar(e.onFocusCapture,Te.onFocusCapture),onBlurCapture:ar(e.onBlurCapture,Te.onBlurCapture),onPointerDownCapture:ar(e.onPointerDownCapture,ge.onPointerDownCapture)})});ry.displayName=S3;var P3="DismissableLayerBranch",pM=Y.forwardRef((e,r)=>{const i=Y.useContext(fM),c=Y.useRef(null),d=on(r,c);return Y.useEffect(()=>{const g=c.current;if(g)return i.branches.add(g),()=>{i.branches.delete(g)}},[i.branches]),ye.jsx(wr.div,{...e,ref:d})});pM.displayName=P3;function E3(e,r=globalThis==null?void 0:globalThis.document){const i=qo(e),c=Y.useRef(!1),d=Y.useRef(()=>{});return Y.useEffect(()=>{const g=l=>{if(l.target&&!c.current){let E=function(){mM(T3,i,P,{discrete:!0})};const P={originalEvent:l};l.pointerType==="touch"?(r.removeEventListener("click",d.current),d.current=E,r.addEventListener("click",d.current,{once:!0})):E()}else r.removeEventListener("click",d.current);c.current=!1},m=window.setTimeout(()=>{r.addEventListener("pointerdown",g)},0);return()=>{window.clearTimeout(m),r.removeEventListener("pointerdown",g),r.removeEventListener("click",d.current)}},[r,i]),{onPointerDownCapture:()=>c.current=!0}}function M3(e,r=globalThis==null?void 0:globalThis.document){const i=qo(e),c=Y.useRef(!1);return Y.useEffect(()=>{const d=g=>{g.target&&!c.current&&mM(C3,i,{originalEvent:g},{discrete:!1})};return r.addEventListener("focusin",d),()=>r.removeEventListener("focusin",d)},[r,i]),{onFocusCapture:()=>c.current=!0,onBlurCapture:()=>c.current=!1}}function GS(){const e=new CustomEvent(Ox);document.dispatchEvent(e)}function mM(e,r,i,{discrete:c}){const d=i.originalEvent.target,g=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:i});r&&d.addEventListener(e,r,{once:!0}),c?dM(d,g):d.dispatchEvent(g)}var k3=ry,I3=pM,Kn=globalThis!=null&&globalThis.document?Y.useLayoutEffect:()=>{},A3="Portal",pw=Y.forwardRef((e,r)=>{var l;const{container:i,...c}=e,[d,g]=Y.useState(!1);Kn(()=>g(!0),[]);const m=i||d&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return m?aM.createPortal(ye.jsx(wr.div,{...c,ref:r}),m):null});pw.displayName=A3;function z3(e,r){return Y.useReducer((i,c)=>r[i][c]??i,e)}var mw=e=>{const{present:r,children:i}=e,c=R3(r),d=typeof i=="function"?i({present:c.isPresent}):Y.Children.only(i),g=on(c.ref,D3(d));return typeof i=="function"||c.isPresent?Y.cloneElement(d,{ref:g}):null};mw.displayName="Presence";function R3(e){const[r,i]=Y.useState(),c=Y.useRef(null),d=Y.useRef(e),g=Y.useRef("none"),m=e?"mounted":"unmounted",[l,E]=z3(m,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return Y.useEffect(()=>{const P=pg(c.current);g.current=l==="mounted"?P:"none"},[l]),Kn(()=>{const P=c.current,R=d.current;if(R!==e){const F=g.current,A=pg(P);e?E("MOUNT"):A==="none"||(P==null?void 0:P.display)==="none"?E("UNMOUNT"):E(R&&F!==A?"ANIMATION_OUT":"UNMOUNT"),d.current=e}},[e,E]),Kn(()=>{if(r){let P;const R=r.ownerDocument.defaultView??window,N=A=>{const Z=pg(c.current).includes(A.animationName);if(A.target===r&&Z&&(E("ANIMATION_END"),!d.current)){const ee=r.style.animationFillMode;r.style.animationFillMode="forwards",P=R.setTimeout(()=>{r.style.animationFillMode==="forwards"&&(r.style.animationFillMode=ee)})}},F=A=>{A.target===r&&(g.current=pg(c.current))};return r.addEventListener("animationstart",F),r.addEventListener("animationcancel",N),r.addEventListener("animationend",N),()=>{R.clearTimeout(P),r.removeEventListener("animationstart",F),r.removeEventListener("animationcancel",N),r.removeEventListener("animationend",N)}}else E("ANIMATION_END")},[r,E]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:Y.useCallback(P=>{c.current=P?getComputedStyle(P):null,i(P)},[])}}function pg(e){return(e==null?void 0:e.animationName)||"none"}function D3(e){var c,d;let r=(c=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:c.get,i=r&&"isReactWarning"in r&&r.isReactWarning;return i?e.ref:(r=(d=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:d.get,i=r&&"isReactWarning"in r&&r.isReactWarning,i?e.props.ref:e.props.ref||e.ref)}var L3=Sb[" useInsertionEffect ".trim().toString()]||Kn;function Fx({prop:e,defaultProp:r,onChange:i=()=>{},caller:c}){const[d,g,m]=O3({defaultProp:r,onChange:i}),l=e!==void 0,E=l?e:d;{const R=Y.useRef(e!==void 0);Y.useEffect(()=>{const N=R.current;N!==l&&console.warn(`${c} is changing from ${N?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),R.current=l},[l,c])}const P=Y.useCallback(R=>{var N;if(l){const F=F3(R)?R(e):R;F!==e&&((N=m.current)==null||N.call(m,F))}else g(R)},[l,e,g,m]);return[E,P]}function O3({defaultProp:e,onChange:r}){const[i,c]=Y.useState(e),d=Y.useRef(i),g=Y.useRef(r);return L3(()=>{g.current=r},[r]),Y.useEffect(()=>{var m;d.current!==i&&((m=g.current)==null||m.call(g,i),d.current=i)},[i,d]),[i,c,g]}function F3(e){return typeof e=="function"}var gM=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),N3="VisuallyHidden",ny=Y.forwardRef((e,r)=>ye.jsx(wr.span,{...e,ref:r,style:{...gM,...e.style}}));ny.displayName=N3;var B3=ny,gw="ToastProvider",[_w,j3,$3]=hM("Toast"),[_M,pU]=Ip("Toast",[$3]),[U3,iy]=_M(gw),yM=e=>{const{__scopeToast:r,label:i="Notification",duration:c=5e3,swipeDirection:d="right",swipeThreshold:g=50,children:m}=e,[l,E]=Y.useState(null),[P,R]=Y.useState(0),N=Y.useRef(!1),F=Y.useRef(!1);return i.trim()||console.error(`Invalid prop \`label\` supplied to \`${gw}\`. Expected non-empty \`string\`.`),ye.jsx(_w.Provider,{scope:r,children:ye.jsx(U3,{scope:r,label:i,duration:c,swipeDirection:d,swipeThreshold:g,toastCount:P,viewport:l,onViewportChange:E,onToastAdd:Y.useCallback(()=>R(A=>A+1),[]),onToastRemove:Y.useCallback(()=>R(A=>A-1),[]),isFocusedToastEscapeKeyDownRef:N,isClosePausedRef:F,children:m})})};yM.displayName=gw;var vM="ToastViewport",V3=["F8"],Nx="toast.viewportPause",Bx="toast.viewportResume",xM=Y.forwardRef((e,r)=>{const{__scopeToast:i,hotkey:c=V3,label:d="Notifications ({hotkey})",...g}=e,m=iy(vM,i),l=j3(i),E=Y.useRef(null),P=Y.useRef(null),R=Y.useRef(null),N=Y.useRef(null),F=on(r,N,m.onViewportChange),A=c.join("+").replace(/Key/g,"").replace(/Digit/g,""),X=m.toastCount>0;Y.useEffect(()=>{const ee=H=>{var W;c.length!==0&&c.every(re=>H[re]||H.code===re)&&((W=N.current)==null||W.focus())};return document.addEventListener("keydown",ee),()=>document.removeEventListener("keydown",ee)},[c]),Y.useEffect(()=>{const ee=E.current,H=N.current;if(X&&ee&&H){const U=()=>{if(!m.isClosePausedRef.current){const Te=new CustomEvent(Nx);H.dispatchEvent(Te),m.isClosePausedRef.current=!0}},W=()=>{if(m.isClosePausedRef.current){const Te=new CustomEvent(Bx);H.dispatchEvent(Te),m.isClosePausedRef.current=!1}},re=Te=>{!ee.contains(Te.relatedTarget)&&W()},ge=()=>{ee.contains(document.activeElement)||W()};return ee.addEventListener("focusin",U),ee.addEventListener("focusout",re),ee.addEventListener("pointermove",U),ee.addEventListener("pointerleave",ge),window.addEventListener("blur",U),window.addEventListener("focus",W),()=>{ee.removeEventListener("focusin",U),ee.removeEventListener("focusout",re),ee.removeEventListener("pointermove",U),ee.removeEventListener("pointerleave",ge),window.removeEventListener("blur",U),window.removeEventListener("focus",W)}}},[X,m.isClosePausedRef]);const Z=Y.useCallback(({tabbingDirection:ee})=>{const U=l().map(W=>{const re=W.ref.current,ge=[re,...r5(re)];return ee==="forwards"?ge:ge.reverse()});return(ee==="forwards"?U.reverse():U).flat()},[l]);return Y.useEffect(()=>{const ee=N.current;if(ee){const H=U=>{var ge,Te,xe;const W=U.altKey||U.ctrlKey||U.metaKey;if(U.key==="Tab"&&!W){const ze=document.activeElement,Ne=U.shiftKey;if(U.target===ee&&Ne){(ge=P.current)==null||ge.focus();return}const et=Z({tabbingDirection:Ne?"backwards":"forwards"}),ot=et.findIndex(qe=>qe===ze);m0(et.slice(ot+1))?U.preventDefault():Ne?(Te=P.current)==null||Te.focus():(xe=R.current)==null||xe.focus()}};return ee.addEventListener("keydown",H),()=>ee.removeEventListener("keydown",H)}},[l,Z]),ye.jsxs(I3,{ref:E,role:"region","aria-label":d.replace("{hotkey}",A),tabIndex:-1,style:{pointerEvents:X?void 0:"none"},children:[X&&ye.jsx(jx,{ref:P,onFocusFromOutsideViewport:()=>{const ee=Z({tabbingDirection:"forwards"});m0(ee)}}),ye.jsx(_w.Slot,{scope:i,children:ye.jsx(wr.ol,{tabIndex:-1,...g,ref:F})}),X&&ye.jsx(jx,{ref:R,onFocusFromOutsideViewport:()=>{const ee=Z({tabbingDirection:"backwards"});m0(ee)}})]})});xM.displayName=vM;var bM="ToastFocusProxy",jx=Y.forwardRef((e,r)=>{const{__scopeToast:i,onFocusFromOutsideViewport:c,...d}=e,g=iy(bM,i);return ye.jsx(ny,{"aria-hidden":!0,tabIndex:0,...d,ref:r,style:{position:"fixed"},onFocus:m=>{var P;const l=m.relatedTarget;!((P=g.viewport)!=null&&P.contains(l))&&c()}})});jx.displayName=bM;var Ap="Toast",Z3="toast.swipeStart",G3="toast.swipeMove",H3="toast.swipeCancel",W3="toast.swipeEnd",wM=Y.forwardRef((e,r)=>{const{forceMount:i,open:c,defaultOpen:d,onOpenChange:g,...m}=e,[l,E]=Fx({prop:c,defaultProp:d??!0,onChange:g,caller:Ap});return ye.jsx(mw,{present:i||l,children:ye.jsx(K3,{open:l,...m,ref:r,onClose:()=>E(!1),onPause:qo(e.onPause),onResume:qo(e.onResume),onSwipeStart:ar(e.onSwipeStart,P=>{P.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:ar(e.onSwipeMove,P=>{const{x:R,y:N}=P.detail.delta;P.currentTarget.setAttribute("data-swipe","move"),P.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${R}px`),P.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${N}px`)}),onSwipeCancel:ar(e.onSwipeCancel,P=>{P.currentTarget.setAttribute("data-swipe","cancel"),P.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),P.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),P.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),P.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:ar(e.onSwipeEnd,P=>{const{x:R,y:N}=P.detail.delta;P.currentTarget.setAttribute("data-swipe","end"),P.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),P.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),P.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${R}px`),P.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${N}px`),E(!1)})})})});wM.displayName=Ap;var[q3,X3]=_M(Ap,{onClose(){}}),K3=Y.forwardRef((e,r)=>{const{__scopeToast:i,type:c="foreground",duration:d,open:g,onClose:m,onEscapeKeyDown:l,onPause:E,onResume:P,onSwipeStart:R,onSwipeMove:N,onSwipeCancel:F,onSwipeEnd:A,...X}=e,Z=iy(Ap,i),[ee,H]=Y.useState(null),U=on(r,qe=>H(qe)),W=Y.useRef(null),re=Y.useRef(null),ge=d||Z.duration,Te=Y.useRef(0),xe=Y.useRef(ge),ze=Y.useRef(0),{onToastAdd:Ne,onToastRemove:Ie}=Z,$e=qo(()=>{var ht;(ee==null?void 0:ee.contains(document.activeElement))&&((ht=Z.viewport)==null||ht.focus()),m()}),et=Y.useCallback(qe=>{!qe||qe===1/0||(window.clearTimeout(ze.current),Te.current=new Date().getTime(),ze.current=window.setTimeout($e,qe))},[$e]);Y.useEffect(()=>{const qe=Z.viewport;if(qe){const ht=()=>{et(xe.current),P==null||P()},dt=()=>{const wt=new Date().getTime()-Te.current;xe.current=xe.current-wt,window.clearTimeout(ze.current),E==null||E()};return qe.addEventListener(Nx,dt),qe.addEventListener(Bx,ht),()=>{qe.removeEventListener(Nx,dt),qe.removeEventListener(Bx,ht)}}},[Z.viewport,ge,E,P,et]),Y.useEffect(()=>{g&&!Z.isClosePausedRef.current&&et(ge)},[g,ge,Z.isClosePausedRef,et]),Y.useEffect(()=>(Ne(),()=>Ie()),[Ne,Ie]);const ot=Y.useMemo(()=>ee?kM(ee):null,[ee]);return Z.viewport?ye.jsxs(ye.Fragment,{children:[ot&&ye.jsx(Y3,{__scopeToast:i,role:"status","aria-live":c==="foreground"?"assertive":"polite","aria-atomic":!0,children:ot}),ye.jsx(q3,{scope:i,onClose:$e,children:Kc.createPortal(ye.jsx(_w.ItemSlot,{scope:i,children:ye.jsx(k3,{asChild:!0,onEscapeKeyDown:ar(l,()=>{Z.isFocusedToastEscapeKeyDownRef.current||$e(),Z.isFocusedToastEscapeKeyDownRef.current=!1}),children:ye.jsx(wr.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":g?"open":"closed","data-swipe-direction":Z.swipeDirection,...X,ref:U,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:ar(e.onKeyDown,qe=>{qe.key==="Escape"&&(l==null||l(qe.nativeEvent),qe.nativeEvent.defaultPrevented||(Z.isFocusedToastEscapeKeyDownRef.current=!0,$e()))}),onPointerDown:ar(e.onPointerDown,qe=>{qe.button===0&&(W.current={x:qe.clientX,y:qe.clientY})}),onPointerMove:ar(e.onPointerMove,qe=>{if(!W.current)return;const ht=qe.clientX-W.current.x,dt=qe.clientY-W.current.y,wt=!!re.current,Ze=["left","right"].includes(Z.swipeDirection),He=["left","up"].includes(Z.swipeDirection)?Math.min:Math.max,pt=Ze?He(0,ht):0,Ct=Ze?0:He(0,dt),ut=qe.pointerType==="touch"?10:2,At={x:pt,y:Ct},kt={originalEvent:qe,delta:At};wt?(re.current=At,mg(G3,N,kt,{discrete:!1})):HS(At,Z.swipeDirection,ut)?(re.current=At,mg(Z3,R,kt,{discrete:!1}),qe.target.setPointerCapture(qe.pointerId)):(Math.abs(ht)>ut||Math.abs(dt)>ut)&&(W.current=null)}),onPointerUp:ar(e.onPointerUp,qe=>{const ht=re.current,dt=qe.target;if(dt.hasPointerCapture(qe.pointerId)&&dt.releasePointerCapture(qe.pointerId),re.current=null,W.current=null,ht){const wt=qe.currentTarget,Ze={originalEvent:qe,delta:ht};HS(ht,Z.swipeDirection,Z.swipeThreshold)?mg(W3,A,Ze,{discrete:!0}):mg(H3,F,Ze,{discrete:!0}),wt.addEventListener("click",He=>He.preventDefault(),{once:!0})}})})})}),Z.viewport)})]}):null}),Y3=e=>{const{__scopeToast:r,children:i,...c}=e,d=iy(Ap,r),[g,m]=Y.useState(!1),[l,E]=Y.useState(!1);return e5(()=>m(!0)),Y.useEffect(()=>{const P=window.setTimeout(()=>E(!0),1e3);return()=>window.clearTimeout(P)},[]),l?null:ye.jsx(pw,{asChild:!0,children:ye.jsx(ny,{...c,children:g&&ye.jsxs(ye.Fragment,{children:[d.label," ",i]})})})},Q3="ToastTitle",SM=Y.forwardRef((e,r)=>{const{__scopeToast:i,...c}=e;return ye.jsx(wr.div,{...c,ref:r})});SM.displayName=Q3;var J3="ToastDescription",TM=Y.forwardRef((e,r)=>{const{__scopeToast:i,...c}=e;return ye.jsx(wr.div,{...c,ref:r})});TM.displayName=J3;var CM="ToastAction",PM=Y.forwardRef((e,r)=>{const{altText:i,...c}=e;return i.trim()?ye.jsx(MM,{altText:i,asChild:!0,children:ye.jsx(yw,{...c,ref:r})}):(console.error(`Invalid prop \`altText\` supplied to \`${CM}\`. Expected non-empty \`string\`.`),null)});PM.displayName=CM;var EM="ToastClose",yw=Y.forwardRef((e,r)=>{const{__scopeToast:i,...c}=e,d=X3(EM,i);return ye.jsx(MM,{asChild:!0,children:ye.jsx(wr.button,{type:"button",...c,ref:r,onClick:ar(e.onClick,d.onClose)})})});yw.displayName=EM;var MM=Y.forwardRef((e,r)=>{const{__scopeToast:i,altText:c,...d}=e;return ye.jsx(wr.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":c||void 0,...d,ref:r})});function kM(e){const r=[];return Array.from(e.childNodes).forEach(c=>{if(c.nodeType===c.TEXT_NODE&&c.textContent&&r.push(c.textContent),t5(c)){const d=c.ariaHidden||c.hidden||c.style.display==="none",g=c.dataset.radixToastAnnounceExclude==="";if(!d)if(g){const m=c.dataset.radixToastAnnounceAlt;m&&r.push(m)}else r.push(...kM(c))}}),r}function mg(e,r,i,{discrete:c}){const d=i.originalEvent.currentTarget,g=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:i});r&&d.addEventListener(e,r,{once:!0}),c?dM(d,g):d.dispatchEvent(g)}var HS=(e,r,i=0)=>{const c=Math.abs(e.x),d=Math.abs(e.y),g=c>d;return r==="left"||r==="right"?g&&c>i:!g&&d>i};function e5(e=()=>{}){const r=qo(e);Kn(()=>{let i=0,c=0;return i=window.requestAnimationFrame(()=>c=window.requestAnimationFrame(r)),()=>{window.cancelAnimationFrame(i),window.cancelAnimationFrame(c)}},[r])}function t5(e){return e.nodeType===e.ELEMENT_NODE}function r5(e){const r=[],i=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:c=>{const d=c.tagName==="INPUT"&&c.type==="hidden";return c.disabled||c.hidden||d?NodeFilter.FILTER_SKIP:c.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;i.nextNode();)r.push(i.currentNode);return r}function m0(e){const r=document.activeElement;return e.some(i=>i===r?!0:(i.focus(),document.activeElement!==r))}var n5=yM,IM=xM,AM=wM,zM=SM,RM=TM,DM=PM,LM=yw;function OM(e){var r,i,c="";if(typeof e=="string"||typeof e=="number")c+=e;else if(typeof e=="object")if(Array.isArray(e)){var d=e.length;for(r=0;r<d;r++)e[r]&&(i=OM(e[r]))&&(c&&(c+=" "),c+=i)}else for(i in e)e[i]&&(c&&(c+=" "),c+=i);return c}function FM(){for(var e,r,i=0,c="",d=arguments.length;i<d;i++)(e=arguments[i])&&(r=OM(e))&&(c&&(c+=" "),c+=r);return c}const WS=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,qS=FM,NM=(e,r)=>i=>{var c;if((r==null?void 0:r.variants)==null)return qS(e,i==null?void 0:i.class,i==null?void 0:i.className);const{variants:d,defaultVariants:g}=r,m=Object.keys(d).map(P=>{const R=i==null?void 0:i[P],N=g==null?void 0:g[P];if(R===null)return null;const F=WS(R)||WS(N);return d[P][F]}),l=i&&Object.entries(i).reduce((P,R)=>{let[N,F]=R;return F===void 0||(P[N]=F),P},{}),E=r==null||(c=r.compoundVariants)===null||c===void 0?void 0:c.reduce((P,R)=>{let{class:N,className:F,...A}=R;return Object.entries(A).every(X=>{let[Z,ee]=X;return Array.isArray(ee)?ee.includes({...g,...l}[Z]):{...g,...l}[Z]===ee})?[...P,N,F]:P},[]);return qS(e,m,E,i==null?void 0:i.class,i==null?void 0:i.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i5=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),BM=(...e)=>e.filter((r,i,c)=>!!r&&r.trim()!==""&&c.indexOf(r)===i).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var o5={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s5=Y.forwardRef(({color:e="currentColor",size:r=24,strokeWidth:i=2,absoluteStrokeWidth:c,className:d="",children:g,iconNode:m,...l},E)=>Y.createElement("svg",{ref:E,...o5,width:r,height:r,stroke:e,strokeWidth:c?Number(i)*24/Number(r):i,className:BM("lucide",d),...l},[...m.map(([P,R])=>Y.createElement(P,R)),...Array.isArray(g)?g:[g]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pl=(e,r)=>{const i=Y.forwardRef(({className:c,...d},g)=>Y.createElement(s5,{ref:g,iconNode:r,className:BM(`lucide-${i5(e)}`,c),...d}));return i.displayName=`${e}`,i};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a5=Pl("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l5=Pl("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jM=Pl("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c5=Pl("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u5=Pl("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h5=Pl("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d5=Pl("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f5=Pl("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),vw="-",p5=e=>{const r=g5(e),{conflictingClassGroups:i,conflictingClassGroupModifiers:c}=e;return{getClassGroupId:m=>{const l=m.split(vw);return l[0]===""&&l.length!==1&&l.shift(),$M(l,r)||m5(m)},getConflictingClassGroupIds:(m,l)=>{const E=i[m]||[];return l&&c[m]?[...E,...c[m]]:E}}},$M=(e,r)=>{var m;if(e.length===0)return r.classGroupId;const i=e[0],c=r.nextPart.get(i),d=c?$M(e.slice(1),c):void 0;if(d)return d;if(r.validators.length===0)return;const g=e.join(vw);return(m=r.validators.find(({validator:l})=>l(g)))==null?void 0:m.classGroupId},XS=/^\[(.+)\]$/,m5=e=>{if(XS.test(e)){const r=XS.exec(e)[1],i=r==null?void 0:r.substring(0,r.indexOf(":"));if(i)return"arbitrary.."+i}},g5=e=>{const{theme:r,prefix:i}=e,c={nextPart:new Map,validators:[]};return y5(Object.entries(e.classGroups),i).forEach(([g,m])=>{$x(m,c,g,r)}),c},$x=(e,r,i,c)=>{e.forEach(d=>{if(typeof d=="string"){const g=d===""?r:KS(r,d);g.classGroupId=i;return}if(typeof d=="function"){if(_5(d)){$x(d(c),r,i,c);return}r.validators.push({validator:d,classGroupId:i});return}Object.entries(d).forEach(([g,m])=>{$x(m,KS(r,g),i,c)})})},KS=(e,r)=>{let i=e;return r.split(vw).forEach(c=>{i.nextPart.has(c)||i.nextPart.set(c,{nextPart:new Map,validators:[]}),i=i.nextPart.get(c)}),i},_5=e=>e.isThemeGetter,y5=(e,r)=>r?e.map(([i,c])=>{const d=c.map(g=>typeof g=="string"?r+g:typeof g=="object"?Object.fromEntries(Object.entries(g).map(([m,l])=>[r+m,l])):g);return[i,d]}):e,v5=e=>{if(e<1)return{get:()=>{},set:()=>{}};let r=0,i=new Map,c=new Map;const d=(g,m)=>{i.set(g,m),r++,r>e&&(r=0,c=i,i=new Map)};return{get(g){let m=i.get(g);if(m!==void 0)return m;if((m=c.get(g))!==void 0)return d(g,m),m},set(g,m){i.has(g)?i.set(g,m):d(g,m)}}},UM="!",x5=e=>{const{separator:r,experimentalParseClassName:i}=e,c=r.length===1,d=r[0],g=r.length,m=l=>{const E=[];let P=0,R=0,N;for(let ee=0;ee<l.length;ee++){let H=l[ee];if(P===0){if(H===d&&(c||l.slice(ee,ee+g)===r)){E.push(l.slice(R,ee)),R=ee+g;continue}if(H==="/"){N=ee;continue}}H==="["?P++:H==="]"&&P--}const F=E.length===0?l:l.substring(R),A=F.startsWith(UM),X=A?F.substring(1):F,Z=N&&N>R?N-R:void 0;return{modifiers:E,hasImportantModifier:A,baseClassName:X,maybePostfixModifierPosition:Z}};return i?l=>i({className:l,parseClassName:m}):m},b5=e=>{if(e.length<=1)return e;const r=[];let i=[];return e.forEach(c=>{c[0]==="["?(r.push(...i.sort(),c),i=[]):i.push(c)}),r.push(...i.sort()),r},w5=e=>({cache:v5(e.cacheSize),parseClassName:x5(e),...p5(e)}),S5=/\s+/,T5=(e,r)=>{const{parseClassName:i,getClassGroupId:c,getConflictingClassGroupIds:d}=r,g=[],m=e.trim().split(S5);let l="";for(let E=m.length-1;E>=0;E-=1){const P=m[E],{modifiers:R,hasImportantModifier:N,baseClassName:F,maybePostfixModifierPosition:A}=i(P);let X=!!A,Z=c(X?F.substring(0,A):F);if(!Z){if(!X){l=P+(l.length>0?" "+l:l);continue}if(Z=c(F),!Z){l=P+(l.length>0?" "+l:l);continue}X=!1}const ee=b5(R).join(":"),H=N?ee+UM:ee,U=H+Z;if(g.includes(U))continue;g.push(U);const W=d(Z,X);for(let re=0;re<W.length;++re){const ge=W[re];g.push(H+ge)}l=P+(l.length>0?" "+l:l)}return l};function C5(){let e=0,r,i,c="";for(;e<arguments.length;)(r=arguments[e++])&&(i=VM(r))&&(c&&(c+=" "),c+=i);return c}const VM=e=>{if(typeof e=="string")return e;let r,i="";for(let c=0;c<e.length;c++)e[c]&&(r=VM(e[c]))&&(i&&(i+=" "),i+=r);return i};function P5(e,...r){let i,c,d,g=m;function m(E){const P=r.reduce((R,N)=>N(R),e());return i=w5(P),c=i.cache.get,d=i.cache.set,g=l,l(E)}function l(E){const P=c(E);if(P)return P;const R=T5(E,i);return d(E,R),R}return function(){return g(C5.apply(null,arguments))}}const Fr=e=>{const r=i=>i[e]||[];return r.isThemeGetter=!0,r},ZM=/^\[(?:([a-z-]+):)?(.+)\]$/i,E5=/^\d+\/\d+$/,M5=new Set(["px","full","screen"]),k5=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,I5=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,A5=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,z5=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,R5=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ws=e=>vh(e)||M5.has(e)||E5.test(e),Za=e=>qh(e,"length",$5),vh=e=>!!e&&!Number.isNaN(Number(e)),g0=e=>qh(e,"number",vh),bf=e=>!!e&&Number.isInteger(Number(e)),D5=e=>e.endsWith("%")&&vh(e.slice(0,-1)),Yt=e=>ZM.test(e),Ga=e=>k5.test(e),L5=new Set(["length","size","percentage"]),O5=e=>qh(e,L5,GM),F5=e=>qh(e,"position",GM),N5=new Set(["image","url"]),B5=e=>qh(e,N5,V5),j5=e=>qh(e,"",U5),wf=()=>!0,qh=(e,r,i)=>{const c=ZM.exec(e);return c?c[1]?typeof r=="string"?c[1]===r:r.has(c[1]):i(c[2]):!1},$5=e=>I5.test(e)&&!A5.test(e),GM=()=>!1,U5=e=>z5.test(e),V5=e=>R5.test(e),Z5=()=>{const e=Fr("colors"),r=Fr("spacing"),i=Fr("blur"),c=Fr("brightness"),d=Fr("borderColor"),g=Fr("borderRadius"),m=Fr("borderSpacing"),l=Fr("borderWidth"),E=Fr("contrast"),P=Fr("grayscale"),R=Fr("hueRotate"),N=Fr("invert"),F=Fr("gap"),A=Fr("gradientColorStops"),X=Fr("gradientColorStopPositions"),Z=Fr("inset"),ee=Fr("margin"),H=Fr("opacity"),U=Fr("padding"),W=Fr("saturate"),re=Fr("scale"),ge=Fr("sepia"),Te=Fr("skew"),xe=Fr("space"),ze=Fr("translate"),Ne=()=>["auto","contain","none"],Ie=()=>["auto","hidden","clip","visible","scroll"],$e=()=>["auto",Yt,r],et=()=>[Yt,r],ot=()=>["",Ws,Za],qe=()=>["auto",vh,Yt],ht=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],dt=()=>["solid","dashed","dotted","double","none"],wt=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Ze=()=>["start","end","center","between","around","evenly","stretch"],He=()=>["","0",Yt],pt=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Ct=()=>[vh,Yt];return{cacheSize:500,separator:":",theme:{colors:[wf],spacing:[Ws,Za],blur:["none","",Ga,Yt],brightness:Ct(),borderColor:[e],borderRadius:["none","","full",Ga,Yt],borderSpacing:et(),borderWidth:ot(),contrast:Ct(),grayscale:He(),hueRotate:Ct(),invert:He(),gap:et(),gradientColorStops:[e],gradientColorStopPositions:[D5,Za],inset:$e(),margin:$e(),opacity:Ct(),padding:et(),saturate:Ct(),scale:Ct(),sepia:He(),skew:Ct(),space:et(),translate:et()},classGroups:{aspect:[{aspect:["auto","square","video",Yt]}],container:["container"],columns:[{columns:[Ga]}],"break-after":[{"break-after":pt()}],"break-before":[{"break-before":pt()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ht(),Yt]}],overflow:[{overflow:Ie()}],"overflow-x":[{"overflow-x":Ie()}],"overflow-y":[{"overflow-y":Ie()}],overscroll:[{overscroll:Ne()}],"overscroll-x":[{"overscroll-x":Ne()}],"overscroll-y":[{"overscroll-y":Ne()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[Z]}],"inset-x":[{"inset-x":[Z]}],"inset-y":[{"inset-y":[Z]}],start:[{start:[Z]}],end:[{end:[Z]}],top:[{top:[Z]}],right:[{right:[Z]}],bottom:[{bottom:[Z]}],left:[{left:[Z]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",bf,Yt]}],basis:[{basis:$e()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Yt]}],grow:[{grow:He()}],shrink:[{shrink:He()}],order:[{order:["first","last","none",bf,Yt]}],"grid-cols":[{"grid-cols":[wf]}],"col-start-end":[{col:["auto",{span:["full",bf,Yt]},Yt]}],"col-start":[{"col-start":qe()}],"col-end":[{"col-end":qe()}],"grid-rows":[{"grid-rows":[wf]}],"row-start-end":[{row:["auto",{span:[bf,Yt]},Yt]}],"row-start":[{"row-start":qe()}],"row-end":[{"row-end":qe()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Yt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Yt]}],gap:[{gap:[F]}],"gap-x":[{"gap-x":[F]}],"gap-y":[{"gap-y":[F]}],"justify-content":[{justify:["normal",...Ze()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...Ze(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...Ze(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[U]}],px:[{px:[U]}],py:[{py:[U]}],ps:[{ps:[U]}],pe:[{pe:[U]}],pt:[{pt:[U]}],pr:[{pr:[U]}],pb:[{pb:[U]}],pl:[{pl:[U]}],m:[{m:[ee]}],mx:[{mx:[ee]}],my:[{my:[ee]}],ms:[{ms:[ee]}],me:[{me:[ee]}],mt:[{mt:[ee]}],mr:[{mr:[ee]}],mb:[{mb:[ee]}],ml:[{ml:[ee]}],"space-x":[{"space-x":[xe]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[xe]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Yt,r]}],"min-w":[{"min-w":[Yt,r,"min","max","fit"]}],"max-w":[{"max-w":[Yt,r,"none","full","min","max","fit","prose",{screen:[Ga]},Ga]}],h:[{h:[Yt,r,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Yt,r,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Yt,r,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Yt,r,"auto","min","max","fit"]}],"font-size":[{text:["base",Ga,Za]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",g0]}],"font-family":[{font:[wf]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Yt]}],"line-clamp":[{"line-clamp":["none",vh,g0]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ws,Yt]}],"list-image":[{"list-image":["none",Yt]}],"list-style-type":[{list:["none","disc","decimal",Yt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[H]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[H]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...dt(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Ws,Za]}],"underline-offset":[{"underline-offset":["auto",Ws,Yt]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:et()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Yt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Yt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[H]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ht(),F5]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",O5]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},B5]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[X]}],"gradient-via-pos":[{via:[X]}],"gradient-to-pos":[{to:[X]}],"gradient-from":[{from:[A]}],"gradient-via":[{via:[A]}],"gradient-to":[{to:[A]}],rounded:[{rounded:[g]}],"rounded-s":[{"rounded-s":[g]}],"rounded-e":[{"rounded-e":[g]}],"rounded-t":[{"rounded-t":[g]}],"rounded-r":[{"rounded-r":[g]}],"rounded-b":[{"rounded-b":[g]}],"rounded-l":[{"rounded-l":[g]}],"rounded-ss":[{"rounded-ss":[g]}],"rounded-se":[{"rounded-se":[g]}],"rounded-ee":[{"rounded-ee":[g]}],"rounded-es":[{"rounded-es":[g]}],"rounded-tl":[{"rounded-tl":[g]}],"rounded-tr":[{"rounded-tr":[g]}],"rounded-br":[{"rounded-br":[g]}],"rounded-bl":[{"rounded-bl":[g]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[H]}],"border-style":[{border:[...dt(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[H]}],"divide-style":[{divide:dt()}],"border-color":[{border:[d]}],"border-color-x":[{"border-x":[d]}],"border-color-y":[{"border-y":[d]}],"border-color-s":[{"border-s":[d]}],"border-color-e":[{"border-e":[d]}],"border-color-t":[{"border-t":[d]}],"border-color-r":[{"border-r":[d]}],"border-color-b":[{"border-b":[d]}],"border-color-l":[{"border-l":[d]}],"divide-color":[{divide:[d]}],"outline-style":[{outline:["",...dt()]}],"outline-offset":[{"outline-offset":[Ws,Yt]}],"outline-w":[{outline:[Ws,Za]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:ot()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[H]}],"ring-offset-w":[{"ring-offset":[Ws,Za]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Ga,j5]}],"shadow-color":[{shadow:[wf]}],opacity:[{opacity:[H]}],"mix-blend":[{"mix-blend":[...wt(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":wt()}],filter:[{filter:["","none"]}],blur:[{blur:[i]}],brightness:[{brightness:[c]}],contrast:[{contrast:[E]}],"drop-shadow":[{"drop-shadow":["","none",Ga,Yt]}],grayscale:[{grayscale:[P]}],"hue-rotate":[{"hue-rotate":[R]}],invert:[{invert:[N]}],saturate:[{saturate:[W]}],sepia:[{sepia:[ge]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[i]}],"backdrop-brightness":[{"backdrop-brightness":[c]}],"backdrop-contrast":[{"backdrop-contrast":[E]}],"backdrop-grayscale":[{"backdrop-grayscale":[P]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[R]}],"backdrop-invert":[{"backdrop-invert":[N]}],"backdrop-opacity":[{"backdrop-opacity":[H]}],"backdrop-saturate":[{"backdrop-saturate":[W]}],"backdrop-sepia":[{"backdrop-sepia":[ge]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[m]}],"border-spacing-x":[{"border-spacing-x":[m]}],"border-spacing-y":[{"border-spacing-y":[m]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Yt]}],duration:[{duration:Ct()}],ease:[{ease:["linear","in","out","in-out",Yt]}],delay:[{delay:Ct()}],animate:[{animate:["none","spin","ping","pulse","bounce",Yt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[re]}],"scale-x":[{"scale-x":[re]}],"scale-y":[{"scale-y":[re]}],rotate:[{rotate:[bf,Yt]}],"translate-x":[{"translate-x":[ze]}],"translate-y":[{"translate-y":[ze]}],"skew-x":[{"skew-x":[Te]}],"skew-y":[{"skew-y":[Te]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Yt]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Yt]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":et()}],"scroll-mx":[{"scroll-mx":et()}],"scroll-my":[{"scroll-my":et()}],"scroll-ms":[{"scroll-ms":et()}],"scroll-me":[{"scroll-me":et()}],"scroll-mt":[{"scroll-mt":et()}],"scroll-mr":[{"scroll-mr":et()}],"scroll-mb":[{"scroll-mb":et()}],"scroll-ml":[{"scroll-ml":et()}],"scroll-p":[{"scroll-p":et()}],"scroll-px":[{"scroll-px":et()}],"scroll-py":[{"scroll-py":et()}],"scroll-ps":[{"scroll-ps":et()}],"scroll-pe":[{"scroll-pe":et()}],"scroll-pt":[{"scroll-pt":et()}],"scroll-pr":[{"scroll-pr":et()}],"scroll-pb":[{"scroll-pb":et()}],"scroll-pl":[{"scroll-pl":et()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Yt]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Ws,Za,g0]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},G5=P5(Z5);function Kr(...e){return G5(FM(e))}const H5=n5,HM=Y.forwardRef(({className:e,...r},i)=>ye.jsx(IM,{ref:i,className:Kr("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...r}));HM.displayName=IM.displayName;const W5=NM("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),WM=Y.forwardRef(({className:e,variant:r,...i},c)=>ye.jsx(AM,{ref:c,className:Kr(W5({variant:r}),e),...i}));WM.displayName=AM.displayName;const q5=Y.forwardRef(({className:e,...r},i)=>ye.jsx(DM,{ref:i,className:Kr("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...r}));q5.displayName=DM.displayName;const qM=Y.forwardRef(({className:e,...r},i)=>ye.jsx(LM,{ref:i,className:Kr("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...r,children:ye.jsx(f5,{className:"h-4 w-4"})}));qM.displayName=LM.displayName;const XM=Y.forwardRef(({className:e,...r},i)=>ye.jsx(zM,{ref:i,className:Kr("text-sm font-semibold",e),...r}));XM.displayName=zM.displayName;const KM=Y.forwardRef(({className:e,...r},i)=>ye.jsx(RM,{ref:i,className:Kr("text-sm opacity-90",e),...r}));KM.displayName=RM.displayName;function X5(){const{toasts:e}=f3();return ye.jsxs(H5,{children:[e.map(function({id:r,title:i,description:c,action:d,...g}){return ye.jsxs(WM,{...g,children:[ye.jsxs("div",{className:"grid gap-1",children:[i&&ye.jsx(XM,{children:i}),c&&ye.jsx(KM,{children:c})]}),d,ye.jsx(qM,{})]},r)}),ye.jsx(HM,{})]})}var YS=["light","dark"],K5="(prefers-color-scheme: dark)",Y5=Y.createContext(void 0),Q5={setTheme:e=>{},themes:[]},J5=()=>{var e;return(e=Y.useContext(Y5))!=null?e:Q5};Y.memo(({forcedTheme:e,storageKey:r,attribute:i,enableSystem:c,enableColorScheme:d,defaultTheme:g,value:m,attrs:l,nonce:E})=>{let P=g==="system",R=i==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${l.map(X=>`'${X}'`).join(",")})`};`:`var d=document.documentElement,n='${i}',s='setAttribute';`,N=d?YS.includes(g)&&g?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${g}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",F=(X,Z=!1,ee=!0)=>{let H=m?m[X]:X,U=Z?X+"|| ''":`'${H}'`,W="";return d&&ee&&!Z&&YS.includes(X)&&(W+=`d.style.colorScheme = '${X}';`),i==="class"?Z||H?W+=`c.add(${U})`:W+="null":H&&(W+=`d[s](n,${U})`),W},A=e?`!function(){${R}${F(e)}}()`:c?`!function(){try{${R}var e=localStorage.getItem('${r}');if('system'===e||(!e&&${P})){var t='${K5}',m=window.matchMedia(t);if(m.media!==t||m.matches){${F("dark")}}else{${F("light")}}}else if(e){${m?`var x=${JSON.stringify(m)};`:""}${F(m?"x[e]":"e",!0)}}${P?"":"else{"+F(g,!1,!1)+"}"}${N}}catch(e){}}()`:`!function(){try{${R}var e=localStorage.getItem('${r}');if(e){${m?`var x=${JSON.stringify(m)};`:""}${F(m?"x[e]":"e",!0)}}else{${F(g,!1,!1)};}${N}}catch(t){}}();`;return Y.createElement("script",{nonce:E,dangerouslySetInnerHTML:{__html:A}})});var eO=e=>{switch(e){case"success":return nO;case"info":return oO;case"warning":return iO;case"error":return sO;default:return null}},tO=Array(12).fill(0),rO=({visible:e,className:r})=>ft.createElement("div",{className:["sonner-loading-wrapper",r].filter(Boolean).join(" "),"data-visible":e},ft.createElement("div",{className:"sonner-spinner"},tO.map((i,c)=>ft.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${c}`})))),nO=ft.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ft.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),iO=ft.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},ft.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),oO=ft.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ft.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),sO=ft.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ft.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),aO=ft.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},ft.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),ft.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),lO=()=>{let[e,r]=ft.useState(document.hidden);return ft.useEffect(()=>{let i=()=>{r(document.hidden)};return document.addEventListener("visibilitychange",i),()=>window.removeEventListener("visibilitychange",i)},[]),e},Ux=1,cO=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let r=this.subscribers.indexOf(e);this.subscribers.splice(r,1)}),this.publish=e=>{this.subscribers.forEach(r=>r(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var r;let{message:i,...c}=e,d=typeof(e==null?void 0:e.id)=="number"||((r=e.id)==null?void 0:r.length)>0?e.id:Ux++,g=this.toasts.find(l=>l.id===d),m=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(d)&&this.dismissedToasts.delete(d),g?this.toasts=this.toasts.map(l=>l.id===d?(this.publish({...l,...e,id:d,title:i}),{...l,...e,id:d,dismissible:m,title:i}):l):this.addToast({title:i,...c,dismissible:m,id:d}),d},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(r=>{this.subscribers.forEach(i=>i({id:r.id,dismiss:!0}))}),this.subscribers.forEach(r=>r({id:e,dismiss:!0})),e),this.message=(e,r)=>this.create({...r,message:e}),this.error=(e,r)=>this.create({...r,message:e,type:"error"}),this.success=(e,r)=>this.create({...r,type:"success",message:e}),this.info=(e,r)=>this.create({...r,type:"info",message:e}),this.warning=(e,r)=>this.create({...r,type:"warning",message:e}),this.loading=(e,r)=>this.create({...r,type:"loading",message:e}),this.promise=(e,r)=>{if(!r)return;let i;r.loading!==void 0&&(i=this.create({...r,promise:e,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));let c=e instanceof Promise?e:e(),d=i!==void 0,g,m=c.then(async E=>{if(g=["resolve",E],ft.isValidElement(E))d=!1,this.create({id:i,type:"default",message:E});else if(hO(E)&&!E.ok){d=!1;let P=typeof r.error=="function"?await r.error(`HTTP error! status: ${E.status}`):r.error,R=typeof r.description=="function"?await r.description(`HTTP error! status: ${E.status}`):r.description;this.create({id:i,type:"error",message:P,description:R})}else if(r.success!==void 0){d=!1;let P=typeof r.success=="function"?await r.success(E):r.success,R=typeof r.description=="function"?await r.description(E):r.description;this.create({id:i,type:"success",message:P,description:R})}}).catch(async E=>{if(g=["reject",E],r.error!==void 0){d=!1;let P=typeof r.error=="function"?await r.error(E):r.error,R=typeof r.description=="function"?await r.description(E):r.description;this.create({id:i,type:"error",message:P,description:R})}}).finally(()=>{var E;d&&(this.dismiss(i),i=void 0),(E=r.finally)==null||E.call(r)}),l=()=>new Promise((E,P)=>m.then(()=>g[0]==="reject"?P(g[1]):E(g[1])).catch(P));return typeof i!="string"&&typeof i!="number"?{unwrap:l}:Object.assign(i,{unwrap:l})},this.custom=(e,r)=>{let i=(r==null?void 0:r.id)||Ux++;return this.create({jsx:e(i),id:i,...r}),i},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},Mi=new cO,uO=(e,r)=>{let i=(r==null?void 0:r.id)||Ux++;return Mi.addToast({title:e,...r,id:i}),i},hO=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",dO=uO,fO=()=>Mi.toasts,pO=()=>Mi.getActiveToasts();Object.assign(dO,{success:Mi.success,info:Mi.info,warning:Mi.warning,error:Mi.error,custom:Mi.custom,message:Mi.message,promise:Mi.promise,dismiss:Mi.dismiss,loading:Mi.loading},{getHistory:fO,getToasts:pO});function mO(e,{insertAt:r}={}){if(typeof document>"u")return;let i=document.head||document.getElementsByTagName("head")[0],c=document.createElement("style");c.type="text/css",r==="top"&&i.firstChild?i.insertBefore(c,i.firstChild):i.appendChild(c),c.styleSheet?c.styleSheet.cssText=e:c.appendChild(document.createTextNode(e))}mO(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function gg(e){return e.label!==void 0}var gO=3,_O="32px",yO="16px",QS=4e3,vO=356,xO=14,bO=20,wO=200;function Oo(...e){return e.filter(Boolean).join(" ")}function SO(e){let[r,i]=e.split("-"),c=[];return r&&c.push(r),i&&c.push(i),c}var TO=e=>{var r,i,c,d,g,m,l,E,P,R,N;let{invert:F,toast:A,unstyled:X,interacting:Z,setHeights:ee,visibleToasts:H,heights:U,index:W,toasts:re,expanded:ge,removeToast:Te,defaultRichColors:xe,closeButton:ze,style:Ne,cancelButtonStyle:Ie,actionButtonStyle:$e,className:et="",descriptionClassName:ot="",duration:qe,position:ht,gap:dt,loadingIcon:wt,expandByDefault:Ze,classNames:He,icons:pt,closeButtonAriaLabel:Ct="Close toast",pauseWhenPageIsHidden:ut}=e,[At,kt]=ft.useState(null),[nr,dr]=ft.useState(null),[gt,sr]=ft.useState(!1),[Vt,tr]=ft.useState(!1),[Dt,Qt]=ft.useState(!1),[Gt,Rr]=ft.useState(!1),[Yr,Nn]=ft.useState(!1),[Sr,sn]=ft.useState(0),[Zr,no]=ft.useState(0),Yn=ft.useRef(A.duration||qe||QS),Yo=ft.useRef(null),Bn=ft.useRef(null),Fi=W===0,bo=W+1<=H,jr=A.type,Qr=A.dismissible!==!1,Si=A.className||"",Is=A.descriptionClassName||"",wo=ft.useMemo(()=>U.findIndex(he=>he.toastId===A.id)||0,[U,A.id]),Ni=ft.useMemo(()=>{var he;return(he=A.closeButton)!=null?he:ze},[A.closeButton,ze]),Me=ft.useMemo(()=>A.duration||qe||QS,[A.duration,qe]),Q=ft.useRef(0),J=ft.useRef(0),ie=ft.useRef(0),de=ft.useRef(null),[we,Ee]=ht.split("-"),De=ft.useMemo(()=>U.reduce((he,Qe,mt)=>mt>=wo?he:he+Qe.height,0),[U,wo]),Ce=lO(),Ve=A.invert||F,je=jr==="loading";J.current=ft.useMemo(()=>wo*dt+De,[wo,De]),ft.useEffect(()=>{Yn.current=Me},[Me]),ft.useEffect(()=>{sr(!0)},[]),ft.useEffect(()=>{let he=Bn.current;if(he){let Qe=he.getBoundingClientRect().height;return no(Qe),ee(mt=>[{toastId:A.id,height:Qe,position:A.position},...mt]),()=>ee(mt=>mt.filter(ct=>ct.toastId!==A.id))}},[ee,A.id]),ft.useLayoutEffect(()=>{if(!gt)return;let he=Bn.current,Qe=he.style.height;he.style.height="auto";let mt=he.getBoundingClientRect().height;he.style.height=Qe,no(mt),ee(ct=>ct.find(yt=>yt.toastId===A.id)?ct.map(yt=>yt.toastId===A.id?{...yt,height:mt}:yt):[{toastId:A.id,height:mt,position:A.position},...ct])},[gt,A.title,A.description,ee,A.id]);let ke=ft.useCallback(()=>{tr(!0),sn(J.current),ee(he=>he.filter(Qe=>Qe.toastId!==A.id)),setTimeout(()=>{Te(A)},wO)},[A,Te,ee,J]);ft.useEffect(()=>{if(A.promise&&jr==="loading"||A.duration===1/0||A.type==="loading")return;let he;return ge||Z||ut&&Ce?(()=>{if(ie.current<Q.current){let Qe=new Date().getTime()-Q.current;Yn.current=Yn.current-Qe}ie.current=new Date().getTime()})():Yn.current!==1/0&&(Q.current=new Date().getTime(),he=setTimeout(()=>{var Qe;(Qe=A.onAutoClose)==null||Qe.call(A,A),ke()},Yn.current)),()=>clearTimeout(he)},[ge,Z,A,jr,ut,Ce,ke]),ft.useEffect(()=>{A.delete&&ke()},[ke,A.delete]);function We(){var he,Qe,mt;return pt!=null&&pt.loading?ft.createElement("div",{className:Oo(He==null?void 0:He.loader,(he=A==null?void 0:A.classNames)==null?void 0:he.loader,"sonner-loader"),"data-visible":jr==="loading"},pt.loading):wt?ft.createElement("div",{className:Oo(He==null?void 0:He.loader,(Qe=A==null?void 0:A.classNames)==null?void 0:Qe.loader,"sonner-loader"),"data-visible":jr==="loading"},wt):ft.createElement(rO,{className:Oo(He==null?void 0:He.loader,(mt=A==null?void 0:A.classNames)==null?void 0:mt.loader),visible:jr==="loading"})}return ft.createElement("li",{tabIndex:0,ref:Bn,className:Oo(et,Si,He==null?void 0:He.toast,(r=A==null?void 0:A.classNames)==null?void 0:r.toast,He==null?void 0:He.default,He==null?void 0:He[jr],(i=A==null?void 0:A.classNames)==null?void 0:i[jr]),"data-sonner-toast":"","data-rich-colors":(c=A.richColors)!=null?c:xe,"data-styled":!(A.jsx||A.unstyled||X),"data-mounted":gt,"data-promise":!!A.promise,"data-swiped":Yr,"data-removed":Vt,"data-visible":bo,"data-y-position":we,"data-x-position":Ee,"data-index":W,"data-front":Fi,"data-swiping":Dt,"data-dismissible":Qr,"data-type":jr,"data-invert":Ve,"data-swipe-out":Gt,"data-swipe-direction":nr,"data-expanded":!!(ge||Ze&&gt),style:{"--index":W,"--toasts-before":W,"--z-index":re.length-W,"--offset":`${Vt?Sr:J.current}px`,"--initial-height":Ze?"auto":`${Zr}px`,...Ne,...A.style},onDragEnd:()=>{Qt(!1),kt(null),de.current=null},onPointerDown:he=>{je||!Qr||(Yo.current=new Date,sn(J.current),he.target.setPointerCapture(he.pointerId),he.target.tagName!=="BUTTON"&&(Qt(!0),de.current={x:he.clientX,y:he.clientY}))},onPointerUp:()=>{var he,Qe,mt,ct;if(Gt||!Qr)return;de.current=null;let yt=Number(((he=Bn.current)==null?void 0:he.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Et=Number(((Qe=Bn.current)==null?void 0:Qe.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),ir=new Date().getTime()-((mt=Yo.current)==null?void 0:mt.getTime()),Nt=At==="x"?yt:Et,Bt=Math.abs(Nt)/ir;if(Math.abs(Nt)>=bO||Bt>.11){sn(J.current),(ct=A.onDismiss)==null||ct.call(A,A),dr(At==="x"?yt>0?"right":"left":Et>0?"down":"up"),ke(),Rr(!0),Nn(!1);return}Qt(!1),kt(null)},onPointerMove:he=>{var Qe,mt,ct,yt;if(!de.current||!Qr||((Qe=window.getSelection())==null?void 0:Qe.toString().length)>0)return;let Et=he.clientY-de.current.y,ir=he.clientX-de.current.x,Nt=(mt=e.swipeDirections)!=null?mt:SO(ht);!At&&(Math.abs(ir)>1||Math.abs(Et)>1)&&kt(Math.abs(ir)>Math.abs(Et)?"x":"y");let Bt={x:0,y:0};At==="y"?(Nt.includes("top")||Nt.includes("bottom"))&&(Nt.includes("top")&&Et<0||Nt.includes("bottom")&&Et>0)&&(Bt.y=Et):At==="x"&&(Nt.includes("left")||Nt.includes("right"))&&(Nt.includes("left")&&ir<0||Nt.includes("right")&&ir>0)&&(Bt.x=ir),(Math.abs(Bt.x)>0||Math.abs(Bt.y)>0)&&Nn(!0),(ct=Bn.current)==null||ct.style.setProperty("--swipe-amount-x",`${Bt.x}px`),(yt=Bn.current)==null||yt.style.setProperty("--swipe-amount-y",`${Bt.y}px`)}},Ni&&!A.jsx?ft.createElement("button",{"aria-label":Ct,"data-disabled":je,"data-close-button":!0,onClick:je||!Qr?()=>{}:()=>{var he;ke(),(he=A.onDismiss)==null||he.call(A,A)},className:Oo(He==null?void 0:He.closeButton,(d=A==null?void 0:A.classNames)==null?void 0:d.closeButton)},(g=pt==null?void 0:pt.close)!=null?g:aO):null,A.jsx||Y.isValidElement(A.title)?A.jsx?A.jsx:typeof A.title=="function"?A.title():A.title:ft.createElement(ft.Fragment,null,jr||A.icon||A.promise?ft.createElement("div",{"data-icon":"",className:Oo(He==null?void 0:He.icon,(m=A==null?void 0:A.classNames)==null?void 0:m.icon)},A.promise||A.type==="loading"&&!A.icon?A.icon||We():null,A.type!=="loading"?A.icon||(pt==null?void 0:pt[jr])||eO(jr):null):null,ft.createElement("div",{"data-content":"",className:Oo(He==null?void 0:He.content,(l=A==null?void 0:A.classNames)==null?void 0:l.content)},ft.createElement("div",{"data-title":"",className:Oo(He==null?void 0:He.title,(E=A==null?void 0:A.classNames)==null?void 0:E.title)},typeof A.title=="function"?A.title():A.title),A.description?ft.createElement("div",{"data-description":"",className:Oo(ot,Is,He==null?void 0:He.description,(P=A==null?void 0:A.classNames)==null?void 0:P.description)},typeof A.description=="function"?A.description():A.description):null),Y.isValidElement(A.cancel)?A.cancel:A.cancel&&gg(A.cancel)?ft.createElement("button",{"data-button":!0,"data-cancel":!0,style:A.cancelButtonStyle||Ie,onClick:he=>{var Qe,mt;gg(A.cancel)&&Qr&&((mt=(Qe=A.cancel).onClick)==null||mt.call(Qe,he),ke())},className:Oo(He==null?void 0:He.cancelButton,(R=A==null?void 0:A.classNames)==null?void 0:R.cancelButton)},A.cancel.label):null,Y.isValidElement(A.action)?A.action:A.action&&gg(A.action)?ft.createElement("button",{"data-button":!0,"data-action":!0,style:A.actionButtonStyle||$e,onClick:he=>{var Qe,mt;gg(A.action)&&((mt=(Qe=A.action).onClick)==null||mt.call(Qe,he),!he.defaultPrevented&&ke())},className:Oo(He==null?void 0:He.actionButton,(N=A==null?void 0:A.classNames)==null?void 0:N.actionButton)},A.action.label):null))};function JS(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function CO(e,r){let i={};return[e,r].forEach((c,d)=>{let g=d===1,m=g?"--mobile-offset":"--offset",l=g?yO:_O;function E(P){["top","right","bottom","left"].forEach(R=>{i[`${m}-${R}`]=typeof P=="number"?`${P}px`:P})}typeof c=="number"||typeof c=="string"?E(c):typeof c=="object"?["top","right","bottom","left"].forEach(P=>{c[P]===void 0?i[`${m}-${P}`]=l:i[`${m}-${P}`]=typeof c[P]=="number"?`${c[P]}px`:c[P]}):E(l)}),i}var PO=Y.forwardRef(function(e,r){let{invert:i,position:c="bottom-right",hotkey:d=["altKey","KeyT"],expand:g,closeButton:m,className:l,offset:E,mobileOffset:P,theme:R="light",richColors:N,duration:F,style:A,visibleToasts:X=gO,toastOptions:Z,dir:ee=JS(),gap:H=xO,loadingIcon:U,icons:W,containerAriaLabel:re="Notifications",pauseWhenPageIsHidden:ge}=e,[Te,xe]=ft.useState([]),ze=ft.useMemo(()=>Array.from(new Set([c].concat(Te.filter(ut=>ut.position).map(ut=>ut.position)))),[Te,c]),[Ne,Ie]=ft.useState([]),[$e,et]=ft.useState(!1),[ot,qe]=ft.useState(!1),[ht,dt]=ft.useState(R!=="system"?R:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),wt=ft.useRef(null),Ze=d.join("+").replace(/Key/g,"").replace(/Digit/g,""),He=ft.useRef(null),pt=ft.useRef(!1),Ct=ft.useCallback(ut=>{xe(At=>{var kt;return(kt=At.find(nr=>nr.id===ut.id))!=null&&kt.delete||Mi.dismiss(ut.id),At.filter(({id:nr})=>nr!==ut.id)})},[]);return ft.useEffect(()=>Mi.subscribe(ut=>{if(ut.dismiss){xe(At=>At.map(kt=>kt.id===ut.id?{...kt,delete:!0}:kt));return}setTimeout(()=>{aM.flushSync(()=>{xe(At=>{let kt=At.findIndex(nr=>nr.id===ut.id);return kt!==-1?[...At.slice(0,kt),{...At[kt],...ut},...At.slice(kt+1)]:[ut,...At]})})})}),[]),ft.useEffect(()=>{if(R!=="system"){dt(R);return}if(R==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?dt("dark"):dt("light")),typeof window>"u")return;let ut=window.matchMedia("(prefers-color-scheme: dark)");try{ut.addEventListener("change",({matches:At})=>{dt(At?"dark":"light")})}catch{ut.addListener(({matches:kt})=>{try{dt(kt?"dark":"light")}catch(nr){console.error(nr)}})}},[R]),ft.useEffect(()=>{Te.length<=1&&et(!1)},[Te]),ft.useEffect(()=>{let ut=At=>{var kt,nr;d.every(dr=>At[dr]||At.code===dr)&&(et(!0),(kt=wt.current)==null||kt.focus()),At.code==="Escape"&&(document.activeElement===wt.current||(nr=wt.current)!=null&&nr.contains(document.activeElement))&&et(!1)};return document.addEventListener("keydown",ut),()=>document.removeEventListener("keydown",ut)},[d]),ft.useEffect(()=>{if(wt.current)return()=>{He.current&&(He.current.focus({preventScroll:!0}),He.current=null,pt.current=!1)}},[wt.current]),ft.createElement("section",{ref:r,"aria-label":`${re} ${Ze}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},ze.map((ut,At)=>{var kt;let[nr,dr]=ut.split("-");return Te.length?ft.createElement("ol",{key:ut,dir:ee==="auto"?JS():ee,tabIndex:-1,ref:wt,className:l,"data-sonner-toaster":!0,"data-theme":ht,"data-y-position":nr,"data-lifted":$e&&Te.length>1&&!g,"data-x-position":dr,style:{"--front-toast-height":`${((kt=Ne[0])==null?void 0:kt.height)||0}px`,"--width":`${vO}px`,"--gap":`${H}px`,...A,...CO(E,P)},onBlur:gt=>{pt.current&&!gt.currentTarget.contains(gt.relatedTarget)&&(pt.current=!1,He.current&&(He.current.focus({preventScroll:!0}),He.current=null))},onFocus:gt=>{gt.target instanceof HTMLElement&&gt.target.dataset.dismissible==="false"||pt.current||(pt.current=!0,He.current=gt.relatedTarget)},onMouseEnter:()=>et(!0),onMouseMove:()=>et(!0),onMouseLeave:()=>{ot||et(!1)},onDragEnd:()=>et(!1),onPointerDown:gt=>{gt.target instanceof HTMLElement&&gt.target.dataset.dismissible==="false"||qe(!0)},onPointerUp:()=>qe(!1)},Te.filter(gt=>!gt.position&&At===0||gt.position===ut).map((gt,sr)=>{var Vt,tr;return ft.createElement(TO,{key:gt.id,icons:W,index:sr,toast:gt,defaultRichColors:N,duration:(Vt=Z==null?void 0:Z.duration)!=null?Vt:F,className:Z==null?void 0:Z.className,descriptionClassName:Z==null?void 0:Z.descriptionClassName,invert:i,visibleToasts:X,closeButton:(tr=Z==null?void 0:Z.closeButton)!=null?tr:m,interacting:ot,position:ut,style:Z==null?void 0:Z.style,unstyled:Z==null?void 0:Z.unstyled,classNames:Z==null?void 0:Z.classNames,cancelButtonStyle:Z==null?void 0:Z.cancelButtonStyle,actionButtonStyle:Z==null?void 0:Z.actionButtonStyle,removeToast:Ct,toasts:Te.filter(Dt=>Dt.position==gt.position),heights:Ne.filter(Dt=>Dt.position==gt.position),setHeights:Ie,expandByDefault:g,gap:H,loadingIcon:U,expanded:$e,pauseWhenPageIsHidden:ge,swipeDirections:e.swipeDirections})})):null}))});const EO=({...e})=>{const{theme:r="system"}=J5();return ye.jsx(PO,{theme:r,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var MO=Sb[" useId ".trim().toString()]||(()=>{}),kO=0;function xw(e){const[r,i]=Y.useState(MO());return Kn(()=>{i(c=>c??String(kO++))},[e]),r?`radix-${r}`:""}const IO=["top","right","bottom","left"],bl=Math.min,Xi=Math.max,w_=Math.round,_g=Math.floor,Ts=e=>({x:e,y:e}),AO={left:"right",right:"left",bottom:"top",top:"bottom"},zO={start:"end",end:"start"};function Vx(e,r,i){return Xi(e,bl(r,i))}function la(e,r){return typeof e=="function"?e(r):e}function ca(e){return e.split("-")[0]}function Xh(e){return e.split("-")[1]}function bw(e){return e==="x"?"y":"x"}function ww(e){return e==="y"?"height":"width"}const RO=new Set(["top","bottom"]);function bs(e){return RO.has(ca(e))?"y":"x"}function Sw(e){return bw(bs(e))}function DO(e,r,i){i===void 0&&(i=!1);const c=Xh(e),d=Sw(e),g=ww(d);let m=d==="x"?c===(i?"end":"start")?"right":"left":c==="start"?"bottom":"top";return r.reference[g]>r.floating[g]&&(m=S_(m)),[m,S_(m)]}function LO(e){const r=S_(e);return[Zx(e),r,Zx(r)]}function Zx(e){return e.replace(/start|end/g,r=>zO[r])}const eT=["left","right"],tT=["right","left"],OO=["top","bottom"],FO=["bottom","top"];function NO(e,r,i){switch(e){case"top":case"bottom":return i?r?tT:eT:r?eT:tT;case"left":case"right":return r?OO:FO;default:return[]}}function BO(e,r,i,c){const d=Xh(e);let g=NO(ca(e),i==="start",c);return d&&(g=g.map(m=>m+"-"+d),r&&(g=g.concat(g.map(Zx)))),g}function S_(e){return e.replace(/left|right|bottom|top/g,r=>AO[r])}function jO(e){return{top:0,right:0,bottom:0,left:0,...e}}function YM(e){return typeof e!="number"?jO(e):{top:e,right:e,bottom:e,left:e}}function T_(e){const{x:r,y:i,width:c,height:d}=e;return{width:c,height:d,top:i,left:r,right:r+c,bottom:i+d,x:r,y:i}}function rT(e,r,i){let{reference:c,floating:d}=e;const g=bs(r),m=Sw(r),l=ww(m),E=ca(r),P=g==="y",R=c.x+c.width/2-d.width/2,N=c.y+c.height/2-d.height/2,F=c[l]/2-d[l]/2;let A;switch(E){case"top":A={x:R,y:c.y-d.height};break;case"bottom":A={x:R,y:c.y+c.height};break;case"right":A={x:c.x+c.width,y:N};break;case"left":A={x:c.x-d.width,y:N};break;default:A={x:c.x,y:c.y}}switch(Xh(r)){case"start":A[m]-=F*(i&&P?-1:1);break;case"end":A[m]+=F*(i&&P?-1:1);break}return A}const $O=async(e,r,i)=>{const{placement:c="bottom",strategy:d="absolute",middleware:g=[],platform:m}=i,l=g.filter(Boolean),E=await(m.isRTL==null?void 0:m.isRTL(r));let P=await m.getElementRects({reference:e,floating:r,strategy:d}),{x:R,y:N}=rT(P,c,E),F=c,A={},X=0;for(let Z=0;Z<l.length;Z++){const{name:ee,fn:H}=l[Z],{x:U,y:W,data:re,reset:ge}=await H({x:R,y:N,initialPlacement:c,placement:F,strategy:d,middlewareData:A,rects:P,platform:m,elements:{reference:e,floating:r}});R=U??R,N=W??N,A={...A,[ee]:{...A[ee],...re}},ge&&X<=50&&(X++,typeof ge=="object"&&(ge.placement&&(F=ge.placement),ge.rects&&(P=ge.rects===!0?await m.getElementRects({reference:e,floating:r,strategy:d}):ge.rects),{x:R,y:N}=rT(P,F,E)),Z=-1)}return{x:R,y:N,placement:F,strategy:d,middlewareData:A}};async function lp(e,r){var i;r===void 0&&(r={});const{x:c,y:d,platform:g,rects:m,elements:l,strategy:E}=e,{boundary:P="clippingAncestors",rootBoundary:R="viewport",elementContext:N="floating",altBoundary:F=!1,padding:A=0}=la(r,e),X=YM(A),ee=l[F?N==="floating"?"reference":"floating":N],H=T_(await g.getClippingRect({element:(i=await(g.isElement==null?void 0:g.isElement(ee)))==null||i?ee:ee.contextElement||await(g.getDocumentElement==null?void 0:g.getDocumentElement(l.floating)),boundary:P,rootBoundary:R,strategy:E})),U=N==="floating"?{x:c,y:d,width:m.floating.width,height:m.floating.height}:m.reference,W=await(g.getOffsetParent==null?void 0:g.getOffsetParent(l.floating)),re=await(g.isElement==null?void 0:g.isElement(W))?await(g.getScale==null?void 0:g.getScale(W))||{x:1,y:1}:{x:1,y:1},ge=T_(g.convertOffsetParentRelativeRectToViewportRelativeRect?await g.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:U,offsetParent:W,strategy:E}):U);return{top:(H.top-ge.top+X.top)/re.y,bottom:(ge.bottom-H.bottom+X.bottom)/re.y,left:(H.left-ge.left+X.left)/re.x,right:(ge.right-H.right+X.right)/re.x}}const UO=e=>({name:"arrow",options:e,async fn(r){const{x:i,y:c,placement:d,rects:g,platform:m,elements:l,middlewareData:E}=r,{element:P,padding:R=0}=la(e,r)||{};if(P==null)return{};const N=YM(R),F={x:i,y:c},A=Sw(d),X=ww(A),Z=await m.getDimensions(P),ee=A==="y",H=ee?"top":"left",U=ee?"bottom":"right",W=ee?"clientHeight":"clientWidth",re=g.reference[X]+g.reference[A]-F[A]-g.floating[X],ge=F[A]-g.reference[A],Te=await(m.getOffsetParent==null?void 0:m.getOffsetParent(P));let xe=Te?Te[W]:0;(!xe||!await(m.isElement==null?void 0:m.isElement(Te)))&&(xe=l.floating[W]||g.floating[X]);const ze=re/2-ge/2,Ne=xe/2-Z[X]/2-1,Ie=bl(N[H],Ne),$e=bl(N[U],Ne),et=Ie,ot=xe-Z[X]-$e,qe=xe/2-Z[X]/2+ze,ht=Vx(et,qe,ot),dt=!E.arrow&&Xh(d)!=null&&qe!==ht&&g.reference[X]/2-(qe<et?Ie:$e)-Z[X]/2<0,wt=dt?qe<et?qe-et:qe-ot:0;return{[A]:F[A]+wt,data:{[A]:ht,centerOffset:qe-ht-wt,...dt&&{alignmentOffset:wt}},reset:dt}}}),VO=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(r){var i,c;const{placement:d,middlewareData:g,rects:m,initialPlacement:l,platform:E,elements:P}=r,{mainAxis:R=!0,crossAxis:N=!0,fallbackPlacements:F,fallbackStrategy:A="bestFit",fallbackAxisSideDirection:X="none",flipAlignment:Z=!0,...ee}=la(e,r);if((i=g.arrow)!=null&&i.alignmentOffset)return{};const H=ca(d),U=bs(l),W=ca(l)===l,re=await(E.isRTL==null?void 0:E.isRTL(P.floating)),ge=F||(W||!Z?[S_(l)]:LO(l)),Te=X!=="none";!F&&Te&&ge.push(...BO(l,Z,X,re));const xe=[l,...ge],ze=await lp(r,ee),Ne=[];let Ie=((c=g.flip)==null?void 0:c.overflows)||[];if(R&&Ne.push(ze[H]),N){const qe=DO(d,m,re);Ne.push(ze[qe[0]],ze[qe[1]])}if(Ie=[...Ie,{placement:d,overflows:Ne}],!Ne.every(qe=>qe<=0)){var $e,et;const qe=((($e=g.flip)==null?void 0:$e.index)||0)+1,ht=xe[qe];if(ht&&(!(N==="alignment"?U!==bs(ht):!1)||Ie.every(Ze=>Ze.overflows[0]>0&&bs(Ze.placement)===U)))return{data:{index:qe,overflows:Ie},reset:{placement:ht}};let dt=(et=Ie.filter(wt=>wt.overflows[0]<=0).sort((wt,Ze)=>wt.overflows[1]-Ze.overflows[1])[0])==null?void 0:et.placement;if(!dt)switch(A){case"bestFit":{var ot;const wt=(ot=Ie.filter(Ze=>{if(Te){const He=bs(Ze.placement);return He===U||He==="y"}return!0}).map(Ze=>[Ze.placement,Ze.overflows.filter(He=>He>0).reduce((He,pt)=>He+pt,0)]).sort((Ze,He)=>Ze[1]-He[1])[0])==null?void 0:ot[0];wt&&(dt=wt);break}case"initialPlacement":dt=l;break}if(d!==dt)return{reset:{placement:dt}}}return{}}}};function nT(e,r){return{top:e.top-r.height,right:e.right-r.width,bottom:e.bottom-r.height,left:e.left-r.width}}function iT(e){return IO.some(r=>e[r]>=0)}const ZO=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(r){const{rects:i}=r,{strategy:c="referenceHidden",...d}=la(e,r);switch(c){case"referenceHidden":{const g=await lp(r,{...d,elementContext:"reference"}),m=nT(g,i.reference);return{data:{referenceHiddenOffsets:m,referenceHidden:iT(m)}}}case"escaped":{const g=await lp(r,{...d,altBoundary:!0}),m=nT(g,i.floating);return{data:{escapedOffsets:m,escaped:iT(m)}}}default:return{}}}}},QM=new Set(["left","top"]);async function GO(e,r){const{placement:i,platform:c,elements:d}=e,g=await(c.isRTL==null?void 0:c.isRTL(d.floating)),m=ca(i),l=Xh(i),E=bs(i)==="y",P=QM.has(m)?-1:1,R=g&&E?-1:1,N=la(r,e);let{mainAxis:F,crossAxis:A,alignmentAxis:X}=typeof N=="number"?{mainAxis:N,crossAxis:0,alignmentAxis:null}:{mainAxis:N.mainAxis||0,crossAxis:N.crossAxis||0,alignmentAxis:N.alignmentAxis};return l&&typeof X=="number"&&(A=l==="end"?X*-1:X),E?{x:A*R,y:F*P}:{x:F*P,y:A*R}}const HO=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(r){var i,c;const{x:d,y:g,placement:m,middlewareData:l}=r,E=await GO(r,e);return m===((i=l.offset)==null?void 0:i.placement)&&(c=l.arrow)!=null&&c.alignmentOffset?{}:{x:d+E.x,y:g+E.y,data:{...E,placement:m}}}}},WO=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(r){const{x:i,y:c,placement:d}=r,{mainAxis:g=!0,crossAxis:m=!1,limiter:l={fn:ee=>{let{x:H,y:U}=ee;return{x:H,y:U}}},...E}=la(e,r),P={x:i,y:c},R=await lp(r,E),N=bs(ca(d)),F=bw(N);let A=P[F],X=P[N];if(g){const ee=F==="y"?"top":"left",H=F==="y"?"bottom":"right",U=A+R[ee],W=A-R[H];A=Vx(U,A,W)}if(m){const ee=N==="y"?"top":"left",H=N==="y"?"bottom":"right",U=X+R[ee],W=X-R[H];X=Vx(U,X,W)}const Z=l.fn({...r,[F]:A,[N]:X});return{...Z,data:{x:Z.x-i,y:Z.y-c,enabled:{[F]:g,[N]:m}}}}}},qO=function(e){return e===void 0&&(e={}),{options:e,fn(r){const{x:i,y:c,placement:d,rects:g,middlewareData:m}=r,{offset:l=0,mainAxis:E=!0,crossAxis:P=!0}=la(e,r),R={x:i,y:c},N=bs(d),F=bw(N);let A=R[F],X=R[N];const Z=la(l,r),ee=typeof Z=="number"?{mainAxis:Z,crossAxis:0}:{mainAxis:0,crossAxis:0,...Z};if(E){const W=F==="y"?"height":"width",re=g.reference[F]-g.floating[W]+ee.mainAxis,ge=g.reference[F]+g.reference[W]-ee.mainAxis;A<re?A=re:A>ge&&(A=ge)}if(P){var H,U;const W=F==="y"?"width":"height",re=QM.has(ca(d)),ge=g.reference[N]-g.floating[W]+(re&&((H=m.offset)==null?void 0:H[N])||0)+(re?0:ee.crossAxis),Te=g.reference[N]+g.reference[W]+(re?0:((U=m.offset)==null?void 0:U[N])||0)-(re?ee.crossAxis:0);X<ge?X=ge:X>Te&&(X=Te)}return{[F]:A,[N]:X}}}},XO=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(r){var i,c;const{placement:d,rects:g,platform:m,elements:l}=r,{apply:E=()=>{},...P}=la(e,r),R=await lp(r,P),N=ca(d),F=Xh(d),A=bs(d)==="y",{width:X,height:Z}=g.floating;let ee,H;N==="top"||N==="bottom"?(ee=N,H=F===(await(m.isRTL==null?void 0:m.isRTL(l.floating))?"start":"end")?"left":"right"):(H=N,ee=F==="end"?"top":"bottom");const U=Z-R.top-R.bottom,W=X-R.left-R.right,re=bl(Z-R[ee],U),ge=bl(X-R[H],W),Te=!r.middlewareData.shift;let xe=re,ze=ge;if((i=r.middlewareData.shift)!=null&&i.enabled.x&&(ze=W),(c=r.middlewareData.shift)!=null&&c.enabled.y&&(xe=U),Te&&!F){const Ie=Xi(R.left,0),$e=Xi(R.right,0),et=Xi(R.top,0),ot=Xi(R.bottom,0);A?ze=X-2*(Ie!==0||$e!==0?Ie+$e:Xi(R.left,R.right)):xe=Z-2*(et!==0||ot!==0?et+ot:Xi(R.top,R.bottom))}await E({...r,availableWidth:ze,availableHeight:xe});const Ne=await m.getDimensions(l.floating);return X!==Ne.width||Z!==Ne.height?{reset:{rects:!0}}:{}}}};function oy(){return typeof window<"u"}function Kh(e){return JM(e)?(e.nodeName||"").toLowerCase():"#document"}function Ji(e){var r;return(e==null||(r=e.ownerDocument)==null?void 0:r.defaultView)||window}function ks(e){var r;return(r=(JM(e)?e.ownerDocument:e.document)||window.document)==null?void 0:r.documentElement}function JM(e){return oy()?e instanceof Node||e instanceof Ji(e).Node:!1}function Xo(e){return oy()?e instanceof Element||e instanceof Ji(e).Element:!1}function Ms(e){return oy()?e instanceof HTMLElement||e instanceof Ji(e).HTMLElement:!1}function oT(e){return!oy()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Ji(e).ShadowRoot}const KO=new Set(["inline","contents"]);function zp(e){const{overflow:r,overflowX:i,overflowY:c,display:d}=Ko(e);return/auto|scroll|overlay|hidden|clip/.test(r+c+i)&&!KO.has(d)}const YO=new Set(["table","td","th"]);function QO(e){return YO.has(Kh(e))}const JO=[":popover-open",":modal"];function sy(e){return JO.some(r=>{try{return e.matches(r)}catch{return!1}})}const eF=["transform","translate","scale","rotate","perspective"],tF=["transform","translate","scale","rotate","perspective","filter"],rF=["paint","layout","strict","content"];function Tw(e){const r=Cw(),i=Xo(e)?Ko(e):e;return eF.some(c=>i[c]?i[c]!=="none":!1)||(i.containerType?i.containerType!=="normal":!1)||!r&&(i.backdropFilter?i.backdropFilter!=="none":!1)||!r&&(i.filter?i.filter!=="none":!1)||tF.some(c=>(i.willChange||"").includes(c))||rF.some(c=>(i.contain||"").includes(c))}function nF(e){let r=wl(e);for(;Ms(r)&&!jh(r);){if(Tw(r))return r;if(sy(r))return null;r=wl(r)}return null}function Cw(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const iF=new Set(["html","body","#document"]);function jh(e){return iF.has(Kh(e))}function Ko(e){return Ji(e).getComputedStyle(e)}function ay(e){return Xo(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function wl(e){if(Kh(e)==="html")return e;const r=e.assignedSlot||e.parentNode||oT(e)&&e.host||ks(e);return oT(r)?r.host:r}function ek(e){const r=wl(e);return jh(r)?e.ownerDocument?e.ownerDocument.body:e.body:Ms(r)&&zp(r)?r:ek(r)}function cp(e,r,i){var c;r===void 0&&(r=[]),i===void 0&&(i=!0);const d=ek(e),g=d===((c=e.ownerDocument)==null?void 0:c.body),m=Ji(d);if(g){const l=Gx(m);return r.concat(m,m.visualViewport||[],zp(d)?d:[],l&&i?cp(l):[])}return r.concat(d,cp(d,[],i))}function Gx(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function tk(e){const r=Ko(e);let i=parseFloat(r.width)||0,c=parseFloat(r.height)||0;const d=Ms(e),g=d?e.offsetWidth:i,m=d?e.offsetHeight:c,l=w_(i)!==g||w_(c)!==m;return l&&(i=g,c=m),{width:i,height:c,$:l}}function Pw(e){return Xo(e)?e:e.contextElement}function xh(e){const r=Pw(e);if(!Ms(r))return Ts(1);const i=r.getBoundingClientRect(),{width:c,height:d,$:g}=tk(r);let m=(g?w_(i.width):i.width)/c,l=(g?w_(i.height):i.height)/d;return(!m||!Number.isFinite(m))&&(m=1),(!l||!Number.isFinite(l))&&(l=1),{x:m,y:l}}const oF=Ts(0);function rk(e){const r=Ji(e);return!Cw()||!r.visualViewport?oF:{x:r.visualViewport.offsetLeft,y:r.visualViewport.offsetTop}}function sF(e,r,i){return r===void 0&&(r=!1),!i||r&&i!==Ji(e)?!1:r}function Uc(e,r,i,c){r===void 0&&(r=!1),i===void 0&&(i=!1);const d=e.getBoundingClientRect(),g=Pw(e);let m=Ts(1);r&&(c?Xo(c)&&(m=xh(c)):m=xh(e));const l=sF(g,i,c)?rk(g):Ts(0);let E=(d.left+l.x)/m.x,P=(d.top+l.y)/m.y,R=d.width/m.x,N=d.height/m.y;if(g){const F=Ji(g),A=c&&Xo(c)?Ji(c):c;let X=F,Z=Gx(X);for(;Z&&c&&A!==X;){const ee=xh(Z),H=Z.getBoundingClientRect(),U=Ko(Z),W=H.left+(Z.clientLeft+parseFloat(U.paddingLeft))*ee.x,re=H.top+(Z.clientTop+parseFloat(U.paddingTop))*ee.y;E*=ee.x,P*=ee.y,R*=ee.x,N*=ee.y,E+=W,P+=re,X=Ji(Z),Z=Gx(X)}}return T_({width:R,height:N,x:E,y:P})}function Ew(e,r){const i=ay(e).scrollLeft;return r?r.left+i:Uc(ks(e)).left+i}function nk(e,r,i){i===void 0&&(i=!1);const c=e.getBoundingClientRect(),d=c.left+r.scrollLeft-(i?0:Ew(e,c)),g=c.top+r.scrollTop;return{x:d,y:g}}function aF(e){let{elements:r,rect:i,offsetParent:c,strategy:d}=e;const g=d==="fixed",m=ks(c),l=r?sy(r.floating):!1;if(c===m||l&&g)return i;let E={scrollLeft:0,scrollTop:0},P=Ts(1);const R=Ts(0),N=Ms(c);if((N||!N&&!g)&&((Kh(c)!=="body"||zp(m))&&(E=ay(c)),Ms(c))){const A=Uc(c);P=xh(c),R.x=A.x+c.clientLeft,R.y=A.y+c.clientTop}const F=m&&!N&&!g?nk(m,E,!0):Ts(0);return{width:i.width*P.x,height:i.height*P.y,x:i.x*P.x-E.scrollLeft*P.x+R.x+F.x,y:i.y*P.y-E.scrollTop*P.y+R.y+F.y}}function lF(e){return Array.from(e.getClientRects())}function cF(e){const r=ks(e),i=ay(e),c=e.ownerDocument.body,d=Xi(r.scrollWidth,r.clientWidth,c.scrollWidth,c.clientWidth),g=Xi(r.scrollHeight,r.clientHeight,c.scrollHeight,c.clientHeight);let m=-i.scrollLeft+Ew(e);const l=-i.scrollTop;return Ko(c).direction==="rtl"&&(m+=Xi(r.clientWidth,c.clientWidth)-d),{width:d,height:g,x:m,y:l}}function uF(e,r){const i=Ji(e),c=ks(e),d=i.visualViewport;let g=c.clientWidth,m=c.clientHeight,l=0,E=0;if(d){g=d.width,m=d.height;const P=Cw();(!P||P&&r==="fixed")&&(l=d.offsetLeft,E=d.offsetTop)}return{width:g,height:m,x:l,y:E}}const hF=new Set(["absolute","fixed"]);function dF(e,r){const i=Uc(e,!0,r==="fixed"),c=i.top+e.clientTop,d=i.left+e.clientLeft,g=Ms(e)?xh(e):Ts(1),m=e.clientWidth*g.x,l=e.clientHeight*g.y,E=d*g.x,P=c*g.y;return{width:m,height:l,x:E,y:P}}function sT(e,r,i){let c;if(r==="viewport")c=uF(e,i);else if(r==="document")c=cF(ks(e));else if(Xo(r))c=dF(r,i);else{const d=rk(e);c={x:r.x-d.x,y:r.y-d.y,width:r.width,height:r.height}}return T_(c)}function ik(e,r){const i=wl(e);return i===r||!Xo(i)||jh(i)?!1:Ko(i).position==="fixed"||ik(i,r)}function fF(e,r){const i=r.get(e);if(i)return i;let c=cp(e,[],!1).filter(l=>Xo(l)&&Kh(l)!=="body"),d=null;const g=Ko(e).position==="fixed";let m=g?wl(e):e;for(;Xo(m)&&!jh(m);){const l=Ko(m),E=Tw(m);!E&&l.position==="fixed"&&(d=null),(g?!E&&!d:!E&&l.position==="static"&&!!d&&hF.has(d.position)||zp(m)&&!E&&ik(e,m))?c=c.filter(R=>R!==m):d=l,m=wl(m)}return r.set(e,c),c}function pF(e){let{element:r,boundary:i,rootBoundary:c,strategy:d}=e;const m=[...i==="clippingAncestors"?sy(r)?[]:fF(r,this._c):[].concat(i),c],l=m[0],E=m.reduce((P,R)=>{const N=sT(r,R,d);return P.top=Xi(N.top,P.top),P.right=bl(N.right,P.right),P.bottom=bl(N.bottom,P.bottom),P.left=Xi(N.left,P.left),P},sT(r,l,d));return{width:E.right-E.left,height:E.bottom-E.top,x:E.left,y:E.top}}function mF(e){const{width:r,height:i}=tk(e);return{width:r,height:i}}function gF(e,r,i){const c=Ms(r),d=ks(r),g=i==="fixed",m=Uc(e,!0,g,r);let l={scrollLeft:0,scrollTop:0};const E=Ts(0);function P(){E.x=Ew(d)}if(c||!c&&!g)if((Kh(r)!=="body"||zp(d))&&(l=ay(r)),c){const A=Uc(r,!0,g,r);E.x=A.x+r.clientLeft,E.y=A.y+r.clientTop}else d&&P();g&&!c&&d&&P();const R=d&&!c&&!g?nk(d,l):Ts(0),N=m.left+l.scrollLeft-E.x-R.x,F=m.top+l.scrollTop-E.y-R.y;return{x:N,y:F,width:m.width,height:m.height}}function _0(e){return Ko(e).position==="static"}function aT(e,r){if(!Ms(e)||Ko(e).position==="fixed")return null;if(r)return r(e);let i=e.offsetParent;return ks(e)===i&&(i=i.ownerDocument.body),i}function ok(e,r){const i=Ji(e);if(sy(e))return i;if(!Ms(e)){let d=wl(e);for(;d&&!jh(d);){if(Xo(d)&&!_0(d))return d;d=wl(d)}return i}let c=aT(e,r);for(;c&&QO(c)&&_0(c);)c=aT(c,r);return c&&jh(c)&&_0(c)&&!Tw(c)?i:c||nF(e)||i}const _F=async function(e){const r=this.getOffsetParent||ok,i=this.getDimensions,c=await i(e.floating);return{reference:gF(e.reference,await r(e.floating),e.strategy),floating:{x:0,y:0,width:c.width,height:c.height}}};function yF(e){return Ko(e).direction==="rtl"}const vF={convertOffsetParentRelativeRectToViewportRelativeRect:aF,getDocumentElement:ks,getClippingRect:pF,getOffsetParent:ok,getElementRects:_F,getClientRects:lF,getDimensions:mF,getScale:xh,isElement:Xo,isRTL:yF};function sk(e,r){return e.x===r.x&&e.y===r.y&&e.width===r.width&&e.height===r.height}function xF(e,r){let i=null,c;const d=ks(e);function g(){var l;clearTimeout(c),(l=i)==null||l.disconnect(),i=null}function m(l,E){l===void 0&&(l=!1),E===void 0&&(E=1),g();const P=e.getBoundingClientRect(),{left:R,top:N,width:F,height:A}=P;if(l||r(),!F||!A)return;const X=_g(N),Z=_g(d.clientWidth-(R+F)),ee=_g(d.clientHeight-(N+A)),H=_g(R),W={rootMargin:-X+"px "+-Z+"px "+-ee+"px "+-H+"px",threshold:Xi(0,bl(1,E))||1};let re=!0;function ge(Te){const xe=Te[0].intersectionRatio;if(xe!==E){if(!re)return m();xe?m(!1,xe):c=setTimeout(()=>{m(!1,1e-7)},1e3)}xe===1&&!sk(P,e.getBoundingClientRect())&&m(),re=!1}try{i=new IntersectionObserver(ge,{...W,root:d.ownerDocument})}catch{i=new IntersectionObserver(ge,W)}i.observe(e)}return m(!0),g}function bF(e,r,i,c){c===void 0&&(c={});const{ancestorScroll:d=!0,ancestorResize:g=!0,elementResize:m=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:E=!1}=c,P=Pw(e),R=d||g?[...P?cp(P):[],...cp(r)]:[];R.forEach(H=>{d&&H.addEventListener("scroll",i,{passive:!0}),g&&H.addEventListener("resize",i)});const N=P&&l?xF(P,i):null;let F=-1,A=null;m&&(A=new ResizeObserver(H=>{let[U]=H;U&&U.target===P&&A&&(A.unobserve(r),cancelAnimationFrame(F),F=requestAnimationFrame(()=>{var W;(W=A)==null||W.observe(r)})),i()}),P&&!E&&A.observe(P),A.observe(r));let X,Z=E?Uc(e):null;E&&ee();function ee(){const H=Uc(e);Z&&!sk(Z,H)&&i(),Z=H,X=requestAnimationFrame(ee)}return i(),()=>{var H;R.forEach(U=>{d&&U.removeEventListener("scroll",i),g&&U.removeEventListener("resize",i)}),N==null||N(),(H=A)==null||H.disconnect(),A=null,E&&cancelAnimationFrame(X)}}const wF=HO,SF=WO,TF=VO,CF=XO,PF=ZO,lT=UO,EF=qO,MF=(e,r,i)=>{const c=new Map,d={platform:vF,...i},g={...d.platform,_c:c};return $O(e,r,{...d,platform:g})};var kF=typeof document<"u",IF=function(){},Gg=kF?Y.useLayoutEffect:IF;function C_(e,r){if(e===r)return!0;if(typeof e!=typeof r)return!1;if(typeof e=="function"&&e.toString()===r.toString())return!0;let i,c,d;if(e&&r&&typeof e=="object"){if(Array.isArray(e)){if(i=e.length,i!==r.length)return!1;for(c=i;c--!==0;)if(!C_(e[c],r[c]))return!1;return!0}if(d=Object.keys(e),i=d.length,i!==Object.keys(r).length)return!1;for(c=i;c--!==0;)if(!{}.hasOwnProperty.call(r,d[c]))return!1;for(c=i;c--!==0;){const g=d[c];if(!(g==="_owner"&&e.$$typeof)&&!C_(e[g],r[g]))return!1}return!0}return e!==e&&r!==r}function ak(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function cT(e,r){const i=ak(e);return Math.round(r*i)/i}function y0(e){const r=Y.useRef(e);return Gg(()=>{r.current=e}),r}function AF(e){e===void 0&&(e={});const{placement:r="bottom",strategy:i="absolute",middleware:c=[],platform:d,elements:{reference:g,floating:m}={},transform:l=!0,whileElementsMounted:E,open:P}=e,[R,N]=Y.useState({x:0,y:0,strategy:i,placement:r,middlewareData:{},isPositioned:!1}),[F,A]=Y.useState(c);C_(F,c)||A(c);const[X,Z]=Y.useState(null),[ee,H]=Y.useState(null),U=Y.useCallback(Ze=>{Ze!==Te.current&&(Te.current=Ze,Z(Ze))},[]),W=Y.useCallback(Ze=>{Ze!==xe.current&&(xe.current=Ze,H(Ze))},[]),re=g||X,ge=m||ee,Te=Y.useRef(null),xe=Y.useRef(null),ze=Y.useRef(R),Ne=E!=null,Ie=y0(E),$e=y0(d),et=y0(P),ot=Y.useCallback(()=>{if(!Te.current||!xe.current)return;const Ze={placement:r,strategy:i,middleware:F};$e.current&&(Ze.platform=$e.current),MF(Te.current,xe.current,Ze).then(He=>{const pt={...He,isPositioned:et.current!==!1};qe.current&&!C_(ze.current,pt)&&(ze.current=pt,Kc.flushSync(()=>{N(pt)}))})},[F,r,i,$e,et]);Gg(()=>{P===!1&&ze.current.isPositioned&&(ze.current.isPositioned=!1,N(Ze=>({...Ze,isPositioned:!1})))},[P]);const qe=Y.useRef(!1);Gg(()=>(qe.current=!0,()=>{qe.current=!1}),[]),Gg(()=>{if(re&&(Te.current=re),ge&&(xe.current=ge),re&&ge){if(Ie.current)return Ie.current(re,ge,ot);ot()}},[re,ge,ot,Ie,Ne]);const ht=Y.useMemo(()=>({reference:Te,floating:xe,setReference:U,setFloating:W}),[U,W]),dt=Y.useMemo(()=>({reference:re,floating:ge}),[re,ge]),wt=Y.useMemo(()=>{const Ze={position:i,left:0,top:0};if(!dt.floating)return Ze;const He=cT(dt.floating,R.x),pt=cT(dt.floating,R.y);return l?{...Ze,transform:"translate("+He+"px, "+pt+"px)",...ak(dt.floating)>=1.5&&{willChange:"transform"}}:{position:i,left:He,top:pt}},[i,l,dt.floating,R.x,R.y]);return Y.useMemo(()=>({...R,update:ot,refs:ht,elements:dt,floatingStyles:wt}),[R,ot,ht,dt,wt])}const zF=e=>{function r(i){return{}.hasOwnProperty.call(i,"current")}return{name:"arrow",options:e,fn(i){const{element:c,padding:d}=typeof e=="function"?e(i):e;return c&&r(c)?c.current!=null?lT({element:c.current,padding:d}).fn(i):{}:c?lT({element:c,padding:d}).fn(i):{}}}},RF=(e,r)=>({...wF(e),options:[e,r]}),DF=(e,r)=>({...SF(e),options:[e,r]}),LF=(e,r)=>({...EF(e),options:[e,r]}),OF=(e,r)=>({...TF(e),options:[e,r]}),FF=(e,r)=>({...CF(e),options:[e,r]}),NF=(e,r)=>({...PF(e),options:[e,r]}),BF=(e,r)=>({...zF(e),options:[e,r]});var jF="Arrow",lk=Y.forwardRef((e,r)=>{const{children:i,width:c=10,height:d=5,...g}=e;return ye.jsx(wr.svg,{...g,ref:r,width:c,height:d,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?i:ye.jsx("polygon",{points:"0,0 30,0 15,10"})})});lk.displayName=jF;var $F=lk;function UF(e){const[r,i]=Y.useState(void 0);return Kn(()=>{if(e){i({width:e.offsetWidth,height:e.offsetHeight});const c=new ResizeObserver(d=>{if(!Array.isArray(d)||!d.length)return;const g=d[0];let m,l;if("borderBoxSize"in g){const E=g.borderBoxSize,P=Array.isArray(E)?E[0]:E;m=P.inlineSize,l=P.blockSize}else m=e.offsetWidth,l=e.offsetHeight;i({width:m,height:l})});return c.observe(e,{box:"border-box"}),()=>c.unobserve(e)}else i(void 0)},[e]),r}var Mw="Popper",[ck,ly]=Ip(Mw),[VF,uk]=ck(Mw),hk=e=>{const{__scopePopper:r,children:i}=e,[c,d]=Y.useState(null);return ye.jsx(VF,{scope:r,anchor:c,onAnchorChange:d,children:i})};hk.displayName=Mw;var dk="PopperAnchor",fk=Y.forwardRef((e,r)=>{const{__scopePopper:i,virtualRef:c,...d}=e,g=uk(dk,i),m=Y.useRef(null),l=on(r,m);return Y.useEffect(()=>{g.onAnchorChange((c==null?void 0:c.current)||m.current)}),c?null:ye.jsx(wr.div,{...d,ref:l})});fk.displayName=dk;var kw="PopperContent",[ZF,GF]=ck(kw),pk=Y.forwardRef((e,r)=>{var gt,sr,Vt,tr,Dt,Qt;const{__scopePopper:i,side:c="bottom",sideOffset:d=0,align:g="center",alignOffset:m=0,arrowPadding:l=0,avoidCollisions:E=!0,collisionBoundary:P=[],collisionPadding:R=0,sticky:N="partial",hideWhenDetached:F=!1,updatePositionStrategy:A="optimized",onPlaced:X,...Z}=e,ee=uk(kw,i),[H,U]=Y.useState(null),W=on(r,Gt=>U(Gt)),[re,ge]=Y.useState(null),Te=UF(re),xe=(Te==null?void 0:Te.width)??0,ze=(Te==null?void 0:Te.height)??0,Ne=c+(g!=="center"?"-"+g:""),Ie=typeof R=="number"?R:{top:0,right:0,bottom:0,left:0,...R},$e=Array.isArray(P)?P:[P],et=$e.length>0,ot={padding:Ie,boundary:$e.filter(WF),altBoundary:et},{refs:qe,floatingStyles:ht,placement:dt,isPositioned:wt,middlewareData:Ze}=AF({strategy:"fixed",placement:Ne,whileElementsMounted:(...Gt)=>bF(...Gt,{animationFrame:A==="always"}),elements:{reference:ee.anchor},middleware:[RF({mainAxis:d+ze,alignmentAxis:m}),E&&DF({mainAxis:!0,crossAxis:!1,limiter:N==="partial"?LF():void 0,...ot}),E&&OF({...ot}),FF({...ot,apply:({elements:Gt,rects:Rr,availableWidth:Yr,availableHeight:Nn})=>{const{width:Sr,height:sn}=Rr.reference,Zr=Gt.floating.style;Zr.setProperty("--radix-popper-available-width",`${Yr}px`),Zr.setProperty("--radix-popper-available-height",`${Nn}px`),Zr.setProperty("--radix-popper-anchor-width",`${Sr}px`),Zr.setProperty("--radix-popper-anchor-height",`${sn}px`)}}),re&&BF({element:re,padding:l}),qF({arrowWidth:xe,arrowHeight:ze}),F&&NF({strategy:"referenceHidden",...ot})]}),[He,pt]=_k(dt),Ct=qo(X);Kn(()=>{wt&&(Ct==null||Ct())},[wt,Ct]);const ut=(gt=Ze.arrow)==null?void 0:gt.x,At=(sr=Ze.arrow)==null?void 0:sr.y,kt=((Vt=Ze.arrow)==null?void 0:Vt.centerOffset)!==0,[nr,dr]=Y.useState();return Kn(()=>{H&&dr(window.getComputedStyle(H).zIndex)},[H]),ye.jsx("div",{ref:qe.setFloating,"data-radix-popper-content-wrapper":"",style:{...ht,transform:wt?ht.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:nr,"--radix-popper-transform-origin":[(tr=Ze.transformOrigin)==null?void 0:tr.x,(Dt=Ze.transformOrigin)==null?void 0:Dt.y].join(" "),...((Qt=Ze.hide)==null?void 0:Qt.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:ye.jsx(ZF,{scope:i,placedSide:He,onArrowChange:ge,arrowX:ut,arrowY:At,shouldHideArrow:kt,children:ye.jsx(wr.div,{"data-side":He,"data-align":pt,...Z,ref:W,style:{...Z.style,animation:wt?void 0:"none"}})})})});pk.displayName=kw;var mk="PopperArrow",HF={top:"bottom",right:"left",bottom:"top",left:"right"},gk=Y.forwardRef(function(r,i){const{__scopePopper:c,...d}=r,g=GF(mk,c),m=HF[g.placedSide];return ye.jsx("span",{ref:g.onArrowChange,style:{position:"absolute",left:g.arrowX,top:g.arrowY,[m]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[g.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[g.placedSide],visibility:g.shouldHideArrow?"hidden":void 0},children:ye.jsx($F,{...d,ref:i,style:{...d.style,display:"block"}})})});gk.displayName=mk;function WF(e){return e!==null}var qF=e=>({name:"transformOrigin",options:e,fn(r){var ee,H,U;const{placement:i,rects:c,middlewareData:d}=r,m=((ee=d.arrow)==null?void 0:ee.centerOffset)!==0,l=m?0:e.arrowWidth,E=m?0:e.arrowHeight,[P,R]=_k(i),N={start:"0%",center:"50%",end:"100%"}[R],F=(((H=d.arrow)==null?void 0:H.x)??0)+l/2,A=(((U=d.arrow)==null?void 0:U.y)??0)+E/2;let X="",Z="";return P==="bottom"?(X=m?N:`${F}px`,Z=`${-E}px`):P==="top"?(X=m?N:`${F}px`,Z=`${c.floating.height+E}px`):P==="right"?(X=`${-E}px`,Z=m?N:`${A}px`):P==="left"&&(X=`${c.floating.width+E}px`,Z=m?N:`${A}px`),{data:{x:X,y:Z}}}});function _k(e){const[r,i="center"]=e.split("-");return[r,i]}var XF=hk,yk=fk,vk=pk,xk=gk,[cy,mU]=Ip("Tooltip",[ly]),Iw=ly(),bk="TooltipProvider",KF=700,uT="tooltip.open",[YF,wk]=cy(bk),Sk=e=>{const{__scopeTooltip:r,delayDuration:i=KF,skipDelayDuration:c=300,disableHoverableContent:d=!1,children:g}=e,m=Y.useRef(!0),l=Y.useRef(!1),E=Y.useRef(0);return Y.useEffect(()=>{const P=E.current;return()=>window.clearTimeout(P)},[]),ye.jsx(YF,{scope:r,isOpenDelayedRef:m,delayDuration:i,onOpen:Y.useCallback(()=>{window.clearTimeout(E.current),m.current=!1},[]),onClose:Y.useCallback(()=>{window.clearTimeout(E.current),E.current=window.setTimeout(()=>m.current=!0,c)},[c]),isPointerInTransitRef:l,onPointerInTransitChange:Y.useCallback(P=>{l.current=P},[]),disableHoverableContent:d,children:g})};Sk.displayName=bk;var Tk="Tooltip",[gU,uy]=cy(Tk),Hx="TooltipTrigger",QF=Y.forwardRef((e,r)=>{const{__scopeTooltip:i,...c}=e,d=uy(Hx,i),g=wk(Hx,i),m=Iw(i),l=Y.useRef(null),E=on(r,l,d.onTriggerChange),P=Y.useRef(!1),R=Y.useRef(!1),N=Y.useCallback(()=>P.current=!1,[]);return Y.useEffect(()=>()=>document.removeEventListener("pointerup",N),[N]),ye.jsx(yk,{asChild:!0,...m,children:ye.jsx(wr.button,{"aria-describedby":d.open?d.contentId:void 0,"data-state":d.stateAttribute,...c,ref:E,onPointerMove:ar(e.onPointerMove,F=>{F.pointerType!=="touch"&&!R.current&&!g.isPointerInTransitRef.current&&(d.onTriggerEnter(),R.current=!0)}),onPointerLeave:ar(e.onPointerLeave,()=>{d.onTriggerLeave(),R.current=!1}),onPointerDown:ar(e.onPointerDown,()=>{d.open&&d.onClose(),P.current=!0,document.addEventListener("pointerup",N,{once:!0})}),onFocus:ar(e.onFocus,()=>{P.current||d.onOpen()}),onBlur:ar(e.onBlur,d.onClose),onClick:ar(e.onClick,d.onClose)})})});QF.displayName=Hx;var JF="TooltipPortal",[_U,e4]=cy(JF,{forceMount:void 0}),$h="TooltipContent",Ck=Y.forwardRef((e,r)=>{const i=e4($h,e.__scopeTooltip),{forceMount:c=i.forceMount,side:d="top",...g}=e,m=uy($h,e.__scopeTooltip);return ye.jsx(mw,{present:c||m.open,children:m.disableHoverableContent?ye.jsx(Pk,{side:d,...g,ref:r}):ye.jsx(t4,{side:d,...g,ref:r})})}),t4=Y.forwardRef((e,r)=>{const i=uy($h,e.__scopeTooltip),c=wk($h,e.__scopeTooltip),d=Y.useRef(null),g=on(r,d),[m,l]=Y.useState(null),{trigger:E,onClose:P}=i,R=d.current,{onPointerInTransitChange:N}=c,F=Y.useCallback(()=>{l(null),N(!1)},[N]),A=Y.useCallback((X,Z)=>{const ee=X.currentTarget,H={x:X.clientX,y:X.clientY},U=s4(H,ee.getBoundingClientRect()),W=a4(H,U),re=l4(Z.getBoundingClientRect()),ge=u4([...W,...re]);l(ge),N(!0)},[N]);return Y.useEffect(()=>()=>F(),[F]),Y.useEffect(()=>{if(E&&R){const X=ee=>A(ee,R),Z=ee=>A(ee,E);return E.addEventListener("pointerleave",X),R.addEventListener("pointerleave",Z),()=>{E.removeEventListener("pointerleave",X),R.removeEventListener("pointerleave",Z)}}},[E,R,A,F]),Y.useEffect(()=>{if(m){const X=Z=>{const ee=Z.target,H={x:Z.clientX,y:Z.clientY},U=(E==null?void 0:E.contains(ee))||(R==null?void 0:R.contains(ee)),W=!c4(H,m);U?F():W&&(F(),P())};return document.addEventListener("pointermove",X),()=>document.removeEventListener("pointermove",X)}},[E,R,m,P,F]),ye.jsx(Pk,{...e,ref:g})}),[r4,n4]=cy(Tk,{isInside:!1}),i4=_3("TooltipContent"),Pk=Y.forwardRef((e,r)=>{const{__scopeTooltip:i,children:c,"aria-label":d,onEscapeKeyDown:g,onPointerDownOutside:m,...l}=e,E=uy($h,i),P=Iw(i),{onClose:R}=E;return Y.useEffect(()=>(document.addEventListener(uT,R),()=>document.removeEventListener(uT,R)),[R]),Y.useEffect(()=>{if(E.trigger){const N=F=>{const A=F.target;A!=null&&A.contains(E.trigger)&&R()};return window.addEventListener("scroll",N,{capture:!0}),()=>window.removeEventListener("scroll",N,{capture:!0})}},[E.trigger,R]),ye.jsx(ry,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:g,onPointerDownOutside:m,onFocusOutside:N=>N.preventDefault(),onDismiss:R,children:ye.jsxs(vk,{"data-state":E.stateAttribute,...P,...l,ref:r,style:{...l.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[ye.jsx(i4,{children:c}),ye.jsx(r4,{scope:i,isInside:!0,children:ye.jsx(B3,{id:E.contentId,role:"tooltip",children:d||c})})]})})});Ck.displayName=$h;var Ek="TooltipArrow",o4=Y.forwardRef((e,r)=>{const{__scopeTooltip:i,...c}=e,d=Iw(i);return n4(Ek,i).isInside?null:ye.jsx(xk,{...d,...c,ref:r})});o4.displayName=Ek;function s4(e,r){const i=Math.abs(r.top-e.y),c=Math.abs(r.bottom-e.y),d=Math.abs(r.right-e.x),g=Math.abs(r.left-e.x);switch(Math.min(i,c,d,g)){case g:return"left";case d:return"right";case i:return"top";case c:return"bottom";default:throw new Error("unreachable")}}function a4(e,r,i=5){const c=[];switch(r){case"top":c.push({x:e.x-i,y:e.y+i},{x:e.x+i,y:e.y+i});break;case"bottom":c.push({x:e.x-i,y:e.y-i},{x:e.x+i,y:e.y-i});break;case"left":c.push({x:e.x+i,y:e.y-i},{x:e.x+i,y:e.y+i});break;case"right":c.push({x:e.x-i,y:e.y-i},{x:e.x-i,y:e.y+i});break}return c}function l4(e){const{top:r,right:i,bottom:c,left:d}=e;return[{x:d,y:r},{x:i,y:r},{x:i,y:c},{x:d,y:c}]}function c4(e,r){const{x:i,y:c}=e;let d=!1;for(let g=0,m=r.length-1;g<r.length;m=g++){const l=r[g],E=r[m],P=l.x,R=l.y,N=E.x,F=E.y;R>c!=F>c&&i<(N-P)*(c-R)/(F-R)+P&&(d=!d)}return d}function u4(e){const r=e.slice();return r.sort((i,c)=>i.x<c.x?-1:i.x>c.x?1:i.y<c.y?-1:i.y>c.y?1:0),h4(r)}function h4(e){if(e.length<=1)return e.slice();const r=[];for(let c=0;c<e.length;c++){const d=e[c];for(;r.length>=2;){const g=r[r.length-1],m=r[r.length-2];if((g.x-m.x)*(d.y-m.y)>=(g.y-m.y)*(d.x-m.x))r.pop();else break}r.push(d)}r.pop();const i=[];for(let c=e.length-1;c>=0;c--){const d=e[c];for(;i.length>=2;){const g=i[i.length-1],m=i[i.length-2];if((g.x-m.x)*(d.y-m.y)>=(g.y-m.y)*(d.x-m.x))i.pop();else break}i.push(d)}return i.pop(),r.length===1&&i.length===1&&r[0].x===i[0].x&&r[0].y===i[0].y?r:r.concat(i)}var d4=Sk,Mk=Ck;const f4=d4,p4=Y.forwardRef(({className:e,sideOffset:r=4,...i},c)=>ye.jsx(Mk,{ref:c,sideOffset:r,className:Kr("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...i}));p4.displayName=Mk.displayName;var hy=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},dy=typeof window>"u"||"Deno"in globalThis;function Bo(){}function m4(e,r){return typeof e=="function"?e(r):e}function g4(e){return typeof e=="number"&&e>=0&&e!==1/0}function _4(e,r){return Math.max(e+(r||0)-Date.now(),0)}function Wx(e,r){return typeof e=="function"?e(r):e}function y4(e,r){return typeof e=="function"?e(r):e}function hT(e,r){const{type:i="all",exact:c,fetchStatus:d,predicate:g,queryKey:m,stale:l}=e;if(m){if(c){if(r.queryHash!==Aw(m,r.options))return!1}else if(!hp(r.queryKey,m))return!1}if(i!=="all"){const E=r.isActive();if(i==="active"&&!E||i==="inactive"&&E)return!1}return!(typeof l=="boolean"&&r.isStale()!==l||d&&d!==r.state.fetchStatus||g&&!g(r))}function dT(e,r){const{exact:i,status:c,predicate:d,mutationKey:g}=e;if(g){if(!r.options.mutationKey)return!1;if(i){if(up(r.options.mutationKey)!==up(g))return!1}else if(!hp(r.options.mutationKey,g))return!1}return!(c&&r.state.status!==c||d&&!d(r))}function Aw(e,r){return((r==null?void 0:r.queryKeyHashFn)||up)(e)}function up(e){return JSON.stringify(e,(r,i)=>qx(i)?Object.keys(i).sort().reduce((c,d)=>(c[d]=i[d],c),{}):i)}function hp(e,r){return e===r?!0:typeof e!=typeof r?!1:e&&r&&typeof e=="object"&&typeof r=="object"?Object.keys(r).every(i=>hp(e[i],r[i])):!1}function kk(e,r){if(e===r)return e;const i=fT(e)&&fT(r);if(i||qx(e)&&qx(r)){const c=i?e:Object.keys(e),d=c.length,g=i?r:Object.keys(r),m=g.length,l=i?[]:{},E=new Set(c);let P=0;for(let R=0;R<m;R++){const N=i?R:g[R];(!i&&E.has(N)||i)&&e[N]===void 0&&r[N]===void 0?(l[N]=void 0,P++):(l[N]=kk(e[N],r[N]),l[N]===e[N]&&e[N]!==void 0&&P++)}return d===m&&P===d?e:l}return r}function fT(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function qx(e){if(!pT(e))return!1;const r=e.constructor;if(r===void 0)return!0;const i=r.prototype;return!(!pT(i)||!i.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function pT(e){return Object.prototype.toString.call(e)==="[object Object]"}function v4(e){return new Promise(r=>{setTimeout(r,e)})}function x4(e,r,i){return typeof i.structuralSharing=="function"?i.structuralSharing(e,r):i.structuralSharing!==!1?kk(e,r):r}function b4(e,r,i=0){const c=[...e,r];return i&&c.length>i?c.slice(1):c}function w4(e,r,i=0){const c=[r,...e];return i&&c.length>i?c.slice(0,-1):c}var zw=Symbol();function Ik(e,r){return!e.queryFn&&(r!=null&&r.initialPromise)?()=>r.initialPromise:!e.queryFn||e.queryFn===zw?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var Mc,Ja,Ch,$C,S4=($C=class extends hy{constructor(){super();fr(this,Mc);fr(this,Ja);fr(this,Ch);Zt(this,Ch,r=>{if(!dy&&window.addEventListener){const i=()=>r();return window.addEventListener("visibilitychange",i,!1),()=>{window.removeEventListener("visibilitychange",i)}}})}onSubscribe(){Je(this,Ja)||this.setEventListener(Je(this,Ch))}onUnsubscribe(){var r;this.hasListeners()||((r=Je(this,Ja))==null||r.call(this),Zt(this,Ja,void 0))}setEventListener(r){var i;Zt(this,Ch,r),(i=Je(this,Ja))==null||i.call(this),Zt(this,Ja,r(c=>{typeof c=="boolean"?this.setFocused(c):this.onFocus()}))}setFocused(r){Je(this,Mc)!==r&&(Zt(this,Mc,r),this.onFocus())}onFocus(){const r=this.isFocused();this.listeners.forEach(i=>{i(r)})}isFocused(){var r;return typeof Je(this,Mc)=="boolean"?Je(this,Mc):((r=globalThis.document)==null?void 0:r.visibilityState)!=="hidden"}},Mc=new WeakMap,Ja=new WeakMap,Ch=new WeakMap,$C),Ak=new S4,Ph,el,Eh,UC,T4=(UC=class extends hy{constructor(){super();fr(this,Ph,!0);fr(this,el);fr(this,Eh);Zt(this,Eh,r=>{if(!dy&&window.addEventListener){const i=()=>r(!0),c=()=>r(!1);return window.addEventListener("online",i,!1),window.addEventListener("offline",c,!1),()=>{window.removeEventListener("online",i),window.removeEventListener("offline",c)}}})}onSubscribe(){Je(this,el)||this.setEventListener(Je(this,Eh))}onUnsubscribe(){var r;this.hasListeners()||((r=Je(this,el))==null||r.call(this),Zt(this,el,void 0))}setEventListener(r){var i;Zt(this,Eh,r),(i=Je(this,el))==null||i.call(this),Zt(this,el,r(this.setOnline.bind(this)))}setOnline(r){Je(this,Ph)!==r&&(Zt(this,Ph,r),this.listeners.forEach(c=>{c(r)}))}isOnline(){return Je(this,Ph)}},Ph=new WeakMap,el=new WeakMap,Eh=new WeakMap,UC),P_=new T4;function C4(){let e,r;const i=new Promise((d,g)=>{e=d,r=g});i.status="pending",i.catch(()=>{});function c(d){Object.assign(i,d),delete i.resolve,delete i.reject}return i.resolve=d=>{c({status:"fulfilled",value:d}),e(d)},i.reject=d=>{c({status:"rejected",reason:d}),r(d)},i}function P4(e){return Math.min(1e3*2**e,3e4)}function zk(e){return(e??"online")==="online"?P_.isOnline():!0}var Rk=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function v0(e){return e instanceof Rk}function Dk(e){let r=!1,i=0,c=!1,d;const g=C4(),m=Z=>{var ee;c||(F(new Rk(Z)),(ee=e.abort)==null||ee.call(e))},l=()=>{r=!0},E=()=>{r=!1},P=()=>Ak.isFocused()&&(e.networkMode==="always"||P_.isOnline())&&e.canRun(),R=()=>zk(e.networkMode)&&e.canRun(),N=Z=>{var ee;c||(c=!0,(ee=e.onSuccess)==null||ee.call(e,Z),d==null||d(),g.resolve(Z))},F=Z=>{var ee;c||(c=!0,(ee=e.onError)==null||ee.call(e,Z),d==null||d(),g.reject(Z))},A=()=>new Promise(Z=>{var ee;d=H=>{(c||P())&&Z(H)},(ee=e.onPause)==null||ee.call(e)}).then(()=>{var Z;d=void 0,c||(Z=e.onContinue)==null||Z.call(e)}),X=()=>{if(c)return;let Z;const ee=i===0?e.initialPromise:void 0;try{Z=ee??e.fn()}catch(H){Z=Promise.reject(H)}Promise.resolve(Z).then(N).catch(H=>{var Te;if(c)return;const U=e.retry??(dy?0:3),W=e.retryDelay??P4,re=typeof W=="function"?W(i,H):W,ge=U===!0||typeof U=="number"&&i<U||typeof U=="function"&&U(i,H);if(r||!ge){F(H);return}i++,(Te=e.onFail)==null||Te.call(e,i,H),v4(re).then(()=>P()?void 0:A()).then(()=>{r?F(H):X()})})};return{promise:g,cancel:m,continue:()=>(d==null||d(),g),cancelRetry:l,continueRetry:E,canStart:R,start:()=>(R()?X():A().then(X),g)}}var E4=e=>setTimeout(e,0);function M4(){let e=[],r=0,i=l=>{l()},c=l=>{l()},d=E4;const g=l=>{r?e.push(l):d(()=>{i(l)})},m=()=>{const l=e;e=[],l.length&&d(()=>{c(()=>{l.forEach(E=>{i(E)})})})};return{batch:l=>{let E;r++;try{E=l()}finally{r--,r||m()}return E},batchCalls:l=>(...E)=>{g(()=>{l(...E)})},schedule:g,setNotifyFunction:l=>{i=l},setBatchNotifyFunction:l=>{c=l},setScheduler:l=>{d=l}}}var yi=M4(),kc,VC,Lk=(VC=class{constructor(){fr(this,kc)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),g4(this.gcTime)&&Zt(this,kc,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(dy?1/0:5*60*1e3))}clearGcTimeout(){Je(this,kc)&&(clearTimeout(Je(this,kc)),Zt(this,kc,void 0))}},kc=new WeakMap,VC),Mh,Ic,ho,Ac,ai,Sp,zc,jo,Xs,ZC,k4=(ZC=class extends Lk{constructor(r){super();fr(this,jo);fr(this,Mh);fr(this,Ic);fr(this,ho);fr(this,Ac);fr(this,ai);fr(this,Sp);fr(this,zc);Zt(this,zc,!1),Zt(this,Sp,r.defaultOptions),this.setOptions(r.options),this.observers=[],Zt(this,Ac,r.client),Zt(this,ho,Je(this,Ac).getQueryCache()),this.queryKey=r.queryKey,this.queryHash=r.queryHash,Zt(this,Mh,A4(this.options)),this.state=r.state??Je(this,Mh),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var r;return(r=Je(this,ai))==null?void 0:r.promise}setOptions(r){this.options={...Je(this,Sp),...r},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&Je(this,ho).remove(this)}setData(r,i){const c=x4(this.state.data,r,this.options);return ii(this,jo,Xs).call(this,{data:c,type:"success",dataUpdatedAt:i==null?void 0:i.updatedAt,manual:i==null?void 0:i.manual}),c}setState(r,i){ii(this,jo,Xs).call(this,{type:"setState",state:r,setStateOptions:i})}cancel(r){var c,d;const i=(c=Je(this,ai))==null?void 0:c.promise;return(d=Je(this,ai))==null||d.cancel(r),i?i.then(Bo).catch(Bo):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Je(this,Mh))}isActive(){return this.observers.some(r=>y4(r.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===zw||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(r=>Wx(r.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(r=>r.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(r=0){return this.state.data===void 0?!0:r==="static"?!1:this.state.isInvalidated?!0:!_4(this.state.dataUpdatedAt,r)}onFocus(){var i;const r=this.observers.find(c=>c.shouldFetchOnWindowFocus());r==null||r.refetch({cancelRefetch:!1}),(i=Je(this,ai))==null||i.continue()}onOnline(){var i;const r=this.observers.find(c=>c.shouldFetchOnReconnect());r==null||r.refetch({cancelRefetch:!1}),(i=Je(this,ai))==null||i.continue()}addObserver(r){this.observers.includes(r)||(this.observers.push(r),this.clearGcTimeout(),Je(this,ho).notify({type:"observerAdded",query:this,observer:r}))}removeObserver(r){this.observers.includes(r)&&(this.observers=this.observers.filter(i=>i!==r),this.observers.length||(Je(this,ai)&&(Je(this,zc)?Je(this,ai).cancel({revert:!0}):Je(this,ai).cancelRetry()),this.scheduleGc()),Je(this,ho).notify({type:"observerRemoved",query:this,observer:r}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||ii(this,jo,Xs).call(this,{type:"invalidate"})}fetch(r,i){var P,R,N;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(i!=null&&i.cancelRefetch))this.cancel({silent:!0});else if(Je(this,ai))return Je(this,ai).continueRetry(),Je(this,ai).promise}if(r&&this.setOptions(r),!this.options.queryFn){const F=this.observers.find(A=>A.options.queryFn);F&&this.setOptions(F.options)}const c=new AbortController,d=F=>{Object.defineProperty(F,"signal",{enumerable:!0,get:()=>(Zt(this,zc,!0),c.signal)})},g=()=>{const F=Ik(this.options,i),X=(()=>{const Z={client:Je(this,Ac),queryKey:this.queryKey,meta:this.meta};return d(Z),Z})();return Zt(this,zc,!1),this.options.persister?this.options.persister(F,X,this):F(X)},l=(()=>{const F={fetchOptions:i,options:this.options,queryKey:this.queryKey,client:Je(this,Ac),state:this.state,fetchFn:g};return d(F),F})();(P=this.options.behavior)==null||P.onFetch(l,this),Zt(this,Ic,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((R=l.fetchOptions)==null?void 0:R.meta))&&ii(this,jo,Xs).call(this,{type:"fetch",meta:(N=l.fetchOptions)==null?void 0:N.meta});const E=F=>{var A,X,Z,ee;v0(F)&&F.silent||ii(this,jo,Xs).call(this,{type:"error",error:F}),v0(F)||((X=(A=Je(this,ho).config).onError)==null||X.call(A,F,this),(ee=(Z=Je(this,ho).config).onSettled)==null||ee.call(Z,this.state.data,F,this)),this.scheduleGc()};return Zt(this,ai,Dk({initialPromise:i==null?void 0:i.initialPromise,fn:l.fetchFn,abort:c.abort.bind(c),onSuccess:F=>{var A,X,Z,ee;if(F===void 0){E(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(F)}catch(H){E(H);return}(X=(A=Je(this,ho).config).onSuccess)==null||X.call(A,F,this),(ee=(Z=Je(this,ho).config).onSettled)==null||ee.call(Z,F,this.state.error,this),this.scheduleGc()},onError:E,onFail:(F,A)=>{ii(this,jo,Xs).call(this,{type:"failed",failureCount:F,error:A})},onPause:()=>{ii(this,jo,Xs).call(this,{type:"pause"})},onContinue:()=>{ii(this,jo,Xs).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0})),Je(this,ai).start()}},Mh=new WeakMap,Ic=new WeakMap,ho=new WeakMap,Ac=new WeakMap,ai=new WeakMap,Sp=new WeakMap,zc=new WeakMap,jo=new WeakSet,Xs=function(r){const i=c=>{switch(r.type){case"failed":return{...c,fetchFailureCount:r.failureCount,fetchFailureReason:r.error};case"pause":return{...c,fetchStatus:"paused"};case"continue":return{...c,fetchStatus:"fetching"};case"fetch":return{...c,...I4(c.data,this.options),fetchMeta:r.meta??null};case"success":return Zt(this,Ic,void 0),{...c,data:r.data,dataUpdateCount:c.dataUpdateCount+1,dataUpdatedAt:r.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!r.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const d=r.error;return v0(d)&&d.revert&&Je(this,Ic)?{...Je(this,Ic),fetchStatus:"idle"}:{...c,error:d,errorUpdateCount:c.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:c.fetchFailureCount+1,fetchFailureReason:d,fetchStatus:"idle",status:"error"};case"invalidate":return{...c,isInvalidated:!0};case"setState":return{...c,...r.state}}};this.state=i(this.state),yi.batch(()=>{this.observers.forEach(c=>{c.onQueryUpdate()}),Je(this,ho).notify({query:this,type:"updated",action:r})})},ZC);function I4(e,r){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:zk(r.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function A4(e){const r=typeof e.initialData=="function"?e.initialData():e.initialData,i=r!==void 0,c=i?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:r,dataUpdateCount:0,dataUpdatedAt:i?c??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:i?"success":"pending",fetchStatus:"idle"}}var ms,GC,z4=(GC=class extends hy{constructor(r={}){super();fr(this,ms);this.config=r,Zt(this,ms,new Map)}build(r,i,c){const d=i.queryKey,g=i.queryHash??Aw(d,i);let m=this.get(g);return m||(m=new k4({client:r,queryKey:d,queryHash:g,options:r.defaultQueryOptions(i),state:c,defaultOptions:r.getQueryDefaults(d)}),this.add(m)),m}add(r){Je(this,ms).has(r.queryHash)||(Je(this,ms).set(r.queryHash,r),this.notify({type:"added",query:r}))}remove(r){const i=Je(this,ms).get(r.queryHash);i&&(r.destroy(),i===r&&Je(this,ms).delete(r.queryHash),this.notify({type:"removed",query:r}))}clear(){yi.batch(()=>{this.getAll().forEach(r=>{this.remove(r)})})}get(r){return Je(this,ms).get(r)}getAll(){return[...Je(this,ms).values()]}find(r){const i={exact:!0,...r};return this.getAll().find(c=>hT(i,c))}findAll(r={}){const i=this.getAll();return Object.keys(r).length>0?i.filter(c=>hT(r,c)):i}notify(r){yi.batch(()=>{this.listeners.forEach(i=>{i(r)})})}onFocus(){yi.batch(()=>{this.getAll().forEach(r=>{r.onFocus()})})}onOnline(){yi.batch(()=>{this.getAll().forEach(r=>{r.onOnline()})})}},ms=new WeakMap,GC),gs,gi,Rc,_s,Ha,HC,R4=(HC=class extends Lk{constructor(r){super();fr(this,_s);fr(this,gs);fr(this,gi);fr(this,Rc);this.mutationId=r.mutationId,Zt(this,gi,r.mutationCache),Zt(this,gs,[]),this.state=r.state||D4(),this.setOptions(r.options),this.scheduleGc()}setOptions(r){this.options=r,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(r){Je(this,gs).includes(r)||(Je(this,gs).push(r),this.clearGcTimeout(),Je(this,gi).notify({type:"observerAdded",mutation:this,observer:r}))}removeObserver(r){Zt(this,gs,Je(this,gs).filter(i=>i!==r)),this.scheduleGc(),Je(this,gi).notify({type:"observerRemoved",mutation:this,observer:r})}optionalRemove(){Je(this,gs).length||(this.state.status==="pending"?this.scheduleGc():Je(this,gi).remove(this))}continue(){var r;return((r=Je(this,Rc))==null?void 0:r.continue())??this.execute(this.state.variables)}async execute(r){var g,m,l,E,P,R,N,F,A,X,Z,ee,H,U,W,re,ge,Te,xe,ze;const i=()=>{ii(this,_s,Ha).call(this,{type:"continue"})};Zt(this,Rc,Dk({fn:()=>this.options.mutationFn?this.options.mutationFn(r):Promise.reject(new Error("No mutationFn found")),onFail:(Ne,Ie)=>{ii(this,_s,Ha).call(this,{type:"failed",failureCount:Ne,error:Ie})},onPause:()=>{ii(this,_s,Ha).call(this,{type:"pause"})},onContinue:i,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Je(this,gi).canRun(this)}));const c=this.state.status==="pending",d=!Je(this,Rc).canStart();try{if(c)i();else{ii(this,_s,Ha).call(this,{type:"pending",variables:r,isPaused:d}),await((m=(g=Je(this,gi).config).onMutate)==null?void 0:m.call(g,r,this));const Ie=await((E=(l=this.options).onMutate)==null?void 0:E.call(l,r));Ie!==this.state.context&&ii(this,_s,Ha).call(this,{type:"pending",context:Ie,variables:r,isPaused:d})}const Ne=await Je(this,Rc).start();return await((R=(P=Je(this,gi).config).onSuccess)==null?void 0:R.call(P,Ne,r,this.state.context,this)),await((F=(N=this.options).onSuccess)==null?void 0:F.call(N,Ne,r,this.state.context)),await((X=(A=Je(this,gi).config).onSettled)==null?void 0:X.call(A,Ne,null,this.state.variables,this.state.context,this)),await((ee=(Z=this.options).onSettled)==null?void 0:ee.call(Z,Ne,null,r,this.state.context)),ii(this,_s,Ha).call(this,{type:"success",data:Ne}),Ne}catch(Ne){try{throw await((U=(H=Je(this,gi).config).onError)==null?void 0:U.call(H,Ne,r,this.state.context,this)),await((re=(W=this.options).onError)==null?void 0:re.call(W,Ne,r,this.state.context)),await((Te=(ge=Je(this,gi).config).onSettled)==null?void 0:Te.call(ge,void 0,Ne,this.state.variables,this.state.context,this)),await((ze=(xe=this.options).onSettled)==null?void 0:ze.call(xe,void 0,Ne,r,this.state.context)),Ne}finally{ii(this,_s,Ha).call(this,{type:"error",error:Ne})}}finally{Je(this,gi).runNext(this)}}},gs=new WeakMap,gi=new WeakMap,Rc=new WeakMap,_s=new WeakSet,Ha=function(r){const i=c=>{switch(r.type){case"failed":return{...c,failureCount:r.failureCount,failureReason:r.error};case"pause":return{...c,isPaused:!0};case"continue":return{...c,isPaused:!1};case"pending":return{...c,context:r.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:r.isPaused,status:"pending",variables:r.variables,submittedAt:Date.now()};case"success":return{...c,data:r.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...c,data:void 0,error:r.error,failureCount:c.failureCount+1,failureReason:r.error,isPaused:!1,status:"error"}}};this.state=i(this.state),yi.batch(()=>{Je(this,gs).forEach(c=>{c.onMutationUpdate(r)}),Je(this,gi).notify({mutation:this,type:"updated",action:r})})},HC);function D4(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var ea,$o,Tp,WC,L4=(WC=class extends hy{constructor(r={}){super();fr(this,ea);fr(this,$o);fr(this,Tp);this.config=r,Zt(this,ea,new Set),Zt(this,$o,new Map),Zt(this,Tp,0)}build(r,i,c){const d=new R4({mutationCache:this,mutationId:++Km(this,Tp)._,options:r.defaultMutationOptions(i),state:c});return this.add(d),d}add(r){Je(this,ea).add(r);const i=yg(r);if(typeof i=="string"){const c=Je(this,$o).get(i);c?c.push(r):Je(this,$o).set(i,[r])}this.notify({type:"added",mutation:r})}remove(r){if(Je(this,ea).delete(r)){const i=yg(r);if(typeof i=="string"){const c=Je(this,$o).get(i);if(c)if(c.length>1){const d=c.indexOf(r);d!==-1&&c.splice(d,1)}else c[0]===r&&Je(this,$o).delete(i)}}this.notify({type:"removed",mutation:r})}canRun(r){const i=yg(r);if(typeof i=="string"){const c=Je(this,$o).get(i),d=c==null?void 0:c.find(g=>g.state.status==="pending");return!d||d===r}else return!0}runNext(r){var c;const i=yg(r);if(typeof i=="string"){const d=(c=Je(this,$o).get(i))==null?void 0:c.find(g=>g!==r&&g.state.isPaused);return(d==null?void 0:d.continue())??Promise.resolve()}else return Promise.resolve()}clear(){yi.batch(()=>{Je(this,ea).forEach(r=>{this.notify({type:"removed",mutation:r})}),Je(this,ea).clear(),Je(this,$o).clear()})}getAll(){return Array.from(Je(this,ea))}find(r){const i={exact:!0,...r};return this.getAll().find(c=>dT(i,c))}findAll(r={}){return this.getAll().filter(i=>dT(r,i))}notify(r){yi.batch(()=>{this.listeners.forEach(i=>{i(r)})})}resumePausedMutations(){const r=this.getAll().filter(i=>i.state.isPaused);return yi.batch(()=>Promise.all(r.map(i=>i.continue().catch(Bo))))}},ea=new WeakMap,$o=new WeakMap,Tp=new WeakMap,WC);function yg(e){var r;return(r=e.options.scope)==null?void 0:r.id}function mT(e){return{onFetch:(r,i)=>{var R,N,F,A,X;const c=r.options,d=(F=(N=(R=r.fetchOptions)==null?void 0:R.meta)==null?void 0:N.fetchMore)==null?void 0:F.direction,g=((A=r.state.data)==null?void 0:A.pages)||[],m=((X=r.state.data)==null?void 0:X.pageParams)||[];let l={pages:[],pageParams:[]},E=0;const P=async()=>{let Z=!1;const ee=W=>{Object.defineProperty(W,"signal",{enumerable:!0,get:()=>(r.signal.aborted?Z=!0:r.signal.addEventListener("abort",()=>{Z=!0}),r.signal)})},H=Ik(r.options,r.fetchOptions),U=async(W,re,ge)=>{if(Z)return Promise.reject();if(re==null&&W.pages.length)return Promise.resolve(W);const xe=(()=>{const $e={client:r.client,queryKey:r.queryKey,pageParam:re,direction:ge?"backward":"forward",meta:r.options.meta};return ee($e),$e})(),ze=await H(xe),{maxPages:Ne}=r.options,Ie=ge?w4:b4;return{pages:Ie(W.pages,ze,Ne),pageParams:Ie(W.pageParams,re,Ne)}};if(d&&g.length){const W=d==="backward",re=W?O4:gT,ge={pages:g,pageParams:m},Te=re(c,ge);l=await U(ge,Te,W)}else{const W=e??g.length;do{const re=E===0?m[0]??c.initialPageParam:gT(c,l);if(E>0&&re==null)break;l=await U(l,re),E++}while(E<W)}return l};r.options.persister?r.fetchFn=()=>{var Z,ee;return(ee=(Z=r.options).persister)==null?void 0:ee.call(Z,P,{client:r.client,queryKey:r.queryKey,meta:r.options.meta,signal:r.signal},i)}:r.fetchFn=P}}}function gT(e,{pages:r,pageParams:i}){const c=r.length-1;return r.length>0?e.getNextPageParam(r[c],r,i[c],i):void 0}function O4(e,{pages:r,pageParams:i}){var c;return r.length>0?(c=e.getPreviousPageParam)==null?void 0:c.call(e,r[0],r,i[0],i):void 0}var rn,tl,rl,kh,Ih,nl,Ah,zh,qC,F4=(qC=class{constructor(e={}){fr(this,rn);fr(this,tl);fr(this,rl);fr(this,kh);fr(this,Ih);fr(this,nl);fr(this,Ah);fr(this,zh);Zt(this,rn,e.queryCache||new z4),Zt(this,tl,e.mutationCache||new L4),Zt(this,rl,e.defaultOptions||{}),Zt(this,kh,new Map),Zt(this,Ih,new Map),Zt(this,nl,0)}mount(){Km(this,nl)._++,Je(this,nl)===1&&(Zt(this,Ah,Ak.subscribe(async e=>{e&&(await this.resumePausedMutations(),Je(this,rn).onFocus())})),Zt(this,zh,P_.subscribe(async e=>{e&&(await this.resumePausedMutations(),Je(this,rn).onOnline())})))}unmount(){var e,r;Km(this,nl)._--,Je(this,nl)===0&&((e=Je(this,Ah))==null||e.call(this),Zt(this,Ah,void 0),(r=Je(this,zh))==null||r.call(this),Zt(this,zh,void 0))}isFetching(e){return Je(this,rn).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return Je(this,tl).findAll({...e,status:"pending"}).length}getQueryData(e){var i;const r=this.defaultQueryOptions({queryKey:e});return(i=Je(this,rn).get(r.queryHash))==null?void 0:i.state.data}ensureQueryData(e){const r=this.defaultQueryOptions(e),i=Je(this,rn).build(this,r),c=i.state.data;return c===void 0?this.fetchQuery(e):(e.revalidateIfStale&&i.isStaleByTime(Wx(r.staleTime,i))&&this.prefetchQuery(r),Promise.resolve(c))}getQueriesData(e){return Je(this,rn).findAll(e).map(({queryKey:r,state:i})=>{const c=i.data;return[r,c]})}setQueryData(e,r,i){const c=this.defaultQueryOptions({queryKey:e}),d=Je(this,rn).get(c.queryHash),g=d==null?void 0:d.state.data,m=m4(r,g);if(m!==void 0)return Je(this,rn).build(this,c).setData(m,{...i,manual:!0})}setQueriesData(e,r,i){return yi.batch(()=>Je(this,rn).findAll(e).map(({queryKey:c})=>[c,this.setQueryData(c,r,i)]))}getQueryState(e){var i;const r=this.defaultQueryOptions({queryKey:e});return(i=Je(this,rn).get(r.queryHash))==null?void 0:i.state}removeQueries(e){const r=Je(this,rn);yi.batch(()=>{r.findAll(e).forEach(i=>{r.remove(i)})})}resetQueries(e,r){const i=Je(this,rn);return yi.batch(()=>(i.findAll(e).forEach(c=>{c.reset()}),this.refetchQueries({type:"active",...e},r)))}cancelQueries(e,r={}){const i={revert:!0,...r},c=yi.batch(()=>Je(this,rn).findAll(e).map(d=>d.cancel(i)));return Promise.all(c).then(Bo).catch(Bo)}invalidateQueries(e,r={}){return yi.batch(()=>(Je(this,rn).findAll(e).forEach(i=>{i.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},r)))}refetchQueries(e,r={}){const i={...r,cancelRefetch:r.cancelRefetch??!0},c=yi.batch(()=>Je(this,rn).findAll(e).filter(d=>!d.isDisabled()&&!d.isStatic()).map(d=>{let g=d.fetch(void 0,i);return i.throwOnError||(g=g.catch(Bo)),d.state.fetchStatus==="paused"?Promise.resolve():g}));return Promise.all(c).then(Bo)}fetchQuery(e){const r=this.defaultQueryOptions(e);r.retry===void 0&&(r.retry=!1);const i=Je(this,rn).build(this,r);return i.isStaleByTime(Wx(r.staleTime,i))?i.fetch(r):Promise.resolve(i.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Bo).catch(Bo)}fetchInfiniteQuery(e){return e.behavior=mT(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Bo).catch(Bo)}ensureInfiniteQueryData(e){return e.behavior=mT(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return P_.isOnline()?Je(this,tl).resumePausedMutations():Promise.resolve()}getQueryCache(){return Je(this,rn)}getMutationCache(){return Je(this,tl)}getDefaultOptions(){return Je(this,rl)}setDefaultOptions(e){Zt(this,rl,e)}setQueryDefaults(e,r){Je(this,kh).set(up(e),{queryKey:e,defaultOptions:r})}getQueryDefaults(e){const r=[...Je(this,kh).values()],i={};return r.forEach(c=>{hp(e,c.queryKey)&&Object.assign(i,c.defaultOptions)}),i}setMutationDefaults(e,r){Je(this,Ih).set(up(e),{mutationKey:e,defaultOptions:r})}getMutationDefaults(e){const r=[...Je(this,Ih).values()],i={};return r.forEach(c=>{hp(e,c.mutationKey)&&Object.assign(i,c.defaultOptions)}),i}defaultQueryOptions(e){if(e._defaulted)return e;const r={...Je(this,rl).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return r.queryHash||(r.queryHash=Aw(r.queryKey,r)),r.refetchOnReconnect===void 0&&(r.refetchOnReconnect=r.networkMode!=="always"),r.throwOnError===void 0&&(r.throwOnError=!!r.suspense),!r.networkMode&&r.persister&&(r.networkMode="offlineFirst"),r.queryFn===zw&&(r.enabled=!1),r}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...Je(this,rl).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){Je(this,rn).clear(),Je(this,tl).clear()}},rn=new WeakMap,tl=new WeakMap,rl=new WeakMap,kh=new WeakMap,Ih=new WeakMap,nl=new WeakMap,Ah=new WeakMap,zh=new WeakMap,qC),N4=Y.createContext(void 0),B4=({client:e,children:r})=>(Y.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),ye.jsx(N4.Provider,{value:e,children:r}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function E_(){return E_=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var i=arguments[r];for(var c in i)Object.prototype.hasOwnProperty.call(i,c)&&(e[c]=i[c])}return e},E_.apply(this,arguments)}var sl;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(sl||(sl={}));const _T="popstate";function j4(e){e===void 0&&(e={});function r(c,d){let{pathname:g,search:m,hash:l}=c.location;return Xx("",{pathname:g,search:m,hash:l},d.state&&d.state.usr||null,d.state&&d.state.key||"default")}function i(c,d){return typeof d=="string"?d:Fk(d)}return U4(r,i,null,e)}function Oi(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}function Ok(e,r){if(!e){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function $4(){return Math.random().toString(36).substr(2,8)}function yT(e,r){return{usr:e.state,key:e.key,idx:r}}function Xx(e,r,i,c){return i===void 0&&(i=null),E_({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof r=="string"?fy(r):r,{state:i,key:r&&r.key||c||$4()})}function Fk(e){let{pathname:r="/",search:i="",hash:c=""}=e;return i&&i!=="?"&&(r+=i.charAt(0)==="?"?i:"?"+i),c&&c!=="#"&&(r+=c.charAt(0)==="#"?c:"#"+c),r}function fy(e){let r={};if(e){let i=e.indexOf("#");i>=0&&(r.hash=e.substr(i),e=e.substr(0,i));let c=e.indexOf("?");c>=0&&(r.search=e.substr(c),e=e.substr(0,c)),e&&(r.pathname=e)}return r}function U4(e,r,i,c){c===void 0&&(c={});let{window:d=document.defaultView,v5Compat:g=!1}=c,m=d.history,l=sl.Pop,E=null,P=R();P==null&&(P=0,m.replaceState(E_({},m.state,{idx:P}),""));function R(){return(m.state||{idx:null}).idx}function N(){l=sl.Pop;let ee=R(),H=ee==null?null:ee-P;P=ee,E&&E({action:l,location:Z.location,delta:H})}function F(ee,H){l=sl.Push;let U=Xx(Z.location,ee,H);P=R()+1;let W=yT(U,P),re=Z.createHref(U);try{m.pushState(W,"",re)}catch(ge){if(ge instanceof DOMException&&ge.name==="DataCloneError")throw ge;d.location.assign(re)}g&&E&&E({action:l,location:Z.location,delta:1})}function A(ee,H){l=sl.Replace;let U=Xx(Z.location,ee,H);P=R();let W=yT(U,P),re=Z.createHref(U);m.replaceState(W,"",re),g&&E&&E({action:l,location:Z.location,delta:0})}function X(ee){let H=d.location.origin!=="null"?d.location.origin:d.location.href,U=typeof ee=="string"?ee:Fk(ee);return U=U.replace(/ $/,"%20"),Oi(H,"No window.location.(origin|href) available to create URL for href: "+U),new URL(U,H)}let Z={get action(){return l},get location(){return e(d,m)},listen(ee){if(E)throw new Error("A history only accepts one active listener");return d.addEventListener(_T,N),E=ee,()=>{d.removeEventListener(_T,N),E=null}},createHref(ee){return r(d,ee)},createURL:X,encodeLocation(ee){let H=X(ee);return{pathname:H.pathname,search:H.search,hash:H.hash}},push:F,replace:A,go(ee){return m.go(ee)}};return Z}var vT;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(vT||(vT={}));function V4(e,r,i){return i===void 0&&(i="/"),Z4(e,r,i)}function Z4(e,r,i,c){let d=typeof r=="string"?fy(r):r,g=jk(d.pathname||"/",i);if(g==null)return null;let m=Nk(e);G4(m);let l=null;for(let E=0;l==null&&E<m.length;++E){let P=nN(g);l=eN(m[E],P)}return l}function Nk(e,r,i,c){r===void 0&&(r=[]),i===void 0&&(i=[]),c===void 0&&(c="");let d=(g,m,l)=>{let E={relativePath:l===void 0?g.path||"":l,caseSensitive:g.caseSensitive===!0,childrenIndex:m,route:g};E.relativePath.startsWith("/")&&(Oi(E.relativePath.startsWith(c),'Absolute route path "'+E.relativePath+'" nested under path '+('"'+c+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),E.relativePath=E.relativePath.slice(c.length));let P=bh([c,E.relativePath]),R=i.concat(E);g.children&&g.children.length>0&&(Oi(g.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+P+'".')),Nk(g.children,r,R,P)),!(g.path==null&&!g.index)&&r.push({path:P,score:Q4(P,g.index),routesMeta:R})};return e.forEach((g,m)=>{var l;if(g.path===""||!((l=g.path)!=null&&l.includes("?")))d(g,m);else for(let E of Bk(g.path))d(g,m,E)}),r}function Bk(e){let r=e.split("/");if(r.length===0)return[];let[i,...c]=r,d=i.endsWith("?"),g=i.replace(/\?$/,"");if(c.length===0)return d?[g,""]:[g];let m=Bk(c.join("/")),l=[];return l.push(...m.map(E=>E===""?g:[g,E].join("/"))),d&&l.push(...m),l.map(E=>e.startsWith("/")&&E===""?"/":E)}function G4(e){e.sort((r,i)=>r.score!==i.score?i.score-r.score:J4(r.routesMeta.map(c=>c.childrenIndex),i.routesMeta.map(c=>c.childrenIndex)))}const H4=/^:[\w-]+$/,W4=3,q4=2,X4=1,K4=10,Y4=-2,xT=e=>e==="*";function Q4(e,r){let i=e.split("/"),c=i.length;return i.some(xT)&&(c+=Y4),r&&(c+=q4),i.filter(d=>!xT(d)).reduce((d,g)=>d+(H4.test(g)?W4:g===""?X4:K4),c)}function J4(e,r){return e.length===r.length&&e.slice(0,-1).every((c,d)=>c===r[d])?e[e.length-1]-r[r.length-1]:0}function eN(e,r,i){let{routesMeta:c}=e,d={},g="/",m=[];for(let l=0;l<c.length;++l){let E=c[l],P=l===c.length-1,R=g==="/"?r:r.slice(g.length)||"/",N=tN({path:E.relativePath,caseSensitive:E.caseSensitive,end:P},R),F=E.route;if(!N)return null;Object.assign(d,N.params),m.push({params:d,pathname:bh([g,N.pathname]),pathnameBase:iN(bh([g,N.pathnameBase])),route:F}),N.pathnameBase!=="/"&&(g=bh([g,N.pathnameBase]))}return m}function tN(e,r){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[i,c]=rN(e.path,e.caseSensitive,e.end),d=r.match(i);if(!d)return null;let g=d[0],m=g.replace(/(.)\/+$/,"$1"),l=d.slice(1);return{params:c.reduce((P,R,N)=>{let{paramName:F,isOptional:A}=R;if(F==="*"){let Z=l[N]||"";m=g.slice(0,g.length-Z.length).replace(/(.)\/+$/,"$1")}const X=l[N];return A&&!X?P[F]=void 0:P[F]=(X||"").replace(/%2F/g,"/"),P},{}),pathname:g,pathnameBase:m,pattern:e}}function rN(e,r,i){r===void 0&&(r=!1),i===void 0&&(i=!0),Ok(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let c=[],d="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(m,l,E)=>(c.push({paramName:l,isOptional:E!=null}),E?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(c.push({paramName:"*"}),d+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):i?d+="\\/*$":e!==""&&e!=="/"&&(d+="(?:(?=\\/|$))"),[new RegExp(d,r?void 0:"i"),c]}function nN(e){try{return e.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return Ok(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+r+").")),e}}function jk(e,r){if(r==="/")return e;if(!e.toLowerCase().startsWith(r.toLowerCase()))return null;let i=r.endsWith("/")?r.length-1:r.length,c=e.charAt(i);return c&&c!=="/"?null:e.slice(i)||"/"}const bh=e=>e.join("/").replace(/\/\/+/g,"/"),iN=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/");function oN(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const $k=["post","put","patch","delete"];new Set($k);const sN=["get",...$k];new Set(sN);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function M_(){return M_=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var i=arguments[r];for(var c in i)Object.prototype.hasOwnProperty.call(i,c)&&(e[c]=i[c])}return e},M_.apply(this,arguments)}const aN=Y.createContext(null),lN=Y.createContext(null),Uk=Y.createContext(null),py=Y.createContext(null),my=Y.createContext({outlet:null,matches:[],isDataRoute:!1}),Vk=Y.createContext(null);function Rw(){return Y.useContext(py)!=null}function Zk(){return Rw()||Oi(!1),Y.useContext(py).location}function cN(e,r){return uN(e,r)}function uN(e,r,i,c){Rw()||Oi(!1);let{navigator:d}=Y.useContext(Uk),{matches:g}=Y.useContext(my),m=g[g.length-1],l=m?m.params:{};m&&m.pathname;let E=m?m.pathnameBase:"/";m&&m.route;let P=Zk(),R;if(r){var N;let ee=typeof r=="string"?fy(r):r;E==="/"||(N=ee.pathname)!=null&&N.startsWith(E)||Oi(!1),R=ee}else R=P;let F=R.pathname||"/",A=F;if(E!=="/"){let ee=E.replace(/^\//,"").split("/");A="/"+F.replace(/^\//,"").split("/").slice(ee.length).join("/")}let X=V4(e,{pathname:A}),Z=mN(X&&X.map(ee=>Object.assign({},ee,{params:Object.assign({},l,ee.params),pathname:bh([E,d.encodeLocation?d.encodeLocation(ee.pathname).pathname:ee.pathname]),pathnameBase:ee.pathnameBase==="/"?E:bh([E,d.encodeLocation?d.encodeLocation(ee.pathnameBase).pathname:ee.pathnameBase])})),g,i,c);return r&&Z?Y.createElement(py.Provider,{value:{location:M_({pathname:"/",search:"",hash:"",state:null,key:"default"},R),navigationType:sl.Pop}},Z):Z}function hN(){let e=vN(),r=oN(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),i=e instanceof Error?e.stack:null,d={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return Y.createElement(Y.Fragment,null,Y.createElement("h2",null,"Unexpected Application Error!"),Y.createElement("h3",{style:{fontStyle:"italic"}},r),i?Y.createElement("pre",{style:d},i):null,null)}const dN=Y.createElement(hN,null);class fN extends Y.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,i){return i.location!==r.location||i.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:i.error,location:i.location,revalidation:r.revalidation||i.revalidation}}componentDidCatch(r,i){console.error("React Router caught the following error during render",r,i)}render(){return this.state.error!==void 0?Y.createElement(my.Provider,{value:this.props.routeContext},Y.createElement(Vk.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function pN(e){let{routeContext:r,match:i,children:c}=e,d=Y.useContext(aN);return d&&d.static&&d.staticContext&&(i.route.errorElement||i.route.ErrorBoundary)&&(d.staticContext._deepestRenderedBoundaryId=i.route.id),Y.createElement(my.Provider,{value:r},c)}function mN(e,r,i,c){var d;if(r===void 0&&(r=[]),i===void 0&&(i=null),c===void 0&&(c=null),e==null){var g;if(!i)return null;if(i.errors)e=i.matches;else if((g=c)!=null&&g.v7_partialHydration&&r.length===0&&!i.initialized&&i.matches.length>0)e=i.matches;else return null}let m=e,l=(d=i)==null?void 0:d.errors;if(l!=null){let R=m.findIndex(N=>N.route.id&&(l==null?void 0:l[N.route.id])!==void 0);R>=0||Oi(!1),m=m.slice(0,Math.min(m.length,R+1))}let E=!1,P=-1;if(i&&c&&c.v7_partialHydration)for(let R=0;R<m.length;R++){let N=m[R];if((N.route.HydrateFallback||N.route.hydrateFallbackElement)&&(P=R),N.route.id){let{loaderData:F,errors:A}=i,X=N.route.loader&&F[N.route.id]===void 0&&(!A||A[N.route.id]===void 0);if(N.route.lazy||X){E=!0,P>=0?m=m.slice(0,P+1):m=[m[0]];break}}}return m.reduceRight((R,N,F)=>{let A,X=!1,Z=null,ee=null;i&&(A=l&&N.route.id?l[N.route.id]:void 0,Z=N.route.errorElement||dN,E&&(P<0&&F===0?(xN("route-fallback"),X=!0,ee=null):P===F&&(X=!0,ee=N.route.hydrateFallbackElement||null)));let H=r.concat(m.slice(0,F+1)),U=()=>{let W;return A?W=Z:X?W=ee:N.route.Component?W=Y.createElement(N.route.Component,null):N.route.element?W=N.route.element:W=R,Y.createElement(pN,{match:N,routeContext:{outlet:R,matches:H,isDataRoute:i!=null},children:W})};return i&&(N.route.ErrorBoundary||N.route.errorElement||F===0)?Y.createElement(fN,{location:i.location,revalidation:i.revalidation,component:Z,error:A,children:U(),routeContext:{outlet:null,matches:H,isDataRoute:!0}}):U()},null)}var Gk=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Gk||{});function gN(e){let r=Y.useContext(lN);return r||Oi(!1),r}function _N(e){let r=Y.useContext(my);return r||Oi(!1),r}function yN(e){let r=_N(),i=r.matches[r.matches.length-1];return i.route.id||Oi(!1),i.route.id}function vN(){var e;let r=Y.useContext(Vk),i=gN(Gk.UseRouteError),c=yN();return r!==void 0?r:(e=i.errors)==null?void 0:e[c]}const bT={};function xN(e,r,i){bT[e]||(bT[e]=!0)}function bN(e,r){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Kx(e){Oi(!1)}function wN(e){let{basename:r="/",children:i=null,location:c,navigationType:d=sl.Pop,navigator:g,static:m=!1,future:l}=e;Rw()&&Oi(!1);let E=r.replace(/^\/*/,"/"),P=Y.useMemo(()=>({basename:E,navigator:g,static:m,future:M_({v7_relativeSplatPath:!1},l)}),[E,l,g,m]);typeof c=="string"&&(c=fy(c));let{pathname:R="/",search:N="",hash:F="",state:A=null,key:X="default"}=c,Z=Y.useMemo(()=>{let ee=jk(R,E);return ee==null?null:{location:{pathname:ee,search:N,hash:F,state:A,key:X},navigationType:d}},[E,R,N,F,A,X,d]);return Z==null?null:Y.createElement(Uk.Provider,{value:P},Y.createElement(py.Provider,{children:i,value:Z}))}function SN(e){let{children:r,location:i}=e;return cN(Yx(r),i)}new Promise(()=>{});function Yx(e,r){r===void 0&&(r=[]);let i=[];return Y.Children.forEach(e,(c,d)=>{if(!Y.isValidElement(c))return;let g=[...r,d];if(c.type===Y.Fragment){i.push.apply(i,Yx(c.props.children,g));return}c.type!==Kx&&Oi(!1),!c.props.index||!c.props.children||Oi(!1);let m={id:c.props.id||g.join("-"),caseSensitive:c.props.caseSensitive,element:c.props.element,Component:c.props.Component,index:c.props.index,path:c.props.path,loader:c.props.loader,action:c.props.action,errorElement:c.props.errorElement,ErrorBoundary:c.props.ErrorBoundary,hasErrorBoundary:c.props.ErrorBoundary!=null||c.props.errorElement!=null,shouldRevalidate:c.props.shouldRevalidate,handle:c.props.handle,lazy:c.props.lazy};c.props.children&&(m.children=Yx(c.props.children,g)),i.push(m)}),i}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const TN="6";try{window.__reactRouterVersion=TN}catch{}const CN="startTransition",wT=Sb[CN];function PN(e){let{basename:r,children:i,future:c,window:d}=e,g=Y.useRef();g.current==null&&(g.current=j4({window:d,v5Compat:!0}));let m=g.current,[l,E]=Y.useState({action:m.action,location:m.location}),{v7_startTransition:P}=c||{},R=Y.useCallback(N=>{P&&wT?wT(()=>E(N)):E(N)},[E,P]);return Y.useLayoutEffect(()=>m.listen(R),[m,R]),Y.useEffect(()=>bN(c),[c]),Y.createElement(wN,{basename:r,children:i,location:l.location,navigationType:l.action,navigator:m,future:c})}var ST;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(ST||(ST={}));var TT;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(TT||(TT={}));const EN="modulepreload",MN=function(e){return"/Domapus/"+e},CT={},Qx=function(r,i,c){let d=Promise.resolve();if(i&&i.length>0){document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),l=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));d=Promise.allSettled(i.map(E=>{if(E=MN(E),E in CT)return;CT[E]=!0;const P=E.endsWith(".css"),R=P?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${E}"]${R}`))return;const N=document.createElement("link");if(N.rel=P?"stylesheet":EN,P||(N.as="script"),N.crossOrigin="",N.href=E,l&&N.setAttribute("nonce",l),document.head.appendChild(N),P)return new Promise((F,A)=>{N.addEventListener("load",F),N.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${E}`)))})}))}function g(m){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=m,window.dispatchEvent(l),!l.defaultPrevented)throw m}return d.then(m=>{for(const l of m||[])l.status==="rejected"&&g(l.reason);return r().catch(g)})};var Hk={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.6.1/LICENSE.txt
 */(function(e,r){(function(i,c){e.exports=c()})(OR,function(){var i={},c={};function d(m,l,E){if(c[m]=E,m==="index"){var P="var sharedModule = {}; ("+c.shared+")(sharedModule); ("+c.worker+")(sharedModule);",R={};return c.shared(R),c.index(i,R),typeof window<"u"&&i.setWorkerUrl(window.URL.createObjectURL(new Blob([P],{type:"text/javascript"}))),i}}d("shared",["exports"],function(m){function l(a,n,s,u){return new(s||(s=Promise))(function(p,v){function x(M){try{T(u.next(M))}catch(I){v(I)}}function w(M){try{T(u.throw(M))}catch(I){v(I)}}function T(M){var I;M.done?p(M.value):(I=M.value,I instanceof s?I:new s(function(D){D(I)})).then(x,w)}T((u=u.apply(a,n||[])).next())})}function E(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var P,R;function N(){if(R)return P;function a(n,s){this.x=n,this.y=s}return R=1,P=a,a.prototype={clone:function(){return new a(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,s){return this.clone()._rotateAround(n,s)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var s=n.x-this.x,u=n.y-this.y;return s*s+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,s){return Math.atan2(this.x*s-this.y*n,this.x*n+this.y*s)},_matMult:function(n){var s=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=s,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var s=Math.cos(n),u=Math.sin(n),p=u*this.x+s*this.y;return this.x=s*this.x-u*this.y,this.y=p,this},_rotateAround:function(n,s){var u=Math.cos(n),p=Math.sin(n),v=s.y+p*(this.x-s.x)+u*(this.y-s.y);return this.x=s.x+u*(this.x-s.x)-p*(this.y-s.y),this.y=v,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},a.convert=function(n){return n instanceof a?n:Array.isArray(n)?new a(n[0],n[1]):n},P}typeof SuppressedError=="function"&&SuppressedError;var F,A,X=E(N()),Z=function(){if(A)return F;function a(n,s,u,p){this.cx=3*n,this.bx=3*(u-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(p-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=s,this.p2x=u,this.p2y=p}return A=1,F=a,a.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,s){if(s===void 0&&(s=1e-6),n<0)return 0;if(n>1)return 1;for(var u=n,p=0;p<8;p++){var v=this.sampleCurveX(u)-n;if(Math.abs(v)<s)return u;var x=this.sampleCurveDerivativeX(u);if(Math.abs(x)<1e-6)break;u-=v/x}var w=0,T=1;for(u=n,p=0;p<20&&(v=this.sampleCurveX(u),!(Math.abs(v-n)<s));p++)n>v?w=u:T=u,u=.5*(T-w)+w;return u},solve:function(n,s){return this.sampleCurveY(this.solveCurveX(n,s))}},F}(),ee=E(Z);let H,U;function W(){return H==null&&(H=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),H}function re(){if(U==null&&(U=!1,W())){const n=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(n){for(let u=0;u<5*5;u++){const p=4*u;n.fillStyle=`rgb(${p},${p+1},${p+2})`,n.fillRect(u%5,Math.floor(u/5),1,1)}const s=n.getImageData(0,0,5,5).data;for(let u=0;u<5*5*4;u++)if(u%4!=3&&s[u]!==u){U=!0;break}}}return U||!1}var ge=1e-6,Te=typeof Float32Array<"u"?Float32Array:Array;function xe(){var a=new Te(9);return Te!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function ze(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function Ne(){var a=new Te(3);return Te!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function Ie(a){return Math.hypot(a[0],a[1],a[2])}function $e(a,n,s){var u=new Te(3);return u[0]=a,u[1]=n,u[2]=s,u}function et(a,n,s){return a[0]=n[0]+s[0],a[1]=n[1]+s[1],a[2]=n[2]+s[2],a}function ot(a,n,s){return a[0]=n[0]*s,a[1]=n[1]*s,a[2]=n[2]*s,a}function qe(a,n,s){var u=n[0],p=n[1],v=n[2],x=s[0],w=s[1],T=s[2];return a[0]=p*T-v*w,a[1]=v*x-u*T,a[2]=u*w-p*x,a}Math.hypot||(Math.hypot=function(){for(var a=0,n=arguments.length;n--;)a+=arguments[n]*arguments[n];return Math.sqrt(a)});var ht,dt=Ie;function wt(a,n,s){var u=n[0],p=n[1],v=n[2],x=n[3];return a[0]=s[0]*u+s[4]*p+s[8]*v+s[12]*x,a[1]=s[1]*u+s[5]*p+s[9]*v+s[13]*x,a[2]=s[2]*u+s[6]*p+s[10]*v+s[14]*x,a[3]=s[3]*u+s[7]*p+s[11]*v+s[15]*x,a}function Ze(){var a=new Te(4);return Te!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function He(a,n,s,u){var p=.5*Math.PI/180;n*=p,s*=p,u*=p;var v=Math.sin(n),x=Math.cos(n),w=Math.sin(s),T=Math.cos(s),M=Math.sin(u),I=Math.cos(u);return a[0]=v*T*I-x*w*M,a[1]=x*w*I+v*T*M,a[2]=x*T*M-v*w*I,a[3]=x*T*I+v*w*M,a}function pt(){var a=new Te(2);return Te!=Float32Array&&(a[0]=0,a[1]=0),a}function Ct(a,n){var s=new Te(2);return s[0]=a,s[1]=n,s}Ne(),ht=new Te(4),Te!=Float32Array&&(ht[0]=0,ht[1]=0,ht[2]=0,ht[3]=0),Ne(),$e(1,0,0),$e(0,1,0),Ze(),Ze(),xe(),pt();const ut=8192;function At(a,n,s){return n*(ut/(a.tileSize*Math.pow(2,s-a.tileID.overscaledZ)))}function kt(a,n){return(a%n+n)%n}function nr(a,n,s){return a*(1-s)+n*s}function dr(a){if(a<=0)return 0;if(a>=1)return 1;const n=a*a,s=n*a;return 4*(a<.5?s:3*(a-n)+s-.75)}function gt(a,n,s,u){const p=new ee(a,n,s,u);return v=>p.solve(v)}const sr=gt(.25,.1,.25,1);function Vt(a,n,s){return Math.min(s,Math.max(n,a))}function tr(a,n,s){const u=s-n,p=((a-n)%u+u)%u+n;return p===n?s:p}function Dt(a,...n){for(const s of n)for(const u in s)a[u]=s[u];return a}let Qt=1;function Gt(a,n,s){const u={};for(const p in a)u[p]=n.call(this,a[p],p,a);return u}function Rr(a,n,s){const u={};for(const p in a)n.call(this,a[p],p,a)&&(u[p]=a[p]);return u}function Yr(a){return Array.isArray(a)?a.map(Yr):typeof a=="object"&&a?Gt(a,Yr):a}const Nn={};function Sr(a){Nn[a]||(typeof console<"u"&&console.warn(a),Nn[a]=!0)}function sn(a,n,s){return(s.y-a.y)*(n.x-a.x)>(n.y-a.y)*(s.x-a.x)}function Zr(a){return typeof WorkerGlobalScope<"u"&&a!==void 0&&a instanceof WorkerGlobalScope}let no=null;function Yn(a){return typeof ImageBitmap<"u"&&a instanceof ImageBitmap}const Yo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Bn(a,n,s,u,p){return l(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const v=new VideoFrame(a,{timestamp:0});try{const x=v==null?void 0:v.format;if(!x||!x.startsWith("BGR")&&!x.startsWith("RGB"))throw new Error(`Unrecognized format ${x}`);const w=x.startsWith("BGR"),T=new Uint8ClampedArray(u*p*4);if(yield v.copyTo(T,function(M,I,D,B,V){const G=4*Math.max(-I,0),K=(Math.max(0,D)-D)*B*4+G,ne=4*B,le=Math.max(0,I),Se=Math.max(0,D);return{rect:{x:le,y:Se,width:Math.min(M.width,I+B)-le,height:Math.min(M.height,D+V)-Se},layout:[{offset:K,stride:ne}]}}(a,n,s,u,p)),w)for(let M=0;M<T.length;M+=4){const I=T[M];T[M]=T[M+2],T[M+2]=I}return T}finally{v.close()}})}let Fi,bo;function jr(a,n,s,u){return a.addEventListener(n,s,u),{unsubscribe:()=>{a.removeEventListener(n,s,u)}}}function Qr(a){return a*Math.PI/180}function Si(a){return a/Math.PI*180}const Is={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},wo={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Ni="AbortError";function Me(){return new Error(Ni)}const Q={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function J(a){return Q.REGISTERED_PROTOCOLS[a.substring(0,a.indexOf("://"))]}const ie="global-dispatcher";class de extends Error{constructor(n,s,u,p){super(`AJAXError: ${s} (${n}): ${u}`),this.status=n,this.statusText=s,this.url=u,this.body=p}}const we=()=>Zr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Ee=function(a,n){if(/:\/\//.test(a.url)&&!/^https?:|^file:/.test(a.url)){const u=J(a.url);if(u)return u(a,n);if(Zr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,targetMapId:ie},n)}if(!(/^file:/.test(s=a.url)||/^file:/.test(we())&&!/^\w+:/.test(s))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(u,p){return l(this,void 0,void 0,function*(){const v=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,cache:u.cache,referrer:we(),signal:p.signal});let x,w;u.type!=="json"||v.headers.has("Accept")||v.headers.set("Accept","application/json");try{x=yield fetch(v)}catch(M){throw new de(0,M.message,u.url,new Blob)}if(!x.ok){const M=yield x.blob();throw new de(x.status,x.statusText,u.url,M)}w=u.type==="arrayBuffer"||u.type==="image"?x.arrayBuffer():u.type==="json"?x.json():x.text();const T=yield w;if(p.signal.aborted)throw Me();return{data:T,cacheControl:x.headers.get("Cache-Control"),expires:x.headers.get("Expires")}})}(a,n);if(Zr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,mustQueue:!0,targetMapId:ie},n)}var s;return function(u,p){return new Promise((v,x)=>{var w;const T=new XMLHttpRequest;T.open(u.method||"GET",u.url,!0),u.type!=="arrayBuffer"&&u.type!=="image"||(T.responseType="arraybuffer");for(const M in u.headers)T.setRequestHeader(M,u.headers[M]);u.type==="json"&&(T.responseType="text",!((w=u.headers)===null||w===void 0)&&w.Accept||T.setRequestHeader("Accept","application/json")),T.withCredentials=u.credentials==="include",T.onerror=()=>{x(new Error(T.statusText))},T.onload=()=>{if(!p.signal.aborted)if((T.status>=200&&T.status<300||T.status===0)&&T.response!==null){let M=T.response;if(u.type==="json")try{M=JSON.parse(T.response)}catch(I){return void x(I)}v({data:M,cacheControl:T.getResponseHeader("Cache-Control"),expires:T.getResponseHeader("Expires")})}else{const M=new Blob([T.response],{type:T.getResponseHeader("Content-Type")});x(new de(T.status,T.statusText,u.url,M))}},p.signal.addEventListener("abort",()=>{T.abort(),x(Me())}),T.send(u.body)})}(a,n)};function De(a){if(!a||a.indexOf("://")<=0||a.indexOf("data:image/")===0||a.indexOf("blob:")===0)return!0;const n=new URL(a),s=window.location;return n.protocol===s.protocol&&n.host===s.host}function Ce(a,n,s){s[a]&&s[a].indexOf(n)!==-1||(s[a]=s[a]||[],s[a].push(n))}function Ve(a,n,s){if(s&&s[a]){const u=s[a].indexOf(n);u!==-1&&s[a].splice(u,1)}}class je{constructor(n,s={}){Dt(this,s),this.type=n}}class ke extends je{constructor(n,s={}){super("error",Dt({error:n},s))}}class We{on(n,s){return this._listeners=this._listeners||{},Ce(n,s,this._listeners),{unsubscribe:()=>{this.off(n,s)}}}off(n,s){return Ve(n,s,this._listeners),Ve(n,s,this._oneTimeListeners),this}once(n,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},Ce(n,s,this._oneTimeListeners),this):new Promise(u=>this.once(n,u))}fire(n,s){typeof n=="string"&&(n=new je(n,s||{}));const u=n.type;if(this.listens(u)){n.target=this;const p=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];for(const w of p)w.call(this,n);const v=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];for(const w of v)Ve(u,w,this._oneTimeListeners),w.call(this,n);const x=this._eventedParent;x&&(Dt(n,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(n))}else n instanceof ke&&console.error(n.error);return this}listens(n){return this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n)}setEventedParent(n,s){return this._eventedParent=n,this._eventedParentData=s,this}}var he={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Qe=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function mt(a,n){const s={};for(const u in a)u!=="ref"&&(s[u]=a[u]);return Qe.forEach(u=>{u in n&&(s[u]=n[u])}),s}function ct(a,n){if(Array.isArray(a)){if(!Array.isArray(n)||a.length!==n.length)return!1;for(let s=0;s<a.length;s++)if(!ct(a[s],n[s]))return!1;return!0}if(typeof a=="object"&&a!==null&&n!==null){if(typeof n!="object"||Object.keys(a).length!==Object.keys(n).length)return!1;for(const s in a)if(!ct(a[s],n[s]))return!1;return!0}return a===n}function yt(a,n){a.push(n)}function Et(a,n,s){yt(s,{command:"addSource",args:[a,n[a]]})}function ir(a,n,s){yt(n,{command:"removeSource",args:[a]}),s[a]=!0}function Nt(a,n,s,u){ir(a,s,u),Et(a,n,s)}function Bt(a,n,s){let u;for(u in a[s])if(Object.prototype.hasOwnProperty.call(a[s],u)&&u!=="data"&&!ct(a[s][u],n[s][u]))return!1;for(u in n[s])if(Object.prototype.hasOwnProperty.call(n[s],u)&&u!=="data"&&!ct(a[s][u],n[s][u]))return!1;return!0}function Rt(a,n,s,u,p,v){a=a||{},n=n||{};for(const x in a)Object.prototype.hasOwnProperty.call(a,x)&&(ct(a[x],n[x])||s.push({command:v,args:[u,x,n[x],p]}));for(const x in n)Object.prototype.hasOwnProperty.call(n,x)&&!Object.prototype.hasOwnProperty.call(a,x)&&(ct(a[x],n[x])||s.push({command:v,args:[u,x,n[x],p]}))}function Jt(a){return a.id}function hn(a,n){return a[n.id]=n,a}class nt{constructor(n,s,u,p){this.message=(n?`${n}: `:"")+u,p&&(this.identifier=p),s!=null&&s.__line__&&(this.line=s.__line__)}}function bn(a,...n){for(const s of n)for(const u in s)a[u]=s[u];return a}class Cr extends Error{constructor(n,s){super(s),this.message=s,this.key=n}}class Qo{constructor(n,s=[]){this.parent=n,this.bindings={};for(const[u,p]of s)this.bindings[u]=p}concat(n){return new Qo(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const As={kind:"null"},at={kind:"number"},jt={kind:"string"},$t={kind:"boolean"},ui={kind:"color"},Qc={kind:"projectionDefinition"},io={kind:"object"},Ut={kind:"value"},So={kind:"collator"},zs={kind:"formatted"},Gr={kind:"padding"},kl={kind:"colorArray"},Il={kind:"numberArray"},To={kind:"resolvedImage"},Al={kind:"variableAnchorOffsetCollection"};function hi(a,n){return{kind:"array",itemType:a,N:n}}function Pr(a){if(a.kind==="array"){const n=Pr(a.itemType);return typeof a.N=="number"?`array<${n}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${n}>`}return a.kind}const Bp=[As,at,jt,$t,ui,Qc,zs,io,hi(Ut),Gr,Il,kl,To,Al];function zl(a,n){if(n.kind==="error")return null;if(a.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!zl(a.itemType,n.itemType))&&(typeof a.N!="number"||a.N===n.N))return null}else{if(a.kind===n.kind)return null;if(a.kind==="value"){for(const s of Bp)if(!zl(s,n))return null}}return`Expected ${Pr(a)} but found ${Pr(n)} instead.`}function Jc(a,n){return n.some(s=>s.kind===a.kind)}function Rs(a,n){return n.some(s=>s==="null"?a===null:s==="array"?Array.isArray(a):s==="object"?a&&!Array.isArray(a)&&typeof a=="object":s===typeof a)}function Jo(a,n){return a.kind==="array"&&n.kind==="array"?a.itemType.kind===n.itemType.kind&&typeof a.N=="number":a.kind===n.kind}const jp=.96422,$p=.82521,Up=4/29,ha=6/29,Vp=3*ha*ha,Zp=ha*ha*ha,Rl=Math.PI/180,Ty=180/Math.PI;function Gp(a){return(a%=360)<0&&(a+=360),a}function da([a,n,s,u]){let p,v;const x=rd((.2225045*(a=td(a))+.7168786*(n=td(n))+.0606169*(s=td(s)))/1);a===n&&n===s?p=v=x:(p=rd((.4360747*a+.3850649*n+.1430804*s)/jp),v=rd((.0139322*a+.0971045*n+.7141733*s)/$p));const w=116*x-16;return[w<0?0:w,500*(p-x),200*(x-v),u]}function td(a){return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function rd(a){return a>Zp?Math.pow(a,1/3):a/Vp+Up}function Hp([a,n,s,u]){let p=(a+16)/116,v=isNaN(n)?p:p+n/500,x=isNaN(s)?p:p-s/200;return p=1*tu(p),v=jp*tu(v),x=$p*tu(x),[eu(3.1338561*v-1.6168667*p-.4906146*x),eu(-.9787684*v+1.9161415*p+.033454*x),eu(.0719453*v-.2289914*p+1.4052427*x),u]}function eu(a){return(a=a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055)<0?0:a>1?1:a}function tu(a){return a>ha?a*a*a:Vp*(a-Up)}const oo=Object.hasOwn||function(a,n){return Object.prototype.hasOwnProperty.call(a,n)};function Ht(a,n){return oo(a,n)?a[n]:void 0}function Co(a){return parseInt(a.padEnd(2,a),16)/255}function Po(a,n){return Ds(n?a/100:a,0,1)}function Ds(a,n,s){return Math.min(Math.max(n,a),s)}function nd(a){return!a.some(Number.isNaN)}const id={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Ti(a,n,s){return a+s*(n-a)}function Eo(a,n,s){return a.map((u,p)=>Ti(u,n[p],s))}class Wt{constructor(n,s,u,p=1,v=!0){this.r=n,this.g=s,this.b=u,this.a=p,v||(this.r*=p,this.g*=p,this.b*=p,p||this.overwriteGetter("rgb",[n,s,u,p]))}static parse(n){if(n instanceof Wt)return n;if(typeof n!="string")return;const s=function(u){if((u=u.toLowerCase().trim())==="transparent")return[0,0,0,0];const p=Ht(id,u);if(p){const[x,w,T]=p;return[x/255,w/255,T/255,1]}if(u.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(u)){const x=u.length<6?1:2;let w=1;return[Co(u.slice(w,w+=x)),Co(u.slice(w,w+=x)),Co(u.slice(w,w+=x)),Co(u.slice(w,w+x)||"ff")]}if(u.startsWith("rgb")){const x=u.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[w,T,M,I,D,B,V,G,K,ne,le,Se]=x,me=[I||" ",V||" ",ne].join("");if(me==="  "||me==="  /"||me===",,"||me===",,,"){const $=[M,B,K].join(""),te=$==="%%%"?100:$===""?255:0;if(te){const _e=[Ds(+T/te,0,1),Ds(+D/te,0,1),Ds(+G/te,0,1),le?Po(+le,Se):1];if(nd(_e))return _e}}return}}const v=u.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(v){const[x,w,T,M,I,D,B,V,G]=v,K=[T||" ",I||" ",B].join("");if(K==="  "||K==="  /"||K===",,"||K===",,,"){const ne=[+w,Ds(+M,0,100),Ds(+D,0,100),V?Po(+V,G):1];if(nd(ne))return function([le,Se,me,$]){function te(_e){const Le=(_e+le/30)%12,Xe=Se*Math.min(me,1-me);return me-Xe*Math.max(-1,Math.min(Le-3,9-Le,1))}return le=Gp(le),Se/=100,me/=100,[te(0),te(8),te(4),$]}(ne)}}}(n);return s?new Wt(...s,!1):void 0}get rgb(){const{r:n,g:s,b:u,a:p}=this,v=p||1/0;return this.overwriteGetter("rgb",[n/v,s/v,u/v,p])}get hcl(){return this.overwriteGetter("hcl",function(n){const[s,u,p,v]=da(n),x=Math.sqrt(u*u+p*p);return[Math.round(1e4*x)?Gp(Math.atan2(p,u)*Ty):NaN,x,s,v]}(this.rgb))}get lab(){return this.overwriteGetter("lab",da(this.rgb))}overwriteGetter(n,s){return Object.defineProperty(this,n,{value:s}),s}toString(){const[n,s,u,p]=this.rgb;return`rgba(${[n,s,u].map(v=>Math.round(255*v)).join(",")},${p})`}static interpolate(n,s,u,p="rgb"){switch(p){case"rgb":{const[v,x,w,T]=Eo(n.rgb,s.rgb,u);return new Wt(v,x,w,T,!1)}case"hcl":{const[v,x,w,T]=n.hcl,[M,I,D,B]=s.hcl;let V,G;if(isNaN(v)||isNaN(M))isNaN(v)?isNaN(M)?V=NaN:(V=M,w!==1&&w!==0||(G=I)):(V=v,D!==1&&D!==0||(G=x));else{let me=M-v;M>v&&me>180?me-=360:M<v&&v-M>180&&(me+=360),V=v+u*me}const[K,ne,le,Se]=function([me,$,te,_e]){return me=isNaN(me)?0:me*Rl,Hp([te,Math.cos(me)*$,Math.sin(me)*$,_e])}([V,G??Ti(x,I,u),Ti(w,D,u),Ti(T,B,u)]);return new Wt(K,ne,le,Se,!1)}case"lab":{const[v,x,w,T]=Hp(Eo(n.lab,s.lab,u));return new Wt(v,x,w,T,!1)}}}}Wt.black=new Wt(0,0,0,1),Wt.white=new Wt(1,1,1,1),Wt.transparent=new Wt(0,0,0,0),Wt.red=new Wt(1,0,0,1);class Dl{constructor(n,s,u){this.sensitivity=n?s?"variant":"case":s?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,s){return this.collator.compare(n,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const ru=["bottom","center","top"];class od{constructor(n,s,u,p,v,x){this.text=n,this.image=s,this.scale=u,this.fontStack=p,this.textColor=v,this.verticalAlign=x}}class An{constructor(n){this.sections=n}static fromString(n){return new An([new od(n,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.name.length!==0)}static factory(n){return n instanceof An?n:An.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}}class Jr{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof Jr)return n;if(typeof n=="number")return new Jr([n,n,n,n]);if(Array.isArray(n)&&!(n.length<1||n.length>4)){for(const s of n)if(typeof s!="number")return;switch(n.length){case 1:n=[n[0],n[0],n[0],n[0]];break;case 2:n=[n[0],n[1],n[0],n[1]];break;case 3:n=[n[0],n[1],n[2],n[1]]}return new Jr(n)}}toString(){return JSON.stringify(this.values)}static interpolate(n,s,u){return new Jr(Eo(n.values,s.values,u))}}class zn{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof zn)return n;if(typeof n=="number")return new zn([n]);if(Array.isArray(n)){for(const s of n)if(typeof s!="number")return;return new zn(n)}}toString(){return JSON.stringify(this.values)}static interpolate(n,s,u){return new zn(Eo(n.values,s.values,u))}}class dn{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof dn)return n;if(typeof n=="string"){const u=Wt.parse(n);return u?new dn([u]):void 0}if(!Array.isArray(n))return;const s=[];for(const u of n){if(typeof u!="string")return;const p=Wt.parse(u);if(!p)return;s.push(p)}return new dn(s)}toString(){return JSON.stringify(this.values)}static interpolate(n,s,u,p="rgb"){const v=[];if(n.values.length!=s.values.length)throw new Error(`colorArray: Arrays have mismatched length (${n.values.length} vs. ${s.values.length}), cannot interpolate.`);for(let x=0;x<n.values.length;x++)v.push(Wt.interpolate(n.values[x],s.values[x],u,p));return new dn(v)}}class Er extends Error{constructor(n){super(n),this.name="RuntimeError"}toJSON(){return this.message}}const nu=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class er{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof er)return n;if(Array.isArray(n)&&!(n.length<1)&&n.length%2==0){for(let s=0;s<n.length;s+=2){const u=n[s],p=n[s+1];if(typeof u!="string"||!nu.has(u)||!Array.isArray(p)||p.length!==2||typeof p[0]!="number"||typeof p[1]!="number")return}return new er(n)}}toString(){return JSON.stringify(this.values)}static interpolate(n,s,u){const p=n.values,v=s.values;if(p.length!==v.length)throw new Er(`Cannot interpolate values of different length. from: ${n.toString()}, to: ${s.toString()}`);const x=[];for(let w=0;w<p.length;w+=2){if(p[w]!==v[w])throw new Er(`Cannot interpolate values containing mismatched anchors. from[${w}]: ${p[w]}, to[${w}]: ${v[w]}`);x.push(p[w]);const[T,M]=p[w+1],[I,D]=v[w+1];x.push([Ti(T,I,u),Ti(M,D,u)])}return new er(x)}}class Qn{constructor(n){this.name=n.name,this.available=n.available}toString(){return this.name}static fromString(n){return n?new Qn({name:n,available:!1}):null}}class Lt{constructor(n,s,u){this.from=n,this.to=s,this.transition=u}static interpolate(n,s,u){return new Lt(n,s,u)}static parse(n){return n instanceof Lt?n:Array.isArray(n)&&n.length===3&&typeof n[0]=="string"&&typeof n[1]=="string"&&typeof n[2]=="number"?new Lt(n[0],n[1],n[2]):typeof n=="object"&&typeof n.from=="string"&&typeof n.to=="string"&&typeof n.transition=="number"?new Lt(n.from,n.to,n.transition):typeof n=="string"?new Lt(n,n,1):void 0}}function Ot(a,n,s,u){return typeof a=="number"&&a>=0&&a<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof s=="number"&&s>=0&&s<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[a,n,s,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[a,n,s,u]:[a,n,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ls(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof Lt||a instanceof Wt||a instanceof Dl||a instanceof An||a instanceof Jr||a instanceof zn||a instanceof dn||a instanceof er||a instanceof Qn)return!0;if(Array.isArray(a)){for(const n of a)if(!Ls(n))return!1;return!0}if(typeof a=="object"){for(const n in a)if(!Ls(a[n]))return!1;return!0}return!1}function zt(a){if(a===null)return As;if(typeof a=="string")return jt;if(typeof a=="boolean")return $t;if(typeof a=="number")return at;if(a instanceof Wt)return ui;if(a instanceof Lt)return Qc;if(a instanceof Dl)return So;if(a instanceof An)return zs;if(a instanceof Jr)return Gr;if(a instanceof zn)return Il;if(a instanceof dn)return kl;if(a instanceof er)return Al;if(a instanceof Qn)return To;if(Array.isArray(a)){const n=a.length;let s;for(const u of a){const p=zt(u);if(s){if(s===p)continue;s=Ut;break}s=p}return hi(s||Ut,n)}return io}function Os(a){const n=typeof a;return a===null?"":n==="string"||n==="number"||n==="boolean"?String(a):a instanceof Wt||a instanceof Lt||a instanceof An||a instanceof Jr||a instanceof zn||a instanceof dn||a instanceof er||a instanceof Qn?a.toString():JSON.stringify(a)}class jn{constructor(n,s){this.type=n,this.value=s}static parse(n,s){if(n.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!Ls(n[1]))return s.error("invalid value");const u=n[1];let p=zt(u);const v=s.expectedType;return p.kind!=="array"||p.N!==0||!v||v.kind!=="array"||typeof v.N=="number"&&v.N!==0||(p=v),new jn(p,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const fa={string:jt,number:at,boolean:$t,object:io};class Jn{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");let u,p=1;const v=n[0];if(v==="array"){let w,T;if(n.length>2){const M=n[1];if(typeof M!="string"||!(M in fa)||M==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);w=fa[M],p++}else w=Ut;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return s.error('The length argument to "array" must be a positive integer literal',2);T=n[2],p++}u=hi(w,T)}else{if(!fa[v])throw new Error(`Types doesn't contain name = ${v}`);u=fa[v]}const x=[];for(;p<n.length;p++){const w=s.parse(n[p],p,Ut);if(!w)return null;x.push(w)}return new Jn(u,x)}evaluate(n){for(let s=0;s<this.args.length;s++){const u=this.args[s].evaluate(n);if(!zl(this.type,zt(u)))return u;if(s===this.args.length-1)throw new Er(`Expected value to be of type ${Pr(this.type)}, but found ${Pr(zt(u))} instead.`)}throw new Error}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}const sd={"to-boolean":$t,"to-color":ui,"to-number":at,"to-string":jt};class so{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const u=n[0];if(!sd[u])throw new Error(`Can't parse ${u} as it is not part of the known types`);if((u==="to-boolean"||u==="to-string")&&n.length!==2)return s.error("Expected one argument.");const p=sd[u],v=[];for(let x=1;x<n.length;x++){const w=s.parse(n[x],x,Ut);if(!w)return null;v.push(w)}return new so(p,v)}evaluate(n){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(n);case"color":{let s,u;for(const p of this.args){if(s=p.evaluate(n),u=null,s instanceof Wt)return s;if(typeof s=="string"){const v=n.parseColor(s);if(v)return v}else if(Array.isArray(s)&&(u=s.length<3||s.length>4?`Invalid rgba value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:Ot(s[0],s[1],s[2],s[3]),!u))return new Wt(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new Er(u||`Could not parse color from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"padding":{let s;for(const u of this.args){s=u.evaluate(n);const p=Jr.parse(s);if(p)return p}throw new Er(`Could not parse padding from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"numberArray":{let s;for(const u of this.args){s=u.evaluate(n);const p=zn.parse(s);if(p)return p}throw new Er(`Could not parse numberArray from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"colorArray":{let s;for(const u of this.args){s=u.evaluate(n);const p=dn.parse(s);if(p)return p}throw new Er(`Could not parse colorArray from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"variableAnchorOffsetCollection":{let s;for(const u of this.args){s=u.evaluate(n);const p=er.parse(s);if(p)return p}throw new Er(`Could not parse variableAnchorOffsetCollection from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"number":{let s=null;for(const u of this.args){if(s=u.evaluate(n),s===null)return 0;const p=Number(s);if(!isNaN(p))return p}throw new Er(`Could not convert ${JSON.stringify(s)} to number.`)}case"formatted":return An.fromString(Os(this.args[0].evaluate(n)));case"resolvedImage":return Qn.fromString(Os(this.args[0].evaluate(n)));case"projectionDefinition":return this.args[0].evaluate(n);default:return Os(this.args[0].evaluate(n))}}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}const Wp=["Unknown","Point","LineString","Polygon"];class qp{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Wp[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(n){let s=this._parseColorCache.get(n);return s||(s=Wt.parse(n),this._parseColorCache.set(n,s)),s}}class Ll{constructor(n,s,u=[],p,v=new Qo,x=[]){this.registry=n,this.path=u,this.key=u.map(w=>`[${w}]`).join(""),this.scope=v,this.errors=x,this.expectedType=p,this._isConstant=s}parse(n,s,u,p,v={}){return s?this.concat(s,u,p)._parse(n,v):this._parse(n,v)}_parse(n,s){function u(p,v,x){return x==="assert"?new Jn(v,[p]):x==="coerce"?new so(v,[p]):p}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=n[0];if(typeof p!="string")return this.error(`Expression name must be a string, but found ${typeof p} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const v=this.registry[p];if(v){let x=v.parse(n,this);if(!x)return null;if(this.expectedType){const w=this.expectedType,T=x.type;if(w.kind!=="string"&&w.kind!=="number"&&w.kind!=="boolean"&&w.kind!=="object"&&w.kind!=="array"||T.kind!=="value"){if(w.kind==="projectionDefinition"&&["string","array"].includes(T.kind)||["color","formatted","resolvedImage"].includes(w.kind)&&["value","string"].includes(T.kind)||["padding","numberArray"].includes(w.kind)&&["value","number","array"].includes(T.kind)||w.kind==="colorArray"&&["value","string","array"].includes(T.kind)||w.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(T.kind))x=u(x,w,s.typeAnnotation||"coerce");else if(this.checkSubtype(w,T))return null}else x=u(x,w,s.typeAnnotation||"assert")}if(!(x instanceof jn)&&x.type.kind!=="resolvedImage"&&this._isConstant(x)){const w=new qp;try{x=new jn(x.type,x.evaluate(w))}catch(T){return this.error(T.message),null}}return x}return this.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,s,u){const p=typeof n=="number"?this.path.concat(n):this.path,v=u?this.scope.concat(u):this.scope;return new Ll(this.registry,this._isConstant,p,s||null,v,this.errors)}error(n,...s){const u=`${this.key}${s.map(p=>`[${p}]`).join("")}`;this.errors.push(new Cr(u,n))}checkSubtype(n,s){const u=zl(n,s);return u&&this.error(u),u}}class Ol{constructor(n,s){this.type=s.type,this.bindings=[].concat(n),this.result=s}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const s of this.bindings)n(s[1]);n(this.result)}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const u=[];for(let v=1;v<n.length-1;v+=2){const x=n[v];if(typeof x!="string")return s.error(`Expected string, but found ${typeof x} instead.`,v);if(/[^a-zA-Z0-9_]/.test(x))return s.error("Variable names must contain only alphanumeric characters or '_'.",v);const w=s.parse(n[v+1],v+1);if(!w)return null;u.push([x,w])}const p=s.parse(n[n.length-1],n.length-1,s.expectedType,u);return p?new Ol(u,p):null}outputDefined(){return this.result.outputDefined()}}class Bi{constructor(n,s){this.type=s.type,this.name=n,this.boundExpression=s}static parse(n,s){if(n.length!==2||typeof n[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const u=n[1];return s.scope.has(u)?new Bi(u,s.scope.get(u)):s.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}}class fn{constructor(n,s,u){this.type=n,this.index=s,this.input=u}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const u=s.parse(n[1],1,at),p=s.parse(n[2],2,hi(s.expectedType||Ut));return u&&p?new fn(p.type.itemType,u,p):null}evaluate(n){const s=this.index.evaluate(n),u=this.input.evaluate(n);if(s<0)throw new Er(`Array index out of bounds: ${s} < 0.`);if(s>=u.length)throw new Er(`Array index out of bounds: ${s} > ${u.length-1}.`);if(s!==Math.floor(s))throw new Er(`Array index must be an integer, but found ${s} instead.`);return u[s]}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}}class pa{constructor(n,s){this.type=$t,this.needle=n,this.haystack=s}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const u=s.parse(n[1],1,Ut),p=s.parse(n[2],2,Ut);return u&&p?Jc(u.type,[$t,jt,at,As,Ut])?new pa(u,p):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Pr(u.type)} instead`):null}evaluate(n){const s=this.needle.evaluate(n),u=this.haystack.evaluate(n);if(!u)return!1;if(!Rs(s,["boolean","string","number","null"]))throw new Er(`Expected first argument to be of type boolean, string, number or null, but found ${Pr(zt(s))} instead.`);if(!Rs(u,["string","array"]))throw new Er(`Expected second argument to be of type array or string, but found ${Pr(zt(u))} instead.`);return u.indexOf(s)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}}class Fl{constructor(n,s,u){this.type=at,this.needle=n,this.haystack=s,this.fromIndex=u}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const u=s.parse(n[1],1,Ut),p=s.parse(n[2],2,Ut);if(!u||!p)return null;if(!Jc(u.type,[$t,jt,at,As,Ut]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Pr(u.type)} instead`);if(n.length===4){const v=s.parse(n[3],3,at);return v?new Fl(u,p,v):null}return new Fl(u,p)}evaluate(n){const s=this.needle.evaluate(n),u=this.haystack.evaluate(n);if(!Rs(s,["boolean","string","number","null"]))throw new Er(`Expected first argument to be of type boolean, string, number or null, but found ${Pr(zt(s))} instead.`);let p;if(this.fromIndex&&(p=this.fromIndex.evaluate(n)),Rs(u,["string"])){const v=u.indexOf(s,p);return v===-1?-1:[...u.slice(0,v)].length}if(Rs(u,["array"]))return u.indexOf(s,p);throw new Er(`Expected second argument to be of type array or string, but found ${Pr(zt(u))} instead.`)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}}class ma{constructor(n,s,u,p,v,x){this.inputType=n,this.type=s,this.input=u,this.cases=p,this.outputs=v,this.otherwise=x}static parse(n,s){if(n.length<5)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return s.error("Expected an even number of arguments.");let u,p;s.expectedType&&s.expectedType.kind!=="value"&&(p=s.expectedType);const v={},x=[];for(let M=2;M<n.length-1;M+=2){let I=n[M];const D=n[M+1];Array.isArray(I)||(I=[I]);const B=s.concat(M);if(I.length===0)return B.error("Expected at least one branch label.");for(const G of I){if(typeof G!="number"&&typeof G!="string")return B.error("Branch labels must be numbers or strings.");if(typeof G=="number"&&Math.abs(G)>Number.MAX_SAFE_INTEGER)return B.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof G=="number"&&Math.floor(G)!==G)return B.error("Numeric branch labels must be integer values.");if(u){if(B.checkSubtype(u,zt(G)))return null}else u=zt(G);if(v[String(G)]!==void 0)return B.error("Branch labels must be unique.");v[String(G)]=x.length}const V=s.parse(D,M,p);if(!V)return null;p=p||V.type,x.push(V)}const w=s.parse(n[1],1,Ut);if(!w)return null;const T=s.parse(n[n.length-1],n.length-1,p);return T?w.type.kind!=="value"&&s.concat(1).checkSubtype(u,w.type)?null:new ma(u,p,w,v,x,T):null}evaluate(n){const s=this.input.evaluate(n);return(zt(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}}class en{constructor(n,s,u){this.type=n,this.branches=s,this.otherwise=u}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return s.error("Expected an odd number of arguments.");let u;s.expectedType&&s.expectedType.kind!=="value"&&(u=s.expectedType);const p=[];for(let x=1;x<n.length-1;x+=2){const w=s.parse(n[x],x,$t);if(!w)return null;const T=s.parse(n[x+1],x+1,u);if(!T)return null;p.push([w,T]),u=u||T.type}const v=s.parse(n[n.length-1],n.length-1,u);if(!v)return null;if(!u)throw new Error("Can't infer output type");return new en(u,p,v)}evaluate(n){for(const[s,u]of this.branches)if(s.evaluate(n))return u.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[s,u]of this.branches)n(s),n(u);n(this.otherwise)}outputDefined(){return this.branches.every(([n,s])=>s.outputDefined())&&this.otherwise.outputDefined()}}class Nl{constructor(n,s,u,p){this.type=n,this.input=s,this.beginIndex=u,this.endIndex=p}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const u=s.parse(n[1],1,Ut),p=s.parse(n[2],2,at);if(!u||!p)return null;if(!Jc(u.type,[hi(Ut),jt,Ut]))return s.error(`Expected first argument to be of type array or string, but found ${Pr(u.type)} instead`);if(n.length===4){const v=s.parse(n[3],3,at);return v?new Nl(u.type,u,p,v):null}return new Nl(u.type,u,p)}evaluate(n){const s=this.input.evaluate(n),u=this.beginIndex.evaluate(n);let p;if(this.endIndex&&(p=this.endIndex.evaluate(n)),Rs(s,["string"]))return[...s].slice(u,p).join("");if(Rs(s,["array"]))return s.slice(u,p);throw new Er(`Expected first argument to be of type array or string, but found ${Pr(zt(s))} instead.`)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}}function ga(a,n){const s=a.length-1;let u,p,v=0,x=s,w=0;for(;v<=x;)if(w=Math.floor((v+x)/2),u=a[w],p=a[w+1],u<=n){if(w===s||n<p)return w;v=w+1}else{if(!(u>n))throw new Er("Input is not a number.");x=w-1}return 0}class _a{constructor(n,s,u){this.type=n,this.input=s,this.labels=[],this.outputs=[];for(const[p,v]of u)this.labels.push(p),this.outputs.push(v)}static parse(n,s){if(n.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return s.error("Expected an even number of arguments.");const u=s.parse(n[1],1,at);if(!u)return null;const p=[];let v=null;s.expectedType&&s.expectedType.kind!=="value"&&(v=s.expectedType);for(let x=1;x<n.length;x+=2){const w=x===1?-1/0:n[x],T=n[x+1],M=x,I=x+1;if(typeof w!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(p.length&&p[p.length-1][0]>=w)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const D=s.parse(T,I,v);if(!D)return null;v=v||D.type,p.push([w,D])}return new _a(v,u,p)}evaluate(n){const s=this.labels,u=this.outputs;if(s.length===1)return u[0].evaluate(n);const p=this.input.evaluate(n);if(p<=s[0])return u[0].evaluate(n);const v=s.length;return p>=s[v-1]?u[v-1].evaluate(n):u[ga(s,p)].evaluate(n)}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}}function Cy(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var es,Bl,ad=function(){if(Bl)return es;function a(n,s,u,p){this.cx=3*n,this.bx=3*(u-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(p-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=s,this.p2x=u,this.p2y=p}return Bl=1,es=a,a.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,s){if(s===void 0&&(s=1e-6),n<0)return 0;if(n>1)return 1;for(var u=n,p=0;p<8;p++){var v=this.sampleCurveX(u)-n;if(Math.abs(v)<s)return u;var x=this.sampleCurveDerivativeX(u);if(Math.abs(x)<1e-6)break;u-=v/x}var w=0,T=1;for(u=n,p=0;p<20&&(v=this.sampleCurveX(u),!(Math.abs(v-n)<s));p++)n>v?w=u:T=u,u=.5*(T-w)+w;return u},solve:function(n,s){return this.sampleCurveY(this.solveCurveX(n,s))}},es}(),Py=Cy(ad);class $n{constructor(n,s,u,p,v){this.type=n,this.operator=s,this.interpolation=u,this.input=p,this.labels=[],this.outputs=[];for(const[x,w]of v)this.labels.push(x),this.outputs.push(w)}static interpolationFactor(n,s,u,p){let v=0;if(n.name==="exponential")v=ya(s,n.base,u,p);else if(n.name==="linear")v=ya(s,1,u,p);else if(n.name==="cubic-bezier"){const x=n.controlPoints;v=new Py(x[0],x[1],x[2],x[3]).solve(ya(s,1,u,p))}return v}static parse(n,s){let[u,p,v,...x]=n;if(!Array.isArray(p)||p.length===0)return s.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const M=p[1];if(typeof M!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:M}}else{if(p[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const M=p.slice(1);if(M.length!==4||M.some(I=>typeof I!="number"||I<0||I>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:M}}}if(n.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(v=s.parse(v,2,at),!v)return null;const w=[];let T=null;u!=="interpolate-hcl"&&u!=="interpolate-lab"||s.expectedType==kl?s.expectedType&&s.expectedType.kind!=="value"&&(T=s.expectedType):T=ui;for(let M=0;M<x.length;M+=2){const I=x[M],D=x[M+1],B=M+3,V=M+4;if(typeof I!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',B);if(w.length&&w[w.length-1][0]>=I)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',B);const G=s.parse(D,V,T);if(!G)return null;T=T||G.type,w.push([I,G])}return Jo(T,at)||Jo(T,Qc)||Jo(T,ui)||Jo(T,Gr)||Jo(T,Il)||Jo(T,kl)||Jo(T,Al)||Jo(T,hi(at))?new $n(T,u,p,v,w):s.error(`Type ${Pr(T)} is not interpolatable.`)}evaluate(n){const s=this.labels,u=this.outputs;if(s.length===1)return u[0].evaluate(n);const p=this.input.evaluate(n);if(p<=s[0])return u[0].evaluate(n);const v=s.length;if(p>=s[v-1])return u[v-1].evaluate(n);const x=ga(s,p),w=$n.interpolationFactor(this.interpolation,p,s[x],s[x+1]),T=u[x].evaluate(n),M=u[x+1].evaluate(n);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Ti(T,M,w);case"color":return Wt.interpolate(T,M,w);case"padding":return Jr.interpolate(T,M,w);case"colorArray":return dn.interpolate(T,M,w);case"numberArray":return zn.interpolate(T,M,w);case"variableAnchorOffsetCollection":return er.interpolate(T,M,w);case"array":return Eo(T,M,w);case"projectionDefinition":return Lt.interpolate(T,M,w)}case"interpolate-hcl":switch(this.type.kind){case"color":return Wt.interpolate(T,M,w,"hcl");case"colorArray":return dn.interpolate(T,M,w,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Wt.interpolate(T,M,w,"lab");case"colorArray":return dn.interpolate(T,M,w,"lab")}}}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}}function ya(a,n,s,u){const p=u-s,v=a-s;return p===0?0:n===1?v/p:(Math.pow(n,v)-1)/(Math.pow(n,p)-1)}const di={color:Wt.interpolate,number:Ti,padding:Jr.interpolate,numberArray:zn.interpolate,colorArray:dn.interpolate,variableAnchorOffsetCollection:er.interpolate,array:Eo};class ei{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");let u=null;const p=s.expectedType;p&&p.kind!=="value"&&(u=p);const v=[];for(const w of n.slice(1)){const T=s.parse(w,1+v.length,u,void 0,{typeAnnotation:"omit"});if(!T)return null;u=u||T.type,v.push(T)}if(!u)throw new Error("No output type");const x=p&&v.some(w=>zl(p,w.type));return new ei(x?Ut:u,v)}evaluate(n){let s,u=null,p=0;for(const v of this.args)if(p++,u=v.evaluate(n),u&&u instanceof Qn&&!u.available&&(s||(s=u.name),u=null,p===this.args.length&&(u=s)),u!==null)break;return u}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}function ld(a,n){return a==="=="||a==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function jl(a,n,s,u){return u.compare(n,s)===0}function va(a,n,s){const u=a!=="=="&&a!=="!=";return class Wk{constructor(v,x,w){this.type=$t,this.lhs=v,this.rhs=x,this.collator=w,this.hasUntypedArgument=v.type.kind==="value"||x.type.kind==="value"}static parse(v,x){if(v.length!==3&&v.length!==4)return x.error("Expected two or three arguments.");const w=v[0];let T=x.parse(v[1],1,Ut);if(!T)return null;if(!ld(w,T.type))return x.concat(1).error(`"${w}" comparisons are not supported for type '${Pr(T.type)}'.`);let M=x.parse(v[2],2,Ut);if(!M)return null;if(!ld(w,M.type))return x.concat(2).error(`"${w}" comparisons are not supported for type '${Pr(M.type)}'.`);if(T.type.kind!==M.type.kind&&T.type.kind!=="value"&&M.type.kind!=="value")return x.error(`Cannot compare types '${Pr(T.type)}' and '${Pr(M.type)}'.`);u&&(T.type.kind==="value"&&M.type.kind!=="value"?T=new Jn(M.type,[T]):T.type.kind!=="value"&&M.type.kind==="value"&&(M=new Jn(T.type,[M])));let I=null;if(v.length===4){if(T.type.kind!=="string"&&M.type.kind!=="string"&&T.type.kind!=="value"&&M.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(I=x.parse(v[3],3,So),!I)return null}return new Wk(T,M,I)}evaluate(v){const x=this.lhs.evaluate(v),w=this.rhs.evaluate(v);if(u&&this.hasUntypedArgument){const T=zt(x),M=zt(w);if(T.kind!==M.kind||T.kind!=="string"&&T.kind!=="number")throw new Er(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${T.kind}, ${M.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const T=zt(x),M=zt(w);if(T.kind!=="string"||M.kind!=="string")return n(v,x,w)}return this.collator?s(v,x,w,this.collator.evaluate(v)):n(v,x,w)}eachChild(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)}outputDefined(){return!0}}}const cd=va("==",function(a,n,s){return n===s},jl),Ey=va("!=",function(a,n,s){return n!==s},function(a,n,s,u){return!jl(0,n,s,u)}),My=va("<",function(a,n,s){return n<s},function(a,n,s,u){return u.compare(n,s)<0}),ky=va(">",function(a,n,s){return n>s},function(a,n,s,u){return u.compare(n,s)>0}),Iy=va("<=",function(a,n,s){return n<=s},function(a,n,s,u){return u.compare(n,s)<=0}),iu=va(">=",function(a,n,s){return n>=s},function(a,n,s,u){return u.compare(n,s)>=0});class ou{constructor(n,s,u){this.type=So,this.locale=u,this.caseSensitive=n,this.diacriticSensitive=s}static parse(n,s){if(n.length!==2)return s.error("Expected one argument.");const u=n[1];if(typeof u!="object"||Array.isArray(u))return s.error("Collator options argument must be an object.");const p=s.parse(u["case-sensitive"]!==void 0&&u["case-sensitive"],1,$t);if(!p)return null;const v=s.parse(u["diacritic-sensitive"]!==void 0&&u["diacritic-sensitive"],1,$t);if(!v)return null;let x=null;return u.locale&&(x=s.parse(u.locale,1,jt),!x)?null:new ou(p,v,x)}evaluate(n){return new Dl(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}}class su{constructor(n,s,u,p,v){this.type=jt,this.number=n,this.locale=s,this.currency=u,this.minFractionDigits=p,this.maxFractionDigits=v}static parse(n,s){if(n.length!==3)return s.error("Expected two arguments.");const u=s.parse(n[1],1,at);if(!u)return null;const p=n[2];if(typeof p!="object"||Array.isArray(p))return s.error("NumberFormat options argument must be an object.");let v=null;if(p.locale&&(v=s.parse(p.locale,1,jt),!v))return null;let x=null;if(p.currency&&(x=s.parse(p.currency,1,jt),!x))return null;let w=null;if(p["min-fraction-digits"]&&(w=s.parse(p["min-fraction-digits"],1,at),!w))return null;let T=null;return p["max-fraction-digits"]&&(T=s.parse(p["max-fraction-digits"],1,at),!T)?null:new su(u,v,x,w,T)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}}class $l{constructor(n){this.type=zs,this.sections=n}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const u=n[1];if(!Array.isArray(u)&&typeof u=="object")return s.error("First argument must be an image or text section.");const p=[];let v=!1;for(let x=1;x<=n.length-1;++x){const w=n[x];if(v&&typeof w=="object"&&!Array.isArray(w)){v=!1;let T=null;if(w["font-scale"]&&(T=s.parse(w["font-scale"],1,at),!T))return null;let M=null;if(w["text-font"]&&(M=s.parse(w["text-font"],1,hi(jt)),!M))return null;let I=null;if(w["text-color"]&&(I=s.parse(w["text-color"],1,ui),!I))return null;let D=null;if(w["vertical-align"]){if(typeof w["vertical-align"]=="string"&&!ru.includes(w["vertical-align"]))return s.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${w["vertical-align"]}' instead.`);if(D=s.parse(w["vertical-align"],1,jt),!D)return null}const B=p[p.length-1];B.scale=T,B.font=M,B.textColor=I,B.verticalAlign=D}else{const T=s.parse(n[x],1,Ut);if(!T)return null;const M=T.type.kind;if(M!=="string"&&M!=="value"&&M!=="null"&&M!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");v=!0,p.push({content:T,scale:null,font:null,textColor:null,verticalAlign:null})}}return new $l(p)}evaluate(n){return new An(this.sections.map(s=>{const u=s.content.evaluate(n);return zt(u)===To?new od("",u,null,null,null,s.verticalAlign?s.verticalAlign.evaluate(n):null):new od(Os(u),null,s.scale?s.scale.evaluate(n):null,s.font?s.font.evaluate(n).join(","):null,s.textColor?s.textColor.evaluate(n):null,s.verticalAlign?s.verticalAlign.evaluate(n):null)}))}eachChild(n){for(const s of this.sections)n(s.content),s.scale&&n(s.scale),s.font&&n(s.font),s.textColor&&n(s.textColor),s.verticalAlign&&n(s.verticalAlign)}outputDefined(){return!1}}class ud{constructor(n){this.type=To,this.input=n}static parse(n,s){if(n.length!==2)return s.error("Expected two arguments.");const u=s.parse(n[1],1,jt);return u?new ud(u):s.error("No image name provided.")}evaluate(n){const s=this.input.evaluate(n),u=Qn.fromString(s);return u&&n.availableImages&&(u.available=n.availableImages.indexOf(s)>-1),u}eachChild(n){n(this.input)}outputDefined(){return!1}}class au{constructor(n){this.type=at,this.input=n}static parse(n,s){if(n.length!==2)return s.error(`Expected 1 argument, but found ${n.length-1} instead.`);const u=s.parse(n[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${Pr(u.type)} instead.`):new au(u):null}evaluate(n){const s=this.input.evaluate(n);if(typeof s=="string")return[...s].length;if(Array.isArray(s))return s.length;throw new Er(`Expected value to be of type string or array, but found ${Pr(zt(s))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}}const ao=8192;function Ay(a,n){const s=(180+a[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,p=Math.pow(2,n.z);return[Math.round(s*p*ao),Math.round(u*p*ao)]}function hd(a,n){const s=Math.pow(2,n.z);return[(p=(a[0]/ao+n.x)/s,360*p-180),(u=(a[1]/ao+n.y)/s,360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90)];var u,p}function Ul(a,n){a[0]=Math.min(a[0],n[0]),a[1]=Math.min(a[1],n[1]),a[2]=Math.max(a[2],n[0]),a[3]=Math.max(a[3],n[1])}function Vl(a,n){return!(a[0]<=n[0]||a[2]>=n[2]||a[1]<=n[1]||a[3]>=n[3])}function Xp(a,n,s){const u=a[0]-n[0],p=a[1]-n[1],v=a[0]-s[0],x=a[1]-s[1];return u*x-v*p==0&&u*v<=0&&p*x<=0}function Zl(a,n,s,u){return(p=[u[0]-s[0],u[1]-s[1]])[0]*(v=[n[0]-a[0],n[1]-a[1]])[1]-p[1]*v[0]!=0&&!(!lu(a,n,s,u)||!lu(s,u,a,n));var p,v}function Kp(a,n,s){for(const u of s)for(let p=0;p<u.length-1;++p)if(Zl(a,n,u[p],u[p+1]))return!0;return!1}function xa(a,n,s=!1){let u=!1;for(const w of n)for(let T=0;T<w.length-1;T++){if(Xp(a,w[T],w[T+1]))return s;(v=w[T])[1]>(p=a)[1]!=(x=w[T+1])[1]>p[1]&&p[0]<(x[0]-v[0])*(p[1]-v[1])/(x[1]-v[1])+v[0]&&(u=!u)}var p,v,x;return u}function zy(a,n){for(const s of n)if(xa(a,s))return!0;return!1}function Yp(a,n){for(const s of a)if(!xa(s,n))return!1;for(let s=0;s<a.length-1;++s)if(Kp(a[s],a[s+1],n))return!1;return!0}function Ry(a,n){for(const s of n)if(Yp(a,s))return!0;return!1}function lu(a,n,s,u){const p=u[0]-s[0],v=u[1]-s[1],x=(a[0]-s[0])*v-p*(a[1]-s[1]),w=(n[0]-s[0])*v-p*(n[1]-s[1]);return x>0&&w<0||x<0&&w>0}function dd(a,n,s){const u=[];for(let p=0;p<a.length;p++){const v=[];for(let x=0;x<a[p].length;x++){const w=Ay(a[p][x],s);Ul(n,w),v.push(w)}u.push(v)}return u}function Qp(a,n,s){const u=[];for(let p=0;p<a.length;p++){const v=dd(a[p],n,s);u.push(v)}return u}function Jp(a,n,s,u){if(a[0]<s[0]||a[0]>s[2]){const p=.5*u;let v=a[0]-s[0]>p?-u:s[0]-a[0]>p?u:0;v===0&&(v=a[0]-s[2]>p?-u:s[2]-a[0]>p?u:0),a[0]+=v}Ul(n,a)}function fd(a,n,s,u){const p=Math.pow(2,u.z)*ao,v=[u.x*ao,u.y*ao],x=[];for(const w of a)for(const T of w){const M=[T.x+v[0],T.y+v[1]];Jp(M,n,s,p),x.push(M)}return x}function pd(a,n,s,u){const p=Math.pow(2,u.z)*ao,v=[u.x*ao,u.y*ao],x=[];for(const T of a){const M=[];for(const I of T){const D=[I.x+v[0],I.y+v[1]];Ul(n,D),M.push(D)}x.push(M)}if(n[2]-n[0]<=p/2){(w=n)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(const T of x)for(const M of T)Jp(M,n,s,p)}var w;return x}class Fs{constructor(n,s){this.type=$t,this.geojson=n,this.geometries=s}static parse(n,s){if(n.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(Ls(n[1])){const u=n[1];if(u.type==="FeatureCollection"){const p=[];for(const v of u.features){const{type:x,coordinates:w}=v.geometry;x==="Polygon"&&p.push(w),x==="MultiPolygon"&&p.push(...w)}if(p.length)return new Fs(u,{type:"MultiPolygon",coordinates:p})}else if(u.type==="Feature"){const p=u.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new Fs(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new Fs(u,u)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(s,u){const p=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],x=s.canonicalID();if(u.type==="Polygon"){const w=dd(u.coordinates,v,x),T=fd(s.geometry(),p,v,x);if(!Vl(p,v))return!1;for(const M of T)if(!xa(M,w))return!1}if(u.type==="MultiPolygon"){const w=Qp(u.coordinates,v,x),T=fd(s.geometry(),p,v,x);if(!Vl(p,v))return!1;for(const M of T)if(!zy(M,w))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(s,u){const p=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],x=s.canonicalID();if(u.type==="Polygon"){const w=dd(u.coordinates,v,x),T=pd(s.geometry(),p,v,x);if(!Vl(p,v))return!1;for(const M of T)if(!Yp(M,w))return!1}if(u.type==="MultiPolygon"){const w=Qp(u.coordinates,v,x),T=pd(s.geometry(),p,v,x);if(!Vl(p,v))return!1;for(const M of T)if(!Ry(M,w))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let em=class{constructor(a=[],n=(s,u)=>s<u?-1:s>u?1:0){if(this.data=a,this.length=this.data.length,this.compare=n,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(a){this.data.push(a),this._up(this.length++)}pop(){if(this.length===0)return;const a=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:n,compare:s}=this,u=n[a];for(;a>0;){const p=a-1>>1,v=n[p];if(s(u,v)>=0)break;n[a]=v,a=p}n[a]=u}_down(a){const{data:n,compare:s}=this,u=this.length>>1,p=n[a];for(;a<u;){let v=1+(a<<1);const x=v+1;if(x<this.length&&s(n[x],n[v])<0&&(v=x),s(n[v],p)>=0)break;n[a]=n[v],a=v}n[a]=p}};function md(a,n,s=0,u=a.length-1,p=Dy){for(;u>s;){if(u-s>600){const T=u-s+1,M=n-s+1,I=Math.log(T),D=.5*Math.exp(2*I/3),B=.5*Math.sqrt(I*D*(T-D)/T)*(M-T/2<0?-1:1);md(a,n,Math.max(s,Math.floor(n-M*D/T+B)),Math.min(u,Math.floor(n+(T-M)*D/T+B)),p)}const v=a[n];let x=s,w=u;for(ba(a,s,n),p(a[u],v)>0&&ba(a,s,u);x<w;){for(ba(a,x,w),x++,w--;p(a[x],v)<0;)x++;for(;p(a[w],v)>0;)w--}p(a[s],v)===0?ba(a,s,w):(w++,ba(a,w,u)),w<=n&&(s=w+1),n<=w&&(u=w-1)}}function ba(a,n,s){const u=a[n];a[n]=a[s],a[s]=u}function Dy(a,n){return a<n?-1:a>n?1:0}function cu(a,n){if(a.length<=1)return[a];const s=[];let u,p;for(const v of a){const x=tm(v);x!==0&&(v.area=Math.abs(x),p===void 0&&(p=x<0),p===x<0?(u&&s.push(u),u=[v]):u.push(v))}if(u&&s.push(u),n>1)for(let v=0;v<s.length;v++)s[v].length<=n||(md(s[v],n,1,s[v].length-1,Ly),s[v]=s[v].slice(0,n));return s}function Ly(a,n){return n.area-a.area}function tm(a){let n=0;for(let s,u,p=0,v=a.length,x=v-1;p<v;x=p++)s=a[p],u=a[x],n+=(u.x-s.x)*(s.y+u.y);return n}const rm=1/298.257223563,nm=rm*(2-rm),im=Math.PI/180;class gd{constructor(n){const s=6378.137*im*1e3,u=Math.cos(n*im),p=1/(1-nm*(1-u*u)),v=Math.sqrt(p);this.kx=s*v*u,this.ky=s*v*p*(1-nm)}distance(n,s){const u=this.wrap(n[0]-s[0])*this.kx,p=(n[1]-s[1])*this.ky;return Math.sqrt(u*u+p*p)}pointOnLine(n,s){let u,p,v,x,w=1/0;for(let T=0;T<n.length-1;T++){let M=n[T][0],I=n[T][1],D=this.wrap(n[T+1][0]-M)*this.kx,B=(n[T+1][1]-I)*this.ky,V=0;D===0&&B===0||(V=(this.wrap(s[0]-M)*this.kx*D+(s[1]-I)*this.ky*B)/(D*D+B*B),V>1?(M=n[T+1][0],I=n[T+1][1]):V>0&&(M+=D/this.kx*V,I+=B/this.ky*V)),D=this.wrap(s[0]-M)*this.kx,B=(s[1]-I)*this.ky;const G=D*D+B*B;G<w&&(w=G,u=M,p=I,v=T,x=V)}return{point:[u,p],index:v,t:Math.max(0,Math.min(1,x))}}wrap(n){for(;n<-180;)n+=360;for(;n>180;)n-=360;return n}}function lr(a,n){return n[0]-a[0]}function uu(a){return a[1]-a[0]+1}function Mo(a,n){return a[1]>=a[0]&&a[1]<n}function _d(a,n){if(a[0]>a[1])return[null,null];const s=uu(a);if(n){if(s===2)return[a,null];const p=Math.floor(s/2);return[[a[0],a[0]+p],[a[0]+p,a[1]]]}if(s===1)return[a,null];const u=Math.floor(s/2)-1;return[[a[0],a[0]+u],[a[0]+u+1,a[1]]]}function yd(a,n){if(!Mo(n,a.length))return[1/0,1/0,-1/0,-1/0];const s=[1/0,1/0,-1/0,-1/0];for(let u=n[0];u<=n[1];++u)Ul(s,a[u]);return s}function vd(a){const n=[1/0,1/0,-1/0,-1/0];for(const s of a)for(const u of s)Ul(n,u);return n}function om(a){return a[0]!==-1/0&&a[1]!==-1/0&&a[2]!==1/0&&a[3]!==1/0}function xd(a,n,s){if(!om(a)||!om(n))return NaN;let u=0,p=0;return a[2]<n[0]&&(u=n[0]-a[2]),a[0]>n[2]&&(u=a[0]-n[2]),a[1]>n[3]&&(p=a[1]-n[3]),a[3]<n[1]&&(p=n[1]-a[3]),s.distance([0,0],[u,p])}function Ns(a,n,s){const u=s.pointOnLine(n,a);return s.distance(a,u.point)}function bd(a,n,s,u,p){const v=Math.min(Ns(a,[s,u],p),Ns(n,[s,u],p)),x=Math.min(Ns(s,[a,n],p),Ns(u,[a,n],p));return Math.min(v,x)}function Oy(a,n,s,u,p){if(!Mo(n,a.length)||!Mo(u,s.length))return 1/0;let v=1/0;for(let x=n[0];x<n[1];++x){const w=a[x],T=a[x+1];for(let M=u[0];M<u[1];++M){const I=s[M],D=s[M+1];if(Zl(w,T,I,D))return 0;v=Math.min(v,bd(w,T,I,D,p))}}return v}function Fy(a,n,s,u,p){if(!Mo(n,a.length)||!Mo(u,s.length))return NaN;let v=1/0;for(let x=n[0];x<=n[1];++x)for(let w=u[0];w<=u[1];++w)if(v=Math.min(v,p.distance(a[x],s[w])),v===0)return v;return v}function Ny(a,n,s){if(xa(a,n,!0))return 0;let u=1/0;for(const p of n){const v=p[0],x=p[p.length-1];if(v!==x&&(u=Math.min(u,Ns(a,[x,v],s)),u===0))return u;const w=s.pointOnLine(p,a);if(u=Math.min(u,s.distance(a,w.point)),u===0)return u}return u}function By(a,n,s,u){if(!Mo(n,a.length))return NaN;for(let v=n[0];v<=n[1];++v)if(xa(a[v],s,!0))return 0;let p=1/0;for(let v=n[0];v<n[1];++v){const x=a[v],w=a[v+1];for(const T of s)for(let M=0,I=T.length,D=I-1;M<I;D=M++){const B=T[D],V=T[M];if(Zl(x,w,B,V))return 0;p=Math.min(p,bd(x,w,B,V,u))}}return p}function sm(a,n){for(const s of a)for(const u of s)if(xa(u,n,!0))return!0;return!1}function jy(a,n,s,u=1/0){const p=vd(a),v=vd(n);if(u!==1/0&&xd(p,v,s)>=u)return u;if(Vl(p,v)){if(sm(a,n))return 0}else if(sm(n,a))return 0;let x=1/0;for(const w of a)for(let T=0,M=w.length,I=M-1;T<M;I=T++){const D=w[I],B=w[T];for(const V of n)for(let G=0,K=V.length,ne=K-1;G<K;ne=G++){const le=V[ne],Se=V[G];if(Zl(D,B,le,Se))return 0;x=Math.min(x,bd(D,B,le,Se,s))}}return x}function am(a,n,s,u,p,v){if(!v)return;const x=xd(yd(u,v),p,s);x<n&&a.push([x,v,[0,0]])}function hu(a,n,s,u,p,v,x){if(!v||!x)return;const w=xd(yd(u,v),yd(p,x),s);w<n&&a.push([w,v,x])}function du(a,n,s,u,p=1/0){let v=Math.min(u.distance(a[0],s[0][0]),p);if(v===0)return v;const x=new em([[0,[0,a.length-1],[0,0]]],lr),w=vd(s);for(;x.length>0;){const T=x.pop();if(T[0]>=v)continue;const M=T[1],I=n?50:100;if(uu(M)<=I){if(!Mo(M,a.length))return NaN;if(n){const D=By(a,M,s,u);if(isNaN(D)||D===0)return D;v=Math.min(v,D)}else for(let D=M[0];D<=M[1];++D){const B=Ny(a[D],s,u);if(v=Math.min(v,B),v===0)return 0}}else{const D=_d(M,n);am(x,v,u,a,w,D[0]),am(x,v,u,a,w,D[1])}}return v}function fu(a,n,s,u,p,v=1/0){let x=Math.min(v,p.distance(a[0],s[0]));if(x===0)return x;const w=new em([[0,[0,a.length-1],[0,s.length-1]]],lr);for(;w.length>0;){const T=w.pop();if(T[0]>=x)continue;const M=T[1],I=T[2],D=n?50:100,B=u?50:100;if(uu(M)<=D&&uu(I)<=B){if(!Mo(M,a.length)&&Mo(I,s.length))return NaN;let V;if(n&&u)V=Oy(a,M,s,I,p),x=Math.min(x,V);else if(n&&!u){const G=a.slice(M[0],M[1]+1);for(let K=I[0];K<=I[1];++K)if(V=Ns(s[K],G,p),x=Math.min(x,V),x===0)return x}else if(!n&&u){const G=s.slice(I[0],I[1]+1);for(let K=M[0];K<=M[1];++K)if(V=Ns(a[K],G,p),x=Math.min(x,V),x===0)return x}else V=Fy(a,M,s,I,p),x=Math.min(x,V)}else{const V=_d(M,n),G=_d(I,u);hu(w,x,p,a,s,V[0],G[0]),hu(w,x,p,a,s,V[0],G[1]),hu(w,x,p,a,s,V[1],G[0]),hu(w,x,p,a,s,V[1],G[1])}}return x}function wd(a){return a.type==="MultiPolygon"?a.coordinates.map(n=>({type:"Polygon",coordinates:n})):a.type==="MultiLineString"?a.coordinates.map(n=>({type:"LineString",coordinates:n})):a.type==="MultiPoint"?a.coordinates.map(n=>({type:"Point",coordinates:n})):[a]}class Bs{constructor(n,s){this.type=at,this.geojson=n,this.geometries=s}static parse(n,s){if(n.length!==2)return s.error(`'distance' expression requires exactly one argument, but found ${n.length-1} instead.`);if(Ls(n[1])){const u=n[1];if(u.type==="FeatureCollection")return new Bs(u,u.features.map(p=>wd(p.geometry)).flat());if(u.type==="Feature")return new Bs(u,wd(u.geometry));if("type"in u&&"coordinates"in u)return new Bs(u,wd(u))}return s.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(s,u){const p=s.geometry(),v=p.flat().map(T=>hd([T.x,T.y],s.canonical));if(p.length===0)return NaN;const x=new gd(v[0][1]);let w=1/0;for(const T of u){switch(T.type){case"Point":w=Math.min(w,fu(v,!1,[T.coordinates],!1,x,w));break;case"LineString":w=Math.min(w,fu(v,!1,T.coordinates,!0,x,w));break;case"Polygon":w=Math.min(w,du(v,!1,T.coordinates,x,w))}if(w===0)return w}return w}(n,this.geometries);if(n.geometryType()==="LineString")return function(s,u){const p=s.geometry(),v=p.flat().map(T=>hd([T.x,T.y],s.canonical));if(p.length===0)return NaN;const x=new gd(v[0][1]);let w=1/0;for(const T of u){switch(T.type){case"Point":w=Math.min(w,fu(v,!0,[T.coordinates],!1,x,w));break;case"LineString":w=Math.min(w,fu(v,!0,T.coordinates,!0,x,w));break;case"Polygon":w=Math.min(w,du(v,!0,T.coordinates,x,w))}if(w===0)return w}return w}(n,this.geometries);if(n.geometryType()==="Polygon")return function(s,u){const p=s.geometry();if(p.length===0||p[0].length===0)return NaN;const v=cu(p,0).map(T=>T.map(M=>M.map(I=>hd([I.x,I.y],s.canonical)))),x=new gd(v[0][0][0][1]);let w=1/0;for(const T of u)for(const M of v){switch(T.type){case"Point":w=Math.min(w,du([T.coordinates],!1,M,x,w));break;case"LineString":w=Math.min(w,du(T.coordinates,!0,M,x,w));break;case"Polygon":w=Math.min(w,jy(M,T.coordinates,x,w))}if(w===0)return w}return w}(n,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Gl{constructor(n){this.type=Ut,this.key=n}static parse(n,s){if(n.length!==2)return s.error(`Expected 1 argument, but found ${n.length-1} instead.`);const u=n[1];return u==null?s.error("Global state property must be defined."):typeof u!="string"?s.error(`Global state property must be string, but found ${typeof n[1]} instead.`):new Gl(u)}evaluate(n){var s;const u=(s=n.globals)===null||s===void 0?void 0:s.globalState;return u&&Object.keys(u).length!==0?Ht(u,this.key):null}eachChild(){}outputDefined(){return!1}}const wa={"==":cd,"!=":Ey,">":ky,"<":My,">=":iu,"<=":Iy,array:Jn,at:fn,boolean:Jn,case:en,coalesce:ei,collator:ou,format:$l,image:ud,in:pa,"index-of":Fl,interpolate:$n,"interpolate-hcl":$n,"interpolate-lab":$n,length:au,let:Ol,literal:jn,match:ma,number:Jn,"number-format":su,object:Jn,slice:Nl,step:_a,string:Jn,"to-boolean":so,"to-color":so,"to-number":so,"to-string":so,var:Bi,within:Fs,distance:Bs,"global-state":Gl};class Ci{constructor(n,s,u,p){this.name=n,this.type=s,this._evaluate=u,this.args=p}evaluate(n){return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}static parse(n,s){const u=n[0],p=Ci.definitions[u];if(!p)return s.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const v=Array.isArray(p)?p[0]:p.type,x=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,w=x.filter(([M])=>!Array.isArray(M)||M.length===n.length-1);let T=null;for(const[M,I]of w){T=new Ll(s.registry,pu,s.path,null,s.scope);const D=[];let B=!1;for(let V=1;V<n.length;V++){const G=n[V],K=Array.isArray(M)?M[V-1]:M.type,ne=T.parse(G,1+D.length,K);if(!ne){B=!0;break}D.push(ne)}if(!B)if(Array.isArray(M)&&M.length!==D.length)T.error(`Expected ${M.length} arguments, but found ${D.length} instead.`);else{for(let V=0;V<D.length;V++){const G=Array.isArray(M)?M[V]:M.type,K=D[V];T.concat(V+1).checkSubtype(G,K.type)}if(T.errors.length===0)return new Ci(u,v,I,D)}}if(w.length===1)s.errors.push(...T.errors);else{const M=(w.length?w:x).map(([D])=>{return B=D,Array.isArray(B)?`(${B.map(Pr).join(", ")})`:`(${Pr(B.type)}...)`;var B}).join(" | "),I=[];for(let D=1;D<n.length;D++){const B=s.parse(n[D],1+I.length);if(!B)return null;I.push(Pr(B.type))}s.error(`Expected arguments of type ${M}, but found (${I.join(", ")}) instead.`)}return null}static register(n,s){Ci.definitions=s;for(const u in s)n[u]=Ci}}function lm(a,[n,s,u,p]){n=n.evaluate(a),s=s.evaluate(a),u=u.evaluate(a);const v=p?p.evaluate(a):1,x=Ot(n,s,u,v);if(x)throw new Er(x);return new Wt(n/255,s/255,u/255,v,!1)}function cm(a,n){return a in n}function Sd(a,n){const s=n[a];return s===void 0?null:s}function js(a){return{type:a}}function pu(a){if(a instanceof Bi)return pu(a.boundExpression);if(a instanceof Ci&&a.name==="error"||a instanceof ou||a instanceof Fs||a instanceof Bs||a instanceof Gl)return!1;const n=a instanceof so||a instanceof Jn;let s=!0;return a.eachChild(u=>{s=n?s&&pu(u):s&&u instanceof jn}),!!s&&mu(a)&&Sa(a,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function mu(a){if(a instanceof Ci&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof Fs||a instanceof Bs)return!1;let n=!0;return a.eachChild(s=>{n&&!mu(s)&&(n=!1)}),n}function Hl(a){if(a instanceof Ci&&a.name==="feature-state")return!1;let n=!0;return a.eachChild(s=>{n&&!Hl(s)&&(n=!1)}),n}function Sa(a,n){if(a instanceof Ci&&n.indexOf(a.name)>=0)return!1;let s=!0;return a.eachChild(u=>{s&&!Sa(u,n)&&(s=!1)}),s}function um(a){return{result:"success",value:a}}function Ta(a){return{result:"error",value:a}}function Ca(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function Td(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function Cd(a){return!!a.expression&&a.expression.interpolated}function qt(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function $s(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)&&zt(a)===io}function hm(a){return a}function dm(a,n){const s=a.stops&&typeof a.stops[0][0]=="object",u=s||!(s||a.property!==void 0),p=a.type||(Cd(n)?"exponential":"interval"),v=function(I){switch(I.type){case"color":return Wt.parse;case"padding":return Jr.parse;case"numberArray":return zn.parse;case"colorArray":return dn.parse;default:return null}}(n);if(v&&((a=bn({},a)).stops&&(a.stops=a.stops.map(I=>[I[0],v(I[1])])),a.default=v(a.default?a.default:n.default)),a.colorSpace&&(x=a.colorSpace)!=="rgb"&&x!=="hcl"&&x!=="lab")throw new Error(`Unknown color space: "${a.colorSpace}"`);var x;const w=function(I){switch(I){case"exponential":return fm;case"interval":return Uy;case"categorical":return $y;case"identity":return pm;default:throw new Error(`Unknown function type "${I}"`)}}(p);let T,M;if(p==="categorical"){T=Object.create(null);for(const I of a.stops)T[I[0]]=I[1];M=typeof a.stops[0][0]}if(s){const I={},D=[];for(let G=0;G<a.stops.length;G++){const K=a.stops[G],ne=K[0].zoom;I[ne]===void 0&&(I[ne]={zoom:ne,type:a.type,property:a.property,default:a.default,stops:[]},D.push(ne)),I[ne].stops.push([K[0].value,K[1]])}const B=[];for(const G of D)B.push([I[G].zoom,dm(I[G],n)]);const V={name:"linear"};return{kind:"composite",interpolationType:V,interpolationFactor:$n.interpolationFactor.bind(void 0,V),zoomStops:B.map(G=>G[0]),evaluate:({zoom:G},K)=>fm({stops:B,base:a.base},n,G).evaluate(G,K)}}if(u){const I=p==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:I,interpolationFactor:$n.interpolationFactor.bind(void 0,I),zoomStops:a.stops.map(D=>D[0]),evaluate:({zoom:D})=>w(a,n,D,T,M)}}return{kind:"source",evaluate(I,D){const B=D&&D.properties?D.properties[a.property]:void 0;return B===void 0?Wl(a.default,n.default):w(a,n,B,T,M)}}}function Wl(a,n,s){return a!==void 0?a:n!==void 0?n:s!==void 0?s:void 0}function $y(a,n,s,u,p){return Wl(typeof s===p?u[s]:void 0,a.default,n.default)}function Uy(a,n,s){if(qt(s)!=="number")return Wl(a.default,n.default);const u=a.stops.length;if(u===1||s<=a.stops[0][0])return a.stops[0][1];if(s>=a.stops[u-1][0])return a.stops[u-1][1];const p=ga(a.stops.map(v=>v[0]),s);return a.stops[p][1]}function fm(a,n,s){const u=a.base!==void 0?a.base:1;if(qt(s)!=="number")return Wl(a.default,n.default);const p=a.stops.length;if(p===1||s<=a.stops[0][0])return a.stops[0][1];if(s>=a.stops[p-1][0])return a.stops[p-1][1];const v=ga(a.stops.map(I=>I[0]),s),x=function(I,D,B,V){const G=V-B,K=I-B;return G===0?0:D===1?K/G:(Math.pow(D,K)-1)/(Math.pow(D,G)-1)}(s,u,a.stops[v][0],a.stops[v+1][0]),w=a.stops[v][1],T=a.stops[v+1][1],M=di[n.type]||hm;return typeof w.evaluate=="function"?{evaluate(...I){const D=w.evaluate.apply(void 0,I),B=T.evaluate.apply(void 0,I);if(D!==void 0&&B!==void 0)return M(D,B,x,a.colorSpace)}}:M(w,T,x,a.colorSpace)}function pm(a,n,s){switch(n.type){case"color":s=Wt.parse(s);break;case"formatted":s=An.fromString(s.toString());break;case"resolvedImage":s=Qn.fromString(s.toString());break;case"padding":s=Jr.parse(s);break;case"colorArray":s=dn.parse(s);break;case"numberArray":s=zn.parse(s);break;default:qt(s)===n.type||n.type==="enum"&&n.values[s]||(s=void 0)}return Wl(s,a.default,n.default)}Ci.register(wa,{error:[{kind:"error"},[jt],(a,[n])=>{throw new Er(n.evaluate(a))}],typeof:[jt,[Ut],(a,[n])=>Pr(zt(n.evaluate(a)))],"to-rgba":[hi(at,4),[ui],(a,[n])=>{const[s,u,p,v]=n.evaluate(a).rgb;return[255*s,255*u,255*p,v]}],rgb:[ui,[at,at,at],lm],rgba:[ui,[at,at,at,at],lm],has:{type:$t,overloads:[[[jt],(a,[n])=>cm(n.evaluate(a),a.properties())],[[jt,io],(a,[n,s])=>cm(n.evaluate(a),s.evaluate(a))]]},get:{type:Ut,overloads:[[[jt],(a,[n])=>Sd(n.evaluate(a),a.properties())],[[jt,io],(a,[n,s])=>Sd(n.evaluate(a),s.evaluate(a))]]},"feature-state":[Ut,[jt],(a,[n])=>Sd(n.evaluate(a),a.featureState||{})],properties:[io,[],a=>a.properties()],"geometry-type":[jt,[],a=>a.geometryType()],id:[Ut,[],a=>a.id()],zoom:[at,[],a=>a.globals.zoom],"heatmap-density":[at,[],a=>a.globals.heatmapDensity||0],elevation:[at,[],a=>a.globals.elevation||0],"line-progress":[at,[],a=>a.globals.lineProgress||0],accumulated:[Ut,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[at,js(at),(a,n)=>{let s=0;for(const u of n)s+=u.evaluate(a);return s}],"*":[at,js(at),(a,n)=>{let s=1;for(const u of n)s*=u.evaluate(a);return s}],"-":{type:at,overloads:[[[at,at],(a,[n,s])=>n.evaluate(a)-s.evaluate(a)],[[at],(a,[n])=>-n.evaluate(a)]]},"/":[at,[at,at],(a,[n,s])=>n.evaluate(a)/s.evaluate(a)],"%":[at,[at,at],(a,[n,s])=>n.evaluate(a)%s.evaluate(a)],ln2:[at,[],()=>Math.LN2],pi:[at,[],()=>Math.PI],e:[at,[],()=>Math.E],"^":[at,[at,at],(a,[n,s])=>Math.pow(n.evaluate(a),s.evaluate(a))],sqrt:[at,[at],(a,[n])=>Math.sqrt(n.evaluate(a))],log10:[at,[at],(a,[n])=>Math.log(n.evaluate(a))/Math.LN10],ln:[at,[at],(a,[n])=>Math.log(n.evaluate(a))],log2:[at,[at],(a,[n])=>Math.log(n.evaluate(a))/Math.LN2],sin:[at,[at],(a,[n])=>Math.sin(n.evaluate(a))],cos:[at,[at],(a,[n])=>Math.cos(n.evaluate(a))],tan:[at,[at],(a,[n])=>Math.tan(n.evaluate(a))],asin:[at,[at],(a,[n])=>Math.asin(n.evaluate(a))],acos:[at,[at],(a,[n])=>Math.acos(n.evaluate(a))],atan:[at,[at],(a,[n])=>Math.atan(n.evaluate(a))],min:[at,js(at),(a,n)=>Math.min(...n.map(s=>s.evaluate(a)))],max:[at,js(at),(a,n)=>Math.max(...n.map(s=>s.evaluate(a)))],abs:[at,[at],(a,[n])=>Math.abs(n.evaluate(a))],round:[at,[at],(a,[n])=>{const s=n.evaluate(a);return s<0?-Math.round(-s):Math.round(s)}],floor:[at,[at],(a,[n])=>Math.floor(n.evaluate(a))],ceil:[at,[at],(a,[n])=>Math.ceil(n.evaluate(a))],"filter-==":[$t,[jt,Ut],(a,[n,s])=>a.properties()[n.value]===s.value],"filter-id-==":[$t,[Ut],(a,[n])=>a.id()===n.value],"filter-type-==":[$t,[jt],(a,[n])=>a.geometryType()===n.value],"filter-<":[$t,[jt,Ut],(a,[n,s])=>{const u=a.properties()[n.value],p=s.value;return typeof u==typeof p&&u<p}],"filter-id-<":[$t,[Ut],(a,[n])=>{const s=a.id(),u=n.value;return typeof s==typeof u&&s<u}],"filter->":[$t,[jt,Ut],(a,[n,s])=>{const u=a.properties()[n.value],p=s.value;return typeof u==typeof p&&u>p}],"filter-id->":[$t,[Ut],(a,[n])=>{const s=a.id(),u=n.value;return typeof s==typeof u&&s>u}],"filter-<=":[$t,[jt,Ut],(a,[n,s])=>{const u=a.properties()[n.value],p=s.value;return typeof u==typeof p&&u<=p}],"filter-id-<=":[$t,[Ut],(a,[n])=>{const s=a.id(),u=n.value;return typeof s==typeof u&&s<=u}],"filter->=":[$t,[jt,Ut],(a,[n,s])=>{const u=a.properties()[n.value],p=s.value;return typeof u==typeof p&&u>=p}],"filter-id->=":[$t,[Ut],(a,[n])=>{const s=a.id(),u=n.value;return typeof s==typeof u&&s>=u}],"filter-has":[$t,[Ut],(a,[n])=>n.value in a.properties()],"filter-has-id":[$t,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[$t,[hi(jt)],(a,[n])=>n.value.indexOf(a.geometryType())>=0],"filter-id-in":[$t,[hi(Ut)],(a,[n])=>n.value.indexOf(a.id())>=0],"filter-in-small":[$t,[jt,hi(Ut)],(a,[n,s])=>s.value.indexOf(a.properties()[n.value])>=0],"filter-in-large":[$t,[jt,hi(Ut)],(a,[n,s])=>function(u,p,v,x){for(;v<=x;){const w=v+x>>1;if(p[w]===u)return!0;p[w]>u?x=w-1:v=w+1}return!1}(a.properties()[n.value],s.value,0,s.value.length-1)],all:{type:$t,overloads:[[[$t,$t],(a,[n,s])=>n.evaluate(a)&&s.evaluate(a)],[js($t),(a,n)=>{for(const s of n)if(!s.evaluate(a))return!1;return!0}]]},any:{type:$t,overloads:[[[$t,$t],(a,[n,s])=>n.evaluate(a)||s.evaluate(a)],[js($t),(a,n)=>{for(const s of n)if(s.evaluate(a))return!0;return!1}]]},"!":[$t,[$t],(a,[n])=>!n.evaluate(a)],"is-supported-script":[$t,[jt],(a,[n])=>{const s=a.globals&&a.globals.isSupportedScript;return!s||s(n.evaluate(a))}],upcase:[jt,[jt],(a,[n])=>n.evaluate(a).toUpperCase()],downcase:[jt,[jt],(a,[n])=>n.evaluate(a).toLowerCase()],concat:[jt,js(Ut),(a,n)=>n.map(s=>Os(s.evaluate(a))).join("")],"resolved-locale":[jt,[So],(a,[n])=>n.evaluate(a).resolvedLocale()]});class gu{constructor(n,s){this.expression=n,this._warningHistory={},this._evaluator=new qp,this._defaultValue=s?function(u){if(u.type==="color"&&$s(u.default))return new Wt(0,0,0,0);switch(u.type){case"color":return Wt.parse(u.default)||null;case"padding":return Jr.parse(u.default)||null;case"numberArray":return zn.parse(u.default)||null;case"colorArray":return dn.parse(u.default)||null;case"variableAnchorOffsetCollection":return er.parse(u.default)||null;case"projectionDefinition":return Lt.parse(u.default)||null;default:return u.default===void 0?null:u.default}}(s):null,this._enumValues=s&&s.type==="enum"?s.values:null}evaluateWithoutErrorHandling(n,s,u,p,v,x){return this._evaluator.globals=n,this._evaluator.feature=s,this._evaluator.featureState=u,this._evaluator.canonical=p,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)}evaluate(n,s,u,p,v,x){this._evaluator.globals=n,this._evaluator.feature=s||null,this._evaluator.featureState=u||null,this._evaluator.canonical=p,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=x||null;try{const w=this.expression.evaluate(this._evaluator);if(w==null||typeof w=="number"&&w!=w)return this._defaultValue;if(this._enumValues&&!(w in this._enumValues))throw new Er(`Expected value to be one of ${Object.keys(this._enumValues).map(T=>JSON.stringify(T)).join(", ")}, but found ${JSON.stringify(w)} instead.`);return w}catch(w){return this._warningHistory[w.message]||(this._warningHistory[w.message]=!0,typeof console<"u"&&console.warn(w.message)),this._defaultValue}}}function _u(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in wa}function yu(a,n){const s=new Ll(wa,pu,[],n?function(p){const v={color:ui,string:jt,number:at,enum:jt,boolean:$t,formatted:zs,padding:Gr,numberArray:Il,colorArray:kl,projectionDefinition:Qc,resolvedImage:To,variableAnchorOffsetCollection:Al};return p.type==="array"?hi(v[p.value]||Ut,p.length):v[p.type]}(n):void 0),u=s.parse(a,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?um(new gu(u,n)):Ta(s.errors)}class ql{constructor(n,s){this.kind=n,this._styleExpression=s,this.isStateDependent=n!=="constant"&&!Hl(s.expression),this.globalStateRefs=Ea(s.expression)}evaluateWithoutErrorHandling(n,s,u,p,v,x){return this._styleExpression.evaluateWithoutErrorHandling(n,s,u,p,v,x)}evaluate(n,s,u,p,v,x){return this._styleExpression.evaluate(n,s,u,p,v,x)}}class vu{constructor(n,s,u,p){this.kind=n,this.zoomStops=u,this._styleExpression=s,this.isStateDependent=n!=="camera"&&!Hl(s.expression),this.globalStateRefs=Ea(s.expression),this.interpolationType=p}evaluateWithoutErrorHandling(n,s,u,p,v,x){return this._styleExpression.evaluateWithoutErrorHandling(n,s,u,p,v,x)}evaluate(n,s,u,p,v,x){return this._styleExpression.evaluate(n,s,u,p,v,x)}interpolationFactor(n,s,u){return this.interpolationType?$n.interpolationFactor(this.interpolationType,n,s,u):0}}function Pd(a,n){const s=yu(a,n);if(s.result==="error")return s;const u=s.value.expression,p=mu(u);if(!p&&!Ca(n))return Ta([new Cr("","data expressions not supported")]);const v=Sa(u,["zoom"]);if(!v&&!Td(n))return Ta([new Cr("","zoom expressions not supported")]);const x=Pa(u);return x||v?x instanceof Cr?Ta([x]):x instanceof $n&&!Cd(n)?Ta([new Cr("",'"interpolate" expressions cannot be used with this property')]):um(x?new vu(p?"camera":"composite",s.value,x.labels,x instanceof $n?x.interpolation:void 0):new ql(p?"constant":"source",s.value)):Ta([new Cr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Xl{constructor(n,s){this._parameters=n,this._specification=s,bn(this,dm(this._parameters,this._specification))}static deserialize(n){return new Xl(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function Pa(a){let n=null;if(a instanceof Ol)n=Pa(a.result);else if(a instanceof ei){for(const s of a.args)if(n=Pa(s),n)break}else(a instanceof _a||a instanceof $n)&&a.input instanceof Ci&&a.input.name==="zoom"&&(n=a);return n instanceof Cr||a.eachChild(s=>{const u=Pa(s);u instanceof Cr?n=u:!n&&u?n=new Cr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&u&&n!==u&&(n=new Cr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}function Ea(a,n=new Set){return a instanceof Gl&&n.add(a.key),a.eachChild(s=>{Ea(s,n)}),n}function Kl(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const n of a.slice(1))if(!Kl(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}const Ed={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ts(a){if(a==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Kl(a)||(a=xu(a));const n=yu(a,Ed);if(n.result==="error")throw new Error(n.value.map(s=>`${s.key}: ${s.message}`).join(", "));return{filter:(s,u,p)=>n.value.evaluate(s,u,{},p),needGeometry:mm(a),getGlobalStateRefs:()=>Ea(n.value.expression)}}function Vy(a,n){return a<n?-1:a>n?1:0}function mm(a){if(!Array.isArray(a))return!1;if(a[0]==="within"||a[0]==="distance")return!0;for(let n=1;n<a.length;n++)if(mm(a[n]))return!0;return!1}function xu(a){if(!a)return!0;const n=a[0];return a.length<=1?n!=="any":n==="=="?Md(a[1],a[2],"=="):n==="!="?Yl(Md(a[1],a[2],"==")):n==="<"||n===">"||n==="<="||n===">="?Md(a[1],a[2],n):n==="any"?(s=a.slice(1),["any"].concat(s.map(xu))):n==="all"?["all"].concat(a.slice(1).map(xu)):n==="none"?["all"].concat(a.slice(1).map(xu).map(Yl)):n==="in"?gm(a[1],a.slice(2)):n==="!in"?Yl(gm(a[1],a.slice(2))):n==="has"?_m(a[1]):n!=="!has"||Yl(_m(a[1]));var s}function Md(a,n,s){switch(a){case"$type":return[`filter-type-${s}`,n];case"$id":return[`filter-id-${s}`,n];default:return[`filter-${s}`,a,n]}}function gm(a,n){if(n.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(s=>typeof s!=typeof n[0])?["filter-in-large",a,["literal",n.sort(Vy)]]:["filter-in-small",a,["literal",n]]}}function _m(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Yl(a){return["!",a]}function bu(a){const n=typeof a;if(n==="number"||n==="boolean"||n==="string"||a==null)return JSON.stringify(a);if(Array.isArray(a)){let p="[";for(const v of a)p+=`${bu(v)},`;return`${p}]`}const s=Object.keys(a).sort();let u="{";for(let p=0;p<s.length;p++)u+=`${JSON.stringify(s[p])}:${bu(a[s[p]])},`;return`${u}}`}function wu(a){let n="";for(const s of Qe)n+=`/${bu(a[s])}`;return n}function ym(a){const n=a.value;return n?[new nt(a.key,n,"constants have been deprecated as of v8")]:[]}function Dr(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function rs(a){if(Array.isArray(a))return a.map(rs);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const n={};for(const s in a)n[s]=rs(a[s]);return n}return Dr(a)}function Pi(a){const n=a.key,s=a.value,u=a.valueSpec||{},p=a.objectElementValidators||{},v=a.style,x=a.styleSpec,w=a.validateSpec;let T=[];const M=qt(s);if(M!=="object")return[new nt(n,s,`object expected, ${M} found`)];for(const I in s){const D=I.split(".")[0],B=Ht(u,D)||u["*"];let V;if(Ht(p,D))V=p[D];else if(Ht(u,D))V=w;else if(p["*"])V=p["*"];else{if(!u["*"]){T.push(new nt(n,s[I],`unknown property "${I}"`));continue}V=w}T=T.concat(V({key:(n&&`${n}.`)+I,value:s[I],valueSpec:B,style:v,styleSpec:x,object:s,objectKey:I,validateSpec:w},s))}for(const I in u)p[I]||u[I].required&&u[I].default===void 0&&s[I]===void 0&&T.push(new nt(n,s,`missing required property "${I}"`));return T}function Su(a){const n=a.value,s=a.valueSpec,u=a.style,p=a.styleSpec,v=a.key,x=a.arrayElementValidator||a.validateSpec;if(qt(n)!=="array")return[new nt(v,n,`array expected, ${qt(n)} found`)];if(s.length&&n.length!==s.length)return[new nt(v,n,`array length ${s.length} expected, length ${n.length} found`)];if(s["min-length"]&&n.length<s["min-length"])return[new nt(v,n,`array length at least ${s["min-length"]} expected, length ${n.length} found`)];let w={type:s.value,values:s.values};p.$version<7&&(w.function=s.function),qt(s.value)==="object"&&(w=s.value);let T=[];for(let M=0;M<n.length;M++)T=T.concat(x({array:n,arrayIndex:M,value:n[M],valueSpec:w,validateSpec:a.validateSpec,style:u,styleSpec:p,key:`${v}[${M}]`}));return T}function Ql(a){const n=a.key,s=a.value,u=a.valueSpec;let p=qt(s);return p==="number"&&s!=s&&(p="NaN"),p!=="number"?[new nt(n,s,`number expected, ${p} found`)]:"minimum"in u&&s<u.minimum?[new nt(n,s,`${s} is less than the minimum value ${u.minimum}`)]:"maximum"in u&&s>u.maximum?[new nt(n,s,`${s} is greater than the maximum value ${u.maximum}`)]:[]}function Ma(a){const n=a.valueSpec,s=Dr(a.value.type);let u,p,v,x={};const w=s!=="categorical"&&a.value.property===void 0,T=!w,M=qt(a.value.stops)==="array"&&qt(a.value.stops[0])==="array"&&qt(a.value.stops[0][0])==="object",I=Pi({key:a.key,value:a.value,valueSpec:a.styleSpec.function,validateSpec:a.validateSpec,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(V){if(s==="identity")return[new nt(V.key,V.value,'identity function may not have a "stops" property')];let G=[];const K=V.value;return G=G.concat(Su({key:V.key,value:K,valueSpec:V.valueSpec,validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec,arrayElementValidator:D})),qt(K)==="array"&&K.length===0&&G.push(new nt(V.key,K,"array must have at least one stop")),G},default:function(V){return V.validateSpec({key:V.key,value:V.value,valueSpec:n,validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec})}}});return s==="identity"&&w&&I.push(new nt(a.key,a.value,'missing required property "property"')),s==="identity"||a.value.stops||I.push(new nt(a.key,a.value,'missing required property "stops"')),s==="exponential"&&a.valueSpec.expression&&!Cd(a.valueSpec)&&I.push(new nt(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(T&&!Ca(a.valueSpec)?I.push(new nt(a.key,a.value,"property functions not supported")):w&&!Td(a.valueSpec)&&I.push(new nt(a.key,a.value,"zoom functions not supported"))),s!=="categorical"&&!M||a.value.property!==void 0||I.push(new nt(a.key,a.value,'"property" property is required')),I;function D(V){let G=[];const K=V.value,ne=V.key;if(qt(K)!=="array")return[new nt(ne,K,`array expected, ${qt(K)} found`)];if(K.length!==2)return[new nt(ne,K,`array length 2 expected, length ${K.length} found`)];if(M){if(qt(K[0])!=="object")return[new nt(ne,K,`object expected, ${qt(K[0])} found`)];if(K[0].zoom===void 0)return[new nt(ne,K,"object stop key must have zoom")];if(K[0].value===void 0)return[new nt(ne,K,"object stop key must have value")];if(v&&v>Dr(K[0].zoom))return[new nt(ne,K[0].zoom,"stop zoom values must appear in ascending order")];Dr(K[0].zoom)!==v&&(v=Dr(K[0].zoom),p=void 0,x={}),G=G.concat(Pi({key:`${ne}[0]`,value:K[0],valueSpec:{zoom:{}},validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec,objectElementValidators:{zoom:Ql,value:B}}))}else G=G.concat(B({key:`${ne}[0]`,value:K[0],validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec},K));return _u(rs(K[1]))?G.concat([new nt(`${ne}[1]`,K[1],"expressions are not allowed in function stops.")]):G.concat(V.validateSpec({key:`${ne}[1]`,value:K[1],valueSpec:n,validateSpec:V.validateSpec,style:V.style,styleSpec:V.styleSpec}))}function B(V,G){const K=qt(V.value),ne=Dr(V.value),le=V.value!==null?V.value:G;if(u){if(K!==u)return[new nt(V.key,le,`${K} stop domain type must match previous stop domain type ${u}`)]}else u=K;if(K!=="number"&&K!=="string"&&K!=="boolean")return[new nt(V.key,le,"stop domain value must be a number, string, or boolean")];if(K!=="number"&&s!=="categorical"){let Se=`number expected, ${K} found`;return Ca(n)&&s===void 0&&(Se+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new nt(V.key,le,Se)]}return s!=="categorical"||K!=="number"||isFinite(ne)&&Math.floor(ne)===ne?s!=="categorical"&&K==="number"&&p!==void 0&&ne<p?[new nt(V.key,le,"stop domain values must appear in ascending order")]:(p=ne,s==="categorical"&&ne in x?[new nt(V.key,le,"stop domain values must be unique")]:(x[ne]=!0,[])):[new nt(V.key,le,`integer expected, found ${ne}`)]}}function ka(a){const n=(a.expressionContext==="property"?Pd:yu)(rs(a.value),a.valueSpec);if(n.result==="error")return n.value.map(u=>new nt(`${a.key}${u.key}`,a.value,u.message));const s=n.value.expression||n.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!s.outputDefined())return[new nt(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!Hl(s))return[new nt(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter"&&!Hl(s))return[new nt(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!Sa(s,["zoom","feature-state"]))return[new nt(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!mu(s))return[new nt(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function kd(a){const n=a.key,s=a.value,u=qt(s);return u!=="string"?[new nt(n,s,`color expected, ${u} found`)]:Wt.parse(String(s))?[]:[new nt(n,s,`color expected, "${s}" found`)]}function Jl(a){const n=a.key,s=a.value,u=a.valueSpec,p=[];return Array.isArray(u.values)?u.values.indexOf(Dr(s))===-1&&p.push(new nt(n,s,`expected one of [${u.values.join(", ")}], ${JSON.stringify(s)} found`)):Object.keys(u.values).indexOf(Dr(s))===-1&&p.push(new nt(n,s,`expected one of [${Object.keys(u.values).join(", ")}], ${JSON.stringify(s)} found`)),p}function Id(a){return Kl(rs(a.value))?ka(bn({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):vm(a)}function vm(a){const n=a.value,s=a.key;if(qt(n)!=="array")return[new nt(s,n,`array expected, ${qt(n)} found`)];const u=a.styleSpec;let p,v=[];if(n.length<1)return[new nt(s,n,"filter array must have at least 1 element")];switch(v=v.concat(Jl({key:`${s}[0]`,value:n[0],valueSpec:u.filter_operator,style:a.style,styleSpec:a.styleSpec})),Dr(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&Dr(n[1])==="$type"&&v.push(new nt(s,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&v.push(new nt(s,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(p=qt(n[1]),p!=="string"&&v.push(new nt(`${s}[1]`,n[1],`string expected, ${p} found`)));for(let x=2;x<n.length;x++)p=qt(n[x]),Dr(n[1])==="$type"?v=v.concat(Jl({key:`${s}[${x}]`,value:n[x],valueSpec:u.geometry_type,style:a.style,styleSpec:a.styleSpec})):p!=="string"&&p!=="number"&&p!=="boolean"&&v.push(new nt(`${s}[${x}]`,n[x],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let x=1;x<n.length;x++)v=v.concat(vm({key:`${s}[${x}]`,value:n[x],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":p=qt(n[1]),n.length!==2?v.push(new nt(s,n,`filter array for "${n[0]}" operator must have 2 elements`)):p!=="string"&&v.push(new nt(`${s}[1]`,n[1],`string expected, ${p} found`))}return v}function xm(a,n){const s=a.key,u=a.validateSpec,p=a.style,v=a.styleSpec,x=a.value,w=a.objectKey,T=v[`${n}_${a.layerType}`];if(!T)return[];const M=w.match(/^(.*)-transition$/);if(n==="paint"&&M&&T[M[1]]&&T[M[1]].transition)return u({key:s,value:x,valueSpec:v.transition,style:p,styleSpec:v});const I=a.valueSpec||T[w];if(!I)return[new nt(s,x,`unknown property "${w}"`)];let D;if(qt(x)==="string"&&Ca(I)&&!I.tokens&&(D=/^{([^}]+)}$/.exec(x)))return[new nt(s,x,`"${w}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(D[1])} }\`.`)];const B=[];return a.layerType==="symbol"&&(w==="text-field"&&p&&!p.glyphs&&B.push(new nt(s,x,'use of "text-field" requires a style "glyphs" property')),w==="text-font"&&$s(rs(x))&&Dr(x.type)==="identity"&&B.push(new nt(s,x,'"text-font" does not support identity functions'))),B.concat(u({key:a.key,value:x,valueSpec:I,style:p,styleSpec:v,expressionContext:"property",propertyType:n,propertyKey:w}))}function Ia(a){return xm(a,"paint")}function Aa(a){return xm(a,"layout")}function ti(a){let n=[];const s=a.value,u=a.key,p=a.style,v=a.styleSpec;if(qt(s)!=="object")return[new nt(u,s,`object expected, ${qt(s)} found`)];s.type||s.ref||n.push(new nt(u,s,'either "type" or "ref" is required'));let x=Dr(s.type);const w=Dr(s.ref);if(s.id){const T=Dr(s.id);for(let M=0;M<a.arrayIndex;M++){const I=p.layers[M];Dr(I.id)===T&&n.push(new nt(u,s.id,`duplicate layer id "${s.id}", previously used at line ${I.id.__line__}`))}}if("ref"in s){let T;["type","source","source-layer","filter","layout"].forEach(M=>{M in s&&n.push(new nt(u,s[M],`"${M}" is prohibited for ref layers`))}),p.layers.forEach(M=>{Dr(M.id)===w&&(T=M)}),T?T.ref?n.push(new nt(u,s.ref,"ref cannot reference another ref layer")):x=Dr(T.type):n.push(new nt(u,s.ref,`ref layer "${w}" not found`))}else if(x!=="background")if(s.source){const T=p.sources&&p.sources[s.source],M=T&&Dr(T.type);T?M==="vector"&&x==="raster"?n.push(new nt(u,s.source,`layer "${s.id}" requires a raster source`)):M!=="raster-dem"&&x==="hillshade"||M!=="raster-dem"&&x==="color-relief"?n.push(new nt(u,s.source,`layer "${s.id}" requires a raster-dem source`)):M==="raster"&&x!=="raster"?n.push(new nt(u,s.source,`layer "${s.id}" requires a vector source`)):M!=="vector"||s["source-layer"]?M==="raster-dem"&&x!=="hillshade"&&x!=="color-relief"?n.push(new nt(u,s.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):x!=="line"||!s.paint||!s.paint["line-gradient"]||M==="geojson"&&T.lineMetrics||n.push(new nt(u,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):n.push(new nt(u,s,`layer "${s.id}" must specify a "source-layer"`)):n.push(new nt(u,s.source,`source "${s.source}" not found`))}else n.push(new nt(u,s,'missing required property "source"'));return n=n.concat(Pi({key:u,value:s,valueSpec:v.layer,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,objectElementValidators:{"*":()=>[],type:()=>a.validateSpec({key:`${u}.type`,value:s.type,valueSpec:v.layer.type,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,object:s,objectKey:"type"}),filter:Id,layout:T=>Pi({layer:s,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":M=>Aa(bn({layerType:x},M))}}),paint:T=>Pi({layer:s,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":M=>Ia(bn({layerType:x},M))}})}})),n}function ji(a){const n=a.value,s=a.key,u=qt(n);return u!=="string"?[new nt(s,n,`string expected, ${u} found`)]:[]}const Ad={promoteId:function({key:a,value:n}){if(qt(n)==="string")return ji({key:a,value:n});{const s=[];for(const u in n)s.push(...ji({key:`${a}.${u}`,value:n[u]}));return s}}};function bm(a){const n=a.value,s=a.key,u=a.styleSpec,p=a.style,v=a.validateSpec;if(!n.type)return[new nt(s,n,'"type" is required')];const x=Dr(n.type);let w;switch(x){case"vector":case"raster":return w=Pi({key:s,value:n,valueSpec:u[`source_${x.replace("-","_")}`],style:a.style,styleSpec:u,objectElementValidators:Ad,validateSpec:v}),w;case"raster-dem":return w=function(T){var M;const I=(M=T.sourceName)!==null&&M!==void 0?M:"",D=T.value,B=T.styleSpec,V=B.source_raster_dem,G=T.style;let K=[];const ne=qt(D);if(D===void 0)return K;if(ne!=="object")return K.push(new nt("source_raster_dem",D,`object expected, ${ne} found`)),K;const le=Dr(D.encoding)==="custom",Se=["redFactor","greenFactor","blueFactor","baseShift"],me=T.value.encoding?`"${T.value.encoding}"`:"Default";for(const $ in D)!le&&Se.includes($)?K.push(new nt($,D[$],`In "${I}": "${$}" is only valid when "encoding" is set to "custom". ${me} encoding found`)):V[$]?K=K.concat(T.validateSpec({key:$,value:D[$],valueSpec:V[$],validateSpec:T.validateSpec,style:G,styleSpec:B})):K.push(new nt($,D[$],`unknown property "${$}"`));return K}({sourceName:s,value:n,style:a.style,styleSpec:u,validateSpec:v}),w;case"geojson":if(w=Pi({key:s,value:n,valueSpec:u.source_geojson,style:p,styleSpec:u,validateSpec:v,objectElementValidators:Ad}),n.cluster)for(const T in n.clusterProperties){const[M,I]=n.clusterProperties[T],D=typeof M=="string"?[M,["accumulated"],["get",T]]:M;w.push(...ka({key:`${s}.${T}.map`,value:I,expressionContext:"cluster-map"})),w.push(...ka({key:`${s}.${T}.reduce`,value:D,expressionContext:"cluster-reduce"}))}return w;case"video":return Pi({key:s,value:n,valueSpec:u.source_video,style:p,validateSpec:v,styleSpec:u});case"image":return Pi({key:s,value:n,valueSpec:u.source_image,style:p,validateSpec:v,styleSpec:u});case"canvas":return[new nt(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Jl({key:`${s}.type`,value:n.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function wm(a){const n=a.value,s=a.styleSpec,u=s.light,p=a.style;let v=[];const x=qt(n);if(n===void 0)return v;if(x!=="object")return v=v.concat([new nt("light",n,`object expected, ${x} found`)]),v;for(const w in n){const T=w.match(/^(.*)-transition$/);v=v.concat(T&&u[T[1]]&&u[T[1]].transition?a.validateSpec({key:w,value:n[w],valueSpec:s.transition,validateSpec:a.validateSpec,style:p,styleSpec:s}):u[w]?a.validateSpec({key:w,value:n[w],valueSpec:u[w],validateSpec:a.validateSpec,style:p,styleSpec:s}):[new nt(w,n[w],`unknown property "${w}"`)])}return v}function za(a){const n=a.value,s=a.styleSpec,u=s.sky,p=a.style,v=qt(n);if(n===void 0)return[];if(v!=="object")return[new nt("sky",n,`object expected, ${v} found`)];let x=[];for(const w in n)x=x.concat(u[w]?a.validateSpec({key:w,value:n[w],valueSpec:u[w],style:p,styleSpec:s}):[new nt(w,n[w],`unknown property "${w}"`)]);return x}function zd(a){const n=a.value,s=a.styleSpec,u=s.terrain,p=a.style;let v=[];const x=qt(n);if(n===void 0)return v;if(x!=="object")return v=v.concat([new nt("terrain",n,`object expected, ${x} found`)]),v;for(const w in n)v=v.concat(u[w]?a.validateSpec({key:w,value:n[w],valueSpec:u[w],validateSpec:a.validateSpec,style:p,styleSpec:s}):[new nt(w,n[w],`unknown property "${w}"`)]);return v}function Tu(a){let n=[];const s=a.value,u=a.key;if(Array.isArray(s)){const p=[],v=[];for(const x in s)s[x].id&&p.includes(s[x].id)&&n.push(new nt(u,s,`all the sprites' ids must be unique, but ${s[x].id} is duplicated`)),p.push(s[x].id),s[x].url&&v.includes(s[x].url)&&n.push(new nt(u,s,`all the sprites' URLs must be unique, but ${s[x].url} is duplicated`)),v.push(s[x].url),n=n.concat(Pi({key:`${u}[${x}]`,value:s[x],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:a.validateSpec}));return n}return ji({key:u,value:s})}function Sm(a){return n=a.value,n&&n.constructor===Object?[]:[new nt(a.key,a.value,`object expected, ${qt(a.value)} found`)];var n}const Cu={"*":()=>[],array:Su,boolean:function(a){const n=a.value,s=a.key,u=qt(n);return u!=="boolean"?[new nt(s,n,`boolean expected, ${u} found`)]:[]},number:Ql,color:kd,constants:ym,enum:Jl,filter:Id,function:Ma,layer:ti,object:Pi,source:bm,light:wm,sky:za,terrain:zd,projection:function(a){const n=a.value,s=a.styleSpec,u=s.projection,p=a.style,v=qt(n);if(n===void 0)return[];if(v!=="object")return[new nt("projection",n,`object expected, ${v} found`)];let x=[];for(const w in n)x=x.concat(u[w]?a.validateSpec({key:w,value:n[w],valueSpec:u[w],style:p,styleSpec:s}):[new nt(w,n[w],`unknown property "${w}"`)]);return x},projectionDefinition:function(a){const n=a.key;let s=a.value;s=s instanceof String?s.valueOf():s;const u=qt(s);return u!=="array"||function(p){return Array.isArray(p)&&p.length===3&&typeof p[0]=="string"&&typeof p[1]=="string"&&typeof p[2]=="number"}(s)||function(p){return!!["interpolate","step","literal"].includes(p[0])}(s)?["array","string"].includes(u)?[]:[new nt(n,s,`projection expected, invalid type "${u}" found`)]:[new nt(n,s,`projection expected, invalid array ${JSON.stringify(s)} found`)]},string:ji,formatted:function(a){return ji(a).length===0?[]:ka(a)},resolvedImage:function(a){return ji(a).length===0?[]:ka(a)},padding:function(a){const n=a.key,s=a.value;if(qt(s)==="array"){if(s.length<1||s.length>4)return[new nt(n,s,`padding requires 1 to 4 values; ${s.length} values found`)];const u={type:"number"};let p=[];for(let v=0;v<s.length;v++)p=p.concat(a.validateSpec({key:`${n}[${v}]`,value:s[v],validateSpec:a.validateSpec,valueSpec:u}));return p}return Ql({key:n,value:s,valueSpec:{}})},numberArray:function(a){const n=a.key,s=a.value;if(qt(s)==="array"){const u={type:"number"};if(s.length<1)return[new nt(n,s,"array length at least 1 expected, length 0 found")];let p=[];for(let v=0;v<s.length;v++)p=p.concat(a.validateSpec({key:`${n}[${v}]`,value:s[v],validateSpec:a.validateSpec,valueSpec:u}));return p}return Ql({key:n,value:s,valueSpec:{}})},colorArray:function(a){const n=a.key,s=a.value;if(qt(s)==="array"){if(s.length<1)return[new nt(n,s,"array length at least 1 expected, length 0 found")];let u=[];for(let p=0;p<s.length;p++)u=u.concat(kd({key:`${n}[${p}]`,value:s[p]}));return u}return kd({key:n,value:s})},variableAnchorOffsetCollection:function(a){const n=a.key,s=a.value,u=qt(s),p=a.styleSpec;if(u!=="array"||s.length<1||s.length%2!=0)return[new nt(n,s,"variableAnchorOffsetCollection requires a non-empty array of even length")];let v=[];for(let x=0;x<s.length;x+=2)v=v.concat(Jl({key:`${n}[${x}]`,value:s[x],valueSpec:p.layout_symbol["text-anchor"]})),v=v.concat(Su({key:`${n}[${x+1}]`,value:s[x+1],valueSpec:{length:2,value:"number"},validateSpec:a.validateSpec,style:a.style,styleSpec:p}));return v},sprite:Tu,state:Sm};function Pu(a){const n=a.value,s=a.valueSpec,u=a.styleSpec;return a.validateSpec=Pu,s.expression&&$s(Dr(n))?Ma(a):s.expression&&_u(rs(n))?ka(a):s.type&&Cu[s.type]?Cu[s.type](a):Pi(bn({},a,{valueSpec:s.type?u[s.type]:s}))}function Ra(a){const n=a.value,s=a.key,u=ji(a);return u.length||(n.indexOf("{fontstack}")===-1&&u.push(new nt(s,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&u.push(new nt(s,n,'"glyphs" url must include a "{range}" token'))),u}function Ei(a,n=he){let s=[];return s=s.concat(Pu({key:"",value:a,valueSpec:n.$root,styleSpec:n,style:a,validateSpec:Pu,objectElementValidators:{glyphs:Ra,"*":()=>[]}})),a.constants&&(s=s.concat(ym({key:"constants",value:a.constants}))),Tm(s)}function $i(a){return function(n){return a({...n,validateSpec:Pu})}}function Tm(a){return[].concat(a).sort((n,s)=>n.line-s.line)}function Un(a){return function(...n){return Tm(a.apply(this,n))}}Ei.source=Un($i(bm)),Ei.sprite=Un($i(Tu)),Ei.glyphs=Un($i(Ra)),Ei.light=Un($i(wm)),Ei.sky=Un($i(za)),Ei.terrain=Un($i(zd)),Ei.state=Un($i(Sm)),Ei.layer=Un($i(ti)),Ei.filter=Un($i(Id)),Ei.paintProperty=Un($i(Ia)),Ei.layoutProperty=Un($i(Aa));const Da=Ei,Zy=Da.light,Eu=Da.sky,Gy=Da.paintProperty,Rd=Da.layoutProperty;function ec(a,n){let s=!1;if(n&&n.length)for(const u of n)a.fire(new ke(new Error(u.message))),s=!0;return s}class La{constructor(n,s,u){const p=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;const x=new Int32Array(this.arrayBuffer);n=x[0],this.d=(s=x[1])+2*(u=x[2]);for(let T=0;T<this.d*this.d;T++){const M=x[3+T],I=x[3+T+1];p.push(M===I?null:x.subarray(M,I))}const w=x[3+p.length+1];this.keys=x.subarray(x[3+p.length],w),this.bboxes=x.subarray(w),this.insert=this._insertReadonly}else{this.d=s+2*u;for(let x=0;x<this.d*this.d;x++)p.push([]);this.keys=[],this.bboxes=[]}this.n=s,this.extent=n,this.padding=u,this.scale=s/n,this.uid=0;const v=u/s*n;this.min=-v,this.max=n+v}insert(n,s,u,p,v){this._forEachCell(s,u,p,v,this._insertCell,this.uid++,void 0,void 0),this.keys.push(n),this.bboxes.push(s),this.bboxes.push(u),this.bboxes.push(p),this.bboxes.push(v)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(n,s,u,p,v,x){this.cells[v].push(x)}query(n,s,u,p,v){const x=this.min,w=this.max;if(n<=x&&s<=x&&w<=u&&w<=p&&!v)return Array.prototype.slice.call(this.keys);{const T=[];return this._forEachCell(n,s,u,p,this._queryCell,T,{},v),T}}_queryCell(n,s,u,p,v,x,w,T){const M=this.cells[v];if(M!==null){const I=this.keys,D=this.bboxes;for(let B=0;B<M.length;B++){const V=M[B];if(w[V]===void 0){const G=4*V;(T?T(D[G+0],D[G+1],D[G+2],D[G+3]):n<=D[G+2]&&s<=D[G+3]&&u>=D[G+0]&&p>=D[G+1])?(w[V]=!0,x.push(I[V])):w[V]=!1}}}}_forEachCell(n,s,u,p,v,x,w,T){const M=this._convertToCellCoord(n),I=this._convertToCellCoord(s),D=this._convertToCellCoord(u),B=this._convertToCellCoord(p);for(let V=M;V<=D;V++)for(let G=I;G<=B;G++){const K=this.d*G+V;if((!T||T(this._convertFromCellCoord(V),this._convertFromCellCoord(G),this._convertFromCellCoord(V+1),this._convertFromCellCoord(G+1)))&&v.call(this,n,s,u,p,K,x,w,T))return}}_convertFromCellCoord(n){return(n-this.padding)/this.scale}_convertToCellCoord(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const n=this.cells,s=3+this.cells.length+1+1;let u=0;for(let x=0;x<this.cells.length;x++)u+=this.cells[x].length;const p=new Int32Array(s+u+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;let v=s;for(let x=0;x<n.length;x++){const w=n[x];p[3+x]=v,p.set(w,v),v+=w.length}return p[3+n.length]=v,p.set(this.keys,v),v+=this.keys.length,p[3+n.length+1]=v,p.set(this.bboxes,v),v+=this.bboxes.length,p.buffer}static serialize(n,s){const u=n.toArrayBuffer();return s&&s.push(u),{buffer:u}}static deserialize(n){return new La(n.buffer)}}const lo={};function _t(a,n,s={}){if(lo[a])throw new Error(`${a} is already registered.`);Object.defineProperty(n,"_classRegistryKey",{value:a,writeable:!1}),lo[a]={klass:n,omit:s.omit||[],shallow:s.shallow||[]}}_t("Object",Object),_t("Set",Set),_t("TransferableGridIndex",La),_t("Color",Wt),_t("Error",Error),_t("AJAXError",de),_t("ResolvedImage",Qn),_t("StylePropertyFunction",Xl),_t("StyleExpression",gu,{omit:["_evaluator"]}),_t("ZoomDependentExpression",vu),_t("ZoomConstantExpression",ql),_t("CompoundExpression",Ci,{omit:["_evaluate"]});for(const a in wa)wa[a]._classRegistryKey||_t(`Expression_${a}`,wa[a]);function Dd(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function tc(a){return a.$name||a.constructor._classRegistryKey}function Ld(a){return!function(n){if(n===null||typeof n!="object")return!1;const s=tc(n);return!(!s||s==="Object")}(a)&&(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||a instanceof Error||Dd(a)||Yn(a)||ArrayBuffer.isView(a)||a instanceof ImageData)}function rc(a,n){if(Ld(a))return(Dd(a)||Yn(a))&&n&&n.push(a),ArrayBuffer.isView(a)&&n&&n.push(a.buffer),a instanceof ImageData&&n&&n.push(a.data.buffer),a;if(Array.isArray(a)){const v=[];for(const x of a)v.push(rc(x,n));return v}if(typeof a!="object")throw new Error("can't serialize object of type "+typeof a);const s=tc(a);if(!s)throw new Error(`can't serialize object of unregistered class ${a.constructor.name}`);if(!lo[s])throw new Error(`${s} is not registered.`);const{klass:u}=lo[s],p=u.serialize?u.serialize(a,n):{};if(u.serialize){if(n&&p===n[n.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const v in a){if(!a.hasOwnProperty(v)||lo[s].omit.indexOf(v)>=0)continue;const x=a[v];p[v]=lo[s].shallow.indexOf(v)>=0?x:rc(x,n)}a instanceof Error&&(p.message=a.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return s!=="Object"&&(p.$name=s),p}function Oa(a){if(Ld(a))return a;if(Array.isArray(a))return a.map(Oa);if(typeof a!="object")throw new Error("can't deserialize object of type "+typeof a);const n=tc(a)||"Object";if(!lo[n])throw new Error(`can't deserialize unregistered class ${n}`);const{klass:s}=lo[n];if(!s)throw new Error(`can't deserialize unregistered class ${n}`);if(s.deserialize)return s.deserialize(a);const u=Object.create(s.prototype);for(const p of Object.keys(a)){if(p==="$name")continue;const v=a[p];u[p]=lo[n].shallow.indexOf(p)>=0?v:Oa(v)}return u}class Od{constructor(){this.first=!0}update(n,s){const u=Math.floor(n);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=n,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=s):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=s),n!==this.lastZoom&&(this.lastZoom=n,this.lastFloorZoom=u,!0))}}const Xt={"Latin-1 Supplement":a=>a>=128&&a<=255,"Hangul Jamo":a=>a>=4352&&a<=4607,Khmer:a=>a>=6016&&a<=6143,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Hiragana:a=>a>=12352&&a<=12447,Katakana:a=>a>=12448&&a<=12543,Kanbun:a=>a>=12688&&a<=12703,"CJK Strokes":a=>a>=12736&&a<=12783,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"CJK Unified Ideographs":a=>a>=19968&&a<=40959,"Hangul Syllables":a=>a>=44032&&a<=55215,"Private Use Area":a=>a>=57344&&a<=63743,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function Fd(a){for(const n of a)if(ku(n.charCodeAt(0)))return!0;return!1}function Cm(a){for(const n of a)if(!Wy(n.charCodeAt(0)))return!1;return!0}function Mu(a){const n=a.map(s=>{try{return new RegExp(`\\p{sc=${s}}`,"u").source}catch{return null}}).filter(s=>s);return new RegExp(n.join("|"),"u")}const Hy=Mu(["Arab","Dupl","Mong","Ougr","Syrc"]);function Wy(a){return!Hy.test(String.fromCodePoint(a))}const Nd=Mu(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function ku(a){return!(a!==746&&a!==747&&(a<4352||!(Xt["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||Xt["CJK Compatibility"](a)||Xt["CJK Strokes"](a)||!(!Xt["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||Xt["Enclosed CJK Letters and Months"](a)||Xt["Ideographic Description Characters"](a)||Xt.Kanbun(a)||Xt.Katakana(a)&&a!==12540||!(!Xt["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!Xt["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||Xt["Vertical Forms"](a)||Xt["Yijing Hexagram Symbols"](a)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(a))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(a))||Nd.test(String.fromCodePoint(a)))))}function Bd(a){return!(ku(a)||function(n){return!!(Xt["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||Xt["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||Xt["Letterlike Symbols"](n)||Xt["Number Forms"](n)||Xt["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||Xt["Control Pictures"](n)&&n!==9251||Xt["Optical Character Recognition"](n)||Xt["Enclosed Alphanumerics"](n)||Xt["Geometric Shapes"](n)||Xt["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||Xt["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||Xt["CJK Symbols and Punctuation"](n)||Xt.Katakana(n)||Xt["Private Use Area"](n)||Xt["CJK Compatibility Forms"](n)||Xt["Small Form Variants"](n)||Xt["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(a))}const Pm=Mu(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function nc(a){return Pm.test(String.fromCodePoint(a))}function qy(a,n){return!(!n&&nc(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||Xt.Khmer(a))}function jd(a){for(const n of a)if(nc(n.charCodeAt(0)))return!0;return!1}const ns=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(a){this.pluginStatus=a.pluginStatus,this.pluginURL=a.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(a){if(ns.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=a.applyArabicShaping,this.processBidirectionalText=a.processBidirectionalText,this.processStyledBidirectionalText=a.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(a,n){return l(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(a.pluginStatus!=="loading")return this.setState(a),a;const s=a.pluginURL,u=new Promise(v=>{this.loadScriptResolve=v});n(s);const p=new Promise(v=>setTimeout(()=>v(),this.TIMEOUT));if(yield Promise.race([u,p]),this.isParsed()){const v={pluginStatus:"loaded",pluginURL:s};return this.setState(v),v}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${s}`)})}};class Tr{constructor(n,s){this.zoom=n,s?(this.now=s.now||0,this.fadeDuration=s.fadeDuration||0,this.zoomHistory=s.zoomHistory||new Od,this.transition=s.transition||{},this.globalState=s.globalState||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Od,this.transition={},this.globalState={})}isSupportedScript(n){return function(s,u){for(const p of s)if(!qy(p.charCodeAt(0),u))return!1;return!0}(n,ns.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const n=this.zoom,s=n-Math.floor(n),u=this.crossFadingFactor();return n>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:s+(1-s)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*s}}}class ic{constructor(n,s){this.property=n,this.value=s,this.expression=function(u,p){if($s(u))return new Xl(u,p);if(_u(u)){const v=Pd(u,p);if(v.result==="error")throw new Error(v.value.map(x=>`${x.key}: ${x.message}`).join(", "));return v.value}{let v=u;return p.type==="color"&&typeof u=="string"?v=Wt.parse(u):p.type!=="padding"||typeof u!="number"&&!Array.isArray(u)?p.type!=="numberArray"||typeof u!="number"&&!Array.isArray(u)?p.type!=="colorArray"||typeof u!="string"&&!Array.isArray(u)?p.type==="variableAnchorOffsetCollection"&&Array.isArray(u)?v=er.parse(u):p.type==="projectionDefinition"&&typeof u=="string"&&(v=Lt.parse(u)):v=dn.parse(u):v=zn.parse(u):v=Jr.parse(u),{globalStateRefs:new Set,kind:"constant",evaluate:()=>v}}}(s===void 0?n.specification.default:s,n.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(n,s,u){return this.property.possiblyEvaluate(this,n,s,u)}}class Iu{constructor(n){this.property=n,this.value=new ic(n,void 0)}transitioned(n,s){return new Em(this.property,this.value,s,Dt({},n.transition,this.transition),n.now)}untransitioned(){return new Em(this.property,this.value,null,{},0)}}class $d{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues)}getValue(n){return Yr(this._values[n].value.value)}setValue(n,s){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new Iu(this._values[n].property)),this._values[n].value=new ic(this._values[n].property,s===null?void 0:Yr(s))}getTransition(n){return Yr(this._values[n].transition)}setTransition(n,s){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new Iu(this._values[n].property)),this._values[n].transition=Yr(s)||void 0}serialize(){const n={};for(const s of Object.keys(this._values)){const u=this.getValue(s);u!==void 0&&(n[s]=u);const p=this.getTransition(s);p!==void 0&&(n[`${s}-transition`]=p)}return n}transitioned(n,s){const u=new Mm(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].transitioned(n,s._values[p]);return u}untransitioned(){const n=new Mm(this._properties);for(const s of Object.keys(this._values))n._values[s]=this._values[s].untransitioned();return n}}class Em{constructor(n,s,u,p,v){this.property=n,this.value=s,this.begin=v+p.delay||0,this.end=this.begin+p.duration||0,n.specification.transition&&(p.delay||p.duration)&&(this.prior=u)}possiblyEvaluate(n,s,u){const p=n.now||0,v=this.value.possiblyEvaluate(n,s,u),x=this.prior;if(x){if(p>this.end)return this.prior=null,v;if(this.value.isDataDriven())return this.prior=null,v;if(p<this.begin)return x.possiblyEvaluate(n,s,u);{const w=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(n,s,u),v,dr(w))}}return v}}class Mm{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,s,u){const p=new Au(this._properties);for(const v of Object.keys(this._values))p._values[v]=this._values[v].possiblyEvaluate(n,s,u);return p}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class Xy{constructor(n){this._properties=n,this._values=Object.create(n.defaultPropertyValues)}hasValue(n){return this._values[n].value!==void 0}getValue(n){return Yr(this._values[n].value)}setValue(n,s){this._values[n]=new ic(this._values[n].property,s===null?void 0:Yr(s))}serialize(){const n={};for(const s of Object.keys(this._values)){const u=this.getValue(s);u!==void 0&&(n[s]=u)}return n}possiblyEvaluate(n,s,u){const p=new Au(this._properties);for(const v of Object.keys(this._values))p._values[v]=this._values[v].possiblyEvaluate(n,s,u);return p}}class co{constructor(n,s,u){this.property=n,this.value=s,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,s,u,p){return this.property.evaluate(this.value,this.parameters,n,s,u,p)}}class Au{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class bt{constructor(n){this.specification=n}possiblyEvaluate(n,s){if(n.isDataDriven())throw new Error("Value should not be data driven");return n.expression.evaluate(s)}interpolate(n,s,u){const p=di[this.specification.type];return p?p(n,s,u):n}}class It{constructor(n,s){this.specification=n,this.overrides=s}possiblyEvaluate(n,s,u,p){return new co(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(s,null,{},u,p)}:n.expression,s)}interpolate(n,s,u){if(n.value.kind!=="constant"||s.value.kind!=="constant")return n;if(n.value.value===void 0||s.value.value===void 0)return new co(this,{kind:"constant",value:void 0},n.parameters);const p=di[this.specification.type];if(p){const v=p(n.value.value,s.value.value,u);return new co(this,{kind:"constant",value:v},n.parameters)}return n}evaluate(n,s,u,p,v,x){return n.kind==="constant"?n.value:n.evaluate(s,u,p,v,x)}}class zu extends It{possiblyEvaluate(n,s,u,p){if(n.value===void 0)return new co(this,{kind:"constant",value:void 0},s);if(n.expression.kind==="constant"){const v=n.expression.evaluate(s,null,{},u,p),x=n.property.specification.type==="resolvedImage"&&typeof v!="string"?v.name:v,w=this._calculate(x,x,x,s);return new co(this,{kind:"constant",value:w},s)}if(n.expression.kind==="camera"){const v=this._calculate(n.expression.evaluate({zoom:s.zoom-1}),n.expression.evaluate({zoom:s.zoom}),n.expression.evaluate({zoom:s.zoom+1}),s);return new co(this,{kind:"constant",value:v},s)}return new co(this,n.expression,s)}evaluate(n,s,u,p,v,x){if(n.kind==="source"){const w=n.evaluate(s,u,p,v,x);return this._calculate(w,w,w,s)}return n.kind==="composite"?this._calculate(n.evaluate({zoom:Math.floor(s.zoom)-1},u,p),n.evaluate({zoom:Math.floor(s.zoom)},u,p),n.evaluate({zoom:Math.floor(s.zoom)+1},u,p),s):n.value}_calculate(n,s,u,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:n,to:s}:{from:u,to:s}}interpolate(n){return n}}class Ud{constructor(n){this.specification=n}possiblyEvaluate(n,s,u,p){if(n.value!==void 0){if(n.expression.kind==="constant"){const v=n.expression.evaluate(s,null,{},u,p);return this._calculate(v,v,v,s)}return this._calculate(n.expression.evaluate(new Tr(Math.floor(s.zoom-1),s)),n.expression.evaluate(new Tr(Math.floor(s.zoom),s)),n.expression.evaluate(new Tr(Math.floor(s.zoom+1),s)),s)}}_calculate(n,s,u,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:n,to:s}:{from:u,to:s}}interpolate(n){return n}}class oc{constructor(n){this.specification=n}possiblyEvaluate(n,s,u,p){return!!n.expression.evaluate(s,null,{},u,p)}interpolate(){return!1}}class Vn{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const s in n){const u=n[s];u.specification.overridable&&this.overridableProperties.push(s);const p=this.defaultPropertyValues[s]=new ic(u,void 0),v=this.defaultTransitionablePropertyValues[s]=new Iu(u);this.defaultTransitioningPropertyValues[s]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=p.possiblyEvaluate({})}}}_t("DataDrivenProperty",It),_t("DataConstantProperty",bt),_t("CrossFadedDataDrivenProperty",zu),_t("CrossFadedProperty",Ud),_t("ColorRampProperty",oc);const km="-transition";class wn extends We{constructor(n,s){if(super(),this.id=n.id,this.type=n.type,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},n.type!=="custom"&&(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type!=="background"&&(this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter,this._featureFilter=ts(n.filter)),s.layout&&(this._unevaluatedLayout=new Xy(s.layout)),s.paint)){this._transitionablePaint=new $d(s.paint);for(const u in n.paint)this.setPaintProperty(u,n.paint[u],{validate:!1});for(const u in n.layout)this.setLayoutProperty(u,n.layout[u],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Au(s.paint)}}setFilter(n){this.filter=n,this._featureFilter=ts(n)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}getLayoutAffectingGlobalStateRefs(){const n=new Set;if(this._unevaluatedLayout)for(const s in this._unevaluatedLayout._values){const u=this._unevaluatedLayout._values[s];for(const p of u.getGlobalStateRefs())n.add(p)}for(const s of this._featureFilter.getGlobalStateRefs())n.add(s);return n}setLayoutProperty(n,s,u={}){s!=null&&this._validate(Rd,`layers.${this.id}.layout.${n}`,n,s,u)||(n!=="visibility"?this._unevaluatedLayout.setValue(n,s):this.visibility=s)}getPaintProperty(n){return n.endsWith(km)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,s,u={}){if(s!=null&&this._validate(Gy,`layers.${this.id}.paint.${n}`,n,s,u))return!1;if(n.endsWith(km))return this._transitionablePaint.setTransition(n.slice(0,-11),s||void 0),!1;{const p=this._transitionablePaint._values[n],v=p.property.specification["property-type"]==="cross-faded-data-driven",x=p.value.isDataDriven(),w=p.value;this._transitionablePaint.setValue(n,s),this._handleSpecialPaintPropertyUpdate(n);const T=this._transitionablePaint._values[n].value;return T.isDataDriven()||x||v||this._handleOverridablePaintPropertyUpdate(n,w,T)}}_handleSpecialPaintPropertyUpdate(n){}_handleOverridablePaintPropertyUpdate(n,s,u){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,s){n.getCrossfadeParameters&&(this._crossfadeParameters=n.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,s)}serialize(){const n={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(n.layout=n.layout||{},n.layout.visibility=this.visibility),Rr(n,(s,u)=>!(s===void 0||u==="layout"&&!Object.keys(s).length||u==="paint"&&!Object.keys(s).length))}_validate(n,s,u,p,v={}){return(!v||v.validate!==!1)&&ec(this,n.call(Da,{key:s,layerType:this.type,objectKey:u,value:p,styleSpec:he,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const n in this.paint._values){const s=this.paint.get(n);if(s instanceof co&&Ca(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}}const Im={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Us{constructor(n,s){this._structArray=n,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Mr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,s){return n._trim(),s&&(n.isTransferred=!0,s.push(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const s=Object.create(this.prototype);return s.arrayBuffer=n.arrayBuffer,s.length=n.length,s.capacity=n.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Lr(a,n=1){let s=0,u=0;return{members:a.map(p=>{const v=Im[p.type].BYTES_PER_ELEMENT,x=s=Am(s,Math.max(n,v)),w=p.components||1;return u=Math.max(u,v),s+=v*w,{name:p.name,type:p.type,components:w,offset:x}}),size:Am(s,Math.max(u,n)),alignment:n}}function Am(a,n){return Math.ceil(a/n)*n}class is extends Mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s){const u=this.length;return this.resize(u+1),this.emplace(u,n,s)}emplace(n,s,u){const p=2*n;return this.int16[p+0]=s,this.int16[p+1]=u,n}}is.prototype.bytesPerElement=4,_t("StructArrayLayout2i4",is);class os extends Mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u){const p=this.length;return this.resize(p+1),this.emplace(p,n,s,u)}emplace(n,s,u,p){const v=3*n;return this.int16[v+0]=s,this.int16[v+1]=u,this.int16[v+2]=p,n}}os.prototype.bytesPerElement=6,_t("StructArrayLayout3i6",os);class Vd extends Mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,p){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,u,p)}emplace(n,s,u,p,v){const x=4*n;return this.int16[x+0]=s,this.int16[x+1]=u,this.int16[x+2]=p,this.int16[x+3]=v,n}}Vd.prototype.bytesPerElement=8,_t("StructArrayLayout4i8",Vd);class Ru extends Mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,p,v,x){const w=this.length;return this.resize(w+1),this.emplace(w,n,s,u,p,v,x)}emplace(n,s,u,p,v,x,w){const T=6*n;return this.int16[T+0]=s,this.int16[T+1]=u,this.int16[T+2]=p,this.int16[T+3]=v,this.int16[T+4]=x,this.int16[T+5]=w,n}}Ru.prototype.bytesPerElement=12,_t("StructArrayLayout2i4i12",Ru);class Vs extends Mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,p,v,x){const w=this.length;return this.resize(w+1),this.emplace(w,n,s,u,p,v,x)}emplace(n,s,u,p,v,x,w){const T=4*n,M=8*n;return this.int16[T+0]=s,this.int16[T+1]=u,this.uint8[M+4]=p,this.uint8[M+5]=v,this.uint8[M+6]=x,this.uint8[M+7]=w,n}}Vs.prototype.bytesPerElement=8,_t("StructArrayLayout2i4ub8",Vs);class sc extends Mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s){const u=this.length;return this.resize(u+1),this.emplace(u,n,s)}emplace(n,s,u){const p=2*n;return this.float32[p+0]=s,this.float32[p+1]=u,n}}sc.prototype.bytesPerElement=8,_t("StructArrayLayout2f8",sc);class Zd extends Mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u,p,v,x,w,T,M,I){const D=this.length;return this.resize(D+1),this.emplace(D,n,s,u,p,v,x,w,T,M,I)}emplace(n,s,u,p,v,x,w,T,M,I,D){const B=10*n;return this.uint16[B+0]=s,this.uint16[B+1]=u,this.uint16[B+2]=p,this.uint16[B+3]=v,this.uint16[B+4]=x,this.uint16[B+5]=w,this.uint16[B+6]=T,this.uint16[B+7]=M,this.uint16[B+8]=I,this.uint16[B+9]=D,n}}Zd.prototype.bytesPerElement=20,_t("StructArrayLayout10ui20",Zd);class Du extends Mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u,p,v,x,w,T,M,I,D,B){const V=this.length;return this.resize(V+1),this.emplace(V,n,s,u,p,v,x,w,T,M,I,D,B)}emplace(n,s,u,p,v,x,w,T,M,I,D,B,V){const G=12*n;return this.int16[G+0]=s,this.int16[G+1]=u,this.int16[G+2]=p,this.int16[G+3]=v,this.uint16[G+4]=x,this.uint16[G+5]=w,this.uint16[G+6]=T,this.uint16[G+7]=M,this.int16[G+8]=I,this.int16[G+9]=D,this.int16[G+10]=B,this.int16[G+11]=V,n}}Du.prototype.bytesPerElement=24,_t("StructArrayLayout4i4ui4i24",Du);class Gd extends Mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u){const p=this.length;return this.resize(p+1),this.emplace(p,n,s,u)}emplace(n,s,u,p){const v=3*n;return this.float32[v+0]=s,this.float32[v+1]=u,this.float32[v+2]=p,n}}Gd.prototype.bytesPerElement=12,_t("StructArrayLayout3f12",Gd);class _ extends Mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint32[1*n+0]=s,n}}_.prototype.bytesPerElement=4,_t("StructArrayLayout1ul4",_);class t extends Mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u,p,v,x,w,T,M){const I=this.length;return this.resize(I+1),this.emplace(I,n,s,u,p,v,x,w,T,M)}emplace(n,s,u,p,v,x,w,T,M,I){const D=10*n,B=5*n;return this.int16[D+0]=s,this.int16[D+1]=u,this.int16[D+2]=p,this.int16[D+3]=v,this.int16[D+4]=x,this.int16[D+5]=w,this.uint32[B+3]=T,this.uint16[D+8]=M,this.uint16[D+9]=I,n}}t.prototype.bytesPerElement=20,_t("StructArrayLayout6i1ul2ui20",t);class o extends Mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,p,v,x){const w=this.length;return this.resize(w+1),this.emplace(w,n,s,u,p,v,x)}emplace(n,s,u,p,v,x,w){const T=6*n;return this.int16[T+0]=s,this.int16[T+1]=u,this.int16[T+2]=p,this.int16[T+3]=v,this.int16[T+4]=x,this.int16[T+5]=w,n}}o.prototype.bytesPerElement=12,_t("StructArrayLayout2i2i2i12",o);class h extends Mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,p,v){const x=this.length;return this.resize(x+1),this.emplace(x,n,s,u,p,v)}emplace(n,s,u,p,v,x){const w=4*n,T=8*n;return this.float32[w+0]=s,this.float32[w+1]=u,this.float32[w+2]=p,this.int16[T+6]=v,this.int16[T+7]=x,n}}h.prototype.bytesPerElement=16,_t("StructArrayLayout2f1f2i16",h);class f extends Mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,p,v,x){const w=this.length;return this.resize(w+1),this.emplace(w,n,s,u,p,v,x)}emplace(n,s,u,p,v,x,w){const T=16*n,M=4*n,I=8*n;return this.uint8[T+0]=s,this.uint8[T+1]=u,this.float32[M+1]=p,this.float32[M+2]=v,this.int16[I+6]=x,this.int16[I+7]=w,n}}f.prototype.bytesPerElement=16,_t("StructArrayLayout2ub2f2i16",f);class y extends Mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u){const p=this.length;return this.resize(p+1),this.emplace(p,n,s,u)}emplace(n,s,u,p){const v=3*n;return this.uint16[v+0]=s,this.uint16[v+1]=u,this.uint16[v+2]=p,n}}y.prototype.bytesPerElement=6,_t("StructArrayLayout3ui6",y);class b extends Mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,p,v,x,w,T,M,I,D,B,V,G,K,ne,le){const Se=this.length;return this.resize(Se+1),this.emplace(Se,n,s,u,p,v,x,w,T,M,I,D,B,V,G,K,ne,le)}emplace(n,s,u,p,v,x,w,T,M,I,D,B,V,G,K,ne,le,Se){const me=24*n,$=12*n,te=48*n;return this.int16[me+0]=s,this.int16[me+1]=u,this.uint16[me+2]=p,this.uint16[me+3]=v,this.uint32[$+2]=x,this.uint32[$+3]=w,this.uint32[$+4]=T,this.uint16[me+10]=M,this.uint16[me+11]=I,this.uint16[me+12]=D,this.float32[$+7]=B,this.float32[$+8]=V,this.uint8[te+36]=G,this.uint8[te+37]=K,this.uint8[te+38]=ne,this.uint32[$+10]=le,this.int16[me+22]=Se,n}}b.prototype.bytesPerElement=48,_t("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",b);class S extends Mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,p,v,x,w,T,M,I,D,B,V,G,K,ne,le,Se,me,$,te,_e,Le,Xe,Be,Ue,tt,Ye){const rt=this.length;return this.resize(rt+1),this.emplace(rt,n,s,u,p,v,x,w,T,M,I,D,B,V,G,K,ne,le,Se,me,$,te,_e,Le,Xe,Be,Ue,tt,Ye)}emplace(n,s,u,p,v,x,w,T,M,I,D,B,V,G,K,ne,le,Se,me,$,te,_e,Le,Xe,Be,Ue,tt,Ye,rt){const Ge=32*n,xt=16*n;return this.int16[Ge+0]=s,this.int16[Ge+1]=u,this.int16[Ge+2]=p,this.int16[Ge+3]=v,this.int16[Ge+4]=x,this.int16[Ge+5]=w,this.int16[Ge+6]=T,this.int16[Ge+7]=M,this.uint16[Ge+8]=I,this.uint16[Ge+9]=D,this.uint16[Ge+10]=B,this.uint16[Ge+11]=V,this.uint16[Ge+12]=G,this.uint16[Ge+13]=K,this.uint16[Ge+14]=ne,this.uint16[Ge+15]=le,this.uint16[Ge+16]=Se,this.uint16[Ge+17]=me,this.uint16[Ge+18]=$,this.uint16[Ge+19]=te,this.uint16[Ge+20]=_e,this.uint16[Ge+21]=Le,this.uint16[Ge+22]=Xe,this.uint32[xt+12]=Be,this.float32[xt+13]=Ue,this.float32[xt+14]=tt,this.uint16[Ge+30]=Ye,this.uint16[Ge+31]=rt,n}}S.prototype.bytesPerElement=64,_t("StructArrayLayout8i15ui1ul2f2ui64",S);class C extends Mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.float32[1*n+0]=s,n}}C.prototype.bytesPerElement=4,_t("StructArrayLayout1f4",C);class k extends Mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u){const p=this.length;return this.resize(p+1),this.emplace(p,n,s,u)}emplace(n,s,u,p){const v=3*n;return this.uint16[6*n+0]=s,this.float32[v+1]=u,this.float32[v+2]=p,n}}k.prototype.bytesPerElement=12,_t("StructArrayLayout1ui2f12",k);class z extends Mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u){const p=this.length;return this.resize(p+1),this.emplace(p,n,s,u)}emplace(n,s,u,p){const v=4*n;return this.uint32[2*n+0]=s,this.uint16[v+2]=u,this.uint16[v+3]=p,n}}z.prototype.bytesPerElement=8,_t("StructArrayLayout1ul2ui8",z);class O extends Mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s){const u=this.length;return this.resize(u+1),this.emplace(u,n,s)}emplace(n,s,u){const p=2*n;return this.uint16[p+0]=s,this.uint16[p+1]=u,n}}O.prototype.bytesPerElement=4,_t("StructArrayLayout2ui4",O);class L extends Mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint16[1*n+0]=s,n}}L.prototype.bytesPerElement=2,_t("StructArrayLayout1ui2",L);class j extends Mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,p){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,u,p)}emplace(n,s,u,p,v){const x=4*n;return this.float32[x+0]=s,this.float32[x+1]=u,this.float32[x+2]=p,this.float32[x+3]=v,n}}j.prototype.bytesPerElement=16,_t("StructArrayLayout4f16",j);class q extends Us{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new X(this.anchorPointX,this.anchorPointY)}}q.prototype.size=20;class se extends t{get(n){return new q(this,n)}}_t("CollisionBoxArray",se);class oe extends Us{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(n){this._structArray.uint8[this._pos1+37]=n}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(n){this._structArray.uint8[this._pos1+38]=n}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(n){this._structArray.uint32[this._pos4+10]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}oe.prototype.size=48;class ae extends b{get(n){return new oe(this,n)}}_t("PlacedSymbolArray",ae);class ce extends Us{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(n){this._structArray.uint32[this._pos4+12]=n}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}ce.prototype.size=64;class pe extends S{get(n){return new ce(this,n)}}_t("SymbolInstanceArray",pe);class ue extends C{getoffsetX(n){return this.float32[1*n+0]}}_t("GlyphOffsetArray",ue);class ve extends os{getx(n){return this.int16[3*n+0]}gety(n){return this.int16[3*n+1]}gettileUnitDistanceFromAnchor(n){return this.int16[3*n+2]}}_t("SymbolLineVertexArray",ve);class be extends Us{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}be.prototype.size=12;class fe extends k{get(n){return new be(this,n)}}_t("TextAnchorOffsetArray",fe);class Pe extends Us{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Pe.prototype.size=8;class Oe extends z{get(n){return new Pe(this,n)}}_t("FeatureIndexArray",Oe);class Ae extends is{}class Re extends is{}class Fe extends is{}class st extends Ru{}class it extends Vs{}class Ke extends sc{}class vt extends Zd{}class Ft extends Du{}class cr extends Gd{}class kr extends _{}class pr extends o{}class Ir extends f{}class _r extends y{}class mr extends O{}const yr=Lr([{name:"a_pos",components:2,type:"Int16"}],4),{members:Sn}=yr;class rr{constructor(n=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=n}prepareSegment(n,s,u,p){const v=this.segments[this.segments.length-1];return n>rr.MAX_VERTEX_ARRAY_LENGTH&&Sr(`Max vertices per segment is ${rr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${rr.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!v||v.vertexLength+n>rr.MAX_VERTEX_ARRAY_LENGTH||v.sortKey!==p?this.createNewSegment(s,u,p):v}createNewSegment(n,s,u){const p={vertexOffset:n.length,primitiveOffset:s.length,vertexLength:0,primitiveLength:0,vaos:{}};return u!==void 0&&(p.sortKey=u),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(p),p}getOrCreateLatestSegment(n,s,u){return this.prepareSegment(0,n,s,u)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const n of this.segments)for(const s in n.vaos)n.vaos[s].destroy()}static simpleSegment(n,s,u,p){return new rr([{vertexOffset:n,primitiveOffset:s,vertexLength:u,primitiveLength:p,vaos:{},sortKey:0}])}}function pn(a,n){return 256*(a=Vt(Math.floor(a),0,255))+Vt(Math.floor(n),0,255)}rr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,_t("SegmentVector",rr);const Tn=Lr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ss,as,ls,uo={exports:{}},ac={exports:{}},lc={exports:{}},Fa=function(){if(ls)return uo.exports;ls=1;var a=(ss||(ss=1,ac.exports=function(s,u){var p,v,x,w,T,M,I,D;for(v=s.length-(p=3&s.length),x=u,T=3432918353,M=461845907,D=0;D<v;)I=255&s.charCodeAt(D)|(255&s.charCodeAt(++D))<<8|(255&s.charCodeAt(++D))<<16|(255&s.charCodeAt(++D))<<24,++D,x=27492+(65535&(w=5*(65535&(x=(x^=I=(65535&(I=(I=(65535&I)*T+(((I>>>16)*T&65535)<<16)&4294967295)<<15|I>>>17))*M+(((I>>>16)*M&65535)<<16)&4294967295)<<13|x>>>19))+((5*(x>>>16)&65535)<<16)&4294967295))+((58964+(w>>>16)&65535)<<16);switch(I=0,p){case 3:I^=(255&s.charCodeAt(D+2))<<16;case 2:I^=(255&s.charCodeAt(D+1))<<8;case 1:x^=I=(65535&(I=(I=(65535&(I^=255&s.charCodeAt(D)))*T+(((I>>>16)*T&65535)<<16)&4294967295)<<15|I>>>17))*M+(((I>>>16)*M&65535)<<16)&4294967295}return x^=s.length,x=2246822507*(65535&(x^=x>>>16))+((2246822507*(x>>>16)&65535)<<16)&4294967295,x=3266489909*(65535&(x^=x>>>13))+((3266489909*(x>>>16)&65535)<<16)&4294967295,(x^=x>>>16)>>>0}),ac.exports),n=(as||(as=1,lc.exports=function(s,u){for(var p,v=s.length,x=u^v,w=0;v>=4;)p=1540483477*(65535&(p=255&s.charCodeAt(w)|(255&s.charCodeAt(++w))<<8|(255&s.charCodeAt(++w))<<16|(255&s.charCodeAt(++w))<<24))+((1540483477*(p>>>16)&65535)<<16),x=1540483477*(65535&x)+((1540483477*(x>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),v-=4,++w;switch(v){case 3:x^=(255&s.charCodeAt(w+2))<<16;case 2:x^=(255&s.charCodeAt(w+1))<<8;case 1:x=1540483477*(65535&(x^=255&s.charCodeAt(w)))+((1540483477*(x>>>16)&65535)<<16)}return x=1540483477*(65535&(x^=x>>>13))+((1540483477*(x>>>16)&65535)<<16),(x^=x>>>15)>>>0}),lc.exports);return uo.exports=a,uo.exports.murmur3=a,uo.exports.murmur2=n,uo.exports}(),ri=E(Fa);class Ui{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(n,s,u,p){this.ids.push(cs(n)),this.positions.push(s,u,p)}getPositions(n){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const s=cs(n);let u=0,p=this.ids.length-1;for(;u<p;){const x=u+p>>1;this.ids[x]>=s?p=x:u=x+1}const v=[];for(;this.ids[u]===s;)v.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return v}static serialize(n,s){const u=new Float64Array(n.ids),p=new Uint32Array(n.positions);return Zs(u,p,0,u.length-1),s&&s.push(u.buffer,p.buffer),{ids:u,positions:p}}static deserialize(n){const s=new Ui;return s.ids=n.ids,s.positions=n.positions,s.indexed=!0,s}}function cs(a){const n=+a;return!isNaN(n)&&n<=Number.MAX_SAFE_INTEGER?n:ri(String(a))}function Zs(a,n,s,u){for(;s<u;){const p=a[s+u>>1];let v=s-1,x=u+1;for(;;){do v++;while(a[v]<p);do x--;while(a[x]>p);if(v>=x)break;$r(a,v,x),$r(n,3*v,3*x),$r(n,3*v+1,3*x+1),$r(n,3*v+2,3*x+2)}x-s<u-x?(Zs(a,n,s,x),s=x+1):(Zs(a,n,x+1,u),u=x)}}function $r(a,n,s){const u=a[n];a[n]=a[s],a[s]=u}_t("FeaturePositionMap",Ui);class xr{constructor(n,s){this.gl=n.gl,this.location=s}}class Zn extends xr{constructor(n,s){super(n,s),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1f(this.location,n))}}class an extends xr{constructor(n,s){super(n,s),this.current=[0,0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]&&n[3]===this.current[3]||(this.current=n,this.gl.uniform4f(this.location,n[0],n[1],n[2],n[3]))}}class zm extends xr{constructor(n,s){super(n,s),this.current=Wt.transparent}set(n){n.r===this.current.r&&n.g===this.current.g&&n.b===this.current.b&&n.a===this.current.a||(this.current=n,this.gl.uniform4f(this.location,n.r,n.g,n.b,n.a))}}const Ky=new Float32Array(16);function Hd(a){return[pn(255*a.r,255*a.g),pn(255*a.b,255*a.a)]}class cc{constructor(n,s,u){this.value=n,this.uniformNames=s.map(p=>`u_${p}`),this.type=u}setUniform(n,s,u){n.set(u.constantOr(this.value))}getBinding(n,s,u){return this.type==="color"?new zm(n,s):new Zn(n,s)}}class Na{constructor(n,s){this.uniformNames=s.map(u=>`u_${u}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(n,s){this.pixelRatioFrom=s.pixelRatio,this.pixelRatioTo=n.pixelRatio,this.patternFrom=s.tlbr,this.patternTo=n.tlbr}setUniform(n,s,u,p){const v=p==="u_pattern_to"?this.patternTo:p==="u_pattern_from"?this.patternFrom:p==="u_pixel_ratio_to"?this.pixelRatioTo:p==="u_pixel_ratio_from"?this.pixelRatioFrom:null;v&&n.set(v)}getBinding(n,s,u){return u.substr(0,9)==="u_pattern"?new an(n,s):new Zn(n,s)}}class ko{constructor(n,s,u,p){this.expression=n,this.type=u,this.maxValue=0,this.paintVertexAttributes=s.map(v=>({name:`a_${v}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(n,s,u,p,v){const x=this.paintVertexArray.length,w=this.expression.evaluate(new Tr(0),s,{},p,[],v);this.paintVertexArray.resize(n),this._setPaintValue(x,n,w)}updatePaintArray(n,s,u,p){const v=this.expression.evaluate({zoom:0},u,p);this._setPaintValue(n,s,v)}_setPaintValue(n,s,u){if(this.type==="color"){const p=Hd(u);for(let v=n;v<s;v++)this.paintVertexArray.emplace(v,p[0],p[1])}else{for(let p=n;p<s;p++)this.paintVertexArray.emplace(p,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Cn{constructor(n,s,u,p,v,x){this.expression=n,this.uniformNames=s.map(w=>`u_${w}_t`),this.type=u,this.useIntegerZoom=p,this.zoom=v,this.maxValue=0,this.paintVertexAttributes=s.map(w=>({name:`a_${w}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(n,s,u,p,v){const x=this.expression.evaluate(new Tr(this.zoom),s,{},p,[],v),w=this.expression.evaluate(new Tr(this.zoom+1),s,{},p,[],v),T=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(T,n,x,w)}updatePaintArray(n,s,u,p){const v=this.expression.evaluate({zoom:this.zoom},u,p),x=this.expression.evaluate({zoom:this.zoom+1},u,p);this._setPaintValue(n,s,v,x)}_setPaintValue(n,s,u,p){if(this.type==="color"){const v=Hd(u),x=Hd(p);for(let w=n;w<s;w++)this.paintVertexArray.emplace(w,v[0],v[1],x[0],x[1])}else{for(let v=n;v<s;v++)this.paintVertexArray.emplace(v,u,p);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(p))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,s){const u=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,p=Vt(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);n.set(p)}getBinding(n,s,u){return new Zn(n,s)}}class Io{constructor(n,s,u,p,v,x){this.expression=n,this.type=s,this.useIntegerZoom=u,this.zoom=p,this.layerId=x,this.zoomInPaintVertexArray=new v,this.zoomOutPaintVertexArray=new v}populatePaintArray(n,s,u){const p=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(n),this.zoomOutPaintVertexArray.resize(n),this._setPaintValues(p,n,s.patterns&&s.patterns[this.layerId],u)}updatePaintArray(n,s,u,p,v){this._setPaintValues(n,s,u.patterns&&u.patterns[this.layerId],v)}_setPaintValues(n,s,u,p){if(!p||!u)return;const{min:v,mid:x,max:w}=u,T=p[v],M=p[x],I=p[w];if(T&&M&&I)for(let D=n;D<s;D++)this.zoomInPaintVertexArray.emplace(D,M.tl[0],M.tl[1],M.br[0],M.br[1],T.tl[0],T.tl[1],T.br[0],T.br[1],M.pixelRatio,T.pixelRatio),this.zoomOutPaintVertexArray.emplace(D,M.tl[0],M.tl[1],M.br[0],M.br[1],I.tl[0],I.tl[1],I.br[0],I.br[1],M.pixelRatio,I.pixelRatio)}upload(n){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=n.createVertexBuffer(this.zoomInPaintVertexArray,Tn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=n.createVertexBuffer(this.zoomOutPaintVertexArray,Tn.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Wd{constructor(n,s,u){this.binders={},this._buffers=[];const p=[];for(const v in n.paint._values){if(!u(v))continue;const x=n.paint.get(v);if(!(x instanceof co&&Ca(x.property.specification)))continue;const w=qd(v,n.type),T=x.value,M=x.property.specification.type,I=x.property.useIntegerZoom,D=x.property.specification["property-type"],B=D==="cross-faded"||D==="cross-faded-data-driven";if(T.kind==="constant")this.binders[v]=B?new Na(T.value,w):new cc(T.value,w,M),p.push(`/u_${v}`);else if(T.kind==="source"||B){const V=Xd(v,M,"source");this.binders[v]=B?new Io(T,M,I,s,V,n.id):new ko(T,w,M,V),p.push(`/a_${v}`)}else{const V=Xd(v,M,"composite");this.binders[v]=new Cn(T,w,M,I,s,V),p.push(`/z_${v}`)}}this.cacheKey=p.sort().join("")}getMaxValue(n){const s=this.binders[n];return s instanceof ko||s instanceof Cn?s.maxValue:0}populatePaintArrays(n,s,u,p,v){for(const x in this.binders){const w=this.binders[x];(w instanceof ko||w instanceof Cn||w instanceof Io)&&w.populatePaintArray(n,s,u,p,v)}}setConstantPatternPositions(n,s){for(const u in this.binders){const p=this.binders[u];p instanceof Na&&p.setConstantPatternPositions(n,s)}}updatePaintArrays(n,s,u,p,v){let x=!1;for(const w in n){const T=s.getPositions(w);for(const M of T){const I=u.feature(M.index);for(const D in this.binders){const B=this.binders[D];if((B instanceof ko||B instanceof Cn||B instanceof Io)&&B.expression.isStateDependent===!0){const V=p.paint.get(D);B.expression=V.value,B.updatePaintArray(M.start,M.end,I,n[w],v),x=!0}}}}return x}defines(){const n=[];for(const s in this.binders){const u=this.binders[s];(u instanceof cc||u instanceof Na)&&n.push(...u.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return n}getBinderAttributes(){const n=[];for(const s in this.binders){const u=this.binders[s];if(u instanceof ko||u instanceof Cn)for(let p=0;p<u.paintVertexAttributes.length;p++)n.push(u.paintVertexAttributes[p].name);else if(u instanceof Io)for(let p=0;p<Tn.members.length;p++)n.push(Tn.members[p].name)}return n}getBinderUniforms(){const n=[];for(const s in this.binders){const u=this.binders[s];if(u instanceof cc||u instanceof Na||u instanceof Cn)for(const p of u.uniformNames)n.push(p)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n,s){const u=[];for(const p in this.binders){const v=this.binders[p];if(v instanceof cc||v instanceof Na||v instanceof Cn){for(const x of v.uniformNames)if(s[x]){const w=v.getBinding(n,s[x],x);u.push({name:x,property:p,binding:w})}}}return u}setUniforms(n,s,u,p){for(const{name:v,property:x,binding:w}of s)this.binders[x].setUniform(w,p,u.get(x),v)}updatePaintBuffers(n){this._buffers=[];for(const s in this.binders){const u=this.binders[s];if(n&&u instanceof Io){const p=n.fromScale===2?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;p&&this._buffers.push(p)}else(u instanceof ko||u instanceof Cn)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(n){for(const s in this.binders){const u=this.binders[s];(u instanceof ko||u instanceof Cn||u instanceof Io)&&u.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const s=this.binders[n];(s instanceof ko||s instanceof Cn||s instanceof Io)&&s.destroy()}}}class us{constructor(n,s,u=()=>!0){this.programConfigurations={};for(const p of n)this.programConfigurations[p.id]=new Wd(p,s,u);this.needsUpload=!1,this._featureMap=new Ui,this._bufferOffset=0}populatePaintArrays(n,s,u,p,v,x){for(const w in this.programConfigurations)this.programConfigurations[w].populatePaintArrays(n,s,p,v,x);s.id!==void 0&&this._featureMap.add(s.id,u,this._bufferOffset,n),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,s,u,p){for(const v of u)this.needsUpload=this.programConfigurations[v.id].updatePaintArrays(n,this._featureMap,s,v,p)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}function qd(a,n){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(`${n}-`,"").replace(/-/g,"_")]}function Xd(a,n,s){const u={color:{source:sc,composite:j},number:{source:C,composite:sc}},p=function(v){return{"line-pattern":{source:vt,composite:vt},"fill-pattern":{source:vt,composite:vt},"fill-extrusion-pattern":{source:vt,composite:vt}}[v]}(a);return p&&p[s]||u[n][s]}_t("ConstantBinder",cc),_t("CrossFadedConstantBinder",Na),_t("SourceExpressionBinder",ko),_t("CrossFadedCompositeBinder",Io),_t("CompositeExpressionBinder",Cn),_t("ProgramConfiguration",Wd,{omit:["_buffers"]}),_t("ProgramConfigurationSet",us);const uc=Math.pow(2,14)-1,Hw=-uc-1;function hc(a){const n=ut/a.extent,s=a.loadGeometry();for(let u=0;u<s.length;u++){const p=s[u];for(let v=0;v<p.length;v++){const x=p[v],w=Math.round(x.x*n),T=Math.round(x.y*n);x.x=Vt(w,Hw,uc),x.y=Vt(T,Hw,uc),(w<x.x||w>x.x+1||T<x.y||T>x.y+1)&&Sr("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return s}function dc(a,n){return{type:a.type,id:a.id,properties:a.properties,geometry:n?hc(a):[]}}const Ww=-32768;function KA(a,n,s,u,p){a.emplaceBack(Ww+8*n+u,Ww+8*s+p)}class Yy{constructor(n){this.zoom=n.zoom,this.globalState=n.globalState,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.id),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new Re,this.indexArray=new _r,this.segments=new rr,this.programConfigurations=new us(n.layers,n.zoom),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(n,s,u){const p=this.layers[0],v=[];let x=null,w=!1,T=p.type==="heatmap";if(p.type==="circle"){const I=p;x=I.layout.get("circle-sort-key"),w=!x.isConstant(),T=T||I.paint.get("circle-pitch-alignment")==="map"}const M=T?s.subdivisionGranularity.circle:1;for(const{feature:I,id:D,index:B,sourceLayerIndex:V}of n){const G=this.layers[0]._featureFilter.needGeometry,K=dc(I,G);if(!this.layers[0]._featureFilter.filter(new Tr(this.zoom,{globalState:this.globalState}),K,u))continue;const ne=w?x.evaluate(K,{},u):void 0,le={id:D,properties:I.properties,type:I.type,sourceLayerIndex:V,index:B,geometry:G?K.geometry:hc(I),patterns:{},sortKey:ne};v.push(le)}w&&v.sort((I,D)=>I.sortKey-D.sortKey);for(const I of v){const{geometry:D,index:B,sourceLayerIndex:V}=I,G=n[B].feature;this.addFeature(I,D,B,u,M),s.featureIndex.insert(G,D,B,V,this.index)}}update(n,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Sn),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,s,u,p,v=1){let x;switch(v){case 1:x=[0,7];break;case 3:x=[0,2,5,7];break;case 5:x=[0,1,3,4,6,7];break;case 7:x=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${v}; valid values are 1, 3, 5, 7.`)}const w=x.length;for(const T of s)for(const M of T){const I=M.x,D=M.y;if(I<0||I>=ut||D<0||D>=ut)continue;const B=this.segments.prepareSegment(w*w,this.layoutVertexArray,this.indexArray,n.sortKey),V=B.vertexLength;for(let G=0;G<w;G++)for(let K=0;K<w;K++)KA(this.layoutVertexArray,I,D,x[K],x[G]);for(let G=0;G<w-1;G++)for(let K=0;K<w-1;K++){const ne=V+G*w+K,le=V+(G+1)*w+K;this.indexArray.emplaceBack(ne,le+1,ne+1),this.indexArray.emplaceBack(ne,le,le+1)}B.vertexLength+=w*w,B.primitiveLength+=(w-1)*(w-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,{},p)}}function qw(a,n){for(let s=0;s<a.length;s++)if(Lu(n,a[s]))return!0;for(let s=0;s<n.length;s++)if(Lu(a,n[s]))return!0;return!!Qy(a,n)}function YA(a,n,s){return!!Lu(a,n)||!!Jy(n,a,s)}function Xw(a,n){if(a.length===1)return Yw(n,a[0]);for(let s=0;s<n.length;s++){const u=n[s];for(let p=0;p<u.length;p++)if(Lu(a,u[p]))return!0}for(let s=0;s<a.length;s++)if(Yw(n,a[s]))return!0;for(let s=0;s<n.length;s++)if(Qy(a,n[s]))return!0;return!1}function QA(a,n,s){if(a.length>1){if(Qy(a,n))return!0;for(let u=0;u<n.length;u++)if(Jy(n[u],a,s))return!0}for(let u=0;u<a.length;u++)if(Jy(a[u],n,s))return!0;return!1}function Qy(a,n){if(a.length===0||n.length===0)return!1;for(let s=0;s<a.length-1;s++){const u=a[s],p=a[s+1];for(let v=0;v<n.length-1;v++)if(JA(u,p,n[v],n[v+1]))return!0}return!1}function JA(a,n,s,u){return sn(a,s,u)!==sn(n,s,u)&&sn(a,n,s)!==sn(a,n,u)}function Jy(a,n,s){const u=s*s;if(n.length===1)return a.distSqr(n[0])<u;for(let p=1;p<n.length;p++)if(Kw(a,n[p-1],n[p])<u)return!0;return!1}function Kw(a,n,s){const u=n.distSqr(s);if(u===0)return a.distSqr(n);const p=((a.x-n.x)*(s.x-n.x)+(a.y-n.y)*(s.y-n.y))/u;return a.distSqr(p<0?n:p>1?s:s.sub(n)._mult(p)._add(n))}function Yw(a,n){let s,u,p,v=!1;for(let x=0;x<a.length;x++){s=a[x];for(let w=0,T=s.length-1;w<s.length;T=w++)u=s[w],p=s[T],u.y>n.y!=p.y>n.y&&n.x<(p.x-u.x)*(n.y-u.y)/(p.y-u.y)+u.x&&(v=!v)}return v}function Lu(a,n){let s=!1;for(let u=0,p=a.length-1;u<a.length;p=u++){const v=a[u],x=a[p];v.y>n.y!=x.y>n.y&&n.x<(x.x-v.x)*(n.y-v.y)/(x.y-v.y)+v.x&&(s=!s)}return s}function ez(a,n,s){const u=s[0],p=s[2];if(a.x<u.x&&n.x<u.x||a.x>p.x&&n.x>p.x||a.y<u.y&&n.y<u.y||a.y>p.y&&n.y>p.y)return!1;const v=sn(a,n,s[0]);return v!==sn(a,n,s[1])||v!==sn(a,n,s[2])||v!==sn(a,n,s[3])}function Kd(a,n,s){const u=n.paint.get(a).value;return u.kind==="constant"?u.value:s.programConfigurations.get(n.id).getMaxValue(a)}function Rm(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function Dm(a,n,s,u,p){if(!n[0]&&!n[1])return a;const v=X.convert(n)._mult(p);s==="viewport"&&v._rotate(-u);const x=[];for(let w=0;w<a.length;w++)x.push(a[w].sub(v));return x}let Qw,Jw;_t("CircleBucket",Yy,{omit:["layers"]});var tz={get paint(){return Jw=Jw||new Vn({"circle-radius":new It(he.paint_circle["circle-radius"]),"circle-color":new It(he.paint_circle["circle-color"]),"circle-blur":new It(he.paint_circle["circle-blur"]),"circle-opacity":new It(he.paint_circle["circle-opacity"]),"circle-translate":new bt(he.paint_circle["circle-translate"]),"circle-translate-anchor":new bt(he.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new bt(he.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new bt(he.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new It(he.paint_circle["circle-stroke-width"]),"circle-stroke-color":new It(he.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new It(he.paint_circle["circle-stroke-opacity"])})},get layout(){return Qw=Qw||new Vn({"circle-sort-key":new It(he.layout_circle["circle-sort-key"])})}};class rz extends wn{constructor(n){super(n,tz)}createBucket(n){return new Yy(n)}queryRadius(n){const s=n;return Kd("circle-radius",this,s)+Kd("circle-stroke-width",this,s)+Rm(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:n,feature:s,featureState:u,geometry:p,transform:v,pixelsToTileUnits:x,unwrappedTileID:w,getElevation:T}){const M=Dm(n,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-v.bearingInRadians,x),I=this.paint.get("circle-radius").evaluate(s,u)+this.paint.get("circle-stroke-width").evaluate(s,u),D=this.paint.get("circle-pitch-alignment")==="map",B=D?M:function(G,K,ne,le){return G.map(Se=>e1(Se,K,ne,le))}(M,v,w,T),V=D?I*x:I;for(const G of p)for(const K of G){const ne=D?K:e1(K,v,w,T);let le=V;const Se=v.projectTileCoordinates(K.x,K.y,w,T).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?le*=Se/v.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(le*=v.cameraToCenterDistance/Se),YA(B,ne,le))return!0}return!1}}function e1(a,n,s,u){const p=n.projectTileCoordinates(a.x,a.y,s,u).point;return new X((.5*p.x+.5)*n.width,(.5*-p.y+.5)*n.height)}class t1 extends Yy{}let r1;_t("HeatmapBucket",t1,{omit:["layers"]});var nz={get paint(){return r1=r1||new Vn({"heatmap-radius":new It(he.paint_heatmap["heatmap-radius"]),"heatmap-weight":new It(he.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new bt(he.paint_heatmap["heatmap-intensity"]),"heatmap-color":new oc(he.paint_heatmap["heatmap-color"]),"heatmap-opacity":new bt(he.paint_heatmap["heatmap-opacity"])})}};function ev(a,{width:n,height:s},u,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==n*s*u)throw new RangeError(`mismatched image size. expected: ${p.length} but got: ${n*s*u}`)}else p=new Uint8Array(n*s*u);return a.width=n,a.height=s,a.data=p,a}function n1(a,{width:n,height:s},u){if(n===a.width&&s===a.height)return;const p=ev({},{width:n,height:s},u);tv(a,p,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,n),height:Math.min(a.height,s)},u),a.width=n,a.height=s,a.data=p.data}function tv(a,n,s,u,p,v){if(p.width===0||p.height===0)return n;if(p.width>a.width||p.height>a.height||s.x>a.width-p.width||s.y>a.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>n.width||p.height>n.height||u.x>n.width-p.width||u.y>n.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const x=a.data,w=n.data;if(x===w)throw new Error("srcData equals dstData, so image is already copied");for(let T=0;T<p.height;T++){const M=((s.y+T)*a.width+s.x)*v,I=((u.y+T)*n.width+u.x)*v;for(let D=0;D<p.width*v;D++)w[I+D]=x[M+D]}return n}class Yd{constructor(n,s){ev(this,n,1,s)}resize(n){n1(this,n,1)}clone(){return new Yd({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,u,p,v){tv(n,s,u,p,v,1)}}class fi{constructor(n,s){ev(this,n,4,s)}resize(n){n1(this,n,4)}replace(n,s){s?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new fi({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,u,p,v){tv(n,s,u,p,v,4)}setPixel(n,s,u){const p=4*(n*this.width+s);this.data[p+0]=Math.round(255*u.r/u.a),this.data[p+1]=Math.round(255*u.g/u.a),this.data[p+2]=Math.round(255*u.b/u.a),this.data[p+3]=Math.round(255*u.a)}}function i1(a){const n={},s=a.resolution||256,u=a.clips?a.clips.length:1,p=a.image||new fi({width:s,height:u});if(Math.log(s)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${s}`);const v=(x,w,T)=>{n[a.evaluationKey]=T;const M=a.expression.evaluate(n);p.setPixel(x/4/s,w/4,M)};if(a.clips)for(let x=0,w=0;x<u;++x,w+=4*s)for(let T=0,M=0;T<s;T++,M+=4){const I=T/(s-1),{start:D,end:B}=a.clips[x];v(w,M,D*(1-I)+B*I)}else for(let x=0,w=0;x<s;x++,w+=4)v(0,w,x/(s-1));return p}_t("AlphaImage",Yd),_t("RGBAImage",fi);const rv="big-fb";class iz extends wn{createBucket(n){return new t1(n)}constructor(n){super(n,nz),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=i1({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(rv)&&this.heatmapFbos.delete(rv)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let o1;var oz={get paint(){return o1=o1||new Vn({"hillshade-illumination-direction":new bt(he.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new bt(he.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new bt(he.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new bt(he.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new bt(he.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new bt(he.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new bt(he.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new bt(he.paint_hillshade["hillshade-method"])})}};class sz extends wn{constructor(n){super(n,oz),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let n=this.paint.get("hillshade-illumination-direction").values,s=this.paint.get("hillshade-illumination-altitude").values,u=this.paint.get("hillshade-highlight-color").values,p=this.paint.get("hillshade-shadow-color").values;const v=Math.max(n.length,s.length,u.length,p.length);n=n.concat(Array(v-n.length).fill(n.at(-1))),s=s.concat(Array(v-s.length).fill(s.at(-1))),u=u.concat(Array(v-u.length).fill(u.at(-1))),p=p.concat(Array(v-p.length).fill(p.at(-1)));const x=s.map(Qr);return{directionRadians:n.map(Qr),altitudeRadians:x,shadowColor:p,highlightColor:u}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let s1;var az={get paint(){return s1=s1||new Vn({"color-relief-opacity":new bt(he["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new oc(he["paint_color-relief"]["color-relief-color"])})}};class nv{constructor(n,s,u,p){this.context=n,this.format=u,this.texture=n.gl.createTexture(),this.update(s,p)}update(n,s,u){const{width:p,height:v}=n,x=!(this.size&&this.size[0]===p&&this.size[1]===v||u),{context:w}=this,{gl:T}=w;if(this.useMipmap=!!(s&&s.useMipmap),T.bindTexture(T.TEXTURE_2D,this.texture),w.pixelStoreUnpackFlipY.set(!1),w.pixelStoreUnpack.set(1),w.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!s||s.premultiply!==!1)),x)this.size=[p,v],n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||Yn(n)?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,n):T.texImage2D(T.TEXTURE_2D,0,this.format,p,v,0,this.format,T.UNSIGNED_BYTE,n.data);else{const{x:M,y:I}=u||{x:0,y:0};n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||Yn(n)?T.texSubImage2D(T.TEXTURE_2D,0,M,I,T.RGBA,T.UNSIGNED_BYTE,n):T.texSubImage2D(T.TEXTURE_2D,0,M,I,p,v,T.RGBA,T.UNSIGNED_BYTE,n.data)}this.useMipmap&&this.isSizePowerOfTwo()&&T.generateMipmap(T.TEXTURE_2D),w.pixelStoreUnpackFlipY.setDefault(),w.pixelStoreUnpack.setDefault(),w.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(n,s,u){const{context:p}=this,{gl:v}=p;v.bindTexture(v.TEXTURE_2D,this.texture),u!==v.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=v.LINEAR),n!==this.filter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,n),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,u||n),this.filter=n),s!==this.wrap&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,s),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,s),this.wrap=s)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}class a1{constructor(n,s,u,p=1,v=1,x=1,w=0){if(this.uid=n,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(u&&!["mapbox","terrarium","custom"].includes(u))return void Sr(`"${u}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=s.height;const T=this.dim=s.height-2;switch(this.data=new Uint32Array(s.data.buffer),u){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=p,this.greenFactor=v,this.blueFactor=x,this.baseShift=w;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let M=0;M<T;M++)this.data[this._idx(-1,M)]=this.data[this._idx(0,M)],this.data[this._idx(T,M)]=this.data[this._idx(T-1,M)],this.data[this._idx(M,-1)]=this.data[this._idx(M,0)],this.data[this._idx(M,T)]=this.data[this._idx(M,T-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(T,-1)]=this.data[this._idx(T-1,0)],this.data[this._idx(-1,T)]=this.data[this._idx(0,T-1)],this.data[this._idx(T,T)]=this.data[this._idx(T-1,T-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let M=0;M<T;M++)for(let I=0;I<T;I++){const D=this.get(M,I);D>this.max&&(this.max=D),D<this.min&&(this.min=D)}}get(n,s){const u=new Uint8Array(this.data.buffer),p=4*this._idx(n,s);return this.unpack(u[p],u[p+1],u[p+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(n,s){if(n<-1||n>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(n+1)}unpack(n,s,u){return n*this.redFactor+s*this.greenFactor+u*this.blueFactor-this.baseShift}pack(n){return l1(n,this.getUnpackVector())}getPixels(){return new fi({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(n,s,u){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let p=s*this.dim,v=s*this.dim+this.dim,x=u*this.dim,w=u*this.dim+this.dim;switch(s){case-1:p=v-1;break;case 1:v=p+1}switch(u){case-1:x=w-1;break;case 1:w=x+1}const T=-s*this.dim,M=-u*this.dim;for(let I=x;I<w;I++)for(let D=p;D<v;D++)this.data[this._idx(D,I)]=n.data[this._idx(D+T,I+M)]}}function l1(a,n){const s=n[0],u=n[1],p=n[2],v=n[3],x=Math.min(s,u,p),w=Math.round((a+v)/x);return{r:Math.floor(w*x/s)%256,g:Math.floor(w*x/u)%256,b:Math.floor(w*x/p)%256}}_t("DEMData",a1);class lz extends wn{constructor(n){super(n,az)}_createColorRamp(n){const s={elevationStops:[],colorStops:[]},u=this._transitionablePaint._values["color-relief-color"].value.expression;if(u instanceof ql&&u._styleExpression.expression instanceof $n){this.colorRampExpression=u;const x=u._styleExpression.expression;s.elevationStops=x.labels,s.colorStops=[];for(const w of s.elevationStops)s.colorStops.push(x.evaluate({globals:{elevation:w}}))}if(s.elevationStops.length<1&&(s.elevationStops=[0],s.colorStops=[Wt.transparent]),s.elevationStops.length<2&&(s.elevationStops.push(s.elevationStops[0]+1),s.colorStops.push(s.colorStops[0])),s.elevationStops.length<=n)return s;const p={elevationStops:[],colorStops:[]},v=(s.elevationStops.length-1)/(n-1);for(let x=0;x<s.elevationStops.length-.5;x+=v)p.elevationStops.push(s.elevationStops[Math.round(x)]),p.colorStops.push(s.colorStops[Math.round(x)]);return Sr(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),p}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(n,s,u){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const p=this._createColorRamp(s),v=new fi({width:p.colorStops.length,height:1}),x=new fi({width:p.colorStops.length,height:1});for(let w=0;w<p.elevationStops.length;w++){const T=l1(p.elevationStops[w],u);x.setPixel(0,w,new Wt(T.r/255,T.g/255,T.b/255,1)),v.setPixel(0,w,p.colorStops[w])}return this.colorRampTextures={elevationTexture:new nv(n,x,n.gl.RGBA),colorTexture:new nv(n,v,n.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const cz=Lr([{name:"a_pos",components:2,type:"Int16"}],4),{members:uz}=cz;function iv(a,n,s){const u=s.patternDependencies;let p=!1;for(const v of n){const x=v.paint.get(`${a}-pattern`);x.isConstant()||(p=!0);const w=x.constantOr(null);w&&(p=!0,u[w.to]=!0,u[w.from]=!0)}return p}function ov(a,n,s,u,p){const v=p.patternDependencies;for(const x of n){const w=x.paint.get(`${a}-pattern`).value;if(w.kind!=="constant"){let T=w.evaluate({zoom:u-1},s,{},p.availableImages),M=w.evaluate({zoom:u},s,{},p.availableImages),I=w.evaluate({zoom:u+1},s,{},p.availableImages);T=T&&T.name?T.name:T,M=M&&M.name?M.name:M,I=I&&I.name?I.name:I,v[T]=!0,v[M]=!0,v[I]=!0,s.patterns[x.id]={min:T,mid:M,max:I}}}return s}function c1(a,n,s,u,p){let v;if(p===function(x,w,T,M){let I=0;for(let D=w,B=T-M;D<T;D+=M)I+=(x[B]-x[D])*(x[D+1]+x[B+1]),B=D;return I}(a,n,s,u)>0)for(let x=n;x<s;x+=u)v=f1(x/u|0,a[x],a[x+1],v);else for(let x=s-u;x>=n;x-=u)v=f1(x/u|0,a[x],a[x+1],v);return v&&Ou(v,v.next)&&(tf(v),v=v.next),v}function fc(a,n){if(!a)return a;n||(n=a);let s,u=a;do if(s=!1,u.steiner||!Ou(u,u.next)&&Hr(u.prev,u,u.next)!==0)u=u.next;else{if(tf(u),u=n=u.prev,u===u.next)break;s=!0}while(s||u!==n);return n}function Qd(a,n,s,u,p,v,x){if(!a)return;!x&&v&&function(T,M,I,D){let B=T;do B.z===0&&(B.z=sv(B.x,B.y,M,I,D)),B.prevZ=B.prev,B.nextZ=B.next,B=B.next;while(B!==T);B.prevZ.nextZ=null,B.prevZ=null,function(V){let G,K=1;do{let ne,le=V;V=null;let Se=null;for(G=0;le;){G++;let me=le,$=0;for(let _e=0;_e<K&&($++,me=me.nextZ,me);_e++);let te=K;for(;$>0||te>0&&me;)$!==0&&(te===0||!me||le.z<=me.z)?(ne=le,le=le.nextZ,$--):(ne=me,me=me.nextZ,te--),Se?Se.nextZ=ne:V=ne,ne.prevZ=Se,Se=ne;le=me}Se.nextZ=null,K*=2}while(G>1)}(B)}(a,u,p,v);let w=a;for(;a.prev!==a.next;){const T=a.prev,M=a.next;if(v?dz(a,u,p,v):hz(a))n.push(T.i,a.i,M.i),tf(a),a=M.next,w=M.next;else if((a=M)===w){x?x===1?Qd(a=fz(fc(a),n),n,s,u,p,v,2):x===2&&pz(a,n,s,u,p,v):Qd(fc(a),n,s,u,p,v,1);break}}}function hz(a){const n=a.prev,s=a,u=a.next;if(Hr(n,s,u)>=0)return!1;const p=n.x,v=s.x,x=u.x,w=n.y,T=s.y,M=u.y,I=Math.min(p,v,x),D=Math.min(w,T,M),B=Math.max(p,v,x),V=Math.max(w,T,M);let G=u.next;for(;G!==n;){if(G.x>=I&&G.x<=B&&G.y>=D&&G.y<=V&&Jd(p,w,v,T,x,M,G.x,G.y)&&Hr(G.prev,G,G.next)>=0)return!1;G=G.next}return!0}function dz(a,n,s,u){const p=a.prev,v=a,x=a.next;if(Hr(p,v,x)>=0)return!1;const w=p.x,T=v.x,M=x.x,I=p.y,D=v.y,B=x.y,V=Math.min(w,T,M),G=Math.min(I,D,B),K=Math.max(w,T,M),ne=Math.max(I,D,B),le=sv(V,G,n,s,u),Se=sv(K,ne,n,s,u);let me=a.prevZ,$=a.nextZ;for(;me&&me.z>=le&&$&&$.z<=Se;){if(me.x>=V&&me.x<=K&&me.y>=G&&me.y<=ne&&me!==p&&me!==x&&Jd(w,I,T,D,M,B,me.x,me.y)&&Hr(me.prev,me,me.next)>=0||(me=me.prevZ,$.x>=V&&$.x<=K&&$.y>=G&&$.y<=ne&&$!==p&&$!==x&&Jd(w,I,T,D,M,B,$.x,$.y)&&Hr($.prev,$,$.next)>=0))return!1;$=$.nextZ}for(;me&&me.z>=le;){if(me.x>=V&&me.x<=K&&me.y>=G&&me.y<=ne&&me!==p&&me!==x&&Jd(w,I,T,D,M,B,me.x,me.y)&&Hr(me.prev,me,me.next)>=0)return!1;me=me.prevZ}for(;$&&$.z<=Se;){if($.x>=V&&$.x<=K&&$.y>=G&&$.y<=ne&&$!==p&&$!==x&&Jd(w,I,T,D,M,B,$.x,$.y)&&Hr($.prev,$,$.next)>=0)return!1;$=$.nextZ}return!0}function fz(a,n){let s=a;do{const u=s.prev,p=s.next.next;!Ou(u,p)&&h1(u,s,s.next,p)&&ef(u,p)&&ef(p,u)&&(n.push(u.i,s.i,p.i),tf(s),tf(s.next),s=a=p),s=s.next}while(s!==a);return fc(s)}function pz(a,n,s,u,p,v){let x=a;do{let w=x.next.next;for(;w!==x.prev;){if(x.i!==w.i&&vz(x,w)){let T=d1(x,w);return x=fc(x,x.next),T=fc(T,T.next),Qd(x,n,s,u,p,v,0),void Qd(T,n,s,u,p,v,0)}w=w.next}x=x.next}while(x!==a)}function mz(a,n){let s=a.x-n.x;return s===0&&(s=a.y-n.y,s===0)&&(s=(a.next.y-a.y)/(a.next.x-a.x)-(n.next.y-n.y)/(n.next.x-n.x)),s}function gz(a,n){const s=function(p,v){let x=v;const w=p.x,T=p.y;let M,I=-1/0;if(Ou(p,x))return x;do{if(Ou(p,x.next))return x.next;if(T<=x.y&&T>=x.next.y&&x.next.y!==x.y){const K=x.x+(T-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(K<=w&&K>I&&(I=K,M=x.x<x.next.x?x:x.next,K===w))return M}x=x.next}while(x!==v);if(!M)return null;const D=M,B=M.x,V=M.y;let G=1/0;x=M;do{if(w>=x.x&&x.x>=B&&w!==x.x&&u1(T<V?w:I,T,B,V,T<V?I:w,T,x.x,x.y)){const K=Math.abs(T-x.y)/(w-x.x);ef(x,p)&&(K<G||K===G&&(x.x>M.x||x.x===M.x&&_z(M,x)))&&(M=x,G=K)}x=x.next}while(x!==D);return M}(a,n);if(!s)return n;const u=d1(s,a);return fc(u,u.next),fc(s,s.next)}function _z(a,n){return Hr(a.prev,a,n.prev)<0&&Hr(n.next,a,a.next)<0}function sv(a,n,s,u,p){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-s)*p|0)|a<<8))|a<<4))|a<<2))|a<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-u)*p|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function yz(a){let n=a,s=a;do(n.x<s.x||n.x===s.x&&n.y<s.y)&&(s=n),n=n.next;while(n!==a);return s}function u1(a,n,s,u,p,v,x,w){return(p-x)*(n-w)>=(a-x)*(v-w)&&(a-x)*(u-w)>=(s-x)*(n-w)&&(s-x)*(v-w)>=(p-x)*(u-w)}function Jd(a,n,s,u,p,v,x,w){return!(a===x&&n===w)&&u1(a,n,s,u,p,v,x,w)}function vz(a,n){return a.next.i!==n.i&&a.prev.i!==n.i&&!function(s,u){let p=s;do{if(p.i!==s.i&&p.next.i!==s.i&&p.i!==u.i&&p.next.i!==u.i&&h1(p,p.next,s,u))return!0;p=p.next}while(p!==s);return!1}(a,n)&&(ef(a,n)&&ef(n,a)&&function(s,u){let p=s,v=!1;const x=(s.x+u.x)/2,w=(s.y+u.y)/2;do p.y>w!=p.next.y>w&&p.next.y!==p.y&&x<(p.next.x-p.x)*(w-p.y)/(p.next.y-p.y)+p.x&&(v=!v),p=p.next;while(p!==s);return v}(a,n)&&(Hr(a.prev,a,n.prev)||Hr(a,n.prev,n))||Ou(a,n)&&Hr(a.prev,a,a.next)>0&&Hr(n.prev,n,n.next)>0)}function Hr(a,n,s){return(n.y-a.y)*(s.x-n.x)-(n.x-a.x)*(s.y-n.y)}function Ou(a,n){return a.x===n.x&&a.y===n.y}function h1(a,n,s,u){const p=Om(Hr(a,n,s)),v=Om(Hr(a,n,u)),x=Om(Hr(s,u,a)),w=Om(Hr(s,u,n));return p!==v&&x!==w||!(p!==0||!Lm(a,s,n))||!(v!==0||!Lm(a,u,n))||!(x!==0||!Lm(s,a,u))||!(w!==0||!Lm(s,n,u))}function Lm(a,n,s){return n.x<=Math.max(a.x,s.x)&&n.x>=Math.min(a.x,s.x)&&n.y<=Math.max(a.y,s.y)&&n.y>=Math.min(a.y,s.y)}function Om(a){return a>0?1:a<0?-1:0}function ef(a,n){return Hr(a.prev,a,a.next)<0?Hr(a,n,a.next)>=0&&Hr(a,a.prev,n)>=0:Hr(a,n,a.prev)<0||Hr(a,a.next,n)<0}function d1(a,n){const s=av(a.i,a.x,a.y),u=av(n.i,n.x,n.y),p=a.next,v=n.prev;return a.next=n,n.prev=a,s.next=p,p.prev=s,u.next=s,s.prev=u,v.next=u,u.prev=v,u}function f1(a,n,s,u){const p=av(a,n,s);return u?(p.next=u.next,p.prev=u,u.next.prev=p,u.next=p):(p.prev=p,p.next=p),p}function tf(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function av(a,n,s){return{i:a,x:n,y:s,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Fu{constructor(n,s){if(s>n)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=n,this._minGranularity=s}getGranularityForZoomLevel(n){return Math.max(Math.floor(this._baseZoomGranularity/(1<<n)),this._minGranularity,1)}}class Fm{constructor(n){this.fill=n.fill,this.line=n.line,this.tile=n.tile,this.stencil=n.stencil,this.circle=n.circle}}Fm.noSubdivision=new Fm({fill:new Fu(0,0),line:new Fu(0,0),tile:new Fu(0,0),stencil:new Fu(0,0),circle:1}),_t("SubdivisionGranularityExpression",Fu),_t("SubdivisionGranularitySetting",Fm);const Nu=-32768,rf=32767;class xz{constructor(n,s){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=n,this._granularityCellSize=ut/n,this._canonical=s}_getKey(n,s){return(n+=32768)<<16|s+32768}_vertexToIndex(n,s){if(n<-32768||s<-32768||n>32767||s>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const u=0|Math.round(n),p=0|Math.round(s),v=this._getKey(u,p);if(this._vertexDictionary.has(v))return this._vertexDictionary.get(v);const x=this._vertexBuffer.length/2;return this._vertexDictionary.set(v,x),this._vertexBuffer.push(u,p),x}_subdivideTrianglesScanline(n){if(this._granularity<2)return function(p,v){const x=[];for(let w=0;w<v.length;w+=3){const T=v[w],M=v[w+1],I=v[w+2],D=p[2*T],B=p[2*T+1];(p[2*M]-D)*(p[2*I+1]-B)-(p[2*M+1]-B)*(p[2*I]-D)>0?(x.push(T),x.push(I),x.push(M)):(x.push(T),x.push(M),x.push(I))}return x}(this._vertexBuffer,n);const s=[],u=n.length;for(let p=0;p<u;p+=3){const v=[n[p+0],n[p+1],n[p+2]],x=[this._vertexBuffer[2*n[p+0]+0],this._vertexBuffer[2*n[p+0]+1],this._vertexBuffer[2*n[p+1]+0],this._vertexBuffer[2*n[p+1]+1],this._vertexBuffer[2*n[p+2]+0],this._vertexBuffer[2*n[p+2]+1]];let w=1/0,T=1/0,M=-1/0,I=-1/0;for(let K=0;K<3;K++){const ne=x[2*K],le=x[2*K+1];w=Math.min(w,ne),M=Math.max(M,ne),T=Math.min(T,le),I=Math.max(I,le)}if(w===M||T===I)continue;const D=Math.floor(w/this._granularityCellSize),B=Math.ceil(M/this._granularityCellSize),V=Math.floor(T/this._granularityCellSize),G=Math.ceil(I/this._granularityCellSize);if(D!==B||V!==G)for(let K=V;K<G;K++){const ne=this._scanlineGenerateVertexRingForCellRow(K,x,v);bz(this._vertexBuffer,ne,s)}else s.push(...v)}return s}_scanlineGenerateVertexRingForCellRow(n,s,u){const p=n*this._granularityCellSize,v=p+this._granularityCellSize,x=[];for(let w=0;w<3;w++){const T=s[2*w],M=s[2*w+1],I=s[2*(w+1)%6],D=s[(2*(w+1)+1)%6],B=s[2*(w+2)%6],V=s[(2*(w+2)+1)%6],G=I-T,K=D-M,ne=G===0,le=K===0,Se=(p-M)/K,me=(v-M)/K,$=Math.min(Se,me),te=Math.max(Se,me);if(!le&&($>=1||te<=0)||le&&(M<p||M>v)){D>=p&&D<=v&&x.push(u[(w+1)%3]);continue}!le&&$>0&&x.push(this._vertexToIndex(T+G*$,M+K*$));const _e=T+G*Math.max($,0),Le=T+G*Math.min(te,1);ne||this._generateIntraEdgeVertices(x,T,M,I,D,_e,Le),!le&&te<1&&x.push(this._vertexToIndex(T+G*te,M+K*te)),(le||D>=p&&D<=v)&&x.push(u[(w+1)%3]),!le&&(D<=p||D>=v)&&this._generateInterEdgeVertices(x,T,M,I,D,B,V,Le,p,v)}return x}_generateIntraEdgeVertices(n,s,u,p,v,x,w){const T=p-s,M=v-u,I=M===0,D=I?Math.min(s,p):Math.min(x,w),B=I?Math.max(s,p):Math.max(x,w),V=Math.floor(D/this._granularityCellSize)+1,G=Math.ceil(B/this._granularityCellSize)-1;if(I?s<p:x<w)for(let K=V;K<=G;K++){const ne=K*this._granularityCellSize;n.push(this._vertexToIndex(ne,u+M*(ne-s)/T))}else for(let K=G;K>=V;K--){const ne=K*this._granularityCellSize;n.push(this._vertexToIndex(ne,u+M*(ne-s)/T))}}_generateInterEdgeVertices(n,s,u,p,v,x,w,T,M,I){const D=v-u,B=x-p,V=w-v,G=(M-v)/V,K=(I-v)/V,ne=Math.min(G,K),le=Math.max(G,K),Se=p+B*ne;let me=Math.floor(Math.min(Se,T)/this._granularityCellSize)+1,$=Math.ceil(Math.max(Se,T)/this._granularityCellSize)-1,te=T<Se;const _e=V===0;if(_e&&(w===M||w===I))return;if(_e||ne>=1||le<=0){const Xe=u-w,Be=x+(s-x)*Math.min((M-w)/Xe,(I-w)/Xe);me=Math.floor(Math.min(Be,T)/this._granularityCellSize)+1,$=Math.ceil(Math.max(Be,T)/this._granularityCellSize)-1,te=T<Be}const Le=D>0?I:M;if(te)for(let Xe=me;Xe<=$;Xe++)n.push(this._vertexToIndex(Xe*this._granularityCellSize,Le));else for(let Xe=$;Xe>=me;Xe--)n.push(this._vertexToIndex(Xe*this._granularityCellSize,Le))}_generateOutline(n){const s=[];for(const u of n){const p=pc(u,this._granularity,!0),v=this._pointArrayToIndices(p),x=[];for(let w=1;w<v.length;w++)x.push(v[w-1]),x.push(v[w]);s.push(x)}return s}_handlePoles(n){let s=!1,u=!1;this._canonical&&(this._canonical.y===0&&(s=!0),this._canonical.y===(1<<this._canonical.z)-1&&(u=!0)),(s||u)&&this._fillPoles(n,s,u)}_ensureNoPoleVertices(){const n=this._vertexBuffer;for(let s=0;s<n.length;s+=2){const u=n[s+1];u===Nu&&(n[s+1]=-32767),u===rf&&(n[s+1]=32766)}}_generatePoleQuad(n,s,u,p,v,x){p>v!=(x===Nu)?(n.push(s),n.push(u),n.push(this._vertexToIndex(p,x)),n.push(u),n.push(this._vertexToIndex(v,x)),n.push(this._vertexToIndex(p,x))):(n.push(u),n.push(s),n.push(this._vertexToIndex(p,x)),n.push(this._vertexToIndex(v,x)),n.push(u),n.push(this._vertexToIndex(p,x)))}_fillPoles(n,s,u){const p=this._vertexBuffer,v=ut,x=n.length;for(let w=2;w<x;w+=3){const T=n[w-2],M=n[w-1],I=n[w],D=p[2*T],B=p[2*T+1],V=p[2*M],G=p[2*M+1],K=p[2*I],ne=p[2*I+1];s&&(B===0&&G===0&&this._generatePoleQuad(n,T,M,D,V,Nu),G===0&&ne===0&&this._generatePoleQuad(n,M,I,V,K,Nu),ne===0&&B===0&&this._generatePoleQuad(n,I,T,K,D,Nu)),u&&(B===v&&G===v&&this._generatePoleQuad(n,T,M,D,V,rf),G===v&&ne===v&&this._generatePoleQuad(n,M,I,V,K,rf),ne===v&&B===v&&this._generatePoleQuad(n,I,T,K,D,rf))}}_initializeVertices(n){for(let s=0;s<n.length;s+=2)this._vertexToIndex(n[s],n[s+1])}subdividePolygonInternal(n,s){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:u,holeIndices:p}=function(w){const T=[],M=[];for(const I of w)if(I.length!==0){I!==w[0]&&T.push(M.length/2);for(let D=0;D<I.length;D++)M.push(I[D].x),M.push(I[D].y)}return{flattened:M,holeIndices:T}}(n);let v;this._initializeVertices(u);try{const w=function(M,I,D=2){const B=I&&I.length,V=B?I[0]*D:M.length;let G=c1(M,0,V,D,!0);const K=[];if(!G||G.next===G.prev)return K;let ne,le,Se;if(B&&(G=function(me,$,te,_e){const Le=[];for(let Xe=0,Be=$.length;Xe<Be;Xe++){const Ue=c1(me,$[Xe]*_e,Xe<Be-1?$[Xe+1]*_e:me.length,_e,!1);Ue===Ue.next&&(Ue.steiner=!0),Le.push(yz(Ue))}Le.sort(mz);for(let Xe=0;Xe<Le.length;Xe++)te=gz(Le[Xe],te);return te}(M,I,G,D)),M.length>80*D){ne=1/0,le=1/0;let me=-1/0,$=-1/0;for(let te=D;te<V;te+=D){const _e=M[te],Le=M[te+1];_e<ne&&(ne=_e),Le<le&&(le=Le),_e>me&&(me=_e),Le>$&&($=Le)}Se=Math.max(me-ne,$-le),Se=Se!==0?32767/Se:0}return Qd(G,K,D,ne,le,Se,0),K}(u,p),T=this._convertIndices(u,w);v=this._subdivideTrianglesScanline(T)}catch(w){console.error(w)}let x=[];return s&&(x=this._generateOutline(n)),this._ensureNoPoleVertices(),this._handlePoles(v),{verticesFlattened:this._vertexBuffer,indicesTriangles:v,indicesLineList:x}}_convertIndices(n,s){const u=[];for(let p=0;p<s.length;p++)u.push(this._vertexToIndex(n[2*s[p]],n[2*s[p]+1]));return u}_pointArrayToIndices(n){const s=[];for(let u=0;u<n.length;u++){const p=n[u];s.push(this._vertexToIndex(p.x,p.y))}return s}}function p1(a,n,s,u=!0){return new xz(s,n).subdividePolygonInternal(a,u)}function pc(a,n,s=!1){if(!a||a.length<1)return[];if(a.length<2)return[];const u=a[0],p=a[a.length-1],v=s&&(u.x!==p.x||u.y!==p.y);if(n<2)return v?[...a,a[0]]:[...a];const x=Math.floor(ut/n),w=[];w.push(new X(a[0].x,a[0].y));const T=a.length,M=v?T:T-1;for(let I=0;I<M;I++){const D=a[I],B=I<T-1?a[I+1]:a[0],V=D.x,G=D.y,K=B.x,ne=B.y,le=V!==K,Se=G!==ne;if(!le&&!Se)continue;const me=K-V,$=ne-G,te=Math.abs(me),_e=Math.abs($);let Le=V,Xe=G;for(;;){const Ue=me>0?(Math.floor(Le/x)+1)*x:(Math.ceil(Le/x)-1)*x,tt=$>0?(Math.floor(Xe/x)+1)*x:(Math.ceil(Xe/x)-1)*x,Ye=Math.abs(Le-Ue),rt=Math.abs(Xe-tt),Ge=Math.abs(Le-K),xt=Math.abs(Xe-ne),Mt=le?Ye/te:Number.POSITIVE_INFINITY,Pt=Se?rt/_e:Number.POSITIVE_INFINITY;if((Ge<=Ye||!le)&&(xt<=rt||!Se))break;if(Mt<Pt&&le||!Se){Le=Ue,Xe+=$*Mt;const St=new X(Le,Math.round(Xe));w[w.length-1].x===St.x&&w[w.length-1].y===St.y||w.push(St)}else{Le+=me*Pt,Xe=tt;const St=new X(Math.round(Le),Xe);w[w.length-1].x===St.x&&w[w.length-1].y===St.y||w.push(St)}}const Be=new X(K,ne);w[w.length-1].x===Be.x&&w[w.length-1].y===Be.y||w.push(Be)}return w}function bz(a,n,s){if(n.length===0)throw new Error("Subdivision vertex ring is empty.");let u=0,p=a[2*n[0]];for(let T=1;T<n.length;T++){const M=a[2*n[T]];M<p&&(p=M,u=T)}const v=n.length;let x=u,w=(x+1)%v;for(;;){const T=x-1>=0?x-1:v-1,M=(w+1)%v,I=a[2*n[T]],D=a[2*n[M]],B=a[2*n[x]],V=a[2*n[x]+1],G=a[2*n[w]+1];let K=!1;if(I<D)K=!0;else if(I>D)K=!1;else{const ne=G-V,le=-(a[2*n[w]]-B),Se=V<G?1:-1;((I-B)*ne+(a[2*n[T]+1]-V)*le)*Se>((D-B)*ne+(a[2*n[M]+1]-V)*le)*Se&&(K=!0)}if(K){const ne=n[T],le=n[x],Se=n[w];ne!==le&&ne!==Se&&le!==Se&&s.push(Se,le,ne),x--,x<0&&(x=v-1)}else{const ne=n[M],le=n[x],Se=n[w];ne!==le&&ne!==Se&&le!==Se&&s.push(Se,le,ne),w++,w>=v&&(w=0)}if(T===M)break}}function m1(a,n,s,u,p,v,x,w,T){const M=p.length/2,I=x&&w&&T;if(M<rr.MAX_VERTEX_ARRAY_LENGTH){const D=n.prepareSegment(M,s,u),B=D.vertexLength;for(let K=0;K<v.length;K+=3)u.emplaceBack(B+v[K],B+v[K+1],B+v[K+2]);let V,G;D.vertexLength+=M,D.primitiveLength+=v.length/3,I&&(G=x.prepareSegment(M,s,w),V=G.vertexLength,G.vertexLength+=M);for(let K=0;K<p.length;K+=2)a(p[K],p[K+1]);if(I)for(let K=0;K<T.length;K++){const ne=T[K];for(let le=1;le<ne.length;le+=2)w.emplaceBack(V+ne[le-1],V+ne[le]);G.primitiveLength+=ne.length/2}}else(function(D,B,V,G,K,ne){const le=[];for(let _e=0;_e<G.length/2;_e++)le.push(-1);const Se={count:0};let me=0,$=D.getOrCreateLatestSegment(B,V),te=$.vertexLength;for(let _e=2;_e<K.length;_e+=3){const Le=K[_e-2],Xe=K[_e-1],Be=K[_e];let Ue=le[Le]<me,tt=le[Xe]<me,Ye=le[Be]<me;$.vertexLength+((Ue?1:0)+(tt?1:0)+(Ye?1:0))>rr.MAX_VERTEX_ARRAY_LENGTH&&($=D.createNewSegment(B,V),me=Se.count,Ue=!0,tt=!0,Ye=!0,te=0);const rt=nf(le,G,ne,Se,Le,Ue,$),Ge=nf(le,G,ne,Se,Xe,tt,$),xt=nf(le,G,ne,Se,Be,Ye,$);V.emplaceBack(te+rt-me,te+Ge-me,te+xt-me),$.primitiveLength++}})(n,s,u,p,v,a),I&&function(D,B,V,G,K,ne){const le=[];for(let _e=0;_e<G.length/2;_e++)le.push(-1);const Se={count:0};let me=0,$=D.getOrCreateLatestSegment(B,V),te=$.vertexLength;for(let _e=0;_e<K.length;_e++){const Le=K[_e];for(let Xe=1;Xe<K[_e].length;Xe+=2){const Be=Le[Xe-1],Ue=Le[Xe];let tt=le[Be]<me,Ye=le[Ue]<me;$.vertexLength+((tt?1:0)+(Ye?1:0))>rr.MAX_VERTEX_ARRAY_LENGTH&&($=D.createNewSegment(B,V),me=Se.count,tt=!0,Ye=!0,te=0);const rt=nf(le,G,ne,Se,Be,tt,$),Ge=nf(le,G,ne,Se,Ue,Ye,$);V.emplaceBack(te+rt-me,te+Ge-me),$.primitiveLength++}}}(x,s,w,p,T,a),n.forceNewSegmentOnNextPrepare(),x==null||x.forceNewSegmentOnNextPrepare()}function nf(a,n,s,u,p,v,x){if(v){const w=u.count;return s(n[2*p],n[2*p+1]),a[p]=u.count,u.count++,x.vertexLength++,w}return a[p]}class lv{constructor(n){this.zoom=n.zoom,this.globalState=n.globalState,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Fe,this.indexArray=new _r,this.indexArray2=new mr,this.programConfigurations=new us(n.layers,n.zoom),this.segments=new rr,this.segments2=new rr,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(n,s,u){this.hasPattern=iv("fill",this.layers,s);const p=this.layers[0].layout.get("fill-sort-key"),v=!p.isConstant(),x=[];for(const{feature:w,id:T,index:M,sourceLayerIndex:I}of n){const D=this.layers[0]._featureFilter.needGeometry,B=dc(w,D);if(!this.layers[0]._featureFilter.filter(new Tr(this.zoom,{globalState:this.globalState}),B,u))continue;const V=v?p.evaluate(B,{},u,s.availableImages):void 0,G={id:T,properties:w.properties,type:w.type,sourceLayerIndex:I,index:M,geometry:D?B.geometry:hc(w),patterns:{},sortKey:V};x.push(G)}v&&x.sort((w,T)=>w.sortKey-T.sortKey);for(const w of x){const{geometry:T,index:M,sourceLayerIndex:I}=w;if(this.hasPattern){const D=ov("fill",this.layers,w,this.zoom,s);this.patternFeatures.push(D)}else this.addFeature(w,T,M,u,{},s.subdivisionGranularity);s.featureIndex.insert(n[M].feature,T,M,I,this.index)}}update(n,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,u)}addFeatures(n,s,u){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,s,u,n.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,uz),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,s,u,p,v,x){for(const w of cu(s,500)){const T=p1(w,p,x.fill.getGranularityForZoomLevel(p.z)),M=this.layoutVertexArray;m1((I,D)=>{M.emplaceBack(I,D)},this.segments,this.layoutVertexArray,this.indexArray,T.verticesFlattened,T.indicesTriangles,this.segments2,this.indexArray2,T.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,v,p)}}let g1,_1;_t("FillBucket",lv,{omit:["layers","patternFeatures"]});var wz={get paint(){return _1=_1||new Vn({"fill-antialias":new bt(he.paint_fill["fill-antialias"]),"fill-opacity":new It(he.paint_fill["fill-opacity"]),"fill-color":new It(he.paint_fill["fill-color"]),"fill-outline-color":new It(he.paint_fill["fill-outline-color"]),"fill-translate":new bt(he.paint_fill["fill-translate"]),"fill-translate-anchor":new bt(he.paint_fill["fill-translate-anchor"]),"fill-pattern":new zu(he.paint_fill["fill-pattern"])})},get layout(){return g1=g1||new Vn({"fill-sort-key":new It(he.layout_fill["fill-sort-key"])})}};class Sz extends wn{constructor(n){super(n,wz)}recalculate(n,s){super.recalculate(n,s);const u=this.paint._values["fill-outline-color"];u.value.kind==="constant"&&u.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new lv(n)}queryRadius(){return Rm(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:n,geometry:s,transform:u,pixelsToTileUnits:p}){return Xw(Dm(n,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-u.bearingInRadians,p),s)}isTileClipped(){return!0}}const Tz=Lr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Cz=Lr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Pz}=Tz;var cv,y1,uv,v1,hv,x1,b1,Nm={};function w1(){if(y1)return cv;y1=1;var a=N();function n(p,v,x,w,T){this.properties={},this.extent=x,this.type=0,this._pbf=p,this._geometry=-1,this._keys=w,this._values=T,p.readFields(s,this,v)}function s(p,v,x){p==1?v.id=x.readVarint():p==2?function(w,T){for(var M=w.readVarint()+w.pos;w.pos<M;){var I=T._keys[w.readVarint()],D=T._values[w.readVarint()];T.properties[I]=D}}(x,v):p==3?v.type=x.readVarint():p==4&&(v._geometry=x.pos)}function u(p){for(var v,x,w=0,T=0,M=p.length,I=M-1;T<M;I=T++)w+=((x=p[I]).x-(v=p[T]).x)*(v.y+x.y);return w}return cv=n,n.types=["Unknown","Point","LineString","Polygon"],n.prototype.loadGeometry=function(){var p=this._pbf;p.pos=this._geometry;for(var v,x=p.readVarint()+p.pos,w=1,T=0,M=0,I=0,D=[];p.pos<x;){if(T<=0){var B=p.readVarint();w=7&B,T=B>>3}if(T--,w===1||w===2)M+=p.readSVarint(),I+=p.readSVarint(),w===1&&(v&&D.push(v),v=[]),v.push(new a(M,I));else{if(w!==7)throw new Error("unknown command "+w);v&&v.push(v[0].clone())}}return v&&D.push(v),D},n.prototype.bbox=function(){var p=this._pbf;p.pos=this._geometry;for(var v=p.readVarint()+p.pos,x=1,w=0,T=0,M=0,I=1/0,D=-1/0,B=1/0,V=-1/0;p.pos<v;){if(w<=0){var G=p.readVarint();x=7&G,w=G>>3}if(w--,x===1||x===2)(T+=p.readSVarint())<I&&(I=T),T>D&&(D=T),(M+=p.readSVarint())<B&&(B=M),M>V&&(V=M);else if(x!==7)throw new Error("unknown command "+x)}return[I,B,D,V]},n.prototype.toGeoJSON=function(p,v,x){var w,T,M=this.extent*Math.pow(2,x),I=this.extent*p,D=this.extent*v,B=this.loadGeometry(),V=n.types[this.type];function G(le){for(var Se=0;Se<le.length;Se++){var me=le[Se];le[Se]=[360*(me.x+I)/M-180,360/Math.PI*Math.atan(Math.exp((180-360*(me.y+D)/M)*Math.PI/180))-90]}}switch(this.type){case 1:var K=[];for(w=0;w<B.length;w++)K[w]=B[w][0];G(B=K);break;case 2:for(w=0;w<B.length;w++)G(B[w]);break;case 3:for(B=function(le){var Se=le.length;if(Se<=1)return[le];for(var me,$,te=[],_e=0;_e<Se;_e++){var Le=u(le[_e]);Le!==0&&($===void 0&&($=Le<0),$===Le<0?(me&&te.push(me),me=[le[_e]]):me.push(le[_e]))}return me&&te.push(me),te}(B),w=0;w<B.length;w++)for(T=0;T<B[w].length;T++)G(B[w][T])}B.length===1?B=B[0]:V="Multi"+V;var ne={type:"Feature",geometry:{type:V,coordinates:B},properties:this.properties};return"id"in this&&(ne.id=this.id),ne},cv}function S1(){if(v1)return uv;v1=1;var a=w1();function n(u,p){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(s,this,p),this.length=this._features.length}function s(u,p,v){u===15?p.version=v.readVarint():u===1?p.name=v.readString():u===5?p.extent=v.readVarint():u===2?p._features.push(v.pos):u===3?p._keys.push(v.readString()):u===4&&p._values.push(function(x){for(var w=null,T=x.readVarint()+x.pos;x.pos<T;){var M=x.readVarint()>>3;w=M===1?x.readString():M===2?x.readFloat():M===3?x.readDouble():M===4?x.readVarint64():M===5?x.readVarint():M===6?x.readSVarint():M===7?x.readBoolean():null}return w}(v))}return uv=n,n.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var p=this._pbf.readVarint()+this._pbf.pos;return new a(this._pbf,p,this.extent,this._keys,this._values)},uv}function T1(){return b1||(b1=1,Nm.VectorTile=function(){if(x1)return hv;x1=1;var a=S1();function n(s,u,p){if(s===3){var v=new a(p,p.readVarint()+p.pos);v.length&&(u[v.name]=v)}}return hv=function(s,u){this.layers=s.readFields(n,{},u)},hv}(),Nm.VectorTileFeature=w1(),Nm.VectorTileLayer=S1()),Nm}var of=E(T1());const Ez=of.VectorTileFeature.types,dv=Math.pow(2,13);function sf(a,n,s,u,p,v,x,w){a.emplaceBack(n,s,2*Math.floor(u*dv)+x,p*dv*2,v*dv*2,Math.round(w))}class fv{constructor(n){this.zoom=n.zoom,this.globalState=n.globalState,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.id),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new st,this.centroidVertexArray=new Ae,this.indexArray=new _r,this.programConfigurations=new us(n.layers,n.zoom),this.segments=new rr,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(n,s,u){this.features=[],this.hasPattern=iv("fill-extrusion",this.layers,s);for(const{feature:p,id:v,index:x,sourceLayerIndex:w}of n){const T=this.layers[0]._featureFilter.needGeometry,M=dc(p,T);if(!this.layers[0]._featureFilter.filter(new Tr(this.zoom,{globalState:this.globalState}),M,u))continue;const I={id:v,sourceLayerIndex:w,index:x,geometry:T?M.geometry:hc(p),properties:p.properties,type:p.type,patterns:{}};this.hasPattern?this.features.push(ov("fill-extrusion",this.layers,I,this.zoom,s)):this.addFeature(I,I.geometry,x,u,{},s.subdivisionGranularity),s.featureIndex.insert(p,I.geometry,x,w,this.index,!0)}}addFeatures(n,s,u){for(const p of this.features){const{geometry:v}=p;this.addFeature(p,v,p.index,s,u,n.subdivisionGranularity)}}update(n,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,u)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Pz),this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,Cz.members,!0),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(n,s,u,p,v,x){for(const w of cu(s,500)){const T={x:0,y:0,sampleCount:0},M=this.layoutVertexArray.length;this.processPolygon(T,p,n,w,x);const I=this.layoutVertexArray.length-M,D=Math.floor(T.x/T.sampleCount),B=Math.floor(T.y/T.sampleCount);for(let V=0;V<I;V++)this.centroidVertexArray.emplaceBack(D,B)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,v,p)}processPolygon(n,s,u,p,v){if(p.length<1||C1(p[0]))return;for(const D of p)D.length!==0&&Mz(n,D);const x={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},w=v.fill.getGranularityForZoomLevel(s.z),T=Ez[u.type]==="Polygon";for(const D of p){if(D.length===0||C1(D))continue;const B=pc(D,w,T);this._generateSideFaces(B,x)}if(!T)return;const M=p1(p,s,w,!1),I=this.layoutVertexArray;m1((D,B)=>{sf(I,D,B,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,M.verticesFlattened,M.indicesTriangles)}_generateSideFaces(n,s){let u=0;for(let p=1;p<n.length;p++){const v=n[p],x=n[p-1];if(kz(v,x))continue;s.segment.vertexLength+4>rr.MAX_VERTEX_ARRAY_LENGTH&&(s.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const w=v.sub(x)._perp()._unit(),T=x.dist(v);u+T>32768&&(u=0),sf(this.layoutVertexArray,v.x,v.y,w.x,w.y,0,0,u),sf(this.layoutVertexArray,v.x,v.y,w.x,w.y,0,1,u),u+=T,sf(this.layoutVertexArray,x.x,x.y,w.x,w.y,0,0,u),sf(this.layoutVertexArray,x.x,x.y,w.x,w.y,0,1,u);const M=s.segment.vertexLength;this.indexArray.emplaceBack(M,M+2,M+1),this.indexArray.emplaceBack(M+1,M+2,M+3),s.segment.vertexLength+=4,s.segment.primitiveLength+=2}}}function Mz(a,n){for(let s=0;s<n.length;s++){const u=n[s];s===n.length-1&&n[0].x===u.x&&n[0].y===u.y||(a.x+=u.x,a.y+=u.y,a.sampleCount++)}}function kz(a,n){return a.x===n.x&&(a.x<0||a.x>ut)||a.y===n.y&&(a.y<0||a.y>ut)}function C1(a){return a.every(n=>n.x<0)||a.every(n=>n.x>ut)||a.every(n=>n.y<0)||a.every(n=>n.y>ut)}let P1;_t("FillExtrusionBucket",fv,{omit:["layers","features"]});var Iz={get paint(){return P1=P1||new Vn({"fill-extrusion-opacity":new bt(he["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new It(he["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new bt(he["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new bt(he["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new zu(he["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new It(he["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new It(he["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new bt(he["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Az extends wn{constructor(n){super(n,Iz)}createBucket(n){return new fv(n)}queryRadius(){return Rm(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:n,feature:s,featureState:u,geometry:p,transform:v,pixelsToTileUnits:x,pixelPosMatrix:w}){const T=Dm(n,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-v.bearingInRadians,x),M=this.paint.get("fill-extrusion-height").evaluate(s,u),I=this.paint.get("fill-extrusion-base").evaluate(s,u),D=function(V,G){const K=[];for(const ne of V){const le=[ne.x,ne.y,0,1];wt(le,le,G),K.push(new X(le[0]/le[3],le[1]/le[3]))}return K}(T,w),B=function(V,G,K,ne){const le=[],Se=[],me=ne[8]*G,$=ne[9]*G,te=ne[10]*G,_e=ne[11]*G,Le=ne[8]*K,Xe=ne[9]*K,Be=ne[10]*K,Ue=ne[11]*K;for(const tt of V){const Ye=[],rt=[];for(const Ge of tt){const xt=Ge.x,Mt=Ge.y,Pt=ne[0]*xt+ne[4]*Mt+ne[12],St=ne[1]*xt+ne[5]*Mt+ne[13],Kt=ne[2]*xt+ne[6]*Mt+ne[14],Or=ne[3]*xt+ne[7]*Mt+ne[15],ln=Kt+te,Dn=Or+_e,Zi=Pt+Le,pi=St+Xe,Pn=Kt+Be,Ar=Or+Ue,gn=new X((Pt+me)/Dn,(St+$)/Dn);gn.z=ln/Dn,Ye.push(gn);const En=new X(Zi/Ar,pi/Ar);En.z=Pn/Ar,rt.push(En)}le.push(Ye),Se.push(rt)}return[le,Se]}(p,I,M,w);return function(V,G,K){let ne=1/0;Xw(K,G)&&(ne=E1(K,G[0]));for(let le=0;le<G.length;le++){const Se=G[le],me=V[le];for(let $=0;$<Se.length-1;$++){const te=Se[$],_e=[te,Se[$+1],me[$+1],me[$],te];qw(K,_e)&&(ne=Math.min(ne,E1(K,_e)))}}return ne!==1/0&&ne}(B[0],B[1],D)}}function af(a,n){return a.x*n.x+a.y*n.y}function E1(a,n){if(a.length===1){let s=0;const u=n[s++];let p;for(;!p||u.equals(p);)if(p=n[s++],!p)return 1/0;for(;s<n.length;s++){const v=n[s],x=a[0],w=p.sub(u),T=v.sub(u),M=x.sub(u),I=af(w,w),D=af(w,T),B=af(T,T),V=af(M,w),G=af(M,T),K=I*B-D*D,ne=(B*V-D*G)/K,le=(I*G-D*V)/K,Se=u.z*(1-ne-le)+p.z*ne+v.z*le;if(isFinite(Se))return Se}return 1/0}{let s=1/0;for(const u of n)s=Math.min(s,u.z);return s}}const zz=Lr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Rz}=zz,Dz=Lr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Lz}=Dz,Oz=of.VectorTileFeature.types,Fz=Math.cos(Math.PI/180*37.5),M1=Math.pow(2,14)/.5;class pv{constructor(n){this.zoom=n.zoom,this.globalState=n.globalState,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new it,this.layoutVertexArray2=new Ke,this.indexArray=new _r,this.programConfigurations=new us(n.layers,n.zoom),this.segments=new rr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(n,s,u){this.hasPattern=iv("line",this.layers,s);const p=this.layers[0].layout.get("line-sort-key"),v=!p.isConstant(),x=[];for(const{feature:w,id:T,index:M,sourceLayerIndex:I}of n){const D=this.layers[0]._featureFilter.needGeometry,B=dc(w,D);if(!this.layers[0]._featureFilter.filter(new Tr(this.zoom,{globalState:this.globalState}),B,u))continue;const V=v?p.evaluate(B,{},u):void 0,G={id:T,properties:w.properties,type:w.type,sourceLayerIndex:I,index:M,geometry:D?B.geometry:hc(w),patterns:{},sortKey:V};x.push(G)}v&&x.sort((w,T)=>w.sortKey-T.sortKey);for(const w of x){const{geometry:T,index:M,sourceLayerIndex:I}=w;if(this.hasPattern){const D=ov("line",this.layers,w,this.zoom,s);this.patternFeatures.push(D)}else this.addFeature(w,T,M,u,{},s.subdivisionGranularity);s.featureIndex.insert(n[M].feature,T,M,I,this.index)}}update(n,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,u)}addFeatures(n,s,u){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,s,u,n.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,Lz)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Rz),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,s,u,p,v,x){const w=this.layers[0].layout,T=w.get("line-join").evaluate(n,{}),M=w.get("line-cap"),I=w.get("line-miter-limit"),D=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(n);for(const B of s)this.addLine(B,n,T,M,I,D,p,x);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,v,p)}addLine(n,s,u,p,v,x,w,T){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,n=pc(n,w?T.line.getGranularityForZoomLevel(w.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let me=0;me<n.length-1;me++)this.totalDistance+=n[me].dist(n[me+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const M=Oz[s.type]==="Polygon";let I=n.length;for(;I>=2&&n[I-1].equals(n[I-2]);)I--;let D=0;for(;D<I-1&&n[D].equals(n[D+1]);)D++;if(I<(M?3:2))return;u==="bevel"&&(v=1.05);const B=this.overscaling<=16?122880/(512*this.overscaling):0,V=this.segments.prepareSegment(10*I,this.layoutVertexArray,this.indexArray);let G,K,ne,le,Se;this.e1=this.e2=-1,M&&(G=n[I-2],Se=n[D].sub(G)._unit()._perp());for(let me=D;me<I;me++){if(ne=me===I-1?M?n[D+1]:void 0:n[me+1],ne&&n[me].equals(ne))continue;Se&&(le=Se),G&&(K=G),G=n[me],Se=ne?ne.sub(G)._unit()._perp():le,le=le||Se;let $=le.add(Se);$.x===0&&$.y===0||$._unit();const te=le.x*Se.x+le.y*Se.y,_e=$.x*Se.x+$.y*Se.y,Le=_e!==0?1/_e:1/0,Xe=2*Math.sqrt(2-2*_e),Be=_e<Fz&&K&&ne,Ue=le.x*Se.y-le.y*Se.x>0;if(Be&&me>D){const rt=G.dist(K);if(rt>2*B){const Ge=G.sub(G.sub(K)._mult(B/rt)._round());this.updateDistance(K,Ge),this.addCurrentVertex(Ge,le,0,0,V),K=Ge}}const tt=K&&ne;let Ye=tt?u:M?"butt":p;if(tt&&Ye==="round"&&(Le<x?Ye="miter":Le<=2&&(Ye="fakeround")),Ye==="miter"&&Le>v&&(Ye="bevel"),Ye==="bevel"&&(Le>2&&(Ye="flipbevel"),Le<v&&(Ye="miter")),K&&this.updateDistance(K,G),Ye==="miter")$._mult(Le),this.addCurrentVertex(G,$,0,0,V);else if(Ye==="flipbevel"){if(Le>100)$=Se.mult(-1);else{const rt=Le*le.add(Se).mag()/le.sub(Se).mag();$._perp()._mult(rt*(Ue?-1:1))}this.addCurrentVertex(G,$,0,0,V),this.addCurrentVertex(G,$.mult(-1),0,0,V)}else if(Ye==="bevel"||Ye==="fakeround"){const rt=-Math.sqrt(Le*Le-1),Ge=Ue?rt:0,xt=Ue?0:rt;if(K&&this.addCurrentVertex(G,le,Ge,xt,V),Ye==="fakeround"){const Mt=Math.round(180*Xe/Math.PI/20);for(let Pt=1;Pt<Mt;Pt++){let St=Pt/Mt;if(St!==.5){const Or=St-.5;St+=St*Or*(St-1)*((1.0904+te*(te*(3.55645-1.43519*te)-3.2452))*Or*Or+(.848013+te*(.215638*te-1.06021)))}const Kt=Se.sub(le)._mult(St)._add(le)._unit()._mult(Ue?-1:1);this.addHalfVertex(G,Kt.x,Kt.y,!1,Ue,0,V)}}ne&&this.addCurrentVertex(G,Se,-Ge,-xt,V)}else if(Ye==="butt")this.addCurrentVertex(G,$,0,0,V);else if(Ye==="square"){const rt=K?1:-1;this.addCurrentVertex(G,$,rt,rt,V)}else Ye==="round"&&(K&&(this.addCurrentVertex(G,le,0,0,V),this.addCurrentVertex(G,le,1,1,V,!0)),ne&&(this.addCurrentVertex(G,Se,-1,-1,V,!0),this.addCurrentVertex(G,Se,0,0,V)));if(Be&&me<I-1){const rt=G.dist(ne);if(rt>2*B){const Ge=G.add(ne.sub(G)._mult(B/rt)._round());this.updateDistance(G,Ge),this.addCurrentVertex(Ge,Se,0,0,V),G=Ge}}}}addCurrentVertex(n,s,u,p,v,x=!1){const w=s.y*p-s.x,T=-s.y-s.x*p;this.addHalfVertex(n,s.x+s.y*u,s.y-s.x*u,x,!1,u,v),this.addHalfVertex(n,w,T,x,!0,-p,v),this.distance>M1/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(n,s,u,p,v,x))}addHalfVertex({x:n,y:s},u,p,v,x,w,T){const M=.5*(this.lineClips?this.scaledDistance*(M1-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((n<<1)+(v?1:0),(s<<1)+(x?1:0),Math.round(63*u)+128,Math.round(63*p)+128,1+(w===0?0:w<0?-1:1)|(63&M)<<2,M>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const I=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,I,this.e2),T.primitiveLength++),x?this.e2=I:this.e1=I}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(n,s){this.distance+=n.dist(s),this.updateScaledDistance()}}let k1,I1;_t("LineBucket",pv,{omit:["layers","patternFeatures"]});var A1={get paint(){return I1=I1||new Vn({"line-opacity":new It(he.paint_line["line-opacity"]),"line-color":new It(he.paint_line["line-color"]),"line-translate":new bt(he.paint_line["line-translate"]),"line-translate-anchor":new bt(he.paint_line["line-translate-anchor"]),"line-width":new It(he.paint_line["line-width"]),"line-gap-width":new It(he.paint_line["line-gap-width"]),"line-offset":new It(he.paint_line["line-offset"]),"line-blur":new It(he.paint_line["line-blur"]),"line-dasharray":new Ud(he.paint_line["line-dasharray"]),"line-pattern":new zu(he.paint_line["line-pattern"]),"line-gradient":new oc(he.paint_line["line-gradient"])})},get layout(){return k1=k1||new Vn({"line-cap":new bt(he.layout_line["line-cap"]),"line-join":new It(he.layout_line["line-join"]),"line-miter-limit":new bt(he.layout_line["line-miter-limit"]),"line-round-limit":new bt(he.layout_line["line-round-limit"]),"line-sort-key":new It(he.layout_line["line-sort-key"])})}};class Nz extends It{possiblyEvaluate(n,s){return s=new Tr(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,zoomHistory:s.zoomHistory,transition:s.transition}),super.possiblyEvaluate(n,s)}evaluate(n,s,u,p){return s=Dt({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(n,s,u,p)}}let Bm;class Bz extends wn{constructor(n){super(n,A1),this.gradientVersion=0,Bm||(Bm=new Nz(A1.paint.properties["line-width"].specification),Bm.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(n){if(n==="line-gradient"){const s=this.gradientExpression();this.stepInterpolant=!!function(u){return u._styleExpression!==void 0}(s)&&s._styleExpression.expression instanceof _a,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(n,s){super.recalculate(n,s),this.paint._values["line-floorwidth"]=Bm.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new pv(n)}queryRadius(n){const s=n,u=z1(Kd("line-width",this,s),Kd("line-gap-width",this,s)),p=Kd("line-offset",this,s);return u/2+Math.abs(p)+Rm(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:n,feature:s,featureState:u,geometry:p,transform:v,pixelsToTileUnits:x}){const w=Dm(n,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-v.bearingInRadians,x),T=x/2*z1(this.paint.get("line-width").evaluate(s,u),this.paint.get("line-gap-width").evaluate(s,u)),M=this.paint.get("line-offset").evaluate(s,u);return M&&(p=function(I,D){const B=[];for(let V=0;V<I.length;V++){const G=I[V],K=[];for(let ne=0;ne<G.length;ne++){const le=G[ne-1],Se=G[ne],me=G[ne+1],$=ne===0?new X(0,0):Se.sub(le)._unit()._perp(),te=ne===G.length-1?new X(0,0):me.sub(Se)._unit()._perp(),_e=$._add(te)._unit(),Le=_e.x*te.x+_e.y*te.y;Le!==0&&_e._mult(1/Le),K.push(_e._mult(D)._add(Se))}B.push(K)}return B}(p,M*x)),function(I,D,B){for(let V=0;V<D.length;V++){const G=D[V];if(I.length>=3){for(let K=0;K<G.length;K++)if(Lu(I,G[K]))return!0}if(QA(I,G,B))return!0}return!1}(w,p,T)}isTileClipped(){return!0}}function z1(a,n){return n>0?n+2*a:a}const jz=Lr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),$z=Lr([{name:"a_projected_pos",components:3,type:"Float32"}],4);Lr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Uz=Lr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Lr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const R1=Lr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Vz=Lr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Zz(a,n,s){return a.sections.forEach(u=>{u.text=function(p,v,x){const w=v.layout.get("text-transform").evaluate(x,{});return w==="uppercase"?p=p.toLocaleUpperCase():w==="lowercase"&&(p=p.toLocaleLowerCase()),ns.applyArabicShaping&&(p=ns.applyArabicShaping(p)),p}(u.text,n,s)}),a}Lr([{name:"triangle",components:3,type:"Uint16"}]),Lr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Lr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Lr([{type:"Float32",name:"offsetX"}]),Lr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Lr([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const lf={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var D1,mv,L1,mn=24,gv={};function Gz(){return D1||(D1=1,gv.read=function(a,n,s,u,p){var v,x,w=8*p-u-1,T=(1<<w)-1,M=T>>1,I=-7,D=s?p-1:0,B=s?-1:1,V=a[n+D];for(D+=B,v=V&(1<<-I)-1,V>>=-I,I+=w;I>0;v=256*v+a[n+D],D+=B,I-=8);for(x=v&(1<<-I)-1,v>>=-I,I+=u;I>0;x=256*x+a[n+D],D+=B,I-=8);if(v===0)v=1-M;else{if(v===T)return x?NaN:1/0*(V?-1:1);x+=Math.pow(2,u),v-=M}return(V?-1:1)*x*Math.pow(2,v-u)},gv.write=function(a,n,s,u,p,v){var x,w,T,M=8*v-p-1,I=(1<<M)-1,D=I>>1,B=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,V=u?0:v-1,G=u?1:-1,K=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(w=isNaN(n)?1:0,x=I):(x=Math.floor(Math.log(n)/Math.LN2),n*(T=Math.pow(2,-x))<1&&(x--,T*=2),(n+=x+D>=1?B/T:B*Math.pow(2,1-D))*T>=2&&(x++,T/=2),x+D>=I?(w=0,x=I):x+D>=1?(w=(n*T-1)*Math.pow(2,p),x+=D):(w=n*Math.pow(2,D-1)*Math.pow(2,p),x=0));p>=8;a[s+V]=255&w,V+=G,w/=256,p-=8);for(x=x<<p|w,M+=p;M>0;a[s+V]=255&x,V+=G,x/=256,M-=8);a[s+V-G]|=128*K}),gv}function O1(){if(L1)return mv;L1=1,mv=n;var a=Gz();function n($){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView($)?$:new Uint8Array($||0),this.pos=0,this.type=0,this.length=this.buf.length}n.Varint=0,n.Fixed64=1,n.Bytes=2,n.Fixed32=5;var s=4294967296,u=1/s,p=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function v($){return $.type===n.Bytes?$.readVarint()+$.pos:$.pos+1}function x($,te,_e){return _e?4294967296*te+($>>>0):4294967296*(te>>>0)+($>>>0)}function w($,te,_e){var Le=te<=16383?1:te<=2097151?2:te<=268435455?3:Math.floor(Math.log(te)/(7*Math.LN2));_e.realloc(Le);for(var Xe=_e.pos-1;Xe>=$;Xe--)_e.buf[Xe+Le]=_e.buf[Xe]}function T($,te){for(var _e=0;_e<$.length;_e++)te.writeVarint($[_e])}function M($,te){for(var _e=0;_e<$.length;_e++)te.writeSVarint($[_e])}function I($,te){for(var _e=0;_e<$.length;_e++)te.writeFloat($[_e])}function D($,te){for(var _e=0;_e<$.length;_e++)te.writeDouble($[_e])}function B($,te){for(var _e=0;_e<$.length;_e++)te.writeBoolean($[_e])}function V($,te){for(var _e=0;_e<$.length;_e++)te.writeFixed32($[_e])}function G($,te){for(var _e=0;_e<$.length;_e++)te.writeSFixed32($[_e])}function K($,te){for(var _e=0;_e<$.length;_e++)te.writeFixed64($[_e])}function ne($,te){for(var _e=0;_e<$.length;_e++)te.writeSFixed64($[_e])}function le($,te){return($[te]|$[te+1]<<8|$[te+2]<<16)+16777216*$[te+3]}function Se($,te,_e){$[_e]=te,$[_e+1]=te>>>8,$[_e+2]=te>>>16,$[_e+3]=te>>>24}function me($,te){return($[te]|$[te+1]<<8|$[te+2]<<16)+($[te+3]<<24)}return n.prototype={destroy:function(){this.buf=null},readFields:function($,te,_e){for(_e=_e||this.length;this.pos<_e;){var Le=this.readVarint(),Xe=Le>>3,Be=this.pos;this.type=7&Le,$(Xe,te,this),this.pos===Be&&this.skip(Le)}return te},readMessage:function($,te){return this.readFields($,te,this.readVarint()+this.pos)},readFixed32:function(){var $=le(this.buf,this.pos);return this.pos+=4,$},readSFixed32:function(){var $=me(this.buf,this.pos);return this.pos+=4,$},readFixed64:function(){var $=le(this.buf,this.pos)+le(this.buf,this.pos+4)*s;return this.pos+=8,$},readSFixed64:function(){var $=le(this.buf,this.pos)+me(this.buf,this.pos+4)*s;return this.pos+=8,$},readFloat:function(){var $=a.read(this.buf,this.pos,!0,23,4);return this.pos+=4,$},readDouble:function(){var $=a.read(this.buf,this.pos,!0,52,8);return this.pos+=8,$},readVarint:function($){var te,_e,Le=this.buf;return te=127&(_e=Le[this.pos++]),_e<128?te:(te|=(127&(_e=Le[this.pos++]))<<7,_e<128?te:(te|=(127&(_e=Le[this.pos++]))<<14,_e<128?te:(te|=(127&(_e=Le[this.pos++]))<<21,_e<128?te:function(Xe,Be,Ue){var tt,Ye,rt=Ue.buf;if(tt=(112&(Ye=rt[Ue.pos++]))>>4,Ye<128||(tt|=(127&(Ye=rt[Ue.pos++]))<<3,Ye<128)||(tt|=(127&(Ye=rt[Ue.pos++]))<<10,Ye<128)||(tt|=(127&(Ye=rt[Ue.pos++]))<<17,Ye<128)||(tt|=(127&(Ye=rt[Ue.pos++]))<<24,Ye<128)||(tt|=(1&(Ye=rt[Ue.pos++]))<<31,Ye<128))return x(Xe,tt,Be);throw new Error("Expected varint not more than 10 bytes")}(te|=(15&(_e=Le[this.pos]))<<28,$,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var $=this.readVarint();return $%2==1?($+1)/-2:$/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var $=this.readVarint()+this.pos,te=this.pos;return this.pos=$,$-te>=12&&p?function(_e,Le,Xe){return p.decode(_e.subarray(Le,Xe))}(this.buf,te,$):function(_e,Le,Xe){for(var Be="",Ue=Le;Ue<Xe;){var tt,Ye,rt,Ge=_e[Ue],xt=null,Mt=Ge>239?4:Ge>223?3:Ge>191?2:1;if(Ue+Mt>Xe)break;Mt===1?Ge<128&&(xt=Ge):Mt===2?(192&(tt=_e[Ue+1]))==128&&(xt=(31&Ge)<<6|63&tt)<=127&&(xt=null):Mt===3?(Ye=_e[Ue+2],(192&(tt=_e[Ue+1]))==128&&(192&Ye)==128&&((xt=(15&Ge)<<12|(63&tt)<<6|63&Ye)<=2047||xt>=55296&&xt<=57343)&&(xt=null)):Mt===4&&(Ye=_e[Ue+2],rt=_e[Ue+3],(192&(tt=_e[Ue+1]))==128&&(192&Ye)==128&&(192&rt)==128&&((xt=(15&Ge)<<18|(63&tt)<<12|(63&Ye)<<6|63&rt)<=65535||xt>=1114112)&&(xt=null)),xt===null?(xt=65533,Mt=1):xt>65535&&(xt-=65536,Be+=String.fromCharCode(xt>>>10&1023|55296),xt=56320|1023&xt),Be+=String.fromCharCode(xt),Ue+=Mt}return Be}(this.buf,te,$)},readBytes:function(){var $=this.readVarint()+this.pos,te=this.buf.subarray(this.pos,$);return this.pos=$,te},readPackedVarint:function($,te){if(this.type!==n.Bytes)return $.push(this.readVarint(te));var _e=v(this);for($=$||[];this.pos<_e;)$.push(this.readVarint(te));return $},readPackedSVarint:function($){if(this.type!==n.Bytes)return $.push(this.readSVarint());var te=v(this);for($=$||[];this.pos<te;)$.push(this.readSVarint());return $},readPackedBoolean:function($){if(this.type!==n.Bytes)return $.push(this.readBoolean());var te=v(this);for($=$||[];this.pos<te;)$.push(this.readBoolean());return $},readPackedFloat:function($){if(this.type!==n.Bytes)return $.push(this.readFloat());var te=v(this);for($=$||[];this.pos<te;)$.push(this.readFloat());return $},readPackedDouble:function($){if(this.type!==n.Bytes)return $.push(this.readDouble());var te=v(this);for($=$||[];this.pos<te;)$.push(this.readDouble());return $},readPackedFixed32:function($){if(this.type!==n.Bytes)return $.push(this.readFixed32());var te=v(this);for($=$||[];this.pos<te;)$.push(this.readFixed32());return $},readPackedSFixed32:function($){if(this.type!==n.Bytes)return $.push(this.readSFixed32());var te=v(this);for($=$||[];this.pos<te;)$.push(this.readSFixed32());return $},readPackedFixed64:function($){if(this.type!==n.Bytes)return $.push(this.readFixed64());var te=v(this);for($=$||[];this.pos<te;)$.push(this.readFixed64());return $},readPackedSFixed64:function($){if(this.type!==n.Bytes)return $.push(this.readSFixed64());var te=v(this);for($=$||[];this.pos<te;)$.push(this.readSFixed64());return $},skip:function($){var te=7&$;if(te===n.Varint)for(;this.buf[this.pos++]>127;);else if(te===n.Bytes)this.pos=this.readVarint()+this.pos;else if(te===n.Fixed32)this.pos+=4;else{if(te!==n.Fixed64)throw new Error("Unimplemented type: "+te);this.pos+=8}},writeTag:function($,te){this.writeVarint($<<3|te)},realloc:function($){for(var te=this.length||16;te<this.pos+$;)te*=2;if(te!==this.length){var _e=new Uint8Array(te);_e.set(this.buf),this.buf=_e,this.length=te}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function($){this.realloc(4),Se(this.buf,$,this.pos),this.pos+=4},writeSFixed32:function($){this.realloc(4),Se(this.buf,$,this.pos),this.pos+=4},writeFixed64:function($){this.realloc(8),Se(this.buf,-1&$,this.pos),Se(this.buf,Math.floor($*u),this.pos+4),this.pos+=8},writeSFixed64:function($){this.realloc(8),Se(this.buf,-1&$,this.pos),Se(this.buf,Math.floor($*u),this.pos+4),this.pos+=8},writeVarint:function($){($=+$||0)>268435455||$<0?function(te,_e){var Le,Xe;if(te>=0?(Le=te%4294967296|0,Xe=te/4294967296|0):(Xe=~(-te/4294967296),4294967295^(Le=~(-te%4294967296))?Le=Le+1|0:(Le=0,Xe=Xe+1|0)),te>=18446744073709552e3||te<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");_e.realloc(10),function(Be,Ue,tt){tt.buf[tt.pos++]=127&Be|128,Be>>>=7,tt.buf[tt.pos++]=127&Be|128,Be>>>=7,tt.buf[tt.pos++]=127&Be|128,Be>>>=7,tt.buf[tt.pos++]=127&Be|128,tt.buf[tt.pos]=127&(Be>>>=7)}(Le,0,_e),function(Be,Ue){var tt=(7&Be)<<4;Ue.buf[Ue.pos++]|=tt|((Be>>>=3)?128:0),Be&&(Ue.buf[Ue.pos++]=127&Be|((Be>>>=7)?128:0),Be&&(Ue.buf[Ue.pos++]=127&Be|((Be>>>=7)?128:0),Be&&(Ue.buf[Ue.pos++]=127&Be|((Be>>>=7)?128:0),Be&&(Ue.buf[Ue.pos++]=127&Be|((Be>>>=7)?128:0),Be&&(Ue.buf[Ue.pos++]=127&Be)))))}(Xe,_e)}($,this):(this.realloc(4),this.buf[this.pos++]=127&$|($>127?128:0),$<=127||(this.buf[this.pos++]=127&($>>>=7)|($>127?128:0),$<=127||(this.buf[this.pos++]=127&($>>>=7)|($>127?128:0),$<=127||(this.buf[this.pos++]=$>>>7&127))))},writeSVarint:function($){this.writeVarint($<0?2*-$-1:2*$)},writeBoolean:function($){this.writeVarint(!!$)},writeString:function($){$=String($),this.realloc(4*$.length),this.pos++;var te=this.pos;this.pos=function(Le,Xe,Be){for(var Ue,tt,Ye=0;Ye<Xe.length;Ye++){if((Ue=Xe.charCodeAt(Ye))>55295&&Ue<57344){if(!tt){Ue>56319||Ye+1===Xe.length?(Le[Be++]=239,Le[Be++]=191,Le[Be++]=189):tt=Ue;continue}if(Ue<56320){Le[Be++]=239,Le[Be++]=191,Le[Be++]=189,tt=Ue;continue}Ue=tt-55296<<10|Ue-56320|65536,tt=null}else tt&&(Le[Be++]=239,Le[Be++]=191,Le[Be++]=189,tt=null);Ue<128?Le[Be++]=Ue:(Ue<2048?Le[Be++]=Ue>>6|192:(Ue<65536?Le[Be++]=Ue>>12|224:(Le[Be++]=Ue>>18|240,Le[Be++]=Ue>>12&63|128),Le[Be++]=Ue>>6&63|128),Le[Be++]=63&Ue|128)}return Be}(this.buf,$,this.pos);var _e=this.pos-te;_e>=128&&w(te,_e,this),this.pos=te-1,this.writeVarint(_e),this.pos+=_e},writeFloat:function($){this.realloc(4),a.write(this.buf,$,this.pos,!0,23,4),this.pos+=4},writeDouble:function($){this.realloc(8),a.write(this.buf,$,this.pos,!0,52,8),this.pos+=8},writeBytes:function($){var te=$.length;this.writeVarint(te),this.realloc(te);for(var _e=0;_e<te;_e++)this.buf[this.pos++]=$[_e]},writeRawMessage:function($,te){this.pos++;var _e=this.pos;$(te,this);var Le=this.pos-_e;Le>=128&&w(_e,Le,this),this.pos=_e-1,this.writeVarint(Le),this.pos+=Le},writeMessage:function($,te,_e){this.writeTag($,n.Bytes),this.writeRawMessage(te,_e)},writePackedVarint:function($,te){te.length&&this.writeMessage($,T,te)},writePackedSVarint:function($,te){te.length&&this.writeMessage($,M,te)},writePackedBoolean:function($,te){te.length&&this.writeMessage($,B,te)},writePackedFloat:function($,te){te.length&&this.writeMessage($,I,te)},writePackedDouble:function($,te){te.length&&this.writeMessage($,D,te)},writePackedFixed32:function($,te){te.length&&this.writeMessage($,V,te)},writePackedSFixed32:function($,te){te.length&&this.writeMessage($,G,te)},writePackedFixed64:function($,te){te.length&&this.writeMessage($,K,te)},writePackedSFixed64:function($,te){te.length&&this.writeMessage($,ne,te)},writeBytesField:function($,te){this.writeTag($,n.Bytes),this.writeBytes(te)},writeFixed32Field:function($,te){this.writeTag($,n.Fixed32),this.writeFixed32(te)},writeSFixed32Field:function($,te){this.writeTag($,n.Fixed32),this.writeSFixed32(te)},writeFixed64Field:function($,te){this.writeTag($,n.Fixed64),this.writeFixed64(te)},writeSFixed64Field:function($,te){this.writeTag($,n.Fixed64),this.writeSFixed64(te)},writeVarintField:function($,te){this.writeTag($,n.Varint),this.writeVarint(te)},writeSVarintField:function($,te){this.writeTag($,n.Varint),this.writeSVarint(te)},writeStringField:function($,te){this.writeTag($,n.Bytes),this.writeString(te)},writeFloatField:function($,te){this.writeTag($,n.Fixed32),this.writeFloat(te)},writeDoubleField:function($,te){this.writeTag($,n.Fixed64),this.writeDouble(te)},writeBooleanField:function($,te){this.writeVarintField($,!!te)}},mv}var Ba,_v=E(O1());function Hz(a,n,s){a===1&&s.readMessage(Wz,n)}function Wz(a,n,s){if(a===3){const{id:u,bitmap:p,width:v,height:x,left:w,top:T,advance:M}=s.readMessage(qz,{});n.push({id:u,bitmap:new Yd({width:v+6,height:x+6},p),metrics:{width:v,height:x,left:w,top:T,advance:M}})}}function qz(a,n,s){a===1?n.id=s.readVarint():a===2?n.bitmap=s.readBytes():a===3?n.width=s.readVarint():a===4?n.height=s.readVarint():a===5?n.left=s.readSVarint():a===6?n.top=s.readSVarint():a===7&&(n.advance=s.readVarint())}function F1(a){let n=0,s=0;for(const x of a)n+=x.w*x.h,s=Math.max(s,x.w);a.sort((x,w)=>w.h-x.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),s),h:1/0}];let p=0,v=0;for(const x of a)for(let w=u.length-1;w>=0;w--){const T=u[w];if(!(x.w>T.w||x.h>T.h)){if(x.x=T.x,x.y=T.y,v=Math.max(v,x.y+x.h),p=Math.max(p,x.x+x.w),x.w===T.w&&x.h===T.h){const M=u.pop();w<u.length&&(u[w]=M)}else x.h===T.h?(T.x+=x.w,T.w-=x.w):x.w===T.w?(T.y+=x.h,T.h-=x.h):(u.push({x:T.x+x.w,y:T.y,w:T.w-x.w,h:x.h}),T.y+=x.h,T.h-=x.h);break}}return{w:p,h:v,fill:n/(p*v)||0}}class yv{constructor(n,{pixelRatio:s,version:u,stretchX:p,stretchY:v,content:x,textFitWidth:w,textFitHeight:T}){this.paddedRect=n,this.pixelRatio=s,this.stretchX=p,this.stretchY=v,this.content=x,this.version=u,this.textFitWidth=w,this.textFitHeight=T}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class N1{constructor(n,s){const u={},p={};this.haveRenderCallbacks=[];const v=[];this.addImages(n,u,v),this.addImages(s,p,v);const{w:x,h:w}=F1(v),T=new fi({width:x||1,height:w||1});for(const M in n){const I=n[M],D=u[M].paddedRect;fi.copy(I.data,T,{x:0,y:0},{x:D.x+1,y:D.y+1},I.data)}for(const M in s){const I=s[M],D=p[M].paddedRect,B=D.x+1,V=D.y+1,G=I.data.width,K=I.data.height;fi.copy(I.data,T,{x:0,y:0},{x:B,y:V},I.data),fi.copy(I.data,T,{x:0,y:K-1},{x:B,y:V-1},{width:G,height:1}),fi.copy(I.data,T,{x:0,y:0},{x:B,y:V+K},{width:G,height:1}),fi.copy(I.data,T,{x:G-1,y:0},{x:B-1,y:V},{width:1,height:K}),fi.copy(I.data,T,{x:0,y:0},{x:B+G,y:V},{width:1,height:K})}this.image=T,this.iconPositions=u,this.patternPositions=p}addImages(n,s,u){for(const p in n){const v=n[p],x={x:0,y:0,w:v.data.width+2,h:v.data.height+2};u.push(x),s[p]=new yv(x,v),v.hasRenderCallback&&this.haveRenderCallbacks.push(p)}}patchUpdatedImages(n,s){n.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const u in n.updatedImages)this.patchUpdatedImage(this.iconPositions[u],n.getImage(u),s),this.patchUpdatedImage(this.patternPositions[u],n.getImage(u),s)}patchUpdatedImage(n,s,u){if(!n||!s||n.version===s.version)return;n.version=s.version;const[p,v]=n.tl;u.update(s.data,void 0,{x:p,y:v})}}_t("ImagePosition",yv),_t("ImageAtlas",N1),m.an=void 0,(Ba=m.an||(m.an={}))[Ba.none=0]="none",Ba[Ba.horizontal=1]="horizontal",Ba[Ba.vertical=2]="vertical",Ba[Ba.horizontalOnly=3]="horizontalOnly";class cf{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(n,s,u){const p=new cf;return p.scale=n||1,p.fontStack=s,p.verticalAlign=u||"bottom",p}static forImage(n,s){const u=new cf;return u.imageName=n,u.verticalAlign=s||"bottom",u}}class Bu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,s){const u=new Bu;for(let p=0;p<n.sections.length;p++){const v=n.sections[p];v.image?u.addImageSection(v):u.addTextSection(v,s)}return u}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSectionIndex(n){return this.sectionIndex[n]}getCharCode(n){return this.text.charCodeAt(n)}verticalizePunctuation(){this.text=function(n){let s="";for(let u=0;u<n.length;u++){const p=n.charCodeAt(u+1)||null,v=n.charCodeAt(u-1)||null;s+=p&&Bd(p)&&!lf[n[u+1]]||v&&Bd(v)&&!lf[n[u-1]]||!lf[n[u]]?n[u]:lf[n[u]]}return s}(this.text)}trim(){let n=0;for(let u=0;u<this.text.length&&$m[this.text.charCodeAt(u)];u++)n++;let s=this.text.length;for(let u=this.text.length-1;u>=0&&u>=n&&$m[this.text.charCodeAt(u)];u--)s--;this.text=this.text.substring(n,s),this.sectionIndex=this.sectionIndex.slice(n,s)}substring(n,s){const u=new Bu;return u.text=this.text.substring(n,s),u.sectionIndex=this.sectionIndex.slice(n,s),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,s)=>Math.max(n,this.sections[s].scale),0)}getMaxImageSize(n){let s=0,u=0;for(let p=0;p<this.length();p++){const v=this.getSection(p);if(v.imageName){const x=n[v.imageName];if(!x)continue;const w=x.displaySize;s=Math.max(s,w[0]),u=Math.max(u,w[1])}}return{maxImageWidth:s,maxImageHeight:u}}addTextSection(n,s){this.text+=n.text,this.sections.push(cf.forText(n.scale,n.fontStack||s,n.verticalAlign));const u=this.sections.length-1;for(let p=0;p<n.text.length;++p)this.sectionIndex.push(u)}addImageSection(n){const s=n.image?n.image.name:"";if(s.length===0)return void Sr("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(cf.forImage(s,n.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Sr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function jm(a,n,s,u,p,v,x,w,T,M,I,D,B,V,G){const K=Bu.fromFeature(a,p);let ne;D===m.an.vertical&&K.verticalizePunctuation();const{processBidirectionalText:le,processStyledBidirectionalText:Se}=ns;if(le&&K.sections.length===1){ne=[];const te=le(K.toString(),vv(K,M,v,n,u,V));for(const _e of te){const Le=new Bu;Le.text=_e,Le.sections=K.sections;for(let Xe=0;Xe<_e.length;Xe++)Le.sectionIndex.push(0);ne.push(Le)}}else if(Se){ne=[];const te=Se(K.text,K.sectionIndex,vv(K,M,v,n,u,V));for(const _e of te){const Le=new Bu;Le.text=_e[0],Le.sectionIndex=_e[1],Le.sections=K.sections,ne.push(Le)}}else ne=function(te,_e){const Le=[],Xe=te.text;let Be=0;for(const Ue of _e)Le.push(te.substring(Be,Ue)),Be=Ue;return Be<Xe.length&&Le.push(te.substring(Be,Xe.length)),Le}(K,vv(K,M,v,n,u,V));const me=[],$={positionedLines:me,text:K.toString(),top:I[1],bottom:I[1],left:I[0],right:I[0],writingMode:D,iconsInText:!1,verticalizable:!1};return function(te,_e,Le,Xe,Be,Ue,tt,Ye,rt,Ge,xt,Mt){let Pt=0,St=0,Kt=0,Or=0;const ln=Ye==="right"?1:Ye==="left"?0:.5,Dn=mn/Mt;let Zi=0;for(const Ar of Be){Ar.trim();const gn=Ar.getMaxScale(),En={positionedGlyphs:[],lineOffset:0};te.positionedLines[Zi]=En;const Mn=En.positionedGlyphs;let ni=0;if(!Ar.length()){St+=Ue,++Zi;continue}const Gi=Qz(Xe,Ar,Dn);for(let mi=0;mi<Ar.length();mi++){const cn=Ar.getSection(mi),yn=Ar.getSectionIndex(mi),vn=Ar.getCharCode(mi),tn=Jz(rt,xt,vn);let br;if(cn.imageName){if(te.iconsInText=!0,cn.scale=cn.scale*Dn,br=tR(cn,tn,gn,Gi,Xe),!br)continue;ni=Math.max(ni,br.imageOffset)}else if(br=eR(cn,vn,tn,Gi,_e,Le),!br)continue;const{rect:Ao,metrics:Vu,baselineOffset:zo}=br;Mn.push({glyph:vn,imageName:cn.imageName,x:Pt,y:St+zo+-17,vertical:tn,scale:cn.scale,fontStack:cn.fontStack,sectionIndex:yn,metrics:Vu,rect:Ao}),tn?(te.verticalizable=!0,Pt+=(cn.imageName?Vu.advance:mn)*cn.scale+Ge):Pt+=Vu.advance*cn.scale+Ge}Mn.length!==0&&(Kt=Math.max(Pt-Ge,Kt),rR(Mn,0,Mn.length-1,ln)),Pt=0,En.lineOffset=Math.max(ni,(gn-1)*mn);const _n=Ue*gn+ni;St+=_n,Or=Math.max(_n,Or),++Zi}const{horizontalAlign:pi,verticalAlign:Pn}=xv(tt);(function(Ar,gn,En,Mn,ni,Gi,_n,mi,cn){const yn=(gn-En)*ni;let vn=0;vn=Gi!==_n?-mi*Mn- -17:-Mn*cn*_n+.5*_n;for(const tn of Ar)for(const br of tn.positionedGlyphs)br.x+=yn,br.y+=vn})(te.positionedLines,ln,pi,Pn,Kt,Or,Ue,St,Be.length),te.top+=-Pn*St,te.bottom=te.top+St,te.left+=-pi*Kt,te.right=te.left+Kt}($,n,s,u,ne,x,w,T,D,M,B,G),!function(te){for(const _e of te)if(_e.positionedGlyphs.length!==0)return!1;return!0}(me)&&$}const $m={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Xz={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Kz={40:!0};function B1(a,n,s,u,p,v){if(n.imageName){const x=u[n.imageName];return x?x.displaySize[0]*n.scale*mn/v+p:0}{const x=s[n.fontStack],w=x&&x[a];return w?w.metrics.advance*n.scale+p:0}}function j1(a,n,s,u){const p=Math.pow(a-n,2);return u?a<n?p/2:2*p:p+Math.abs(s)*s}function Yz(a,n,s){let u=0;return a===10&&(u-=1e4),s&&(u+=150),a!==40&&a!==65288||(u+=50),n!==41&&n!==65289||(u+=50),u}function $1(a,n,s,u,p,v){let x=null,w=j1(n,s,p,v);for(const T of u){const M=j1(n-T.x,s,p,v)+T.badness;M<=w&&(x=T,w=M)}return{index:a,x:n,priorBreak:x,badness:w}}function U1(a){return a?U1(a.priorBreak).concat(a.index):[]}function vv(a,n,s,u,p,v){if(!a)return[];const x=[],w=function(D,B,V,G,K,ne){let le=0;for(let Se=0;Se<D.length();Se++){const me=D.getSection(Se);le+=B1(D.getCharCode(Se),me,G,K,B,ne)}return le/Math.max(1,Math.ceil(le/V))}(a,n,s,u,p,v),T=a.text.indexOf("")>=0;let M=0;for(let D=0;D<a.length();D++){const B=a.getSection(D),V=a.getCharCode(D);if($m[V]||(M+=B1(V,B,u,p,n,v)),D<a.length()-1){const G=!((I=V)<11904)&&(!!Xt["CJK Compatibility Forms"](I)||!!Xt["CJK Compatibility"](I)||!!Xt["CJK Strokes"](I)||!!Xt["CJK Symbols and Punctuation"](I)||!!Xt["Enclosed CJK Letters and Months"](I)||!!Xt["Halfwidth and Fullwidth Forms"](I)||!!Xt["Ideographic Description Characters"](I)||!!Xt["Vertical Forms"](I)||Nd.test(String.fromCodePoint(I)));(Xz[V]||G||B.imageName||D!==a.length()-2&&Kz[a.getCharCode(D+1)])&&x.push($1(D+1,M,w,x,Yz(V,a.getCharCode(D+1),G&&T),!1))}}var I;return U1($1(a.length(),M,w,x,0,!0))}function xv(a){let n=.5,s=.5;switch(a){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:n,verticalAlign:s}}function Qz(a,n,s){const u=n.getMaxScale()*mn,{maxImageWidth:p,maxImageHeight:v}=n.getMaxImageSize(a),x=Math.max(u,v*s);return{verticalLineContentWidth:Math.max(u,p*s),horizontalLineContentHeight:x}}function V1(a){switch(a){case"top":return 0;case"center":return .5;default:return 1}}function Jz(a,n,s){return!(a===m.an.horizontal||!n&&!ku(s)||n&&($m[s]||(u=s,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(u)))));var u}function eR(a,n,s,u,p,v){const x=v[a.fontStack],w=function(M,I,D,B){if(M&&M.rect)return M;const V=I[D.fontStack],G=V&&V[B];return G?{rect:null,metrics:G.metrics}:null}(x&&x[n],p,a,n);if(w===null)return null;let T;if(s)T=u.verticalLineContentWidth-a.scale*mn;else{const M=V1(a.verticalAlign);T=(u.horizontalLineContentHeight-a.scale*mn)*M}return{rect:w.rect,metrics:w.metrics,baselineOffset:T}}function tR(a,n,s,u,p){const v=p[a.imageName];if(!v)return null;const x=v.paddedRect,w=v.displaySize,T={width:w[0],height:w[1],left:1,top:-3,advance:n?w[1]:w[0]};let M;if(n)M=u.verticalLineContentWidth-w[1]*a.scale;else{const I=V1(a.verticalAlign);M=(u.horizontalLineContentHeight-w[1]*a.scale)*I}return{rect:x,metrics:T,baselineOffset:M,imageOffset:(n?w[0]:w[1])*a.scale-mn*s}}function rR(a,n,s,u){if(u===0)return;const p=a[s],v=(a[s].x+p.metrics.advance*p.scale)*u;for(let x=n;x<=s;x++)a[x].x-=v}function nR(a,n,s){const{horizontalAlign:u,verticalAlign:p}=xv(s),v=n[0]-a.displaySize[0]*u,x=n[1]-a.displaySize[1]*p;return{image:a,top:x,bottom:x+a.displaySize[1],left:v,right:v+a.displaySize[0]}}function Z1(a){var n,s;let u=a.left,p=a.top,v=a.right-u,x=a.bottom-p;const w=(n=a.image.textFitWidth)!==null&&n!==void 0?n:"stretchOrShrink",T=(s=a.image.textFitHeight)!==null&&s!==void 0?s:"stretchOrShrink",M=(a.image.content[2]-a.image.content[0])/(a.image.content[3]-a.image.content[1]);if(T==="proportional"){if(w==="stretchOnly"&&v/x<M||w==="proportional"){const I=Math.ceil(x*M);u*=I/v,v=I}}else if(w==="proportional"&&T==="stretchOnly"&&M!==0&&v/x>M){const I=Math.ceil(v/M);p*=I/x,x=I}return{x1:u,y1:p,x2:u+v,y2:p+x}}function G1(a,n,s,u,p,v){const x=a.image;let w;if(x.content){const ne=x.content,le=x.pixelRatio||1;w=[ne[0]/le,ne[1]/le,x.displaySize[0]-ne[2]/le,x.displaySize[1]-ne[3]/le]}const T=n.left*v,M=n.right*v;let I,D,B,V;s==="width"||s==="both"?(V=p[0]+T-u[3],D=p[0]+M+u[1]):(V=p[0]+(T+M-x.displaySize[0])/2,D=V+x.displaySize[0]);const G=n.top*v,K=n.bottom*v;return s==="height"||s==="both"?(I=p[1]+G-u[0],B=p[1]+K+u[2]):(I=p[1]+(G+K-x.displaySize[1])/2,B=I+x.displaySize[1]),{image:x,top:I,right:D,bottom:B,left:V,collisionPadding:w}}const Gs=128,ja=32640;function H1(a,n){const{expression:s}=n;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new Tr(a+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:p}=s;let v=0;for(;v<u.length&&u[v]<=a;)v++;v=Math.max(0,v-1);let x=v;for(;x<u.length&&u[x]<a+1;)x++;x=Math.min(u.length-1,x);const w=u[v],T=u[x];return s.kind==="composite"?{kind:"composite",minZoom:w,maxZoom:T,interpolationType:p}:{kind:"camera",minZoom:w,maxZoom:T,minSize:s.evaluate(new Tr(w)),maxSize:s.evaluate(new Tr(T)),interpolationType:p}}}function bv(a,n,s){let u="never";const p=a.get(n);return p?u=p:a.get(s)&&(u="always"),u}const iR=of.VectorTileFeature.types,oR=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Um(a,n,s,u,p,v,x,w,T,M,I,D,B){const V=w?Math.min(ja,Math.round(w[0])):0,G=w?Math.min(ja,Math.round(w[1])):0;a.emplaceBack(n,s,Math.round(32*u),Math.round(32*p),v,x,(V<<1)+(T?1:0),G,16*M,16*I,256*D,256*B)}function wv(a,n,s){a.emplaceBack(n.x,n.y,s),a.emplaceBack(n.x,n.y,s),a.emplaceBack(n.x,n.y,s),a.emplaceBack(n.x,n.y,s)}function sR(a){for(const n of a.sections)if(jd(n.text))return!0;return!1}class Sv{constructor(n){this.layoutVertexArray=new Ft,this.indexArray=new _r,this.programConfigurations=n,this.segments=new rr,this.dynamicLayoutVertexArray=new cr,this.opacityVertexArray=new kr,this.hasVisibleVertices=!1,this.placedSymbolArray=new ae}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(n,s,u,p){this.isEmpty()||(u&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,jz.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,$z.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,oR,!0),this.opacityVertexBuffer.itemSize=1),(u||p)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}_t("SymbolBuffers",Sv);class Tv{constructor(n,s,u){this.layoutVertexArray=new n,this.layoutAttributes=s,this.indexArray=new u,this.segments=new rr,this.collisionVertexArray=new Ir}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,Uz.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}_t("CollisionBuffers",Tv);class ju{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.globalState=n.globalState,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(x=>x.id),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=H1(this.zoom,s["text-size"]),this.iconSizeData=H1(this.zoom,s["icon-size"]);const u=this.layers[0].layout,p=u.get("symbol-sort-key"),v=u.get("symbol-z-order");this.canOverlap=bv(u,"text-overlap","text-allow-overlap")!=="never"||bv(u,"icon-overlap","icon-allow-overlap")!=="never"||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=v!=="viewport-y"&&!p.isConstant(),this.sortFeaturesByY=(v==="viewport-y"||v==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,u.get("symbol-placement")==="point"&&(this.writingModes=u.get("text-writing-mode").map(x=>m.an[x])),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=n.sourceID}createArrays(){this.text=new Sv(new us(this.layers,this.zoom,n=>/^text/.test(n))),this.icon=new Sv(new us(this.layers,this.zoom,n=>/^icon/.test(n))),this.glyphOffsetArray=new ue,this.lineVertexArray=new ve,this.symbolInstances=new pe,this.textAnchorOffsets=new fe}calculateGlyphDependencies(n,s,u,p,v){for(let x=0;x<n.length;x++)if(s[n.charCodeAt(x)]=!0,(u||p)&&v){const w=lf[n.charAt(x)];w&&(s[w.charCodeAt(0)]=!0)}}populate(n,s,u){const p=this.layers[0],v=p.layout,x=v.get("text-font"),w=v.get("text-field"),T=v.get("icon-image"),M=(w.value.kind!=="constant"||w.value.value instanceof An&&!w.value.value.isEmpty()||w.value.value.toString().length>0)&&(x.value.kind!=="constant"||x.value.value.length>0),I=T.value.kind!=="constant"||!!T.value.value||Object.keys(T.parameters).length>0,D=v.get("symbol-sort-key");if(this.features=[],!M&&!I)return;const B=s.iconDependencies,V=s.glyphDependencies,G=s.availableImages,K=new Tr(this.zoom,{globalState:this.globalState});for(const{feature:ne,id:le,index:Se,sourceLayerIndex:me}of n){const $=p._featureFilter.needGeometry,te=dc(ne,$);if(!p._featureFilter.filter(K,te,u))continue;let _e,Le;if($||(te.geometry=hc(ne)),M){const Be=p.getValueAndResolveTokens("text-field",te,u,G),Ue=An.factory(Be),tt=this.hasRTLText=this.hasRTLText||sR(Ue);(!tt||ns.getRTLTextPluginStatus()==="unavailable"||tt&&ns.isParsed())&&(_e=Zz(Ue,p,te))}if(I){const Be=p.getValueAndResolveTokens("icon-image",te,u,G);Le=Be instanceof Qn?Be:Qn.fromString(Be)}if(!_e&&!Le)continue;const Xe=this.sortFeaturesByKey?D.evaluate(te,{},u):void 0;if(this.features.push({id:le,text:_e,icon:Le,index:Se,sourceLayerIndex:me,geometry:te.geometry,properties:ne.properties,type:iR[ne.type],sortKey:Xe}),Le&&(B[Le.name]=!0),_e){const Be=x.evaluate(te,{},u).join(","),Ue=v.get("text-rotation-alignment")!=="viewport"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(m.an.vertical)>=0;for(const tt of _e.sections)if(tt.image)B[tt.image.name]=!0;else{const Ye=Fd(_e.toString()),rt=tt.fontStack||Be,Ge=V[rt]=V[rt]||{};this.calculateGlyphDependencies(tt.text,Ge,Ue,this.allowVerticalPlacement,Ye)}}}v.get("symbol-placement")==="line"&&(this.features=function(ne){const le={},Se={},me=[];let $=0;function te(Be){me.push(ne[Be]),$++}function _e(Be,Ue,tt){const Ye=Se[Be];return delete Se[Be],Se[Ue]=Ye,me[Ye].geometry[0].pop(),me[Ye].geometry[0]=me[Ye].geometry[0].concat(tt[0]),Ye}function Le(Be,Ue,tt){const Ye=le[Ue];return delete le[Ue],le[Be]=Ye,me[Ye].geometry[0].shift(),me[Ye].geometry[0]=tt[0].concat(me[Ye].geometry[0]),Ye}function Xe(Be,Ue,tt){const Ye=tt?Ue[0][Ue[0].length-1]:Ue[0][0];return`${Be}:${Ye.x}:${Ye.y}`}for(let Be=0;Be<ne.length;Be++){const Ue=ne[Be],tt=Ue.geometry,Ye=Ue.text?Ue.text.toString():null;if(!Ye){te(Be);continue}const rt=Xe(Ye,tt),Ge=Xe(Ye,tt,!0);if(rt in Se&&Ge in le&&Se[rt]!==le[Ge]){const xt=Le(rt,Ge,tt),Mt=_e(rt,Ge,me[xt].geometry);delete le[rt],delete Se[Ge],Se[Xe(Ye,me[Mt].geometry,!0)]=Mt,me[xt].geometry=null}else rt in Se?_e(rt,Ge,tt):Ge in le?Le(rt,Ge,tt):(te(Be),le[rt]=$-1,Se[Ge]=$-1)}return me.filter(Be=>Be.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ne,le)=>ne.sortKey-le.sortKey)}update(n,s,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(n,s,this.layers,u),this.icon.programConfigurations.updatePaintArrays(n,s,this.layers,u))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,s){const u=this.lineVertexArray.length;if(n.segment!==void 0){let p=n.dist(s[n.segment+1]),v=n.dist(s[n.segment]);const x={};for(let w=n.segment+1;w<s.length;w++)x[w]={x:s[w].x,y:s[w].y,tileUnitDistanceFromAnchor:p},w<s.length-1&&(p+=s[w+1].dist(s[w]));for(let w=n.segment||0;w>=0;w--)x[w]={x:s[w].x,y:s[w].y,tileUnitDistanceFromAnchor:v},w>0&&(v+=s[w-1].dist(s[w]));for(let w=0;w<s.length;w++){const T=x[w];this.lineVertexArray.emplaceBack(T.x,T.y,T.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(n,s,u,p,v,x,w,T,M,I,D,B){const V=n.indexArray,G=n.layoutVertexArray,K=n.segments.prepareSegment(4*s.length,G,V,this.canOverlap?x.sortKey:void 0),ne=this.glyphOffsetArray.length,le=K.vertexLength,Se=this.allowVerticalPlacement&&w===m.an.vertical?Math.PI/2:0,me=x.text&&x.text.sections;for(let $=0;$<s.length;$++){const{tl:te,tr:_e,bl:Le,br:Xe,tex:Be,pixelOffsetTL:Ue,pixelOffsetBR:tt,minFontScaleX:Ye,minFontScaleY:rt,glyphOffset:Ge,isSDF:xt,sectionIndex:Mt}=s[$],Pt=K.vertexLength,St=Ge[1];Um(G,T.x,T.y,te.x,St+te.y,Be.x,Be.y,u,xt,Ue.x,Ue.y,Ye,rt),Um(G,T.x,T.y,_e.x,St+_e.y,Be.x+Be.w,Be.y,u,xt,tt.x,Ue.y,Ye,rt),Um(G,T.x,T.y,Le.x,St+Le.y,Be.x,Be.y+Be.h,u,xt,Ue.x,tt.y,Ye,rt),Um(G,T.x,T.y,Xe.x,St+Xe.y,Be.x+Be.w,Be.y+Be.h,u,xt,tt.x,tt.y,Ye,rt),wv(n.dynamicLayoutVertexArray,T,Se),V.emplaceBack(Pt,Pt+2,Pt+1),V.emplaceBack(Pt+1,Pt+2,Pt+3),K.vertexLength+=4,K.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ge[0]),$!==s.length-1&&Mt===s[$+1].sectionIndex||n.programConfigurations.populatePaintArrays(G.length,x,x.index,{},B,me&&me[Mt])}n.placedSymbolArray.emplaceBack(T.x,T.y,ne,this.glyphOffsetArray.length-ne,le,M,I,T.segment,u?u[0]:0,u?u[1]:0,p[0],p[1],w,0,!1,0,D)}_addCollisionDebugVertex(n,s,u,p,v,x){return s.emplaceBack(0,0),n.emplaceBack(u.x,u.y,p,v,Math.round(x.x),Math.round(x.y))}addCollisionDebugVertices(n,s,u,p,v,x,w){const T=v.segments.prepareSegment(4,v.layoutVertexArray,v.indexArray),M=T.vertexLength,I=v.layoutVertexArray,D=v.collisionVertexArray,B=w.anchorX,V=w.anchorY;this._addCollisionDebugVertex(I,D,x,B,V,new X(n,s)),this._addCollisionDebugVertex(I,D,x,B,V,new X(u,s)),this._addCollisionDebugVertex(I,D,x,B,V,new X(u,p)),this._addCollisionDebugVertex(I,D,x,B,V,new X(n,p)),T.vertexLength+=4;const G=v.indexArray;G.emplaceBack(M,M+1),G.emplaceBack(M+1,M+2),G.emplaceBack(M+2,M+3),G.emplaceBack(M+3,M),T.primitiveLength+=4}addDebugCollisionBoxes(n,s,u,p){for(let v=n;v<s;v++){const x=this.collisionBoxArray.get(v);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,p?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,u)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Tv(pr,R1.members,mr),this.iconCollisionBox=new Tv(pr,R1.members,mr);for(let n=0;n<this.symbolInstances.length;n++){const s=this.symbolInstances.get(n);this.addDebugCollisionBoxes(s.textBoxStartIndex,s.textBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.iconBoxStartIndex,s.iconBoxEndIndex,s,!1),this.addDebugCollisionBoxes(s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex,s,!1)}}_deserializeCollisionBoxesForSymbol(n,s,u,p,v,x,w,T,M){const I={};for(let D=s;D<u;D++){const B=n.get(D);I.textBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},I.textFeatureIndex=B.featureIndex;break}for(let D=p;D<v;D++){const B=n.get(D);I.verticalTextBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},I.verticalTextFeatureIndex=B.featureIndex;break}for(let D=x;D<w;D++){const B=n.get(D);I.iconBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},I.iconFeatureIndex=B.featureIndex;break}for(let D=T;D<M;D++){const B=n.get(D);I.verticalIconBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},I.verticalIconFeatureIndex=B.featureIndex;break}return I}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const u=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(n,s){const u=n.placedSymbolArray.get(s),p=u.vertexStartIndex+4*u.numGlyphs;for(let v=u.vertexStartIndex;v<p;v+=4)n.indexArray.emplaceBack(v,v+2,v+1),n.indexArray.emplaceBack(v+1,v+2,v+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(n),u=Math.cos(n),p=[],v=[],x=[];for(let w=0;w<this.symbolInstances.length;++w){x.push(w);const T=this.symbolInstances.get(w);p.push(0|Math.round(s*T.anchorX+u*T.anchorY)),v.push(T.featureIndex)}return x.sort((w,T)=>p[w]-p[T]||v[T]-v[w]),x}addToSortKeyRanges(n,s){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===s?u.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const u=this.symbolInstances.get(s);this.featureSortOrder.push(u.featureIndex),[u.rightJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.leftJustifiedTextSymbolIndex].forEach((p,v,x)=>{p>=0&&x.indexOf(p)===v&&this.addIndicesForPlacedSymbol(this.text,p)}),u.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,u.verticalPlacedTextSymbolIndex),u.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.placedIconSymbolIndex),u.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let W1,q1;_t("SymbolBucket",ju,{omit:["layers","collisionBoxArray","features","compareText"]}),ju.MAX_GLYPHS=65535,ju.addDynamicAttributes=wv;var Cv={get paint(){return q1=q1||new Vn({"icon-opacity":new It(he.paint_symbol["icon-opacity"]),"icon-color":new It(he.paint_symbol["icon-color"]),"icon-halo-color":new It(he.paint_symbol["icon-halo-color"]),"icon-halo-width":new It(he.paint_symbol["icon-halo-width"]),"icon-halo-blur":new It(he.paint_symbol["icon-halo-blur"]),"icon-translate":new bt(he.paint_symbol["icon-translate"]),"icon-translate-anchor":new bt(he.paint_symbol["icon-translate-anchor"]),"text-opacity":new It(he.paint_symbol["text-opacity"]),"text-color":new It(he.paint_symbol["text-color"],{runtimeType:ui,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new It(he.paint_symbol["text-halo-color"]),"text-halo-width":new It(he.paint_symbol["text-halo-width"]),"text-halo-blur":new It(he.paint_symbol["text-halo-blur"]),"text-translate":new bt(he.paint_symbol["text-translate"]),"text-translate-anchor":new bt(he.paint_symbol["text-translate-anchor"])})},get layout(){return W1=W1||new Vn({"symbol-placement":new bt(he.layout_symbol["symbol-placement"]),"symbol-spacing":new bt(he.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new bt(he.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new It(he.layout_symbol["symbol-sort-key"]),"symbol-z-order":new bt(he.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new bt(he.layout_symbol["icon-allow-overlap"]),"icon-overlap":new bt(he.layout_symbol["icon-overlap"]),"icon-ignore-placement":new bt(he.layout_symbol["icon-ignore-placement"]),"icon-optional":new bt(he.layout_symbol["icon-optional"]),"icon-rotation-alignment":new bt(he.layout_symbol["icon-rotation-alignment"]),"icon-size":new It(he.layout_symbol["icon-size"]),"icon-text-fit":new bt(he.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new bt(he.layout_symbol["icon-text-fit-padding"]),"icon-image":new It(he.layout_symbol["icon-image"]),"icon-rotate":new It(he.layout_symbol["icon-rotate"]),"icon-padding":new It(he.layout_symbol["icon-padding"]),"icon-keep-upright":new bt(he.layout_symbol["icon-keep-upright"]),"icon-offset":new It(he.layout_symbol["icon-offset"]),"icon-anchor":new It(he.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new bt(he.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new bt(he.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new bt(he.layout_symbol["text-rotation-alignment"]),"text-field":new It(he.layout_symbol["text-field"]),"text-font":new It(he.layout_symbol["text-font"]),"text-size":new It(he.layout_symbol["text-size"]),"text-max-width":new It(he.layout_symbol["text-max-width"]),"text-line-height":new bt(he.layout_symbol["text-line-height"]),"text-letter-spacing":new It(he.layout_symbol["text-letter-spacing"]),"text-justify":new It(he.layout_symbol["text-justify"]),"text-radial-offset":new It(he.layout_symbol["text-radial-offset"]),"text-variable-anchor":new bt(he.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new It(he.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new It(he.layout_symbol["text-anchor"]),"text-max-angle":new bt(he.layout_symbol["text-max-angle"]),"text-writing-mode":new bt(he.layout_symbol["text-writing-mode"]),"text-rotate":new It(he.layout_symbol["text-rotate"]),"text-padding":new bt(he.layout_symbol["text-padding"]),"text-keep-upright":new bt(he.layout_symbol["text-keep-upright"]),"text-transform":new It(he.layout_symbol["text-transform"]),"text-offset":new It(he.layout_symbol["text-offset"]),"text-allow-overlap":new bt(he.layout_symbol["text-allow-overlap"]),"text-overlap":new bt(he.layout_symbol["text-overlap"]),"text-ignore-placement":new bt(he.layout_symbol["text-ignore-placement"]),"text-optional":new bt(he.layout_symbol["text-optional"])})}};class X1{constructor(n){if(n.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=n.property.overrides?n.property.overrides.runtimeType:As,this.defaultValue=n}evaluate(n){if(n.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(n.formattedSection))return s.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}_t("FormatSectionOverride",X1,{omit:["defaultValue"]});class Vm extends wn{constructor(n){super(n,Cv)}recalculate(n,s){if(super.recalculate(n,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const u=this.layout.get("text-writing-mode");if(u){const p=[];for(const v of u)p.indexOf(v)<0&&p.push(v);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(n,s,u,p){const v=this.layout.get(n).evaluate(s,{},u,p),x=this._unevaluatedLayout._values[n];return x.isDataDriven()||_u(x.value)||!v?v:function(w,T){return T.replace(/{([^{}]+)}/g,(M,I)=>w&&I in w?String(w[I]):"")}(s.properties,v)}createBucket(n){return new ju(n)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const n of Cv.paint.overridableProperties){if(!Vm.hasPaintOverride(this.layout,n))continue;const s=this.paint.get(n),u=new X1(s),p=new gu(u,s.property.specification);let v=null;v=s.value.kind==="constant"||s.value.kind==="source"?new ql("source",p):new vu("composite",p,s.value.zoomStops),this.paint._values[n]=new co(s.property,v,s.parameters)}}_handleOverridablePaintPropertyUpdate(n,s,u){return!(!this.layout||s.isDataDriven()||u.isDataDriven())&&Vm.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,s){const u=n.get("text-field"),p=Cv.paint.properties[s];let v=!1;const x=w=>{for(const T of w)if(p.overrides&&p.overrides.hasOverride(T))return void(v=!0)};if(u.value.kind==="constant"&&u.value.value instanceof An)x(u.value.value.sections);else if(u.value.kind==="source"){const w=M=>{v||(M instanceof jn&&zt(M.value)===zs?x(M.value.sections):M instanceof $l?x(M.sections):M.eachChild(w))},T=u.value;T._styleExpression&&w(T._styleExpression.expression)}return v}}let K1;var aR={get paint(){return K1=K1||new Vn({"background-color":new bt(he.paint_background["background-color"]),"background-pattern":new Ud(he.paint_background["background-pattern"]),"background-opacity":new bt(he.paint_background["background-opacity"])})}};class lR extends wn{constructor(n){super(n,aR)}}let Y1;var cR={get paint(){return Y1=Y1||new Vn({"raster-opacity":new bt(he.paint_raster["raster-opacity"]),"raster-hue-rotate":new bt(he.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new bt(he.paint_raster["raster-brightness-min"]),"raster-brightness-max":new bt(he.paint_raster["raster-brightness-max"]),"raster-saturation":new bt(he.paint_raster["raster-saturation"]),"raster-contrast":new bt(he.paint_raster["raster-contrast"]),"raster-resampling":new bt(he.paint_raster["raster-resampling"]),"raster-fade-duration":new bt(he.paint_raster["raster-fade-duration"])})}};class uR extends wn{constructor(n){super(n,cR)}}class hR extends wn{constructor(n){super(n,{}),this.onAdd=s=>{this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)},this.onRemove=s=>{this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)},this.implementation=n}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class dR{constructor(n){this._methodToThrottle=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const fR={once:!0},Pv=63710088e-1;class $a{constructor(n,s){if(isNaN(n)||isNaN(s))throw new Error(`Invalid LngLat object: (${n}, ${s})`);if(this.lng=+n,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new $a(tr(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const s=Math.PI/180,u=this.lat*s,p=n.lat*s,v=Math.sin(u)*Math.sin(p)+Math.cos(u)*Math.cos(p)*Math.cos((n.lng-this.lng)*s);return Pv*Math.acos(Math.min(v,1))}static convert(n){if(n instanceof $a)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new $a(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new $a(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Q1=2*Math.PI*Pv;function J1(a){return Q1*Math.cos(a*Math.PI/180)}function e2(a){return(180+a)/360}function t2(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function r2(a,n){return a/J1(n)}function Ev(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function n2(a,n){return a*J1(Ev(n))}class uf{constructor(n,s,u=0){this.x=+n,this.y=+s,this.z=+u}static fromLngLat(n,s=0){const u=$a.convert(n);return new uf(e2(u.lng),t2(u.lat),r2(s,u.lat))}toLngLat(){return new $a(360*this.x-180,Ev(this.y))}toAltitude(){return n2(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Q1*(n=Ev(this.y),1/Math.cos(n*Math.PI/180));var n}}function i2(a,n,s){var u=2*Math.PI*6378137/256/Math.pow(2,s);return[a*u-2*Math.PI*6378137/2,n*u-2*Math.PI*6378137/2]}class Mv{constructor(n,s,u){if(!function(p,v,x){return!(p<0||p>25||x<0||x>=Math.pow(2,p)||v<0||v>=Math.pow(2,p))}(n,s,u))throw new Error(`x=${s}, y=${u}, z=${n} outside of bounds. 0<=x<${Math.pow(2,n)}, 0<=y<${Math.pow(2,n)} 0<=z<=25 `);this.z=n,this.x=s,this.y=u,this.key=$u(0,n,n,s,u)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,s,u){const p=(x=this.y,w=this.z,T=i2(256*(v=this.x),256*(x=Math.pow(2,w)-x-1),w),M=i2(256*(v+1),256*(x+1),w),T[0]+","+T[1]+","+M[0]+","+M[1]);var v,x,w,T,M;const I=function(D,B,V){let G,K="";for(let ne=D;ne>0;ne--)G=1<<ne-1,K+=(B&G?1:0)+(V&G?2:0);return K}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(u==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,s>1?"@2x":"").replace(/{quadkey}/g,I).replace(/{bbox-epsg-3857}/g,p)}isChildOf(n){const s=this.z-n.z;return s>0&&n.x===this.x>>s&&n.y===this.y>>s}getTilePoint(n){const s=Math.pow(2,this.z);return new X((n.x*s-this.x)*ut,(n.y*s-this.y)*ut)}toString(){return`${this.z}/${this.x}/${this.y}`}}class o2{constructor(n,s){this.wrap=n,this.canonical=s,this.key=$u(n,s.z,s.z,s.x,s.y)}}class Vi{constructor(n,s,u,p,v){if(this.terrainRttPosMatrix32f=null,n<u)throw new Error(`overscaledZ should be >= z; overscaledZ = ${n}; z = ${u}`);this.overscaledZ=n,this.wrap=s,this.canonical=new Mv(u,+p,+v),this.key=$u(s,n,u,p,v)}clone(){return new Vi(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const s=this.canonical.z-n;return n>this.canonical.z?new Vi(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Vi(n,this.wrap,n,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(n,s){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const u=this.canonical.z-n;return n>this.canonical.z?$u(this.wrap*+s,n,this.canonical.z,this.canonical.x,this.canonical.y):$u(this.wrap*+s,n,n,this.canonical.x>>u,this.canonical.y>>u)}isChildOf(n){if(n.wrap!==this.wrap)return!1;const s=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.x===this.canonical.x>>s&&n.canonical.y===this.canonical.y>>s}children(n){if(this.overscaledZ>=n)return[new Vi(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,u=2*this.canonical.x,p=2*this.canonical.y;return[new Vi(s,this.wrap,s,u,p),new Vi(s,this.wrap,s,u+1,p),new Vi(s,this.wrap,s,u,p+1),new Vi(s,this.wrap,s,u+1,p+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new Vi(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new Vi(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new o2(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(n){return this.canonical.getTilePoint(new uf(n.x-this.wrap,n.y))}}function $u(a,n,s,u,p){(a*=2)<0&&(a=-1*a-1);const v=1<<s;return(v*v*a+v*p+u).toString(36)+s.toString(36)+n.toString(36)}_t("CanonicalTileID",Mv),_t("OverscaledTileID",Vi,{omit:["terrainRttPosMatrix32f"]});class mc{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(n){return this.minX=Math.min(this.minX,n.x),this.minY=Math.min(this.minY,n.y),this.maxX=Math.max(this.maxX,n.x),this.maxY=Math.max(this.maxY,n.y),this}expandBy(n){return this.minX-=n,this.minY-=n,this.maxX+=n,this.maxY+=n,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(n){return this.expandBy(-n)}map(n){const s=new mc;return s.extend(n(new X(this.minX,this.minY))),s.extend(n(new X(this.maxX,this.minY))),s.extend(n(new X(this.minX,this.maxY))),s.extend(n(new X(this.maxX,this.maxY))),s}static fromPoints(n){const s=new mc;for(const u of n)s.extend(u);return s}contains(n){return n.x>=this.minX&&n.x<=this.maxX&&n.y>=this.minY&&n.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(n){return!this.empty()&&!n.empty()&&n.minX>=this.minX&&n.maxX<=this.maxX&&n.minY>=this.minY&&n.maxY<=this.maxY}intersects(n){return!this.empty()&&!n.empty()&&n.minX<=this.maxX&&n.maxX>=this.minX&&n.minY<=this.maxY&&n.maxY>=this.minY}}class s2{constructor(n){this._stringToNumber={},this._numberToString=[];for(let s=0;s<n.length;s++){const u=n[s];this._stringToNumber[u]=s,this._numberToString[s]=u}}encode(n){return this._stringToNumber[n]}decode(n){if(n>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${n} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[n]}}class a2{constructor(n,s,u,p,v){this.type="Feature",this._vectorTileFeature=n,n._z=s,n._x=u,n._y=p,this.properties=n.properties,this.id=v}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={geometry:this.geometry};for(const s in this)s!=="_geometry"&&s!=="_vectorTileFeature"&&(n[s]=this[s]);return n}}class l2{constructor(n,s){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new La(ut,16,0),this.grid3D=new La(ut,16,0),this.featureIndexArray=new Oe,this.promoteId=s}insert(n,s,u,p,v,x){const w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,p,v);const T=x?this.grid3D:this.grid;for(let M=0;M<s.length;M++){const I=s[M],D=[1/0,1/0,-1/0,-1/0];for(let B=0;B<I.length;B++){const V=I[B];D[0]=Math.min(D[0],V.x),D[1]=Math.min(D[1],V.y),D[2]=Math.max(D[2],V.x),D[3]=Math.max(D[3],V.y)}D[0]<ut&&D[1]<ut&&D[2]>=0&&D[3]>=0&&T.insert(w,D[0],D[1],D[2],D[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new of.VectorTile(new _v(this.rawTileData)).layers,this.sourceLayerCoder=new s2(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(n,s,u,p){this.loadVTLayers();const v=n.params,x=ut/n.tileSize/n.scale,w=ts(v.filter),T=n.queryGeometry,M=n.queryPadding*x,I=mc.fromPoints(T),D=this.grid.query(I.minX-M,I.minY-M,I.maxX+M,I.maxY+M),B=mc.fromPoints(n.cameraQueryGeometry).expandBy(M),V=this.grid3D.query(B.minX,B.minY,B.maxX,B.maxY,(ne,le,Se,me)=>function($,te,_e,Le,Xe){for(const Ue of $)if(te<=Ue.x&&_e<=Ue.y&&Le>=Ue.x&&Xe>=Ue.y)return!0;const Be=[new X(te,_e),new X(te,Xe),new X(Le,Xe),new X(Le,_e)];if($.length>2){for(const Ue of Be)if(Lu($,Ue))return!0}for(let Ue=0;Ue<$.length-1;Ue++)if(ez($[Ue],$[Ue+1],Be))return!0;return!1}(n.cameraQueryGeometry,ne-M,le-M,Se+M,me+M));for(const ne of V)D.push(ne);D.sort(pR);const G={};let K;for(let ne=0;ne<D.length;ne++){const le=D[ne];if(le===K)continue;K=le;const Se=this.featureIndexArray.get(le);let me=null;this.loadMatchingFeature(G,Se.bucketIndex,Se.sourceLayerIndex,Se.featureIndex,w,v.layers,v.availableImages,s,u,p,($,te,_e)=>(me||(me=hc($)),te.queryIntersectsFeature({queryGeometry:T,feature:$,featureState:_e,geometry:me,zoom:this.z,transform:n.transform,pixelsToTileUnits:x,pixelPosMatrix:n.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:n.getElevation})))}return G}loadMatchingFeature(n,s,u,p,v,x,w,T,M,I,D){const B=this.bucketLayerIDs[s];if(x&&!B.some(ne=>x.has(ne)))return;const V=this.sourceLayerCoder.decode(u),G=this.vtLayers[V].feature(p);if(v.needGeometry){const ne=dc(G,!0);if(!v.filter(new Tr(this.tileID.overscaledZ),ne,this.tileID.canonical))return}else if(!v.filter(new Tr(this.tileID.overscaledZ),G))return;const K=this.getId(G,V);for(let ne=0;ne<B.length;ne++){const le=B[ne];if(x&&!x.has(le))continue;const Se=T[le];if(!Se)continue;let me={};K&&I&&(me=I.getState(Se.sourceLayer||"_geojsonTileLayer",K));const $=Dt({},M[le]);$.paint=c2($.paint,Se.paint,G,me,w),$.layout=c2($.layout,Se.layout,G,me,w);const te=!D||D(G,Se,me);if(!te)continue;const _e=new a2(G,this.z,this.x,this.y,K);_e.layer=$;let Le=n[le];Le===void 0&&(Le=n[le]=[]),Le.push({featureIndex:p,feature:_e,intersectionZ:te})}}lookupSymbolFeatures(n,s,u,p,v,x,w,T){const M={};this.loadVTLayers();const I=ts(v);for(const D of n)this.loadMatchingFeature(M,u,p,D,I,x,w,T,s);return M}hasLayer(n){for(const s of this.bucketLayerIDs)for(const u of s)if(n===u)return!0;return!1}getId(n,s){var u;let p=n.id;return this.promoteId&&(p=n.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[s]],typeof p=="boolean"&&(p=Number(p)),p===void 0&&(!((u=n.properties)===null||u===void 0)&&u.cluster)&&this.promoteId&&(p=Number(n.properties.cluster_id))),p}}function c2(a,n,s,u,p){return Gt(a,(v,x)=>{const w=n instanceof Au?n.get(x):null;return w&&w.evaluate?w.evaluate(s,u,p):w})}function pR(a,n){return n-a}function u2(a,n,s,u,p){const v=[];for(let x=0;x<a.length;x++){const w=a[x];let T;for(let M=0;M<w.length-1;M++){let I=w[M],D=w[M+1];I.x<n&&D.x<n||(I.x<n?I=new X(n,I.y+(n-I.x)/(D.x-I.x)*(D.y-I.y))._round():D.x<n&&(D=new X(n,I.y+(n-I.x)/(D.x-I.x)*(D.y-I.y))._round()),I.y<s&&D.y<s||(I.y<s?I=new X(I.x+(s-I.y)/(D.y-I.y)*(D.x-I.x),s)._round():D.y<s&&(D=new X(I.x+(s-I.y)/(D.y-I.y)*(D.x-I.x),s)._round()),I.x>=u&&D.x>=u||(I.x>=u?I=new X(u,I.y+(u-I.x)/(D.x-I.x)*(D.y-I.y))._round():D.x>=u&&(D=new X(u,I.y+(u-I.x)/(D.x-I.x)*(D.y-I.y))._round()),I.y>=p&&D.y>=p||(I.y>=p?I=new X(I.x+(p-I.y)/(D.y-I.y)*(D.x-I.x),p)._round():D.y>=p&&(D=new X(I.x+(p-I.y)/(D.y-I.y)*(D.x-I.x),p)._round()),T&&I.equals(T[T.length-1])||(T=[I],v.push(T)),T.push(D)))))}}return v}_t("FeatureIndex",l2,{omit:["rawTileData","sourceLayerCoder"]});class Ua extends X{constructor(n,s,u,p){super(n,s),this.angle=u,p!==void 0&&(this.segment=p)}clone(){return new Ua(this.x,this.y,this.angle,this.segment)}}function h2(a,n,s,u,p){if(n.segment===void 0||s===0)return!0;let v=n,x=n.segment+1,w=0;for(;w>-s/2;){if(x--,x<0)return!1;w-=a[x].dist(v),v=a[x]}w+=a[x].dist(a[x+1]),x++;const T=[];let M=0;for(;w<s/2;){const I=a[x],D=a[x+1];if(!D)return!1;let B=a[x-1].angleTo(I)-I.angleTo(D);for(B=Math.abs((B+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:w,angleDelta:B}),M+=B;w-T[0].distance>u;)M-=T.shift().angleDelta;if(M>p)return!1;x++,w+=I.dist(D)}return!0}function d2(a){let n=0;for(let s=0;s<a.length-1;s++)n+=a[s].dist(a[s+1]);return n}function f2(a,n,s){return a?.6*n*s:0}function p2(a,n){return Math.max(a?a.right-a.left:0,n?n.right-n.left:0)}function mR(a,n,s,u,p,v){const x=f2(s,p,v),w=p2(s,u)*v;let T=0;const M=d2(a)/2;for(let I=0;I<a.length-1;I++){const D=a[I],B=a[I+1],V=D.dist(B);if(T+V>M){const G=(M-T)/V,K=di.number(D.x,B.x,G),ne=di.number(D.y,B.y,G),le=new Ua(K,ne,B.angleTo(D),I);return le._round(),!x||h2(a,le,w,x,n)?le:void 0}T+=V}}function gR(a,n,s,u,p,v,x,w,T){const M=f2(u,v,x),I=p2(u,p),D=I*x,B=a[0].x===0||a[0].x===T||a[0].y===0||a[0].y===T;return n-D<n/4&&(n=D+n/4),m2(a,B?n/2*w%n:(I/2+2*v)*x*w%n,n,M,s,D,B,!1,T)}function m2(a,n,s,u,p,v,x,w,T){const M=v/2,I=d2(a);let D=0,B=n-s,V=[];for(let G=0;G<a.length-1;G++){const K=a[G],ne=a[G+1],le=K.dist(ne),Se=ne.angleTo(K);for(;B+s<D+le;){B+=s;const me=(B-D)/le,$=di.number(K.x,ne.x,me),te=di.number(K.y,ne.y,me);if($>=0&&$<T&&te>=0&&te<T&&B-M>=0&&B+M<=I){const _e=new Ua($,te,Se,G);_e._round(),u&&!h2(a,_e,v,u,p)||V.push(_e)}}D+=le}return w||V.length||x||(V=m2(a,D/2,s,u,p,v,x,!0,T)),V}function g2(a,n,s,u){const p=[],v=a.image,x=v.pixelRatio,w=v.paddedRect.w-2,T=v.paddedRect.h-2;let M={x1:a.left,y1:a.top,x2:a.right,y2:a.bottom};const I=v.stretchX||[[0,w]],D=v.stretchY||[[0,T]],B=(Ge,xt)=>Ge+xt[1]-xt[0],V=I.reduce(B,0),G=D.reduce(B,0),K=w-V,ne=T-G;let le=0,Se=V,me=0,$=G,te=0,_e=K,Le=0,Xe=ne;if(v.content&&u){const Ge=v.content,xt=Ge[2]-Ge[0],Mt=Ge[3]-Ge[1];(v.textFitWidth||v.textFitHeight)&&(M=Z1(a)),le=Zm(I,0,Ge[0]),me=Zm(D,0,Ge[1]),Se=Zm(I,Ge[0],Ge[2]),$=Zm(D,Ge[1],Ge[3]),te=Ge[0]-le,Le=Ge[1]-me,_e=xt-Se,Xe=Mt-$}const Be=M.x1,Ue=M.y1,tt=M.x2-Be,Ye=M.y2-Ue,rt=(Ge,xt,Mt,Pt)=>{const St=Gm(Ge.stretch-le,Se,tt,Be),Kt=Hm(Ge.fixed-te,_e,Ge.stretch,V),Or=Gm(xt.stretch-me,$,Ye,Ue),ln=Hm(xt.fixed-Le,Xe,xt.stretch,G),Dn=Gm(Mt.stretch-le,Se,tt,Be),Zi=Hm(Mt.fixed-te,_e,Mt.stretch,V),pi=Gm(Pt.stretch-me,$,Ye,Ue),Pn=Hm(Pt.fixed-Le,Xe,Pt.stretch,G),Ar=new X(St,Or),gn=new X(Dn,Or),En=new X(Dn,pi),Mn=new X(St,pi),ni=new X(Kt/x,ln/x),Gi=new X(Zi/x,Pn/x),_n=n*Math.PI/180;if(_n){const yn=Math.sin(_n),vn=Math.cos(_n),tn=[vn,-yn,yn,vn];Ar._matMult(tn),gn._matMult(tn),Mn._matMult(tn),En._matMult(tn)}const mi=Ge.stretch+Ge.fixed,cn=xt.stretch+xt.fixed;return{tl:Ar,tr:gn,bl:Mn,br:En,tex:{x:v.paddedRect.x+1+mi,y:v.paddedRect.y+1+cn,w:Mt.stretch+Mt.fixed-mi,h:Pt.stretch+Pt.fixed-cn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ni,pixelOffsetBR:Gi,minFontScaleX:_e/x/tt,minFontScaleY:Xe/x/Ye,isSDF:s}};if(u&&(v.stretchX||v.stretchY)){const Ge=_2(I,K,V),xt=_2(D,ne,G);for(let Mt=0;Mt<Ge.length-1;Mt++){const Pt=Ge[Mt],St=Ge[Mt+1];for(let Kt=0;Kt<xt.length-1;Kt++)p.push(rt(Pt,xt[Kt],St,xt[Kt+1]))}}else p.push(rt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:T+1}));return p}function Zm(a,n,s){let u=0;for(const p of a)u+=Math.max(n,Math.min(s,p[1]))-Math.max(n,Math.min(s,p[0]));return u}function _2(a,n,s){const u=[{fixed:-1,stretch:0}];for(const[p,v]of a){const x=u[u.length-1];u.push({fixed:p-x.stretch,stretch:x.stretch}),u.push({fixed:p-x.stretch,stretch:x.stretch+(v-p)})}return u.push({fixed:n+1,stretch:s}),u}function Gm(a,n,s,u){return a/n*s+u}function Hm(a,n,s,u){return a-n*s/u}_t("Anchor",Ua);class Wm{constructor(n,s,u,p,v,x,w,T,M,I){var D;if(this.boxStartIndex=n.length,M){let B=x.top,V=x.bottom;const G=x.collisionPadding;G&&(B-=G[1],V+=G[3]);let K=V-B;K>0&&(K=Math.max(10,K),this.circleDiameter=K)}else{const B=!((D=x.image)===null||D===void 0)&&D.content&&(x.image.textFitWidth||x.image.textFitHeight)?Z1(x):{x1:x.left,y1:x.top,x2:x.right,y2:x.bottom};B.y1=B.y1*w-T[0],B.y2=B.y2*w+T[2],B.x1=B.x1*w-T[3],B.x2=B.x2*w+T[1];const V=x.collisionPadding;if(V&&(B.x1-=V[0]*w,B.y1-=V[1]*w,B.x2+=V[2]*w,B.y2+=V[3]*w),I){const G=new X(B.x1,B.y1),K=new X(B.x2,B.y1),ne=new X(B.x1,B.y2),le=new X(B.x2,B.y2),Se=I*Math.PI/180;G._rotate(Se),K._rotate(Se),ne._rotate(Se),le._rotate(Se),B.x1=Math.min(G.x,K.x,ne.x,le.x),B.x2=Math.max(G.x,K.x,ne.x,le.x),B.y1=Math.min(G.y,K.y,ne.y,le.y),B.y2=Math.max(G.y,K.y,ne.y,le.y)}n.emplaceBack(s.x,s.y,B.x1,B.y1,B.x2,B.y2,u,p,v)}this.boxEndIndex=n.length}}class _R{constructor(n=[],s=(u,p)=>u<p?-1:u>p?1:0){if(this.data=n,this.length=this.data.length,this.compare=s,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],s=this.data.pop();return--this.length>0&&(this.data[0]=s,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:s,compare:u}=this,p=s[n];for(;n>0;){const v=n-1>>1,x=s[v];if(u(p,x)>=0)break;s[n]=x,n=v}s[n]=p}_down(n){const{data:s,compare:u}=this,p=this.length>>1,v=s[n];for(;n<p;){let x=1+(n<<1);const w=x+1;if(w<this.length&&u(s[w],s[x])<0&&(x=w),u(s[x],v)>=0)break;s[n]=s[x],n=x}s[n]=v}}function yR(a,n=1,s=!1){const u=mc.fromPoints(a[0]),p=Math.min(u.width(),u.height());let v=p/2;const x=new _R([],vR),{minX:w,minY:T,maxX:M,maxY:I}=u;if(p===0)return new X(w,T);for(let V=w;V<M;V+=p)for(let G=T;G<I;G+=p)x.push(new Uu(V+v,G+v,v,a));let D=function(V){let G=0,K=0,ne=0;const le=V[0];for(let Se=0,me=le.length,$=me-1;Se<me;$=Se++){const te=le[Se],_e=le[$],Le=te.x*_e.y-_e.x*te.y;K+=(te.x+_e.x)*Le,ne+=(te.y+_e.y)*Le,G+=3*Le}return new Uu(K/G,ne/G,0,V)}(a),B=x.length;for(;x.length;){const V=x.pop();(V.d>D.d||!D.d)&&(D=V,s&&console.log("found best %d after %d probes",Math.round(1e4*V.d)/1e4,B)),V.max-D.d<=n||(v=V.h/2,x.push(new Uu(V.p.x-v,V.p.y-v,v,a)),x.push(new Uu(V.p.x+v,V.p.y-v,v,a)),x.push(new Uu(V.p.x-v,V.p.y+v,v,a)),x.push(new Uu(V.p.x+v,V.p.y+v,v,a)),B+=4)}return s&&(console.log(`num probes: ${B}`),console.log(`best distance: ${D.d}`)),D.p}function vR(a,n){return n.max-a.max}function Uu(a,n,s,u){this.p=new X(a,n),this.h=s,this.d=function(p,v){let x=!1,w=1/0;for(let T=0;T<v.length;T++){const M=v[T];for(let I=0,D=M.length,B=D-1;I<D;B=I++){const V=M[I],G=M[B];V.y>p.y!=G.y>p.y&&p.x<(G.x-V.x)*(p.y-V.y)/(G.y-V.y)+V.x&&(x=!x),w=Math.min(w,Kw(p,V,G))}}return(x?1:-1)*Math.sqrt(w)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}var Rn;m.aD=void 0,(Rn=m.aD||(m.aD={}))[Rn.center=1]="center",Rn[Rn.left=2]="left",Rn[Rn.right=3]="right",Rn[Rn.top=4]="top",Rn[Rn.bottom=5]="bottom",Rn[Rn["top-left"]=6]="top-left",Rn[Rn["top-right"]=7]="top-right",Rn[Rn["bottom-left"]=8]="bottom-left",Rn[Rn["bottom-right"]=9]="bottom-right";const kv=Number.POSITIVE_INFINITY;function y2(a,n){return n[1]!==kv?function(s,u,p){let v=0,x=0;switch(u=Math.abs(u),p=Math.abs(p),s){case"top-right":case"top-left":case"top":x=p-7;break;case"bottom-right":case"bottom-left":case"bottom":x=7-p}switch(s){case"top-right":case"bottom-right":case"right":v=-u;break;case"top-left":case"bottom-left":case"left":v=u}return[v,x]}(a,n[0],n[1]):function(s,u){let p=0,v=0;u<0&&(u=0);const x=u/Math.SQRT2;switch(s){case"top-right":case"top-left":v=x-7;break;case"bottom-right":case"bottom-left":v=7-x;break;case"bottom":v=7-u;break;case"top":v=u-7}switch(s){case"top-right":case"bottom-right":p=-x;break;case"top-left":case"bottom-left":p=x;break;case"left":p=u;break;case"right":p=-u}return[p,v]}(a,n[0])}function v2(a,n,s){var u;const p=a.layout,v=(u=p.get("text-variable-anchor-offset"))===null||u===void 0?void 0:u.evaluate(n,{},s);if(v){const w=v.values,T=[];for(let M=0;M<w.length;M+=2){const I=T[M]=w[M],D=w[M+1].map(B=>B*mn);I.startsWith("top")?D[1]-=7:I.startsWith("bottom")&&(D[1]+=7),T[M+1]=D}return new er(T)}const x=p.get("text-variable-anchor");if(x){let w;w=a._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[p.get("text-radial-offset").evaluate(n,{},s)*mn,kv]:p.get("text-offset").evaluate(n,{},s).map(M=>M*mn);const T=[];for(const M of x)T.push(M,y2(M,w));return new er(T)}return null}function Iv(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function xR(a,n,s,u,p,v,x,w,T,M,I,D){let B=v.textMaxSize.evaluate(n,{});B===void 0&&(B=x);const V=a.layers[0].layout,G=V.get("icon-offset").evaluate(n,{},I),K=b2(s.horizontal),ne=x/24,le=a.tilePixelRatio*ne,Se=a.tilePixelRatio*B/24,me=a.tilePixelRatio*w,$=a.tilePixelRatio*V.get("symbol-spacing"),te=V.get("text-padding")*a.tilePixelRatio,_e=function(Mt,Pt,St,Kt=1){const Or=Mt.get("icon-padding").evaluate(Pt,{},St),ln=Or&&Or.values;return[ln[0]*Kt,ln[1]*Kt,ln[2]*Kt,ln[3]*Kt]}(V,n,I,a.tilePixelRatio),Le=V.get("text-max-angle")/180*Math.PI,Xe=V.get("text-rotation-alignment")!=="viewport"&&V.get("symbol-placement")!=="point",Be=V.get("icon-rotation-alignment")==="map"&&V.get("symbol-placement")!=="point",Ue=V.get("symbol-placement"),tt=$/2,Ye=V.get("icon-text-fit");let rt;u&&Ye!=="none"&&(a.allowVerticalPlacement&&s.vertical&&(rt=G1(u,s.vertical,Ye,V.get("icon-text-fit-padding"),G,ne)),K&&(u=G1(u,K,Ye,V.get("icon-text-fit-padding"),G,ne)));const Ge=I?D.line.getGranularityForZoomLevel(I.z):1,xt=(Mt,Pt)=>{Pt.x<0||Pt.x>=ut||Pt.y<0||Pt.y>=ut||function(St,Kt,Or,ln,Dn,Zi,pi,Pn,Ar,gn,En,Mn,ni,Gi,_n,mi,cn,yn,vn,tn,br,Ao,Vu,zo,SR){const Zu=St.addToLineVertexArray(Kt,Or);let gc,Gu,Hu,Wu,C2=0,P2=0,E2=0,M2=0,Nv=-1,Bv=-1;const Hs={};let k2=ri("");if(St.allowVerticalPlacement&&ln.vertical){const Gn=Pn.layout.get("text-rotate").evaluate(br,{},zo)+90;Hu=new Wm(Ar,Kt,gn,En,Mn,ln.vertical,ni,Gi,_n,Gn),pi&&(Wu=new Wm(Ar,Kt,gn,En,Mn,pi,cn,yn,_n,Gn))}if(Dn){const Gn=Pn.layout.get("icon-rotate").evaluate(br,{}),Hi=Pn.layout.get("icon-text-fit")!=="none",_c=g2(Dn,Gn,Vu,Hi),Do=pi?g2(pi,Gn,Vu,Hi):void 0;Gu=new Wm(Ar,Kt,gn,En,Mn,Dn,cn,yn,!1,Gn),C2=4*_c.length;const yc=St.iconSizeData;let hs=null;yc.kind==="source"?(hs=[Gs*Pn.layout.get("icon-size").evaluate(br,{})],hs[0]>ja&&Sr(`${St.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):yc.kind==="composite"&&(hs=[Gs*Ao.compositeIconSizes[0].evaluate(br,{},zo),Gs*Ao.compositeIconSizes[1].evaluate(br,{},zo)],(hs[0]>ja||hs[1]>ja)&&Sr(`${St.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),St.addSymbols(St.icon,_c,hs,tn,vn,br,m.an.none,Kt,Zu.lineStartIndex,Zu.lineLength,-1,zo),Nv=St.icon.placedSymbolArray.length-1,Do&&(P2=4*Do.length,St.addSymbols(St.icon,Do,hs,tn,vn,br,m.an.vertical,Kt,Zu.lineStartIndex,Zu.lineLength,-1,zo),Bv=St.icon.placedSymbolArray.length-1)}const I2=Object.keys(ln.horizontal);for(const Gn of I2){const Hi=ln.horizontal[Gn];if(!gc){k2=ri(Hi.text);const Do=Pn.layout.get("text-rotate").evaluate(br,{},zo);gc=new Wm(Ar,Kt,gn,En,Mn,Hi,ni,Gi,_n,Do)}const _c=Hi.positionedLines.length===1;if(E2+=x2(St,Kt,Hi,Zi,Pn,_n,br,mi,Zu,ln.vertical?m.an.horizontal:m.an.horizontalOnly,_c?I2:[Gn],Hs,Nv,Ao,zo),_c)break}ln.vertical&&(M2+=x2(St,Kt,ln.vertical,Zi,Pn,_n,br,mi,Zu,m.an.vertical,["vertical"],Hs,Bv,Ao,zo));const TR=gc?gc.boxStartIndex:St.collisionBoxArray.length,CR=gc?gc.boxEndIndex:St.collisionBoxArray.length,PR=Hu?Hu.boxStartIndex:St.collisionBoxArray.length,ER=Hu?Hu.boxEndIndex:St.collisionBoxArray.length,MR=Gu?Gu.boxStartIndex:St.collisionBoxArray.length,kR=Gu?Gu.boxEndIndex:St.collisionBoxArray.length,IR=Wu?Wu.boxStartIndex:St.collisionBoxArray.length,AR=Wu?Wu.boxEndIndex:St.collisionBoxArray.length;let Ro=-1;const Xm=(Gn,Hi)=>Gn&&Gn.circleDiameter?Math.max(Gn.circleDiameter,Hi):Hi;Ro=Xm(gc,Ro),Ro=Xm(Hu,Ro),Ro=Xm(Gu,Ro),Ro=Xm(Wu,Ro);const A2=Ro>-1?1:0;A2&&(Ro*=SR/mn),St.glyphOffsetArray.length>=ju.MAX_GLYPHS&&Sr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),br.sortKey!==void 0&&St.addToSortKeyRanges(St.symbolInstances.length,br.sortKey);const zR=v2(Pn,br,zo),[RR,DR]=function(Gn,Hi){const _c=Gn.length,Do=Hi==null?void 0:Hi.values;if((Do==null?void 0:Do.length)>0)for(let yc=0;yc<Do.length;yc+=2){const hs=Do[yc+1];Gn.emplaceBack(m.aD[Do[yc]],hs[0],hs[1])}return[_c,Gn.length]}(St.textAnchorOffsets,zR);St.symbolInstances.emplaceBack(Kt.x,Kt.y,Hs.right>=0?Hs.right:-1,Hs.center>=0?Hs.center:-1,Hs.left>=0?Hs.left:-1,Hs.vertical||-1,Nv,Bv,k2,TR,CR,PR,ER,MR,kR,IR,AR,gn,E2,M2,C2,P2,A2,0,ni,Ro,RR,DR)}(a,Pt,Mt,s,u,p,rt,a.layers[0],a.collisionBoxArray,n.index,n.sourceLayerIndex,a.index,le,[te,te,te,te],Xe,T,me,_e,Be,G,n,v,M,I,x)};if(Ue==="line")for(const Mt of u2(n.geometry,0,0,ut,ut)){const Pt=pc(Mt,Ge),St=gR(Pt,$,Le,s.vertical||K,u,24,Se,a.overscaling,ut);for(const Kt of St)K&&bR(a,K.text,tt,Kt)||xt(Pt,Kt)}else if(Ue==="line-center"){for(const Mt of n.geometry)if(Mt.length>1){const Pt=pc(Mt,Ge),St=mR(Pt,Le,s.vertical||K,u,24,Se);St&&xt(Pt,St)}}else if(n.type==="Polygon")for(const Mt of cu(n.geometry,0)){const Pt=yR(Mt,16);xt(pc(Mt[0],Ge,!0),new Ua(Pt.x,Pt.y,0))}else if(n.type==="LineString")for(const Mt of n.geometry){const Pt=pc(Mt,Ge);xt(Pt,new Ua(Pt[0].x,Pt[0].y,0))}else if(n.type==="Point")for(const Mt of n.geometry)for(const Pt of Mt)xt([Pt],new Ua(Pt.x,Pt.y,0))}function x2(a,n,s,u,p,v,x,w,T,M,I,D,B,V,G){const K=function(Se,me,$,te,_e,Le,Xe,Be){const Ue=te.layout.get("text-rotate").evaluate(Le,{})*Math.PI/180,tt=[];for(const Ye of me.positionedLines)for(const rt of Ye.positionedGlyphs){if(!rt.rect)continue;const Ge=rt.rect||{};let xt=4,Mt=!0,Pt=1,St=0;const Kt=(_e||Be)&&rt.vertical,Or=rt.metrics.advance*rt.scale/2;if(Be&&me.verticalizable&&(St=Ye.lineOffset/2-(rt.imageName?-(mn-rt.metrics.width*rt.scale)/2:(rt.scale-1)*mn)),rt.imageName){const yn=Xe[rt.imageName];Mt=yn.sdf,Pt=yn.pixelRatio,xt=1/Pt}const ln=_e?[rt.x+Or,rt.y]:[0,0];let Dn=_e?[0,0]:[rt.x+Or+$[0],rt.y+$[1]-St],Zi=[0,0];Kt&&(Zi=Dn,Dn=[0,0]);const pi=rt.metrics.isDoubleResolution?2:1,Pn=(rt.metrics.left-xt)*rt.scale-Or+Dn[0],Ar=(-rt.metrics.top-xt)*rt.scale+Dn[1],gn=Pn+Ge.w/pi*rt.scale/Pt,En=Ar+Ge.h/pi*rt.scale/Pt,Mn=new X(Pn,Ar),ni=new X(gn,Ar),Gi=new X(Pn,En),_n=new X(gn,En);if(Kt){const yn=new X(-Or,Or- -17),vn=-Math.PI/2,tn=12-Or,br=new X(22-tn,-(rt.imageName?tn:0)),Ao=new X(...Zi);Mn._rotateAround(vn,yn)._add(br)._add(Ao),ni._rotateAround(vn,yn)._add(br)._add(Ao),Gi._rotateAround(vn,yn)._add(br)._add(Ao),_n._rotateAround(vn,yn)._add(br)._add(Ao)}if(Ue){const yn=Math.sin(Ue),vn=Math.cos(Ue),tn=[vn,-yn,yn,vn];Mn._matMult(tn),ni._matMult(tn),Gi._matMult(tn),_n._matMult(tn)}const mi=new X(0,0),cn=new X(0,0);tt.push({tl:Mn,tr:ni,bl:Gi,br:_n,tex:Ge,writingMode:me.writingMode,glyphOffset:ln,sectionIndex:rt.sectionIndex,isSDF:Mt,pixelOffsetTL:mi,pixelOffsetBR:cn,minFontScaleX:0,minFontScaleY:0})}return tt}(0,s,w,p,v,x,u,a.allowVerticalPlacement),ne=a.textSizeData;let le=null;ne.kind==="source"?(le=[Gs*p.layout.get("text-size").evaluate(x,{})],le[0]>ja&&Sr(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ne.kind==="composite"&&(le=[Gs*V.compositeTextSizes[0].evaluate(x,{},G),Gs*V.compositeTextSizes[1].evaluate(x,{},G)],(le[0]>ja||le[1]>ja)&&Sr(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),a.addSymbols(a.text,K,le,w,v,x,M,n,T.lineStartIndex,T.lineLength,B,G);for(const Se of I)D[Se]=a.text.placedSymbolArray.length-1;return 4*K.length}function b2(a){for(const n in a)return a[n];return null}function bR(a,n,s,u){const p=a.compareText;if(n in p){const v=p[n];for(let x=v.length-1;x>=0;x--)if(u.dist(v[x])<s)return!0}else p[n]=[];return p[n].push(u),!1}const w2=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Av{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,u]=new Uint8Array(n,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const p=u>>4;if(p!==1)throw new Error(`Got v${p} data when expected v1.`);const v=w2[15&u];if(!v)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(n,2,1),[w]=new Uint32Array(n,4,1);return new Av(w,x,v,n)}constructor(n,s=64,u=Float64Array,p){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=u,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const v=w2.indexOf(this.ArrayType),x=2*n*this.ArrayType.BYTES_PER_ELEMENT,w=n*this.IndexArrayType.BYTES_PER_ELEMENT,T=(8-w%8)%8;if(v<0)throw new Error(`Unexpected typed array class: ${u}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+w+T,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+x+w+T),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+w+T,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+v]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=n)}add(n,s){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=n,this.coords[this._pos++]=s,u}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return zv(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,s,u,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:x,nodeSize:w}=this,T=[0,v.length-1,0],M=[];for(;T.length;){const I=T.pop()||0,D=T.pop()||0,B=T.pop()||0;if(D-B<=w){for(let ne=B;ne<=D;ne++){const le=x[2*ne],Se=x[2*ne+1];le>=n&&le<=u&&Se>=s&&Se<=p&&M.push(v[ne])}continue}const V=B+D>>1,G=x[2*V],K=x[2*V+1];G>=n&&G<=u&&K>=s&&K<=p&&M.push(v[V]),(I===0?n<=G:s<=K)&&(T.push(B),T.push(V-1),T.push(1-I)),(I===0?u>=G:p>=K)&&(T.push(V+1),T.push(D),T.push(1-I))}return M}within(n,s,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:v,nodeSize:x}=this,w=[0,p.length-1,0],T=[],M=u*u;for(;w.length;){const I=w.pop()||0,D=w.pop()||0,B=w.pop()||0;if(D-B<=x){for(let ne=B;ne<=D;ne++)T2(v[2*ne],v[2*ne+1],n,s)<=M&&T.push(p[ne]);continue}const V=B+D>>1,G=v[2*V],K=v[2*V+1];T2(G,K,n,s)<=M&&T.push(p[V]),(I===0?n-u<=G:s-u<=K)&&(w.push(B),w.push(V-1),w.push(1-I)),(I===0?n+u>=G:s+u>=K)&&(w.push(V+1),w.push(D),w.push(1-I))}return T}}function zv(a,n,s,u,p,v){if(p-u<=s)return;const x=u+p>>1;S2(a,n,x,u,p,v),zv(a,n,s,u,x-1,1-v),zv(a,n,s,x+1,p,1-v)}function S2(a,n,s,u,p,v){for(;p>u;){if(p-u>600){const M=p-u+1,I=s-u+1,D=Math.log(M),B=.5*Math.exp(2*D/3),V=.5*Math.sqrt(D*B*(M-B)/M)*(I-M/2<0?-1:1);S2(a,n,s,Math.max(u,Math.floor(s-I*B/M+V)),Math.min(p,Math.floor(s+(M-I)*B/M+V)),v)}const x=n[2*s+v];let w=u,T=p;for(hf(a,n,u,s),n[2*p+v]>x&&hf(a,n,u,p);w<T;){for(hf(a,n,w,T),w++,T--;n[2*w+v]<x;)w++;for(;n[2*T+v]>x;)T--}n[2*u+v]===x?hf(a,n,u,T):(T++,hf(a,n,T,p)),T<=s&&(u=T+1),s<=T&&(p=T-1)}}function hf(a,n,s,u){Rv(a,s,u),Rv(n,2*s,2*u),Rv(n,2*s+1,2*u+1)}function Rv(a,n,s){const u=a[n];a[n]=a[s],a[s]=u}function T2(a,n,s,u){const p=a-s,v=n-u;return p*p+v*v}var Dv;m.cw=void 0,(Dv=m.cw||(m.cw={})).create="create",Dv.load="load",Dv.fullLoad="fullLoad";let qm=null,df=[];const Lv=1e3/60,Ov="loadTime",Fv="fullLoadTime",wR={mark(a){performance.mark(a)},frame(a){const n=a;qm!=null&&df.push(n-qm),qm=n},clearMetrics(){qm=null,df=[],performance.clearMeasures(Ov),performance.clearMeasures(Fv);for(const a in m.cw)performance.clearMarks(m.cw[a])},getPerformanceMetrics(){performance.measure(Ov,m.cw.create,m.cw.load),performance.measure(Fv,m.cw.create,m.cw.fullLoad);const a=performance.getEntriesByName(Ov)[0].duration,n=performance.getEntriesByName(Fv)[0].duration,s=df.length,u=1/(df.reduce((v,x)=>v+x,0)/s/1e3),p=df.filter(v=>v>Lv).reduce((v,x)=>v+(x-Lv)/Lv,0);return{loadTime:a,fullLoadTime:n,fps:u,percentDroppedFrames:p/(s+p)*100,totalFrames:s}}};m.$=ut,m.A=Te,m.B=function([a,n,s]){return n+=90,n*=Math.PI/180,s*=Math.PI/180,{x:a*Math.cos(n)*Math.sin(s),y:a*Math.sin(n)*Math.sin(s),z:a*Math.cos(s)}},m.C=di,m.D=bt,m.E=We,m.F=Tr,m.G=Eu,m.H=function(a){if(no==null){const n=a.navigator?a.navigator.userAgent:null;no=!!a.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return no},m.I=yv,m.J=class{constructor(a,n){this.target=a,this.mapId=n,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new dR(()=>this.process()),this.subscription=jr(this.target,"message",s=>this.receive(s),!1),this.globalScope=Zr(self)?a:window}registerMessageHandler(a,n){this.messageHandlers[a]=n}sendAsync(a,n){return new Promise((s,u)=>{const p=Math.round(1e18*Math.random()).toString(36).substring(0,10),v=n?jr(n.signal,"abort",()=>{v==null||v.unsubscribe(),delete this.resolveRejects[p];const T={id:p,type:"<cancel>",origin:location.origin,targetMapId:a.targetMapId,sourceMapId:this.mapId};this.target.postMessage(T)},fR):null;this.resolveRejects[p]={resolve:T=>{v==null||v.unsubscribe(),s(T)},reject:T=>{v==null||v.unsubscribe(),u(T)}};const x=[],w=Object.assign(Object.assign({},a),{id:p,sourceMapId:this.mapId,origin:location.origin,data:rc(a.data,x)});this.target.postMessage(w,{transfer:x})})}receive(a){const n=a.data,s=n.id;if(!(n.origin!=="file://"&&location.origin!=="file://"&&n.origin!=="resource://android"&&location.origin!=="resource://android"&&n.origin!==location.origin||n.targetMapId&&this.mapId!==n.targetMapId)){if(n.type==="<cancel>"){delete this.tasks[s];const u=this.abortControllers[s];return delete this.abortControllers[s],void(u&&u.abort())}if(Zr(self)||n.mustQueue)return this.tasks[s]=n,this.taskQueue.push(s),void this.invoker.trigger();this.processTask(s,n)}}process(){if(this.taskQueue.length===0)return;const a=this.taskQueue.shift(),n=this.tasks[a];delete this.tasks[a],this.taskQueue.length>0&&this.invoker.trigger(),n&&this.processTask(a,n)}processTask(a,n){return l(this,void 0,void 0,function*(){if(n.type==="<response>"){const p=this.resolveRejects[a];return delete this.resolveRejects[a],p?void(n.error?p.reject(Oa(n.error)):p.resolve(Oa(n.data))):void 0}if(!this.messageHandlers[n.type])return void this.completeTask(a,new Error(`Could not find a registered handler for ${n.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const s=Oa(n.data),u=new AbortController;this.abortControllers[a]=u;try{const p=yield this.messageHandlers[n.type](n.sourceMapId,s,u);this.completeTask(a,null,p)}catch(p){this.completeTask(a,p)}})}completeTask(a,n,s){const u=[];delete this.abortControllers[a];const p={id:a,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:n?rc(n):null,data:rc(s,u)};this.target.postMessage(p,{transfer:u})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},m.K=ie,m.L=function(){var a=new Te(16);return Te!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},m.M=function(a,n,s){var u,p,v,x,w,T,M,I,D,B,V,G,K=s[0],ne=s[1],le=s[2];return n===a?(a[12]=n[0]*K+n[4]*ne+n[8]*le+n[12],a[13]=n[1]*K+n[5]*ne+n[9]*le+n[13],a[14]=n[2]*K+n[6]*ne+n[10]*le+n[14],a[15]=n[3]*K+n[7]*ne+n[11]*le+n[15]):(p=n[1],v=n[2],x=n[3],w=n[4],T=n[5],M=n[6],I=n[7],D=n[8],B=n[9],V=n[10],G=n[11],a[0]=u=n[0],a[1]=p,a[2]=v,a[3]=x,a[4]=w,a[5]=T,a[6]=M,a[7]=I,a[8]=D,a[9]=B,a[10]=V,a[11]=G,a[12]=u*K+w*ne+D*le+n[12],a[13]=p*K+T*ne+B*le+n[13],a[14]=v*K+M*ne+V*le+n[14],a[15]=x*K+I*ne+G*le+n[15]),a},m.N=function(a,n,s){var u=s[0],p=s[1],v=s[2];return a[0]=n[0]*u,a[1]=n[1]*u,a[2]=n[2]*u,a[3]=n[3]*u,a[4]=n[4]*p,a[5]=n[5]*p,a[6]=n[6]*p,a[7]=n[7]*p,a[8]=n[8]*v,a[9]=n[9]*v,a[10]=n[10]*v,a[11]=n[11]*v,a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15],a},m.O=function(a,n,s){var u=n[0],p=n[1],v=n[2],x=n[3],w=n[4],T=n[5],M=n[6],I=n[7],D=n[8],B=n[9],V=n[10],G=n[11],K=n[12],ne=n[13],le=n[14],Se=n[15],me=s[0],$=s[1],te=s[2],_e=s[3];return a[0]=me*u+$*w+te*D+_e*K,a[1]=me*p+$*T+te*B+_e*ne,a[2]=me*v+$*M+te*V+_e*le,a[3]=me*x+$*I+te*G+_e*Se,a[4]=(me=s[4])*u+($=s[5])*w+(te=s[6])*D+(_e=s[7])*K,a[5]=me*p+$*T+te*B+_e*ne,a[6]=me*v+$*M+te*V+_e*le,a[7]=me*x+$*I+te*G+_e*Se,a[8]=(me=s[8])*u+($=s[9])*w+(te=s[10])*D+(_e=s[11])*K,a[9]=me*p+$*T+te*B+_e*ne,a[10]=me*v+$*M+te*V+_e*le,a[11]=me*x+$*I+te*G+_e*Se,a[12]=(me=s[12])*u+($=s[13])*w+(te=s[14])*D+(_e=s[15])*K,a[13]=me*p+$*T+te*B+_e*ne,a[14]=me*v+$*M+te*V+_e*le,a[15]=me*x+$*I+te*G+_e*Se,a},m.P=X,m.Q=function(a,n){const s={};for(let u=0;u<n.length;u++){const p=n[u];p in a&&(s[p]=a[p])}return s},m.R=fi,m.S=$a,m.T=nv,m.U=t2,m.V=e2,m.W=W,m.X=re,m.Y=Bn,m.Z=Vi,m._=l,m.a=Q,m.a$=function(a,n,s){return a[0]=n[0]*s,a[1]=n[1]*s,a[2]=n[2]*s,a[3]=n[3]*s,a},m.a0=uf,m.a1=mc,m.a2=25,m.a3=Mv,m.a4=a=>{const n=window.document.createElement("video");return n.muted=!0,new Promise(s=>{n.onloadstart=()=>{s(n)};for(const u of a){const p=window.document.createElement("source");De(u)||(n.crossOrigin="Anonymous"),p.src=u,n.appendChild(p)}})},m.a5=nt,m.a6=function(){return Qt++},m.a7=se,m.a8=ju,m.a9=ts,m.aA=mn,m.aB=At,m.aC=function(a,n,s,u,p=!1){if(!s[0]&&!s[1])return[0,0];const v=p?u==="map"?-a.bearingInRadians:0:u==="viewport"?a.bearingInRadians:0;if(v){const x=Math.sin(v),w=Math.cos(v);s=[s[0]*w-s[1]*x,s[0]*x+s[1]*w]}return[p?s[0]:At(n,s[0],a.zoom),p?s[1]:At(n,s[1],a.zoom)]},m.aE=bv,m.aF=Iv,m.aG=xv,m.aH=Av,m.aI=Lr,m.aJ=Fm,m.aK=Ae,m.aL=rr,m.aM=_r,m.aN=tr,m.aO=Si,m.aP=n2,m.aQ=ot,m.aR=et,m.aS=function(a){var n=new Te(3);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n},m.aT=function(a,n,s){return a[0]=n[0]-s[0],a[1]=n[1]-s[1],a[2]=n[2]-s[2],a},m.aU=function(a,n){var s=n[0],u=n[1],p=n[2],v=s*s+u*u+p*p;return v>0&&(v=1/Math.sqrt(v)),a[0]=n[0]*v,a[1]=n[1]*v,a[2]=n[2]*v,a},m.aV=qe,m.aW=function(a,n){return a[0]*n[0]+a[1]*n[1]+a[2]*n[2]},m.aX=function(a,n,s){return a[0]=n[0]*s[0],a[1]=n[1]*s[1],a[2]=n[2]*s[2],a[3]=n[3]*s[3],a},m.aY=Ie,m.aZ=function(a,n,s){const u=n[0]*s[0]+n[1]*s[1]+n[2]*s[2];return u===0?null:(-(a[0]*s[0]+a[1]*s[1]+a[2]*s[2])-s[3])/u},m.a_=dt,m.aa=dc,m.ab=a2,m.ac=function(a){const n={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,u,p,v)=>{const x=p||v;return n[u]=!x||x.toLowerCase(),""}),n["max-age"]){const s=parseInt(n["max-age"],10);isNaN(s)?delete n["max-age"]:n["max-age"]=s}return n},m.ad=Qr,m.ae=function(a){return Math.pow(2,a)},m.af=ze,m.ag=Vt,m.ah=85.051129,m.ai=r2,m.aj=function(a){return Math.log(a)/Math.LN2},m.ak=function(a){var n=a[0],s=a[1];return n*n+s*s},m.al=function(a,n){const s=[];for(const u in a)u in n||s.push(u);return s},m.am=function(a,n){let s=0,u=0;if(a.kind==="constant")u=a.layoutSize;else if(a.kind!=="source"){const{interpolationType:p,minZoom:v,maxZoom:x}=a,w=p?Vt($n.interpolationFactor(p,n,v,x),0,1):0;a.kind==="camera"?u=di.number(a.minSize,a.maxSize,w):s=w}return{uSizeT:s,uSize:u}},m.ao=function(a,{uSize:n,uSizeT:s},{lowerSize:u,upperSize:p}){return a.kind==="source"?u/Gs:a.kind==="composite"?di.number(u/Gs,p/Gs,s):n},m.ap=function(a,n){var s=n[0],u=n[1],p=n[2],v=n[3],x=n[4],w=n[5],T=n[6],M=n[7],I=n[8],D=n[9],B=n[10],V=n[11],G=n[12],K=n[13],ne=n[14],le=n[15],Se=s*w-u*x,me=s*T-p*x,$=s*M-v*x,te=u*T-p*w,_e=u*M-v*w,Le=p*M-v*T,Xe=I*K-D*G,Be=I*ne-B*G,Ue=I*le-V*G,tt=D*ne-B*K,Ye=D*le-V*K,rt=B*le-V*ne,Ge=Se*rt-me*Ye+$*tt+te*Ue-_e*Be+Le*Xe;return Ge?(a[0]=(w*rt-T*Ye+M*tt)*(Ge=1/Ge),a[1]=(p*Ye-u*rt-v*tt)*Ge,a[2]=(K*Le-ne*_e+le*te)*Ge,a[3]=(B*_e-D*Le-V*te)*Ge,a[4]=(T*Ue-x*rt-M*Be)*Ge,a[5]=(s*rt-p*Ue+v*Be)*Ge,a[6]=(ne*$-G*Le-le*me)*Ge,a[7]=(I*Le-B*$+V*me)*Ge,a[8]=(x*Ye-w*Ue+M*Xe)*Ge,a[9]=(u*Ue-s*Ye-v*Xe)*Ge,a[10]=(G*_e-K*$+le*Se)*Ge,a[11]=(D*$-I*_e-V*Se)*Ge,a[12]=(w*Be-x*tt-T*Xe)*Ge,a[13]=(s*tt-u*Be+p*Xe)*Ge,a[14]=(K*me-G*te-ne*Se)*Ge,a[15]=(I*te-D*me+B*Se)*Ge,a):null},m.aq=pt,m.ar=function(a){return Math.hypot(a[0],a[1])},m.as=function(a){return a[0]=0,a[1]=0,a},m.at=function(a,n,s){return a[0]=n[0]*s,a[1]=n[1]*s,a},m.au=wv,m.av=wt,m.aw=function(a,n,s,u){const p=n.y-a.y,v=n.x-a.x,x=u.y-s.y,w=u.x-s.x,T=x*v-w*p;if(T===0)return null;const M=(w*(a.y-s.y)-x*(a.x-s.x))/T;return new X(a.x+M*v,a.y+M*p)},m.ax=u2,m.ay=qw,m.az=function(a){let n=1/0,s=1/0,u=-1/0,p=-1/0;for(const v of a)n=Math.min(n,v.x),s=Math.min(s,v.y),u=Math.max(u,v.x),p=Math.max(p,v.y);return[n,s,u,p]},m.b=Yn,m.b$=Vz,m.b0=function(a,n){return a[0]*n[0]+a[1]*n[1]+a[2]*n[2]+a[3]},m.b1=o2,m.b2=$u,m.b3=function(a,n,s,u,p){var v,x=1/Math.tan(n/2);return a[0]=x/s,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=x,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,p!=null&&p!==1/0?(a[10]=(p+u)*(v=1/(u-p)),a[14]=2*p*u*v):(a[10]=-1,a[14]=-2*u),a},m.b4=function(a){var n=new Te(16);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n[3]=a[3],n[4]=a[4],n[5]=a[5],n[6]=a[6],n[7]=a[7],n[8]=a[8],n[9]=a[9],n[10]=a[10],n[11]=a[11],n[12]=a[12],n[13]=a[13],n[14]=a[14],n[15]=a[15],n},m.b5=function(a,n,s){var u=Math.sin(s),p=Math.cos(s),v=n[0],x=n[1],w=n[2],T=n[3],M=n[4],I=n[5],D=n[6],B=n[7];return n!==a&&(a[8]=n[8],a[9]=n[9],a[10]=n[10],a[11]=n[11],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[0]=v*p+M*u,a[1]=x*p+I*u,a[2]=w*p+D*u,a[3]=T*p+B*u,a[4]=M*p-v*u,a[5]=I*p-x*u,a[6]=D*p-w*u,a[7]=B*p-T*u,a},m.b6=function(a,n,s){var u=Math.sin(s),p=Math.cos(s),v=n[4],x=n[5],w=n[6],T=n[7],M=n[8],I=n[9],D=n[10],B=n[11];return n!==a&&(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[4]=v*p+M*u,a[5]=x*p+I*u,a[6]=w*p+D*u,a[7]=T*p+B*u,a[8]=M*p-v*u,a[9]=I*p-x*u,a[10]=D*p-w*u,a[11]=B*p-T*u,a},m.b7=function(){const a=new Float32Array(16);return ze(a),a},m.b8=function(){const a=new Float64Array(16);return ze(a),a},m.b9=function(){return new Float64Array(16)},m.bA=function(a){return a[0]=0,a[1]=0,a[2]=0,a},m.bB=function(a,n,s,u){const p=Math.sqrt(a*a+n*n),v=Math.sqrt(s*s+u*u);a/=p,n/=p,s/=v,u/=v;const x=Math.acos(a*s+n*u);return-n*s+a*u>0?x:-x},m.bC=function(a,n){const s=kt(a,2*Math.PI),u=kt(n,2*Math.PI);return Math.min(Math.abs(s-u),Math.abs(s-u+2*Math.PI),Math.abs(s-u-2*Math.PI))},m.bD=function(){const a={},n=he.$version;for(const s in he.$root){const u=he.$root[s];if(u.required){let p=null;p=s==="version"?n:u.type==="array"?[]:{},p!=null&&(a[s]=p)}}return a},m.bE=Od,m.bF=we,m.bG=function a(n,s){if(Array.isArray(n)){if(!Array.isArray(s)||n.length!==s.length)return!1;for(let u=0;u<n.length;u++)if(!a(n[u],s[u]))return!1;return!0}if(typeof n=="object"&&n!==null&&s!==null){if(typeof s!="object"||Object.keys(n).length!==Object.keys(s).length)return!1;for(const u in n)if(!a(n[u],s[u]))return!1;return!0}return n===s},m.bH=function(a){a=a.slice();const n=Object.create(null);for(let s=0;s<a.length;s++)n[a[s].id]=a[s];for(let s=0;s<a.length;s++)"ref"in a[s]&&(a[s]=mt(a[s],n[a[s].ref]));return a},m.bI=function(a){if(a.type==="custom")return new hR(a);switch(a.type){case"background":return new lR(a);case"circle":return new rz(a);case"color-relief":return new lz(a);case"fill":return new Sz(a);case"fill-extrusion":return new Az(a);case"heatmap":return new iz(a);case"hillshade":return new sz(a);case"line":return new Bz(a);case"raster":return new uR(a);case"symbol":return new Vm(a)}},m.bJ=Yr,m.bK=function(a,n){if(!a)return[{command:"setStyle",args:[n]}];let s=[];try{if(!ct(a.version,n.version))return[{command:"setStyle",args:[n]}];ct(a.center,n.center)||s.push({command:"setCenter",args:[n.center]}),ct(a.state,n.state)||s.push({command:"setGlobalState",args:[n.state]}),ct(a.centerAltitude,n.centerAltitude)||s.push({command:"setCenterAltitude",args:[n.centerAltitude]}),ct(a.zoom,n.zoom)||s.push({command:"setZoom",args:[n.zoom]}),ct(a.bearing,n.bearing)||s.push({command:"setBearing",args:[n.bearing]}),ct(a.pitch,n.pitch)||s.push({command:"setPitch",args:[n.pitch]}),ct(a.roll,n.roll)||s.push({command:"setRoll",args:[n.roll]}),ct(a.sprite,n.sprite)||s.push({command:"setSprite",args:[n.sprite]}),ct(a.glyphs,n.glyphs)||s.push({command:"setGlyphs",args:[n.glyphs]}),ct(a.transition,n.transition)||s.push({command:"setTransition",args:[n.transition]}),ct(a.light,n.light)||s.push({command:"setLight",args:[n.light]}),ct(a.terrain,n.terrain)||s.push({command:"setTerrain",args:[n.terrain]}),ct(a.sky,n.sky)||s.push({command:"setSky",args:[n.sky]}),ct(a.projection,n.projection)||s.push({command:"setProjection",args:[n.projection]});const u={},p=[];(function(x,w,T,M){let I;for(I in w=w||{},x=x||{})Object.prototype.hasOwnProperty.call(x,I)&&(Object.prototype.hasOwnProperty.call(w,I)||ir(I,T,M));for(I in w)Object.prototype.hasOwnProperty.call(w,I)&&(Object.prototype.hasOwnProperty.call(x,I)?ct(x[I],w[I])||(x[I].type==="geojson"&&w[I].type==="geojson"&&Bt(x,w,I)?yt(T,{command:"setGeoJSONSourceData",args:[I,w[I].data]}):Nt(I,w,T,M)):Et(I,w,T))})(a.sources,n.sources,p,u);const v=[];a.layers&&a.layers.forEach(x=>{"source"in x&&u[x.source]?s.push({command:"removeLayer",args:[x.id]}):v.push(x)}),s=s.concat(p),function(x,w,T){w=w||[];const M=(x=x||[]).map(Jt),I=w.map(Jt),D=x.reduce(hn,{}),B=w.reduce(hn,{}),V=M.slice(),G=Object.create(null);let K,ne,le,Se,me;for(let $=0,te=0;$<M.length;$++)K=M[$],Object.prototype.hasOwnProperty.call(B,K)?te++:(yt(T,{command:"removeLayer",args:[K]}),V.splice(V.indexOf(K,te),1));for(let $=0,te=0;$<I.length;$++)K=I[I.length-1-$],V[V.length-1-$]!==K&&(Object.prototype.hasOwnProperty.call(D,K)?(yt(T,{command:"removeLayer",args:[K]}),V.splice(V.lastIndexOf(K,V.length-te),1)):te++,Se=V[V.length-$],yt(T,{command:"addLayer",args:[B[K],Se]}),V.splice(V.length-$,0,K),G[K]=!0);for(let $=0;$<I.length;$++)if(K=I[$],ne=D[K],le=B[K],!G[K]&&!ct(ne,le))if(ct(ne.source,le.source)&&ct(ne["source-layer"],le["source-layer"])&&ct(ne.type,le.type)){for(me in Rt(ne.layout,le.layout,T,K,null,"setLayoutProperty"),Rt(ne.paint,le.paint,T,K,null,"setPaintProperty"),ct(ne.filter,le.filter)||yt(T,{command:"setFilter",args:[K,le.filter]}),ct(ne.minzoom,le.minzoom)&&ct(ne.maxzoom,le.maxzoom)||yt(T,{command:"setLayerZoomRange",args:[K,le.minzoom,le.maxzoom]}),ne)Object.prototype.hasOwnProperty.call(ne,me)&&me!=="layout"&&me!=="paint"&&me!=="filter"&&me!=="metadata"&&me!=="minzoom"&&me!=="maxzoom"&&(me.indexOf("paint.")===0?Rt(ne[me],le[me],T,K,me.slice(6),"setPaintProperty"):ct(ne[me],le[me])||yt(T,{command:"setLayerProperty",args:[K,me,le[me]]}));for(me in le)Object.prototype.hasOwnProperty.call(le,me)&&!Object.prototype.hasOwnProperty.call(ne,me)&&me!=="layout"&&me!=="paint"&&me!=="filter"&&me!=="metadata"&&me!=="minzoom"&&me!=="maxzoom"&&(me.indexOf("paint.")===0?Rt(ne[me],le[me],T,K,me.slice(6),"setPaintProperty"):ct(ne[me],le[me])||yt(T,{command:"setLayerProperty",args:[K,me,le[me]]}))}else yt(T,{command:"removeLayer",args:[K]}),Se=V[V.lastIndexOf(K)+1],yt(T,{command:"addLayer",args:[le,Se]})}(v,n.layers,s)}catch(u){console.warn("Unable to compute style diff:",u),s=[{command:"setStyle",args:[n]}]}return s},m.bL=function(a){const n=[],s=a.id;return s===void 0&&n.push({message:`layers.${s}: missing required property "id"`}),a.render===void 0&&n.push({message:`layers.${s}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&n.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),n},m.bM=Gt,m.bN=Rr,m.bO=class extends xr{constructor(a,n){super(a,n),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},m.bP=zm,m.bQ=class extends xr{constructor(a,n){super(a,n),this.current=Ky}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let n=1;n<16;n++)if(a[n]!==this.current[n]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},m.bR=an,m.bS=class extends xr{constructor(a,n){super(a,n),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},m.bT=class extends xr{constructor(a,n){super(a,n),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},m.bU=xe,m.bV=function(a,n){var s=Math.sin(n),u=Math.cos(n);return a[0]=u,a[1]=s,a[2]=0,a[3]=-s,a[4]=u,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},m.bW=function(a,n,s){var u=n[0],p=n[1],v=n[2];return a[0]=u*s[0]+p*s[3]+v*s[6],a[1]=u*s[1]+p*s[4]+v*s[7],a[2]=u*s[2]+p*s[5]+v*s[8],a},m.bX=function(a,n,s,u,p,v,x){var w=1/(n-s),T=1/(u-p),M=1/(v-x);return a[0]=-2*w,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*T,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*M,a[11]=0,a[12]=(n+s)*w,a[13]=(p+u)*T,a[14]=(x+v)*M,a[15]=1,a},m.bY=class extends xr{constructor(a,n){super(a,n),this.current=new Array}set(a){if(a!=this.current){this.current=a;const n=new Float32Array(4*a.length);for(let s=0;s<a.length;s++)n[4*s]=a[s].r,n[4*s+1]=a[s].g,n[4*s+2]=a[s].b,n[4*s+3]=a[s].a;this.gl.uniform4fv(this.location,n)}}},m.bZ=class extends xr{constructor(a,n){super(a,n),this.current=new Array}set(a){if(a!=this.current){this.current=a;const n=new Float32Array(a);this.gl.uniform1fv(this.location,n)}}},m.b_=class extends h{},m.ba=function(a,n,s){const u=new Float64Array(4);return He(u,a,n-90,s),u},m.bb=function(a,n,s,u){var p,v,x,w,T,M=n[0],I=n[1],D=n[2],B=n[3],V=s[0],G=s[1],K=s[2],ne=s[3];return(v=M*V+I*G+D*K+B*ne)<0&&(v=-v,V=-V,G=-G,K=-K,ne=-ne),1-v>ge?(p=Math.acos(v),x=Math.sin(p),w=Math.sin((1-u)*p)/x,T=Math.sin(u*p)/x):(w=1-u,T=u),a[0]=w*M+T*V,a[1]=w*I+T*G,a[2]=w*D+T*K,a[3]=w*B+T*ne,a},m.bc=function(a){const n=new Float64Array(9);var s,u,p,v,x,w,T,M,I,D,B,V,G,K,ne,le,Se,me;D=(p=(u=a)[0])*(T=p+p),B=(v=u[1])*T,G=(x=u[2])*T,K=x*(M=v+v),le=(w=u[3])*T,Se=w*M,me=w*(I=x+x),(s=n)[0]=1-(V=v*M)-(ne=x*I),s[3]=B-me,s[6]=G+Se,s[1]=B+me,s[4]=1-D-ne,s[7]=K-le,s[2]=G-Se,s[5]=K+le,s[8]=1-D-V;const $=Si(-Math.asin(Vt(n[2],-1,1)));let te,_e;return Math.hypot(n[5],n[8])<.001?(te=0,_e=-Si(Math.atan2(n[3],n[4]))):(te=Si(n[5]===0&&n[8]===0?0:Math.atan2(n[5],n[8])),_e=Si(n[1]===0&&n[0]===0?0:Math.atan2(n[1],n[0]))),{roll:te,pitch:$+90,bearing:_e}},m.bd=function(a,n){return a.roll==n.roll&&a.pitch==n.pitch&&a.bearing==n.bearing},m.be=Wt,m.bf=Zn,m.bg=Nu,m.bh=rf,m.bi=Fu,m.bj=nr,m.bk=dr,m.bl=Lt,m.bm=function(a,n,s,u,p){return nr(u,p,Vt((a-n)/(s-n),0,1))},m.bn=kt,m.bo=function(){return new Float64Array(3)},m.bp=function(a,n,s,u){return a[0]=n[0]+s[0]*u,a[1]=n[1]+s[1]*u,a[2]=n[2]+s[2]*u,a},m.bq=He,m.br=function(a,n,s){var u=s[0],p=s[1],v=s[2],x=n[0],w=n[1],T=n[2],M=p*T-v*w,I=v*x-u*T,D=u*w-p*x,B=p*D-v*I,V=v*M-u*D,G=u*I-p*M,K=2*s[3];return I*=K,D*=K,V*=2,G*=2,a[0]=x+(M*=K)+(B*=2),a[1]=w+I+V,a[2]=T+D+G,a},m.bs=function(a,n,s){const u=(p=[a[0],a[1],a[2],n[0],n[1],n[2],s[0],s[1],s[2]])[0]*((I=p[8])*(x=p[4])-(w=p[5])*(M=p[7]))+p[1]*(-I*(v=p[3])+w*(T=p[6]))+p[2]*(M*v-x*T);var p,v,x,w,T,M,I;if(u===0)return null;const D=qe([],[n[0],n[1],n[2]],[s[0],s[1],s[2]]),B=qe([],[s[0],s[1],s[2]],[a[0],a[1],a[2]]),V=qe([],[a[0],a[1],a[2]],[n[0],n[1],n[2]]),G=ot([],D,-a[3]);return et(G,G,ot([],B,-n[3])),et(G,G,ot([],V,-s[3])),ot(G,G,1/u),G},m.bt=Pv,m.bu=function(){return new Float64Array(4)},m.bv=function(a,n,s,u){var p=[],v=[];return p[0]=n[0]-s[0],p[1]=n[1]-s[1],p[2]=n[2]-s[2],v[0]=p[0]*Math.cos(u)-p[1]*Math.sin(u),v[1]=p[0]*Math.sin(u)+p[1]*Math.cos(u),v[2]=p[2],a[0]=v[0]+s[0],a[1]=v[1]+s[1],a[2]=v[2]+s[2],a},m.bw=function(a,n,s,u){var p=[],v=[];return p[0]=n[0]-s[0],p[1]=n[1]-s[1],p[2]=n[2]-s[2],v[0]=p[0],v[1]=p[1]*Math.cos(u)-p[2]*Math.sin(u),v[2]=p[1]*Math.sin(u)+p[2]*Math.cos(u),a[0]=v[0]+s[0],a[1]=v[1]+s[1],a[2]=v[2]+s[2],a},m.bx=function(a,n,s,u){var p=[],v=[];return p[0]=n[0]-s[0],p[1]=n[1]-s[1],p[2]=n[2]-s[2],v[0]=p[2]*Math.sin(u)+p[0]*Math.cos(u),v[1]=p[1],v[2]=p[2]*Math.cos(u)-p[0]*Math.sin(u),a[0]=v[0]+s[0],a[1]=v[1]+s[1],a[2]=v[2]+s[2],a},m.by=function(a,n,s){var u=Math.sin(s),p=Math.cos(s),v=n[0],x=n[1],w=n[2],T=n[3],M=n[8],I=n[9],D=n[10],B=n[11];return n!==a&&(a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[0]=v*p-M*u,a[1]=x*p-I*u,a[2]=w*p-D*u,a[3]=T*p-B*u,a[8]=v*u+M*p,a[9]=x*u+I*p,a[10]=w*u+D*p,a[11]=T*u+B*p,a},m.bz=function(a,n){const s=kt(a,360),u=kt(n,360),p=u-s,v=u>s?p-360:p+360;return Math.abs(p)<Math.abs(v)?p:v},m.c=Me,m.c0=class extends y{},m.c1=rv,m.c2=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},m.c3=i1,m.c4=function(a,n,s){var u=n[0],p=n[1],v=n[2],x=s[3]*u+s[7]*p+s[11]*v+s[15];return a[0]=(s[0]*u+s[4]*p+s[8]*v+s[12])/(x=x||1),a[1]=(s[1]*u+s[5]*p+s[9]*v+s[13])/x,a[2]=(s[2]*u+s[6]*p+s[10]*v+s[14])/x,a},m.c5=class extends Vd{},m.c6=class extends L{},m.c7=function(a,n){return a[0]===n[0]&&a[1]===n[1]&&a[2]===n[2]&&a[3]===n[3]&&a[4]===n[4]&&a[5]===n[5]&&a[6]===n[6]&&a[7]===n[7]&&a[8]===n[8]&&a[9]===n[9]&&a[10]===n[10]&&a[11]===n[11]&&a[12]===n[12]&&a[13]===n[13]&&a[14]===n[14]&&a[15]===n[15]},m.c8=function(a,n){var s=a[0],u=a[1],p=a[2],v=a[3],x=a[4],w=a[5],T=a[6],M=a[7],I=a[8],D=a[9],B=a[10],V=a[11],G=a[12],K=a[13],ne=a[14],le=a[15],Se=n[0],me=n[1],$=n[2],te=n[3],_e=n[4],Le=n[5],Xe=n[6],Be=n[7],Ue=n[8],tt=n[9],Ye=n[10],rt=n[11],Ge=n[12],xt=n[13],Mt=n[14],Pt=n[15];return Math.abs(s-Se)<=ge*Math.max(1,Math.abs(s),Math.abs(Se))&&Math.abs(u-me)<=ge*Math.max(1,Math.abs(u),Math.abs(me))&&Math.abs(p-$)<=ge*Math.max(1,Math.abs(p),Math.abs($))&&Math.abs(v-te)<=ge*Math.max(1,Math.abs(v),Math.abs(te))&&Math.abs(x-_e)<=ge*Math.max(1,Math.abs(x),Math.abs(_e))&&Math.abs(w-Le)<=ge*Math.max(1,Math.abs(w),Math.abs(Le))&&Math.abs(T-Xe)<=ge*Math.max(1,Math.abs(T),Math.abs(Xe))&&Math.abs(M-Be)<=ge*Math.max(1,Math.abs(M),Math.abs(Be))&&Math.abs(I-Ue)<=ge*Math.max(1,Math.abs(I),Math.abs(Ue))&&Math.abs(D-tt)<=ge*Math.max(1,Math.abs(D),Math.abs(tt))&&Math.abs(B-Ye)<=ge*Math.max(1,Math.abs(B),Math.abs(Ye))&&Math.abs(V-rt)<=ge*Math.max(1,Math.abs(V),Math.abs(rt))&&Math.abs(G-Ge)<=ge*Math.max(1,Math.abs(G),Math.abs(Ge))&&Math.abs(K-xt)<=ge*Math.max(1,Math.abs(K),Math.abs(xt))&&Math.abs(ne-Mt)<=ge*Math.max(1,Math.abs(ne),Math.abs(Mt))&&Math.abs(le-Pt)<=ge*Math.max(1,Math.abs(le),Math.abs(Pt))},m.c9=function(a,n){return a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7],a[8]=n[8],a[9]=n[9],a[10]=n[10],a[11]=n[11],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15],a},m.cA=function(a){delete Q.REGISTERED_PROTOCOLS[a]},m.cB=function(a,n){const s={};for(let p=0;p<a.length;p++){const v=n&&n[a[p].id]||wu(a[p]);n&&(n[a[p].id]=v);let x=s[v];x||(x=s[v]=[]),x.push(a[p])}const u=[];for(const p in s)u.push(s[p]);return u},m.cC=_t,m.cD=s2,m.cE=l2,m.cF=N1,m.cG=function(a){a.bucket.createArrays(),a.bucket.tilePixelRatio=ut/(512*a.bucket.overscaling),a.bucket.compareText={},a.bucket.iconsNeedLinear=!1;const n=a.bucket.layers[0],s=n.layout,u=n._unevaluatedLayout._values,p={layoutIconSize:u["icon-size"].possiblyEvaluate(new Tr(a.bucket.zoom+1),a.canonical),layoutTextSize:u["text-size"].possiblyEvaluate(new Tr(a.bucket.zoom+1),a.canonical),textMaxSize:u["text-size"].possiblyEvaluate(new Tr(18))};if(a.bucket.textSizeData.kind==="composite"){const{minZoom:M,maxZoom:I}=a.bucket.textSizeData;p.compositeTextSizes=[u["text-size"].possiblyEvaluate(new Tr(M),a.canonical),u["text-size"].possiblyEvaluate(new Tr(I),a.canonical)]}if(a.bucket.iconSizeData.kind==="composite"){const{minZoom:M,maxZoom:I}=a.bucket.iconSizeData;p.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new Tr(M),a.canonical),u["icon-size"].possiblyEvaluate(new Tr(I),a.canonical)]}const v=s.get("text-line-height")*mn,x=s.get("text-rotation-alignment")!=="viewport"&&s.get("symbol-placement")!=="point",w=s.get("text-keep-upright"),T=s.get("text-size");for(const M of a.bucket.features){const I=s.get("text-font").evaluate(M,{},a.canonical).join(","),D=T.evaluate(M,{},a.canonical),B=p.layoutTextSize.evaluate(M,{},a.canonical),V=p.layoutIconSize.evaluate(M,{},a.canonical),G={horizontal:{},vertical:void 0},K=M.text;let ne,le=[0,0];if(K){const $=K.toString(),te=s.get("text-letter-spacing").evaluate(M,{},a.canonical)*mn,_e=Cm($)?te:0,Le=s.get("text-anchor").evaluate(M,{},a.canonical),Xe=v2(n,M,a.canonical);if(!Xe){const Ye=s.get("text-radial-offset").evaluate(M,{},a.canonical);le=Ye?y2(Le,[Ye*mn,kv]):s.get("text-offset").evaluate(M,{},a.canonical).map(rt=>rt*mn)}let Be=x?"center":s.get("text-justify").evaluate(M,{},a.canonical);const Ue=s.get("symbol-placement")==="point"?s.get("text-max-width").evaluate(M,{},a.canonical)*mn:1/0,tt=()=>{a.bucket.allowVerticalPlacement&&Fd($)&&(G.vertical=jm(K,a.glyphMap,a.glyphPositions,a.imagePositions,I,Ue,v,Le,"left",_e,le,m.an.vertical,!0,B,D))};if(!x&&Xe){const Ye=new Set;if(Be==="auto")for(let Ge=0;Ge<Xe.values.length;Ge+=2)Ye.add(Iv(Xe.values[Ge]));else Ye.add(Be);let rt=!1;for(const Ge of Ye)if(!G.horizontal[Ge])if(rt)G.horizontal[Ge]=G.horizontal[0];else{const xt=jm(K,a.glyphMap,a.glyphPositions,a.imagePositions,I,Ue,v,"center",Ge,_e,le,m.an.horizontal,!1,B,D);xt&&(G.horizontal[Ge]=xt,rt=xt.positionedLines.length===1)}tt()}else{Be==="auto"&&(Be=Iv(Le));const Ye=jm(K,a.glyphMap,a.glyphPositions,a.imagePositions,I,Ue,v,Le,Be,_e,le,m.an.horizontal,!1,B,D);Ye&&(G.horizontal[Be]=Ye),tt(),Fd($)&&x&&w&&(G.vertical=jm(K,a.glyphMap,a.glyphPositions,a.imagePositions,I,Ue,v,Le,Be,_e,le,m.an.vertical,!1,B,D))}}let Se=!1;if(M.icon&&M.icon.name){const $=a.imageMap[M.icon.name];$&&(ne=nR(a.imagePositions[M.icon.name],s.get("icon-offset").evaluate(M,{},a.canonical),s.get("icon-anchor").evaluate(M,{},a.canonical)),Se=!!$.sdf,a.bucket.sdfIcons===void 0?a.bucket.sdfIcons=Se:a.bucket.sdfIcons!==Se&&Sr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),($.pixelRatio!==a.bucket.pixelRatio||s.get("icon-rotate").constantOr(1)!==0)&&(a.bucket.iconsNeedLinear=!0))}const me=b2(G.horizontal)||G.vertical;a.bucket.iconsInText=!!me&&me.iconsInText,(me||ne)&&xR(a.bucket,M,G,ne,a.imageMap,p,B,V,le,Se,a.canonical,a.subdivisionGranularity)}a.showCollisionBoxes&&a.bucket.generateCollisionDebugBuffers()},m.cH=pv,m.cI=lv,m.cJ=fv,m.cK=of,m.cL=_v,m.cM=class{constructor(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let a=performance.getEntriesByName(this._marks.measure);return a.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),a=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),a}},m.cN=function(a,n,s,u,p){return l(this,void 0,void 0,function*(){if(re())try{return yield Bn(a,n,s,u,p)}catch{}return function(v,x,w,T,M){const I=v.width,D=v.height;Fi&&bo||(Fi=new OffscreenCanvas(I,D),bo=Fi.getContext("2d",{willReadFrequently:!0})),Fi.width=I,Fi.height=D,bo.drawImage(v,0,0,I,D);const B=bo.getImageData(x,w,T,M);return bo.clearRect(0,0,I,D),B.data}(a,n,s,u,p)})},m.cO=a1,m.cP=E,m.cQ=N,m.cR=T1,m.cS=O1,m.cT=yu,m.cU=ns,m.ca=a=>a.type==="symbol",m.cb=a=>a.type==="circle",m.cc=a=>a.type==="heatmap",m.cd=a=>a.type==="line",m.ce=a=>a.type==="fill",m.cf=a=>a.type==="fill-extrusion",m.cg=a=>a.type==="hillshade",m.ch=a=>a.type==="color-relief",m.ci=a=>a.type==="raster",m.cj=a=>a.type==="background",m.ck=a=>a.type==="custom",m.cl=gt,m.cm=function(a,n,s){const u=Ct(n.x-s.x,n.y-s.y),p=Ct(a.x-s.x,a.y-s.y);var v,x;return Si(Math.atan2(u[0]*p[1]-u[1]*p[0],(v=u)[0]*(x=p)[0]+v[1]*x[1]))},m.cn=sr,m.co=function(a,n){return wo[n]&&(a instanceof MouseEvent||a instanceof WheelEvent)},m.cp=function(a,n){return Is[n]&&"touches"in a},m.cq=function(a){return Is[a]||wo[a]},m.cr=function(a,n,s){var u=n[0],p=n[1];return a[0]=s[0]*u+s[4]*p+s[12],a[1]=s[1]*u+s[5]*p+s[13],a},m.cs=function(a,n){const{x:s,y:u}=uf.fromLngLat(n);return!(a<0||a>25||u<0||u>=1||s<0||s>=1)},m.ct=function(a,n){return a[0]=n[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=n[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=n[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},m.cu=class extends os{},m.cv=wR,m.cx=function(a){return a.message===Ni},m.cy=de,m.cz=function(a,n){Q.REGISTERED_PROTOCOLS[a]=n},m.d=De,m.e=Dt,m.f=a=>l(void 0,void 0,void 0,function*(){if(a.byteLength===0)return createImageBitmap(new ImageData(1,1));const n=new Blob([new Uint8Array(a)],{type:"image/png"});try{return createImageBitmap(n)}catch(s){throw new Error(`Could not load image because of ${s.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),m.g=J,m.h=a=>new Promise((n,s)=>{const u=new Image;u.onload=()=>{n(u),URL.revokeObjectURL(u.src),u.onload=null,window.requestAnimationFrame(()=>{u.src=Yo})},u.onerror=()=>s(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const p=new Blob([new Uint8Array(a)],{type:"image/png"});u.src=a.byteLength?URL.createObjectURL(p):Yo}),m.i=Zr,m.j=(a,n)=>Ee(Dt(a,{type:"json"}),n),m.k=ke,m.l=je,m.m=Ee,m.n=(a,n)=>Ee(Dt(a,{type:"arrayBuffer"}),n),m.o=function(a){return new _v(a).readFields(Hz,[])},m.p=F1,m.q=Yd,m.r=Vn,m.s=jr,m.t=$d,m.u=Xt,m.v=he,m.w=Sr,m.x=Zy,m.y=ec,m.z=Da}),d("worker",["./shared"],function(m){class l{constructor(Q){this.keyCache={},Q&&this.replace(Q)}replace(Q){this._layerConfigs={},this._layers={},this.update(Q,[])}update(Q,J){for(const de of Q){this._layerConfigs[de.id]=de;const we=this._layers[de.id]=m.bI(de);we._featureFilter=m.a9(we.filter),this.keyCache[de.id]&&delete this.keyCache[de.id]}for(const de of J)delete this.keyCache[de],delete this._layerConfigs[de],delete this._layers[de];this.familiesBySource={};const ie=m.cB(Object.values(this._layerConfigs),this.keyCache);for(const de of ie){const we=de.map(ke=>this._layers[ke.id]),Ee=we[0];if(Ee.visibility==="none")continue;const De=Ee.source||"";let Ce=this.familiesBySource[De];Ce||(Ce=this.familiesBySource[De]={});const Ve=Ee.sourceLayer||"_geojsonTileLayer";let je=Ce[Ve];je||(je=Ce[Ve]=[]),je.push(we)}}}class E{constructor(Q){const J={},ie=[];for(const De in Q){const Ce=Q[De],Ve=J[De]={};for(const je in Ce){const ke=Ce[+je];if(!ke||ke.bitmap.width===0||ke.bitmap.height===0)continue;const We={x:0,y:0,w:ke.bitmap.width+2,h:ke.bitmap.height+2};ie.push(We),Ve[je]={rect:We,metrics:ke.metrics}}}const{w:de,h:we}=m.p(ie),Ee=new m.q({width:de||1,height:we||1});for(const De in Q){const Ce=Q[De];for(const Ve in Ce){const je=Ce[+Ve];if(!je||je.bitmap.width===0||je.bitmap.height===0)continue;const ke=J[De][Ve].rect;m.q.copy(je.bitmap,Ee,{x:0,y:0},{x:ke.x+1,y:ke.y+1},je.bitmap)}}this.image=Ee,this.positions=J}}m.cC("GlyphAtlas",E);class P{constructor(Q){this.tileID=new m.Z(Q.tileID.overscaledZ,Q.tileID.wrap,Q.tileID.canonical.z,Q.tileID.canonical.x,Q.tileID.canonical.y),this.uid=Q.uid,this.zoom=Q.zoom,this.pixelRatio=Q.pixelRatio,this.tileSize=Q.tileSize,this.source=Q.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Q.showCollisionBoxes,this.collectResourceTiming=!!Q.collectResourceTiming,this.returnDependencies=!!Q.returnDependencies,this.promoteId=Q.promoteId,this.inFlightDependencies=[],this.globalState=Q.globalState}parse(Q,J,ie,de,we){return m._(this,void 0,void 0,function*(){this.status="parsing",this.data=Q,this.collisionBoxArray=new m.a7;const Ee=new m.cD(Object.keys(Q.layers).sort()),De=new m.cE(this.tileID,this.promoteId);De.bucketLayerIDs=[];const Ce={},Ve={featureIndex:De,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ie,subdivisionGranularity:we},je=J.familiesBySource[this.source];for(const Rt in je){const Jt=Q.layers[Rt];if(!Jt)continue;Jt.version===1&&m.w(`Vector tile source "${this.source}" layer "${Rt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const hn=Ee.encode(Rt),nt=[];for(let bn=0;bn<Jt.length;bn++){const Cr=Jt.feature(bn),Qo=De.getId(Cr,Rt);nt.push({feature:Cr,id:Qo,index:bn,sourceLayerIndex:hn})}for(const bn of je[Rt]){const Cr=bn[0];Cr.source!==this.source&&m.w(`layer.source = ${Cr.source} does not equal this.source = ${this.source}`),Cr.minzoom&&this.zoom<Math.floor(Cr.minzoom)||Cr.maxzoom&&this.zoom>=Cr.maxzoom||Cr.visibility!=="none"&&(R(bn,this.zoom,ie),(Ce[Cr.id]=Cr.createBucket({index:De.bucketLayerIDs.length,layers:bn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:hn,sourceID:this.source,globalState:this.globalState})).populate(nt,Ve,this.tileID.canonical),De.bucketLayerIDs.push(bn.map(Qo=>Qo.id)))}}const ke=m.bM(Ve.glyphDependencies,Rt=>Object.keys(Rt).map(Number));this.inFlightDependencies.forEach(Rt=>Rt==null?void 0:Rt.abort()),this.inFlightDependencies=[];let We=Promise.resolve({});if(Object.keys(ke).length){const Rt=new AbortController;this.inFlightDependencies.push(Rt),We=de.sendAsync({type:"GG",data:{stacks:ke,source:this.source,tileID:this.tileID,type:"glyphs"}},Rt)}const he=Object.keys(Ve.iconDependencies);let Qe=Promise.resolve({});if(he.length){const Rt=new AbortController;this.inFlightDependencies.push(Rt),Qe=de.sendAsync({type:"GI",data:{icons:he,source:this.source,tileID:this.tileID,type:"icons"}},Rt)}const mt=Object.keys(Ve.patternDependencies);let ct=Promise.resolve({});if(mt.length){const Rt=new AbortController;this.inFlightDependencies.push(Rt),ct=de.sendAsync({type:"GI",data:{icons:mt,source:this.source,tileID:this.tileID,type:"patterns"}},Rt)}const[yt,Et,ir]=yield Promise.all([We,Qe,ct]),Nt=new E(yt),Bt=new m.cF(Et,ir);for(const Rt in Ce){const Jt=Ce[Rt];Jt instanceof m.a8?(R(Jt.layers,this.zoom,ie),m.cG({bucket:Jt,glyphMap:yt,glyphPositions:Nt.positions,imageMap:Et,imagePositions:Bt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Ve.subdivisionGranularity})):Jt.hasPattern&&(Jt instanceof m.cH||Jt instanceof m.cI||Jt instanceof m.cJ)&&(R(Jt.layers,this.zoom,ie),Jt.addFeatures(Ve,this.tileID.canonical,Bt.patternPositions))}return this.status="done",{buckets:Object.values(Ce).filter(Rt=>!Rt.isEmpty()),featureIndex:De,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Nt.image,imageAtlas:Bt,glyphMap:this.returnDependencies?yt:null,iconMap:this.returnDependencies?Et:null,glyphPositions:this.returnDependencies?Nt.positions:null}})}}function R(Me,Q,J){const ie=new m.F(Q);for(const de of Me)de.recalculate(ie,J)}class N{constructor(Q,J,ie){this.actor=Q,this.layerIndex=J,this.availableImages=ie,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(Q,J){return m._(this,void 0,void 0,function*(){const ie=yield m.n(Q.request,J);try{return{vectorTile:new m.cK.VectorTile(new m.cL(ie.data)),rawData:ie.data,cacheControl:ie.cacheControl,expires:ie.expires}}catch(de){const we=new Uint8Array(ie.data);let Ee=`Unable to parse the tile at ${Q.request.url}, `;throw Ee+=we[0]===31&&we[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${de.message}`,new Error(Ee)}})}loadTile(Q){return m._(this,void 0,void 0,function*(){const J=Q.uid,ie=!!(Q&&Q.request&&Q.request.collectResourceTiming)&&new m.cM(Q.request),de=new P(Q);this.loading[J]=de;const we=new AbortController;de.abort=we;try{const Ee=yield this.loadVectorTile(Q,we);if(delete this.loading[J],!Ee)return null;const De=Ee.rawData,Ce={};Ee.expires&&(Ce.expires=Ee.expires),Ee.cacheControl&&(Ce.cacheControl=Ee.cacheControl);const Ve={};if(ie){const ke=ie.finish();ke&&(Ve.resourceTiming=JSON.parse(JSON.stringify(ke)))}de.vectorTile=Ee.vectorTile;const je=de.parse(Ee.vectorTile,this.layerIndex,this.availableImages,this.actor,Q.subdivisionGranularity);this.loaded[J]=de,this.fetching[J]={rawTileData:De,cacheControl:Ce,resourceTiming:Ve};try{const ke=yield je;return m.e({rawTileData:De.slice(0)},ke,Ce,Ve)}finally{delete this.fetching[J]}}catch(Ee){throw delete this.loading[J],de.status="done",this.loaded[J]=de,Ee}})}reloadTile(Q){return m._(this,void 0,void 0,function*(){const J=Q.uid;if(!this.loaded||!this.loaded[J])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const ie=this.loaded[J];if(ie.showCollisionBoxes=Q.showCollisionBoxes,ie.globalState=Q.globalState,ie.status==="parsing"){const de=yield ie.parse(ie.vectorTile,this.layerIndex,this.availableImages,this.actor,Q.subdivisionGranularity);let we;if(this.fetching[J]){const{rawTileData:Ee,cacheControl:De,resourceTiming:Ce}=this.fetching[J];delete this.fetching[J],we=m.e({rawTileData:Ee.slice(0)},de,De,Ce)}else we=de;return we}if(ie.status==="done"&&ie.vectorTile)return ie.parse(ie.vectorTile,this.layerIndex,this.availableImages,this.actor,Q.subdivisionGranularity)})}abortTile(Q){return m._(this,void 0,void 0,function*(){const J=this.loading,ie=Q.uid;J&&J[ie]&&J[ie].abort&&(J[ie].abort.abort(),delete J[ie])})}removeTile(Q){return m._(this,void 0,void 0,function*(){this.loaded&&this.loaded[Q.uid]&&delete this.loaded[Q.uid]})}}class F{constructor(){this.loaded={}}loadTile(Q){return m._(this,void 0,void 0,function*(){const{uid:J,encoding:ie,rawImageData:de,redFactor:we,greenFactor:Ee,blueFactor:De,baseShift:Ce}=Q,Ve=de.width+2,je=de.height+2,ke=m.b(de)?new m.R({width:Ve,height:je},yield m.cN(de,-1,-1,Ve,je)):de,We=new m.cO(J,ke,ie,we,Ee,De,Ce);return this.loaded=this.loaded||{},this.loaded[J]=We,We})}removeTile(Q){const J=this.loaded,ie=Q.uid;J&&J[ie]&&delete J[ie]}}var A,X,Z=function(){if(X)return A;function Me(J,ie){if(J.length!==0){Q(J[0],ie);for(var de=1;de<J.length;de++)Q(J[de],!ie)}}function Q(J,ie){for(var de=0,we=0,Ee=0,De=J.length,Ce=De-1;Ee<De;Ce=Ee++){var Ve=(J[Ee][0]-J[Ce][0])*(J[Ce][1]+J[Ee][1]),je=de+Ve;we+=Math.abs(de)>=Math.abs(Ve)?de-je+Ve:Ve-je+de,de=je}de+we>=0!=!!ie&&J.reverse()}return X=1,A=function J(ie,de){var we,Ee=ie&&ie.type;if(Ee==="FeatureCollection")for(we=0;we<ie.features.length;we++)J(ie.features[we],de);else if(Ee==="GeometryCollection")for(we=0;we<ie.geometries.length;we++)J(ie.geometries[we],de);else if(Ee==="Feature")J(ie.geometry,de);else if(Ee==="Polygon")Me(ie.coordinates,de);else if(Ee==="MultiPolygon")for(we=0;we<ie.coordinates.length;we++)Me(ie.coordinates[we],de);return ie}}(),ee=m.cP(Z);const H=m.cK.VectorTileFeature.prototype.toGeoJSON;class U{constructor(Q){this._feature=Q,this.extent=m.$,this.type=Q.type,this.properties=Q.tags,"id"in Q&&!isNaN(Q.id)&&(this.id=parseInt(Q.id,10))}loadGeometry(){if(this._feature.type===1){const Q=[];for(const J of this._feature.geometry)Q.push([new m.P(J[0],J[1])]);return Q}{const Q=[];for(const J of this._feature.geometry){const ie=[];for(const de of J)ie.push(new m.P(de[0],de[1]));Q.push(ie)}return Q}}toGeoJSON(Q,J,ie){return H.call(this,Q,J,ie)}}class W{constructor(Q){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=m.$,this.length=Q.length,this._features=Q}feature(Q){return new U(this._features[Q])}}var re,ge,Te,xe={exports:{}},ze=function(){if(Te)return xe.exports;Te=1;var Me=m.cS(),Q=function(){if(ge)return re;ge=1;var je=m.cQ(),ke=m.cR().VectorTileFeature;function We(Qe,mt){this.options=mt||{},this.features=Qe,this.length=Qe.length}function he(Qe,mt){this.id=typeof Qe.id=="number"?Qe.id:void 0,this.type=Qe.type,this.rawGeometry=Qe.type===1?[Qe.geometry]:Qe.geometry,this.properties=Qe.tags,this.extent=mt||4096}return re=We,We.prototype.feature=function(Qe){return new he(this.features[Qe],this.options.extent)},he.prototype.loadGeometry=function(){var Qe=this.rawGeometry;this.geometry=[];for(var mt=0;mt<Qe.length;mt++){for(var ct=Qe[mt],yt=[],Et=0;Et<ct.length;Et++)yt.push(new je(ct[Et][0],ct[Et][1]));this.geometry.push(yt)}return this.geometry},he.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Qe=this.geometry,mt=1/0,ct=-1/0,yt=1/0,Et=-1/0,ir=0;ir<Qe.length;ir++)for(var Nt=Qe[ir],Bt=0;Bt<Nt.length;Bt++){var Rt=Nt[Bt];mt=Math.min(mt,Rt.x),ct=Math.max(ct,Rt.x),yt=Math.min(yt,Rt.y),Et=Math.max(Et,Rt.y)}return[mt,yt,ct,Et]},he.prototype.toGeoJSON=ke.prototype.toGeoJSON,re}();function J(je){var ke=new Me;return function(We,he){for(var Qe in We.layers)he.writeMessage(3,ie,We.layers[Qe])}(je,ke),ke.finish()}function ie(je,ke){var We;ke.writeVarintField(15,je.version||1),ke.writeStringField(1,je.name||""),ke.writeVarintField(5,je.extent||4096);var he={keys:[],values:[],keycache:{},valuecache:{}};for(We=0;We<je.length;We++)he.feature=je.feature(We),ke.writeMessage(2,de,he);var Qe=he.keys;for(We=0;We<Qe.length;We++)ke.writeStringField(3,Qe[We]);var mt=he.values;for(We=0;We<mt.length;We++)ke.writeMessage(4,Ve,mt[We])}function de(je,ke){var We=je.feature;We.id!==void 0&&ke.writeVarintField(1,We.id),ke.writeMessage(2,we,je),ke.writeVarintField(3,We.type),ke.writeMessage(4,Ce,We)}function we(je,ke){var We=je.feature,he=je.keys,Qe=je.values,mt=je.keycache,ct=je.valuecache;for(var yt in We.properties){var Et=We.properties[yt],ir=mt[yt];if(Et!==null){ir===void 0&&(he.push(yt),mt[yt]=ir=he.length-1),ke.writeVarint(ir);var Nt=typeof Et;Nt!=="string"&&Nt!=="boolean"&&Nt!=="number"&&(Et=JSON.stringify(Et));var Bt=Nt+":"+Et,Rt=ct[Bt];Rt===void 0&&(Qe.push(Et),ct[Bt]=Rt=Qe.length-1),ke.writeVarint(Rt)}}}function Ee(je,ke){return(ke<<3)+(7&je)}function De(je){return je<<1^je>>31}function Ce(je,ke){for(var We=je.loadGeometry(),he=je.type,Qe=0,mt=0,ct=We.length,yt=0;yt<ct;yt++){var Et=We[yt],ir=1;he===1&&(ir=Et.length),ke.writeVarint(Ee(1,ir));for(var Nt=he===3?Et.length-1:Et.length,Bt=0;Bt<Nt;Bt++){Bt===1&&he!==1&&ke.writeVarint(Ee(2,Nt-1));var Rt=Et[Bt].x-Qe,Jt=Et[Bt].y-mt;ke.writeVarint(De(Rt)),ke.writeVarint(De(Jt)),Qe+=Rt,mt+=Jt}he===3&&ke.writeVarint(Ee(7,1))}}function Ve(je,ke){var We=typeof je;We==="string"?ke.writeStringField(1,je):We==="boolean"?ke.writeBooleanField(7,je):We==="number"&&(je%1!=0?ke.writeDoubleField(3,je):je<0?ke.writeSVarintField(6,je):ke.writeVarintField(5,je))}return xe.exports=J,xe.exports.fromVectorTileJs=J,xe.exports.fromGeojsonVt=function(je,ke){ke=ke||{};var We={};for(var he in je)We[he]=new Q(je[he].features,ke),We[he].name=he,We[he].version=ke.version,We[he].extent=ke.extent;return J({layers:We})},xe.exports.GeoJSONWrapper=Q,xe.exports}(),Ne=m.cP(ze);const Ie={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Me=>Me},$e=Math.fround||(et=new Float32Array(1),Me=>(et[0]=+Me,et[0]));var et;class ot{constructor(Q){this.options=Object.assign(Object.create(Ie),Q),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Q){const{log:J,minZoom:ie,maxZoom:de}=this.options;J&&console.time("total time");const we=`prepare ${Q.length} points`;J&&console.time(we),this.points=Q;const Ee=[];for(let Ce=0;Ce<Q.length;Ce++){const Ve=Q[Ce];if(!Ve.geometry)continue;const[je,ke]=Ve.geometry.coordinates,We=$e(dt(je)),he=$e(wt(ke));Ee.push(We,he,1/0,Ce,-1,1),this.options.reduce&&Ee.push(0)}let De=this.trees[de+1]=this._createTree(Ee);J&&console.timeEnd(we);for(let Ce=de;Ce>=ie;Ce--){const Ve=+Date.now();De=this.trees[Ce]=this._createTree(this._cluster(De,Ce)),J&&console.log("z%d: %d clusters in %dms",Ce,De.numItems,+Date.now()-Ve)}return J&&console.timeEnd("total time"),this}getClusters(Q,J){let ie=((Q[0]+180)%360+360)%360-180;const de=Math.max(-90,Math.min(90,Q[1]));let we=Q[2]===180?180:((Q[2]+180)%360+360)%360-180;const Ee=Math.max(-90,Math.min(90,Q[3]));if(Q[2]-Q[0]>=360)ie=-180,we=180;else if(ie>we){const ke=this.getClusters([ie,de,180,Ee],J),We=this.getClusters([-180,de,we,Ee],J);return ke.concat(We)}const De=this.trees[this._limitZoom(J)],Ce=De.range(dt(ie),wt(Ee),dt(we),wt(de)),Ve=De.data,je=[];for(const ke of Ce){const We=this.stride*ke;je.push(Ve[We+5]>1?qe(Ve,We,this.clusterProps):this.points[Ve[We+3]])}return je}getChildren(Q){const J=this._getOriginId(Q),ie=this._getOriginZoom(Q),de="No cluster with the specified id.",we=this.trees[ie];if(!we)throw new Error(de);const Ee=we.data;if(J*this.stride>=Ee.length)throw new Error(de);const De=this.options.radius/(this.options.extent*Math.pow(2,ie-1)),Ce=we.within(Ee[J*this.stride],Ee[J*this.stride+1],De),Ve=[];for(const je of Ce){const ke=je*this.stride;Ee[ke+4]===Q&&Ve.push(Ee[ke+5]>1?qe(Ee,ke,this.clusterProps):this.points[Ee[ke+3]])}if(Ve.length===0)throw new Error(de);return Ve}getLeaves(Q,J,ie){const de=[];return this._appendLeaves(de,Q,J=J||10,ie=ie||0,0),de}getTile(Q,J,ie){const de=this.trees[this._limitZoom(Q)],we=Math.pow(2,Q),{extent:Ee,radius:De}=this.options,Ce=De/Ee,Ve=(ie-Ce)/we,je=(ie+1+Ce)/we,ke={features:[]};return this._addTileFeatures(de.range((J-Ce)/we,Ve,(J+1+Ce)/we,je),de.data,J,ie,we,ke),J===0&&this._addTileFeatures(de.range(1-Ce/we,Ve,1,je),de.data,we,ie,we,ke),J===we-1&&this._addTileFeatures(de.range(0,Ve,Ce/we,je),de.data,-1,ie,we,ke),ke.features.length?ke:null}getClusterExpansionZoom(Q){let J=this._getOriginZoom(Q)-1;for(;J<=this.options.maxZoom;){const ie=this.getChildren(Q);if(J++,ie.length!==1)break;Q=ie[0].properties.cluster_id}return J}_appendLeaves(Q,J,ie,de,we){const Ee=this.getChildren(J);for(const De of Ee){const Ce=De.properties;if(Ce&&Ce.cluster?we+Ce.point_count<=de?we+=Ce.point_count:we=this._appendLeaves(Q,Ce.cluster_id,ie,de,we):we<de?we++:Q.push(De),Q.length===ie)break}return we}_createTree(Q){const J=new m.aH(Q.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ie=0;ie<Q.length;ie+=this.stride)J.add(Q[ie],Q[ie+1]);return J.finish(),J.data=Q,J}_addTileFeatures(Q,J,ie,de,we,Ee){for(const De of Q){const Ce=De*this.stride,Ve=J[Ce+5]>1;let je,ke,We;if(Ve)je=ht(J,Ce,this.clusterProps),ke=J[Ce],We=J[Ce+1];else{const mt=this.points[J[Ce+3]];je=mt.properties;const[ct,yt]=mt.geometry.coordinates;ke=dt(ct),We=wt(yt)}const he={type:1,geometry:[[Math.round(this.options.extent*(ke*we-ie)),Math.round(this.options.extent*(We*we-de))]],tags:je};let Qe;Qe=Ve||this.options.generateId?J[Ce+3]:this.points[J[Ce+3]].id,Qe!==void 0&&(he.id=Qe),Ee.features.push(he)}}_limitZoom(Q){return Math.max(this.options.minZoom,Math.min(Math.floor(+Q),this.options.maxZoom+1))}_cluster(Q,J){const{radius:ie,extent:de,reduce:we,minPoints:Ee}=this.options,De=ie/(de*Math.pow(2,J)),Ce=Q.data,Ve=[],je=this.stride;for(let ke=0;ke<Ce.length;ke+=je){if(Ce[ke+2]<=J)continue;Ce[ke+2]=J;const We=Ce[ke],he=Ce[ke+1],Qe=Q.within(Ce[ke],Ce[ke+1],De),mt=Ce[ke+5];let ct=mt;for(const yt of Qe){const Et=yt*je;Ce[Et+2]>J&&(ct+=Ce[Et+5])}if(ct>mt&&ct>=Ee){let yt,Et=We*mt,ir=he*mt,Nt=-1;const Bt=(ke/je<<5)+(J+1)+this.points.length;for(const Rt of Qe){const Jt=Rt*je;if(Ce[Jt+2]<=J)continue;Ce[Jt+2]=J;const hn=Ce[Jt+5];Et+=Ce[Jt]*hn,ir+=Ce[Jt+1]*hn,Ce[Jt+4]=Bt,we&&(yt||(yt=this._map(Ce,ke,!0),Nt=this.clusterProps.length,this.clusterProps.push(yt)),we(yt,this._map(Ce,Jt)))}Ce[ke+4]=Bt,Ve.push(Et/ct,ir/ct,1/0,Bt,-1,ct),we&&Ve.push(Nt)}else{for(let yt=0;yt<je;yt++)Ve.push(Ce[ke+yt]);if(ct>1)for(const yt of Qe){const Et=yt*je;if(!(Ce[Et+2]<=J)){Ce[Et+2]=J;for(let ir=0;ir<je;ir++)Ve.push(Ce[Et+ir])}}}}return Ve}_getOriginId(Q){return Q-this.points.length>>5}_getOriginZoom(Q){return(Q-this.points.length)%32}_map(Q,J,ie){if(Q[J+5]>1){const Ee=this.clusterProps[Q[J+6]];return ie?Object.assign({},Ee):Ee}const de=this.points[Q[J+3]].properties,we=this.options.map(de);return ie&&we===de?Object.assign({},we):we}}function qe(Me,Q,J){return{type:"Feature",id:Me[Q+3],properties:ht(Me,Q,J),geometry:{type:"Point",coordinates:[(ie=Me[Q],360*(ie-.5)),Ze(Me[Q+1])]}};var ie}function ht(Me,Q,J){const ie=Me[Q+5],de=ie>=1e4?`${Math.round(ie/1e3)}k`:ie>=1e3?Math.round(ie/100)/10+"k":ie,we=Me[Q+6],Ee=we===-1?{}:Object.assign({},J[we]);return Object.assign(Ee,{cluster:!0,cluster_id:Me[Q+3],point_count:ie,point_count_abbreviated:de})}function dt(Me){return Me/360+.5}function wt(Me){const Q=Math.sin(Me*Math.PI/180),J=.5-.25*Math.log((1+Q)/(1-Q))/Math.PI;return J<0?0:J>1?1:J}function Ze(Me){const Q=(180-360*Me)*Math.PI/180;return 360*Math.atan(Math.exp(Q))/Math.PI-90}function He(Me,Q,J,ie){let de=ie;const we=Q+(J-Q>>1);let Ee,De=J-Q;const Ce=Me[Q],Ve=Me[Q+1],je=Me[J],ke=Me[J+1];for(let We=Q+3;We<J;We+=3){const he=pt(Me[We],Me[We+1],Ce,Ve,je,ke);if(he>de)Ee=We,de=he;else if(he===de){const Qe=Math.abs(We-we);Qe<De&&(Ee=We,De=Qe)}}de>ie&&(Ee-Q>3&&He(Me,Q,Ee,ie),Me[Ee+2]=de,J-Ee>3&&He(Me,Ee,J,ie))}function pt(Me,Q,J,ie,de,we){let Ee=de-J,De=we-ie;if(Ee!==0||De!==0){const Ce=((Me-J)*Ee+(Q-ie)*De)/(Ee*Ee+De*De);Ce>1?(J=de,ie=we):Ce>0&&(J+=Ee*Ce,ie+=De*Ce)}return Ee=Me-J,De=Q-ie,Ee*Ee+De*De}function Ct(Me,Q,J,ie){const de={id:Me??null,type:Q,geometry:J,tags:ie,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(Q==="Point"||Q==="MultiPoint"||Q==="LineString")ut(de,J);else if(Q==="Polygon")ut(de,J[0]);else if(Q==="MultiLineString")for(const we of J)ut(de,we);else if(Q==="MultiPolygon")for(const we of J)ut(de,we[0]);return de}function ut(Me,Q){for(let J=0;J<Q.length;J+=3)Me.minX=Math.min(Me.minX,Q[J]),Me.minY=Math.min(Me.minY,Q[J+1]),Me.maxX=Math.max(Me.maxX,Q[J]),Me.maxY=Math.max(Me.maxY,Q[J+1])}function At(Me,Q,J,ie){if(!Q.geometry)return;const de=Q.geometry.coordinates;if(de&&de.length===0)return;const we=Q.geometry.type,Ee=Math.pow(J.tolerance/((1<<J.maxZoom)*J.extent),2);let De=[],Ce=Q.id;if(J.promoteId?Ce=Q.properties[J.promoteId]:J.generateId&&(Ce=ie||0),we==="Point")kt(de,De);else if(we==="MultiPoint")for(const Ve of de)kt(Ve,De);else if(we==="LineString")nr(de,De,Ee,!1);else if(we==="MultiLineString"){if(J.lineMetrics){for(const Ve of de)De=[],nr(Ve,De,Ee,!1),Me.push(Ct(Ce,"LineString",De,Q.properties));return}dr(de,De,Ee,!1)}else if(we==="Polygon")dr(de,De,Ee,!0);else{if(we!=="MultiPolygon"){if(we==="GeometryCollection"){for(const Ve of Q.geometry.geometries)At(Me,{id:Ce,geometry:Ve,properties:Q.properties},J,ie);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Ve of de){const je=[];dr(Ve,je,Ee,!0),De.push(je)}}Me.push(Ct(Ce,we,De,Q.properties))}function kt(Me,Q){Q.push(gt(Me[0]),sr(Me[1]),0)}function nr(Me,Q,J,ie){let de,we,Ee=0;for(let Ce=0;Ce<Me.length;Ce++){const Ve=gt(Me[Ce][0]),je=sr(Me[Ce][1]);Q.push(Ve,je,0),Ce>0&&(Ee+=ie?(de*je-Ve*we)/2:Math.sqrt(Math.pow(Ve-de,2)+Math.pow(je-we,2))),de=Ve,we=je}const De=Q.length-3;Q[2]=1,He(Q,0,De,J),Q[De+2]=1,Q.size=Math.abs(Ee),Q.start=0,Q.end=Q.size}function dr(Me,Q,J,ie){for(let de=0;de<Me.length;de++){const we=[];nr(Me[de],we,J,ie),Q.push(we)}}function gt(Me){return Me/360+.5}function sr(Me){const Q=Math.sin(Me*Math.PI/180),J=.5-.25*Math.log((1+Q)/(1-Q))/Math.PI;return J<0?0:J>1?1:J}function Vt(Me,Q,J,ie,de,we,Ee,De){if(ie/=Q,we>=(J/=Q)&&Ee<ie)return Me;if(Ee<J||we>=ie)return null;const Ce=[];for(const Ve of Me){const je=Ve.geometry;let ke=Ve.type;const We=de===0?Ve.minX:Ve.minY,he=de===0?Ve.maxX:Ve.maxY;if(We>=J&&he<ie){Ce.push(Ve);continue}if(he<J||We>=ie)continue;let Qe=[];if(ke==="Point"||ke==="MultiPoint")tr(je,Qe,J,ie,de);else if(ke==="LineString")Dt(je,Qe,J,ie,de,!1,De.lineMetrics);else if(ke==="MultiLineString")Gt(je,Qe,J,ie,de,!1);else if(ke==="Polygon")Gt(je,Qe,J,ie,de,!0);else if(ke==="MultiPolygon")for(const mt of je){const ct=[];Gt(mt,ct,J,ie,de,!0),ct.length&&Qe.push(ct)}if(Qe.length){if(De.lineMetrics&&ke==="LineString"){for(const mt of Qe)Ce.push(Ct(Ve.id,ke,mt,Ve.tags));continue}ke!=="LineString"&&ke!=="MultiLineString"||(Qe.length===1?(ke="LineString",Qe=Qe[0]):ke="MultiLineString"),ke!=="Point"&&ke!=="MultiPoint"||(ke=Qe.length===3?"Point":"MultiPoint"),Ce.push(Ct(Ve.id,ke,Qe,Ve.tags))}}return Ce.length?Ce:null}function tr(Me,Q,J,ie,de){for(let we=0;we<Me.length;we+=3){const Ee=Me[we+de];Ee>=J&&Ee<=ie&&Rr(Q,Me[we],Me[we+1],Me[we+2])}}function Dt(Me,Q,J,ie,de,we,Ee){let De=Qt(Me);const Ce=de===0?Yr:Nn;let Ve,je,ke=Me.start;for(let ct=0;ct<Me.length-3;ct+=3){const yt=Me[ct],Et=Me[ct+1],ir=Me[ct+2],Nt=Me[ct+3],Bt=Me[ct+4],Rt=de===0?yt:Et,Jt=de===0?Nt:Bt;let hn=!1;Ee&&(Ve=Math.sqrt(Math.pow(yt-Nt,2)+Math.pow(Et-Bt,2))),Rt<J?Jt>J&&(je=Ce(De,yt,Et,Nt,Bt,J),Ee&&(De.start=ke+Ve*je)):Rt>ie?Jt<ie&&(je=Ce(De,yt,Et,Nt,Bt,ie),Ee&&(De.start=ke+Ve*je)):Rr(De,yt,Et,ir),Jt<J&&Rt>=J&&(je=Ce(De,yt,Et,Nt,Bt,J),hn=!0),Jt>ie&&Rt<=ie&&(je=Ce(De,yt,Et,Nt,Bt,ie),hn=!0),!we&&hn&&(Ee&&(De.end=ke+Ve*je),Q.push(De),De=Qt(Me)),Ee&&(ke+=Ve)}let We=Me.length-3;const he=Me[We],Qe=Me[We+1],mt=de===0?he:Qe;mt>=J&&mt<=ie&&Rr(De,he,Qe,Me[We+2]),We=De.length-3,we&&We>=3&&(De[We]!==De[0]||De[We+1]!==De[1])&&Rr(De,De[0],De[1],De[2]),De.length&&Q.push(De)}function Qt(Me){const Q=[];return Q.size=Me.size,Q.start=Me.start,Q.end=Me.end,Q}function Gt(Me,Q,J,ie,de,we){for(const Ee of Me)Dt(Ee,Q,J,ie,de,we,!1)}function Rr(Me,Q,J,ie){Me.push(Q,J,ie)}function Yr(Me,Q,J,ie,de,we){const Ee=(we-Q)/(ie-Q);return Rr(Me,we,J+(de-J)*Ee,1),Ee}function Nn(Me,Q,J,ie,de,we){const Ee=(we-J)/(de-J);return Rr(Me,Q+(ie-Q)*Ee,we,1),Ee}function Sr(Me,Q){const J=[];for(let ie=0;ie<Me.length;ie++){const de=Me[ie],we=de.type;let Ee;if(we==="Point"||we==="MultiPoint"||we==="LineString")Ee=sn(de.geometry,Q);else if(we==="MultiLineString"||we==="Polygon"){Ee=[];for(const De of de.geometry)Ee.push(sn(De,Q))}else if(we==="MultiPolygon"){Ee=[];for(const De of de.geometry){const Ce=[];for(const Ve of De)Ce.push(sn(Ve,Q));Ee.push(Ce)}}J.push(Ct(de.id,we,Ee,de.tags))}return J}function sn(Me,Q){const J=[];J.size=Me.size,Me.start!==void 0&&(J.start=Me.start,J.end=Me.end);for(let ie=0;ie<Me.length;ie+=3)J.push(Me[ie]+Q,Me[ie+1],Me[ie+2]);return J}function Zr(Me,Q){if(Me.transformed)return Me;const J=1<<Me.z,ie=Me.x,de=Me.y;for(const we of Me.features){const Ee=we.geometry,De=we.type;if(we.geometry=[],De===1)for(let Ce=0;Ce<Ee.length;Ce+=2)we.geometry.push(no(Ee[Ce],Ee[Ce+1],Q,J,ie,de));else for(let Ce=0;Ce<Ee.length;Ce++){const Ve=[];for(let je=0;je<Ee[Ce].length;je+=2)Ve.push(no(Ee[Ce][je],Ee[Ce][je+1],Q,J,ie,de));we.geometry.push(Ve)}}return Me.transformed=!0,Me}function no(Me,Q,J,ie,de,we){return[Math.round(J*(Me*ie-de)),Math.round(J*(Q*ie-we))]}function Yn(Me,Q,J,ie,de){const we=Q===de.maxZoom?0:de.tolerance/((1<<Q)*de.extent),Ee={features:[],numPoints:0,numSimplified:0,numFeatures:Me.length,source:null,x:J,y:ie,z:Q,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const De of Me)Yo(Ee,De,we,de);return Ee}function Yo(Me,Q,J,ie){const de=Q.geometry,we=Q.type,Ee=[];if(Me.minX=Math.min(Me.minX,Q.minX),Me.minY=Math.min(Me.minY,Q.minY),Me.maxX=Math.max(Me.maxX,Q.maxX),Me.maxY=Math.max(Me.maxY,Q.maxY),we==="Point"||we==="MultiPoint")for(let De=0;De<de.length;De+=3)Ee.push(de[De],de[De+1]),Me.numPoints++,Me.numSimplified++;else if(we==="LineString")Bn(Ee,de,Me,J,!1,!1);else if(we==="MultiLineString"||we==="Polygon")for(let De=0;De<de.length;De++)Bn(Ee,de[De],Me,J,we==="Polygon",De===0);else if(we==="MultiPolygon")for(let De=0;De<de.length;De++){const Ce=de[De];for(let Ve=0;Ve<Ce.length;Ve++)Bn(Ee,Ce[Ve],Me,J,!0,Ve===0)}if(Ee.length){let De=Q.tags||null;if(we==="LineString"&&ie.lineMetrics){De={};for(const Ve in Q.tags)De[Ve]=Q.tags[Ve];De.mapbox_clip_start=de.start/de.size,De.mapbox_clip_end=de.end/de.size}const Ce={geometry:Ee,type:we==="Polygon"||we==="MultiPolygon"?3:we==="LineString"||we==="MultiLineString"?2:1,tags:De};Q.id!==null&&(Ce.id=Q.id),Me.features.push(Ce)}}function Bn(Me,Q,J,ie,de,we){const Ee=ie*ie;if(ie>0&&Q.size<(de?Ee:ie))return void(J.numPoints+=Q.length/3);const De=[];for(let Ce=0;Ce<Q.length;Ce+=3)(ie===0||Q[Ce+2]>Ee)&&(J.numSimplified++,De.push(Q[Ce],Q[Ce+1])),J.numPoints++;de&&function(Ce,Ve){let je=0;for(let ke=0,We=Ce.length,he=We-2;ke<We;he=ke,ke+=2)je+=(Ce[ke]-Ce[he])*(Ce[ke+1]+Ce[he+1]);if(je>0===Ve)for(let ke=0,We=Ce.length;ke<We/2;ke+=2){const he=Ce[ke],Qe=Ce[ke+1];Ce[ke]=Ce[We-2-ke],Ce[ke+1]=Ce[We-1-ke],Ce[We-2-ke]=he,Ce[We-1-ke]=Qe}}(De,we),Me.push(De)}const Fi={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class bo{constructor(Q,J){const ie=(J=this.options=function(we,Ee){for(const De in Ee)we[De]=Ee[De];return we}(Object.create(Fi),J)).debug;if(ie&&console.time("preprocess data"),J.maxZoom<0||J.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(J.promoteId&&J.generateId)throw new Error("promoteId and generateId cannot be used together.");let de=function(we,Ee){const De=[];if(we.type==="FeatureCollection")for(let Ce=0;Ce<we.features.length;Ce++)At(De,we.features[Ce],Ee,Ce);else At(De,we.type==="Feature"?we:{geometry:we},Ee);return De}(Q,J);this.tiles={},this.tileCoords=[],ie&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",J.indexMaxZoom,J.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),de=function(we,Ee){const De=Ee.buffer/Ee.extent;let Ce=we;const Ve=Vt(we,1,-1-De,De,0,-1,2,Ee),je=Vt(we,1,1-De,2+De,0,-1,2,Ee);return(Ve||je)&&(Ce=Vt(we,1,-De,1+De,0,-1,2,Ee)||[],Ve&&(Ce=Sr(Ve,1).concat(Ce)),je&&(Ce=Ce.concat(Sr(je,-1)))),Ce}(de,J),de.length&&this.splitTile(de,0,0,0),ie&&(de.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(Q,J,ie,de,we,Ee,De){const Ce=[Q,J,ie,de],Ve=this.options,je=Ve.debug;for(;Ce.length;){de=Ce.pop(),ie=Ce.pop(),J=Ce.pop(),Q=Ce.pop();const ke=1<<J,We=jr(J,ie,de);let he=this.tiles[We];if(!he&&(je>1&&console.time("creation"),he=this.tiles[We]=Yn(Q,J,ie,de,Ve),this.tileCoords.push({z:J,x:ie,y:de}),je)){je>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",J,ie,de,he.numFeatures,he.numPoints,he.numSimplified),console.timeEnd("creation"));const hn=`z${J}`;this.stats[hn]=(this.stats[hn]||0)+1,this.total++}if(he.source=Q,we==null){if(J===Ve.indexMaxZoom||he.numPoints<=Ve.indexMaxPoints)continue}else{if(J===Ve.maxZoom||J===we)continue;if(we!=null){const hn=we-J;if(ie!==Ee>>hn||de!==De>>hn)continue}}if(he.source=null,Q.length===0)continue;je>1&&console.time("clipping");const Qe=.5*Ve.buffer/Ve.extent,mt=.5-Qe,ct=.5+Qe,yt=1+Qe;let Et=null,ir=null,Nt=null,Bt=null,Rt=Vt(Q,ke,ie-Qe,ie+ct,0,he.minX,he.maxX,Ve),Jt=Vt(Q,ke,ie+mt,ie+yt,0,he.minX,he.maxX,Ve);Q=null,Rt&&(Et=Vt(Rt,ke,de-Qe,de+ct,1,he.minY,he.maxY,Ve),ir=Vt(Rt,ke,de+mt,de+yt,1,he.minY,he.maxY,Ve),Rt=null),Jt&&(Nt=Vt(Jt,ke,de-Qe,de+ct,1,he.minY,he.maxY,Ve),Bt=Vt(Jt,ke,de+mt,de+yt,1,he.minY,he.maxY,Ve),Jt=null),je>1&&console.timeEnd("clipping"),Ce.push(Et||[],J+1,2*ie,2*de),Ce.push(ir||[],J+1,2*ie,2*de+1),Ce.push(Nt||[],J+1,2*ie+1,2*de),Ce.push(Bt||[],J+1,2*ie+1,2*de+1)}}getTile(Q,J,ie){Q=+Q,J=+J,ie=+ie;const de=this.options,{extent:we,debug:Ee}=de;if(Q<0||Q>24)return null;const De=1<<Q,Ce=jr(Q,J=J+De&De-1,ie);if(this.tiles[Ce])return Zr(this.tiles[Ce],we);Ee>1&&console.log("drilling down to z%d-%d-%d",Q,J,ie);let Ve,je=Q,ke=J,We=ie;for(;!Ve&&je>0;)je--,ke>>=1,We>>=1,Ve=this.tiles[jr(je,ke,We)];return Ve&&Ve.source?(Ee>1&&(console.log("found parent tile z%d-%d-%d",je,ke,We),console.time("drilling down")),this.splitTile(Ve.source,je,ke,We,Q,J,ie),Ee>1&&console.timeEnd("drilling down"),this.tiles[Ce]?Zr(this.tiles[Ce],we):null):null}}function jr(Me,Q,J){return 32*((1<<Me)*J+Q)+Me}function Qr(Me,Q){return Q?Me.properties[Q]:Me.id}function Si(Me,Q){if(Me==null)return!0;if(Me.type==="Feature")return Qr(Me,Q)!=null;if(Me.type==="FeatureCollection"){const J=new Set;for(const ie of Me.features){const de=Qr(ie,Q);if(de==null||J.has(de))return!1;J.add(de)}return!0}return!1}function Is(Me,Q){const J=new Map;if(Me!=null)if(Me.type==="Feature")J.set(Qr(Me,Q),Me);else for(const ie of Me.features)J.set(Qr(ie,Q),ie);return J}class wo extends N{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(Q,J){return m._(this,void 0,void 0,function*(){const ie=Q.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const de=this._geoJSONIndex.getTile(ie.z,ie.x,ie.y);if(!de)return null;const we=new W(de.features);let Ee=Ne(we);return Ee.byteOffset===0&&Ee.byteLength===Ee.buffer.byteLength||(Ee=new Uint8Array(Ee)),{vectorTile:we,rawData:Ee.buffer}})}loadData(Q){return m._(this,void 0,void 0,function*(){var J;(J=this._pendingRequest)===null||J===void 0||J.abort();const ie=!!(Q&&Q.request&&Q.request.collectResourceTiming)&&new m.cM(Q.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(Q,this._pendingRequest),this._geoJSONIndex=Q.cluster?new ot(function({superclusterOptions:Ee,clusterProperties:De}){if(!De||!Ee)return Ee;const Ce={},Ve={},je={accumulated:null,zoom:0},ke={properties:null},We=Object.keys(De);for(const he of We){const[Qe,mt]=De[he],ct=m.cT(mt),yt=m.cT(typeof Qe=="string"?[Qe,["accumulated"],["get",he]]:Qe);Ce[he]=ct.value,Ve[he]=yt.value}return Ee.map=he=>{ke.properties=he;const Qe={};for(const mt of We)Qe[mt]=Ce[mt].evaluate(je,ke);return Qe},Ee.reduce=(he,Qe)=>{ke.properties=Qe;for(const mt of We)je.accumulated=he[mt],he[mt]=Ve[mt].evaluate(je,ke)},Ee}(Q)).load((yield this._pendingData).features):(de=yield this._pendingData,new bo(de,Q.geojsonVtOptions)),this.loaded={};const we={};if(ie){const Ee=ie.finish();Ee&&(we.resourceTiming={},we.resourceTiming[Q.source]=JSON.parse(JSON.stringify(Ee)))}return we}catch(we){if(delete this._pendingRequest,m.cx(we))return{abandoned:!0};throw we}var de})}getData(){return m._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(Q){const J=this.loaded;return J&&J[Q.uid]?super.reloadTile(Q):this.loadTile(Q)}loadAndProcessGeoJSON(Q,J){return m._(this,void 0,void 0,function*(){let ie=yield this.loadGeoJSON(Q,J);if(delete this._pendingRequest,typeof ie!="object")throw new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`);if(ee(ie,!0),Q.filter){const de=m.cT(Q.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(de.result==="error")throw new Error(de.value.map(Ee=>`${Ee.key}: ${Ee.message}`).join(", "));ie={type:"FeatureCollection",features:ie.features.filter(Ee=>de.value.evaluate({zoom:0},Ee))}}return ie})}loadGeoJSON(Q,J){return m._(this,void 0,void 0,function*(){const{promoteId:ie}=Q;if(Q.request){const de=yield m.j(Q.request,J);return this._dataUpdateable=Si(de.data,ie)?Is(de.data,ie):void 0,de.data}if(typeof Q.data=="string")try{const de=JSON.parse(Q.data);return this._dataUpdateable=Si(de,ie)?Is(de,ie):void 0,de}catch{throw new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`)}if(!Q.dataDiff)throw new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${Q.source}`);return function(de,we,Ee){var De,Ce,Ve,je;if(we.removeAll&&de.clear(),we.remove)for(const ke of we.remove)de.delete(ke);if(we.add)for(const ke of we.add){const We=Qr(ke,Ee);We!=null&&de.set(We,ke)}if(we.update)for(const ke of we.update){let We=de.get(ke.id);if(We==null)continue;const he=!ke.removeAllProperties&&(((De=ke.removeProperties)===null||De===void 0?void 0:De.length)>0||((Ce=ke.addOrUpdateProperties)===null||Ce===void 0?void 0:Ce.length)>0);if((ke.newGeometry||ke.removeAllProperties||he)&&(We=Object.assign({},We),de.set(ke.id,We),he&&(We.properties=Object.assign({},We.properties))),ke.newGeometry&&(We.geometry=ke.newGeometry),ke.removeAllProperties)We.properties={};else if(((Ve=ke.removeProperties)===null||Ve===void 0?void 0:Ve.length)>0)for(const Qe of ke.removeProperties)Object.prototype.hasOwnProperty.call(We.properties,Qe)&&delete We.properties[Qe];if(((je=ke.addOrUpdateProperties)===null||je===void 0?void 0:je.length)>0)for(const{key:Qe,value:mt}of ke.addOrUpdateProperties)We.properties[Qe]=mt}}(this._dataUpdateable,Q.dataDiff,ie),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(Q){return m._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(Q){return this._geoJSONIndex.getClusterExpansionZoom(Q.clusterId)}getClusterChildren(Q){return this._geoJSONIndex.getChildren(Q.clusterId)}getClusterLeaves(Q){return this._geoJSONIndex.getLeaves(Q.clusterId,Q.limit,Q.offset)}}class Ni{constructor(Q){this.self=Q,this.actor=new m.J(Q),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(J,ie)=>{if(this.externalWorkerSourceTypes[J])throw new Error(`Worker source with name "${J}" already registered.`);this.externalWorkerSourceTypes[J]=ie},this.self.addProtocol=m.cz,this.self.removeProtocol=m.cA,this.self.registerRTLTextPlugin=J=>{m.cU.setMethods(J)},this.actor.registerMessageHandler("LDT",(J,ie)=>this._getDEMWorkerSource(J,ie.source).loadTile(ie)),this.actor.registerMessageHandler("RDT",(J,ie)=>m._(this,void 0,void 0,function*(){this._getDEMWorkerSource(J,ie.source).removeTile(ie)})),this.actor.registerMessageHandler("GCEZ",(J,ie)=>m._(this,void 0,void 0,function*(){return this._getWorkerSource(J,ie.type,ie.source).getClusterExpansionZoom(ie)})),this.actor.registerMessageHandler("GCC",(J,ie)=>m._(this,void 0,void 0,function*(){return this._getWorkerSource(J,ie.type,ie.source).getClusterChildren(ie)})),this.actor.registerMessageHandler("GCL",(J,ie)=>m._(this,void 0,void 0,function*(){return this._getWorkerSource(J,ie.type,ie.source).getClusterLeaves(ie)})),this.actor.registerMessageHandler("LD",(J,ie)=>this._getWorkerSource(J,ie.type,ie.source).loadData(ie)),this.actor.registerMessageHandler("GD",(J,ie)=>this._getWorkerSource(J,ie.type,ie.source).getData()),this.actor.registerMessageHandler("LT",(J,ie)=>this._getWorkerSource(J,ie.type,ie.source).loadTile(ie)),this.actor.registerMessageHandler("RT",(J,ie)=>this._getWorkerSource(J,ie.type,ie.source).reloadTile(ie)),this.actor.registerMessageHandler("AT",(J,ie)=>this._getWorkerSource(J,ie.type,ie.source).abortTile(ie)),this.actor.registerMessageHandler("RMT",(J,ie)=>this._getWorkerSource(J,ie.type,ie.source).removeTile(ie)),this.actor.registerMessageHandler("RS",(J,ie)=>m._(this,void 0,void 0,function*(){if(!this.workerSources[J]||!this.workerSources[J][ie.type]||!this.workerSources[J][ie.type][ie.source])return;const de=this.workerSources[J][ie.type][ie.source];delete this.workerSources[J][ie.type][ie.source],de.removeSource!==void 0&&de.removeSource(ie)})),this.actor.registerMessageHandler("RM",J=>m._(this,void 0,void 0,function*(){delete this.layerIndexes[J],delete this.availableImages[J],delete this.workerSources[J],delete this.demWorkerSources[J]})),this.actor.registerMessageHandler("SR",(J,ie)=>m._(this,void 0,void 0,function*(){this.referrer=ie})),this.actor.registerMessageHandler("SRPS",(J,ie)=>this._syncRTLPluginState(J,ie)),this.actor.registerMessageHandler("IS",(J,ie)=>m._(this,void 0,void 0,function*(){this.self.importScripts(ie)})),this.actor.registerMessageHandler("SI",(J,ie)=>this._setImages(J,ie)),this.actor.registerMessageHandler("UL",(J,ie)=>m._(this,void 0,void 0,function*(){this._getLayerIndex(J).update(ie.layers,ie.removedIds)})),this.actor.registerMessageHandler("SL",(J,ie)=>m._(this,void 0,void 0,function*(){this._getLayerIndex(J).replace(ie)}))}_setImages(Q,J){return m._(this,void 0,void 0,function*(){this.availableImages[Q]=J;for(const ie in this.workerSources[Q]){const de=this.workerSources[Q][ie];for(const we in de)de[we].availableImages=J}})}_syncRTLPluginState(Q,J){return m._(this,void 0,void 0,function*(){return yield m.cU.syncState(J,this.self.importScripts)})}_getAvailableImages(Q){let J=this.availableImages[Q];return J||(J=[]),J}_getLayerIndex(Q){let J=this.layerIndexes[Q];return J||(J=this.layerIndexes[Q]=new l),J}_getWorkerSource(Q,J,ie){if(this.workerSources[Q]||(this.workerSources[Q]={}),this.workerSources[Q][J]||(this.workerSources[Q][J]={}),!this.workerSources[Q][J][ie]){const de={sendAsync:(we,Ee)=>(we.targetMapId=Q,this.actor.sendAsync(we,Ee))};switch(J){case"vector":this.workerSources[Q][J][ie]=new N(de,this._getLayerIndex(Q),this._getAvailableImages(Q));break;case"geojson":this.workerSources[Q][J][ie]=new wo(de,this._getLayerIndex(Q),this._getAvailableImages(Q));break;default:this.workerSources[Q][J][ie]=new this.externalWorkerSourceTypes[J](de,this._getLayerIndex(Q),this._getAvailableImages(Q))}}return this.workerSources[Q][J][ie]}_getDEMWorkerSource(Q,J){return this.demWorkerSources[Q]||(this.demWorkerSources[Q]={}),this.demWorkerSources[Q][J]||(this.demWorkerSources[Q][J]=new F),this.demWorkerSources[Q][J]}}return m.i(self)&&(self.worker=new Ni(self)),Ni}),d("index",["exports","./shared"],function(m,l){var E="5.6.1";function P(){var _=new l.A(4);return l.A!=Float32Array&&(_[1]=0,_[2]=0),_[0]=1,_[3]=1,_}let R,N;const F={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(_,t,o){const h=requestAnimationFrame(y=>{f(),t(y)}),{unsubscribe:f}=l.s(_.signal,"abort",()=>{f(),cancelAnimationFrame(h),o(l.c())},!1)},frameAsync(_){return new Promise((t,o)=>{this.frame(_,t,o)})},getImageData(_,t=0){return this.getImageCanvasContext(_).getImageData(-t,-t,_.width+2*t,_.height+2*t)},getImageCanvasContext(_){const t=window.document.createElement("canvas"),o=t.getContext("2d",{willReadFrequently:!0});if(!o)throw new Error("failed to create canvas 2d context");return t.width=_.width,t.height=_.height,o.drawImage(_,0,0,_.width,_.height),o},resolveURL:_=>(R||(R=document.createElement("a")),R.href=_,R.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(N==null&&(N=matchMedia("(prefers-reduced-motion: reduce)")),N.matches)}};class A{static testProp(t){if(!A.docStyle)return t[0];for(let o=0;o<t.length;o++)if(t[o]in A.docStyle)return t[o];return t[0]}static create(t,o,h){const f=window.document.createElement(t);return o!==void 0&&(f.className=o),h&&h.appendChild(f),f}static createNS(t,o){return window.document.createElementNS(t,o)}static disableDrag(){A.docStyle&&A.selectProp&&(A.userSelect=A.docStyle[A.selectProp],A.docStyle[A.selectProp]="none")}static enableDrag(){A.docStyle&&A.selectProp&&(A.docStyle[A.selectProp]=A.userSelect)}static setTransform(t,o){t.style[A.transformProp]=o}static addEventListener(t,o,h,f={}){t.addEventListener(o,h,"passive"in f?f:f.capture)}static removeEventListener(t,o,h,f={}){t.removeEventListener(o,h,"passive"in f?f:f.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",A.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",A.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",A.suppressClickInternal,!0)},0)}static getScale(t){const o=t.getBoundingClientRect();return{x:o.width/t.offsetWidth||1,y:o.height/t.offsetHeight||1,boundingClientRect:o}}static getPoint(t,o,h){const f=o.boundingClientRect;return new l.P((h.clientX-f.left)/o.x-t.clientLeft,(h.clientY-f.top)/o.y-t.clientTop)}static mousePos(t,o){const h=A.getScale(t);return A.getPoint(t,h,o)}static touchPos(t,o){const h=[],f=A.getScale(t);for(let y=0;y<o.length;y++)h.push(A.getPoint(t,f,o[y]));return h}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}static sanitize(t){const o=new DOMParser().parseFromString(t,"text/html").body||document.createElement("body"),h=o.querySelectorAll("script");for(const f of h)f.remove();return A.clean(o),o.innerHTML}static isPossiblyDangerous(t,o){const h=o.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(t)||!h.includes("javascript:")&&!h.includes("data:"))||!!t.startsWith("on")||void 0}static clean(t){const o=t.children;for(const h of o)A.removeAttributes(h),A.clean(h)}static removeAttributes(t){for(const{name:o,value:h}of t.attributes)A.isPossiblyDangerous(o,h)&&t.removeAttribute(o)}}A.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,A.selectProp=A.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),A.transformProp=A.testProp(["transform","WebkitTransform"]);const X={supported:!1,testSupport:function(_){!H&&ee&&(U?W(_):Z=_)}};let Z,ee,H=!1,U=!1;function W(_){const t=_.createTexture();_.bindTexture(_.TEXTURE_2D,t);try{if(_.texImage2D(_.TEXTURE_2D,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,ee),_.isContextLost())return;X.supported=!0}catch{}_.deleteTexture(t),H=!0}var re;typeof document<"u"&&(ee=document.createElement("img"),ee.onload=()=>{Z&&W(Z),Z=null,U=!0},ee.onerror=()=>{H=!0,Z=null},ee.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(_){let t,o,h,f;_.resetRequestQueue=()=>{t=[],o=0,h=0,f={}},_.addThrottleControl=C=>{const k=h++;return f[k]=C,k},_.removeThrottleControl=C=>{delete f[C],b()},_.getImage=(C,k,z=!0)=>new Promise((O,L)=>{X.supported&&(C.headers||(C.headers={}),C.headers.accept="image/webp,*/*"),l.e(C,{type:"image"}),t.push({abortController:k,requestParameters:C,supportImageRefresh:z,state:"queued",onError:j=>{L(j)},onSuccess:j=>{O(j)}}),b()});const y=C=>l._(this,void 0,void 0,function*(){C.state="running";const{requestParameters:k,supportImageRefresh:z,onError:O,onSuccess:L,abortController:j}=C,q=z===!1&&!l.i(self)&&!l.g(k.url)&&(!k.headers||Object.keys(k.headers).reduce((ae,ce)=>ae&&ce==="accept",!0));o++;const se=q?S(k,j):l.m(k,j);try{const ae=yield se;delete C.abortController,C.state="completed",ae.data instanceof HTMLImageElement||l.b(ae.data)?L(ae):ae.data&&L({data:yield(oe=ae.data,typeof createImageBitmap=="function"?l.f(oe):l.h(oe)),cacheControl:ae.cacheControl,expires:ae.expires})}catch(ae){delete C.abortController,O(ae)}finally{o--,b()}var oe}),b=()=>{const C=(()=>{for(const k of Object.keys(f))if(f[k]())return!0;return!1})()?l.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:l.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let k=o;k<C&&t.length>0;k++){const z=t.shift();z.abortController.signal.aborted?k--:y(z)}},S=(C,k)=>new Promise((z,O)=>{const L=new Image,j=C.url,q=C.credentials;q&&q==="include"?L.crossOrigin="use-credentials":(q&&q==="same-origin"||!l.d(j))&&(L.crossOrigin="anonymous"),k.signal.addEventListener("abort",()=>{L.src="",O(l.c())}),L.fetchPriority="high",L.onload=()=>{L.onerror=L.onload=null,z({data:L})},L.onerror=()=>{L.onerror=L.onload=null,k.signal.aborted||O(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},L.src=j})}(re||(re={})),re.resetRequestQueue();class ge{constructor(t){this._transformRequestFn=t}transformRequest(t,o){return this._transformRequestFn&&this._transformRequestFn(t,o)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function Te(_){const t=[];if(typeof _=="string")t.push({id:"default",url:_});else if(_&&_.length>0){const o=[];for(const{id:h,url:f}of _){const y=`${h}${f}`;o.indexOf(y)===-1&&(o.push(y),t.push({id:h,url:f}))}}return t}function xe(_,t,o){try{const h=new URL(_);return h.pathname+=`${t}${o}`,h.toString()}catch{throw new Error(`Invalid sprite URL "${_}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function ze(_){const{userImage:t}=_;return!!(t&&t.render&&t.render())&&(_.data.replace(new Uint8Array(t.data.buffer)),!0)}class Ne extends l.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:o,promiseResolve:h}of this.requestors)h(this._getImagesForIds(o));this.requestors=[]}}getImage(t){const o=this.images[t];if(o&&!o.data&&o.spriteData){const h=o.spriteData;o.data=new l.R({width:h.width,height:h.height},h.context.getImageData(h.x,h.y,h.width,h.height).data),o.spriteData=null}return o}addImage(t,o){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,o)&&(this.images[t]=o)}_validate(t,o){let h=!0;const f=o.data||o.spriteData;return this._validateStretch(o.stretchX,f&&f.width)||(this.fire(new l.k(new Error(`Image "${t}" has invalid "stretchX" value`))),h=!1),this._validateStretch(o.stretchY,f&&f.height)||(this.fire(new l.k(new Error(`Image "${t}" has invalid "stretchY" value`))),h=!1),this._validateContent(o.content,o)||(this.fire(new l.k(new Error(`Image "${t}" has invalid "content" value`))),h=!1),h}_validateStretch(t,o){if(!t)return!0;let h=0;for(const f of t){if(f[0]<h||f[1]<f[0]||o<f[1])return!1;h=f[1]}return!0}_validateContent(t,o){if(!t)return!0;if(t.length!==4)return!1;const h=o.spriteData,f=h&&h.width||o.data.width,y=h&&h.height||o.data.height;return!(t[0]<0||f<t[0]||t[1]<0||y<t[1]||t[2]<0||f<t[2]||t[3]<0||y<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,o,h=!0){const f=this.getImage(t);if(h&&(f.data.width!==o.data.width||f.data.height!==o.data.height))throw new Error(`size mismatch between old image (${f.data.width}x${f.data.height}) and new image (${o.data.width}x${o.data.height}).`);o.version=f.version+1,this.images[t]=o,this.updatedImages[t]=!0}removeImage(t){const o=this.images[t];delete this.images[t],delete this.patterns[t],o.userImage&&o.userImage.onRemove&&o.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise((o,h)=>{let f=!0;if(!this.isLoaded())for(const y of t)this.images[y]||(f=!1);this.isLoaded()||f?o(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:o})})}_getImagesForIds(t){const o={};for(const h of t){let f=this.getImage(h);f||(this.fire(new l.l("styleimagemissing",{id:h})),f=this.getImage(h)),f?o[h]={data:f.data.clone(),pixelRatio:f.pixelRatio,sdf:f.sdf,version:f.version,stretchX:f.stretchX,stretchY:f.stretchY,content:f.content,textFitWidth:f.textFitWidth,textFitHeight:f.textFitHeight,hasRenderCallback:!!(f.userImage&&f.userImage.render)}:l.w(`Image "${h}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return o}getPixelSize(){const{width:t,height:o}=this.atlasImage;return{width:t,height:o}}getPattern(t){const o=this.patterns[t],h=this.getImage(t);if(!h)return null;if(o&&o.position.version===h.version)return o.position;if(o)o.position.version=h.version;else{const f={w:h.data.width+2,h:h.data.height+2,x:0,y:0},y=new l.I(f,h);this.patterns[t]={bin:f,position:y}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const o=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new l.T(t,this.atlasImage,o.RGBA),this.atlasTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const y in this.patterns)t.push(this.patterns[y].bin);const{w:o,h}=l.p(t),f=this.atlasImage;f.resize({width:o||1,height:h||1});for(const y in this.patterns){const{bin:b}=this.patterns[y],S=b.x+1,C=b.y+1,k=this.getImage(y).data,z=k.width,O=k.height;l.R.copy(k,f,{x:0,y:0},{x:S,y:C},{width:z,height:O}),l.R.copy(k,f,{x:0,y:O-1},{x:S,y:C-1},{width:z,height:1}),l.R.copy(k,f,{x:0,y:0},{x:S,y:C+O},{width:z,height:1}),l.R.copy(k,f,{x:z-1,y:0},{x:S-1,y:C},{width:1,height:O}),l.R.copy(k,f,{x:0,y:0},{x:S+z,y:C},{width:1,height:O})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const o of t){if(this.callbackDispatchedThisFrame[o])continue;this.callbackDispatchedThisFrame[o]=!0;const h=this.getImage(o);h||l.w(`Image with ID: "${o}" was not found`),ze(h)&&this.updateImage(o,h)}}}const Ie=1e20;function $e(_,t,o,h,f,y,b,S,C){for(let k=t;k<t+h;k++)et(_,o*y+k,y,f,b,S,C);for(let k=o;k<o+f;k++)et(_,k*y+t,1,h,b,S,C)}function et(_,t,o,h,f,y,b){y[0]=0,b[0]=-Ie,b[1]=Ie,f[0]=_[t];for(let S=1,C=0,k=0;S<h;S++){f[S]=_[t+S*o];const z=S*S;do{const O=y[C];k=(f[S]-f[O]+z-O*O)/(S-O)/2}while(k<=b[C]&&--C>-1);C++,y[C]=S,b[C]=k,b[C+1]=Ie}for(let S=0,C=0;S<h;S++){for(;b[C+1]<S;)C++;const k=y[C],z=S-k;_[t+S*o]=f[k]+z*z}}class ot{constructor(t,o){this.requestManager=t,this.localIdeographFontFamily=o,this.entries={}}setURL(t){this.url=t}getGlyphs(t){return l._(this,void 0,void 0,function*(){const o=[];for(const y in t)for(const b of t[y])o.push(this._getAndCacheGlyphsPromise(y,b));const h=yield Promise.all(o),f={};for(const{stack:y,id:b,glyph:S}of h)f[y]||(f[y]={}),f[y][b]=S&&{id:S.id,bitmap:S.bitmap.clone(),metrics:S.metrics};return f})}_getAndCacheGlyphsPromise(t,o){return l._(this,void 0,void 0,function*(){let h=this.entries[t];h||(h=this.entries[t]={glyphs:{},requests:{},ranges:{}});let f=h.glyphs[o];if(f!==void 0)return{stack:t,id:o,glyph:f};if(f=this._tinySDF(h,t,o),f)return h.glyphs[o]=f,{stack:t,id:o,glyph:f};const y=Math.floor(o/256);if(256*y>65535)throw new Error("glyphs > 65535 not supported");if(h.ranges[y])return{stack:t,id:o,glyph:f};if(!this.url)throw new Error("glyphsUrl is not set");if(!h.requests[y]){const S=ot.loadGlyphRange(t,y,this.url,this.requestManager);h.requests[y]=S}const b=yield h.requests[y];for(const S in b)this._doesCharSupportLocalGlyph(+S)||(h.glyphs[+S]=b[+S]);return h.ranges[y]=!0,{stack:t,id:o,glyph:b[o]||null}})}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(t))||l.u["CJK Unified Ideographs"](t)||l.u["Hangul Syllables"](t)||l.u.Hiragana(t)||l.u.Katakana(t)||l.u["CJK Symbols and Punctuation"](t)||l.u["Halfwidth and Fullwidth Forms"](t))}_tinySDF(t,o,h){const f=this.localIdeographFontFamily;if(!f||!this._doesCharSupportLocalGlyph(h))return;let y=t.tinySDF;if(!y){let S="400";/bold/i.test(o)?S="900":/medium/i.test(o)?S="500":/light/i.test(o)&&(S="200"),y=t.tinySDF=new ot.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:f,fontWeight:S})}const b=y.draw(String.fromCharCode(h));return{id:h,bitmap:new l.q({width:b.width||60,height:b.height||60},b.data),metrics:{width:b.glyphWidth/2||24,height:b.glyphHeight/2||24,left:b.glyphLeft/2+.5||0,top:b.glyphTop/2-27.5||-8,advance:b.glyphAdvance/2||24,isDoubleResolution:!0}}}}ot.loadGlyphRange=function(_,t,o,h){return l._(this,void 0,void 0,function*(){const f=256*t,y=f+255,b=h.transformRequest(o.replace("{fontstack}",_).replace("{range}",`${f}-${y}`),"Glyphs"),S=yield l.n(b,new AbortController);if(!S||!S.data)throw new Error(`Could not load glyph range. range: ${t}, ${f}-${y}`);const C={};for(const k of l.o(S.data))C[k.id]=k;return C})},ot.TinySDF=class{constructor({fontSize:_=24,buffer:t=3,radius:o=8,cutoff:h=.25,fontFamily:f="sans-serif",fontWeight:y="normal",fontStyle:b="normal"}={}){this.buffer=t,this.cutoff=h,this.radius=o;const S=this.size=_+4*t,C=this._createCanvas(S),k=this.ctx=C.getContext("2d",{willReadFrequently:!0});k.font=`${b} ${y} ${_}px ${f}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Uint16Array(S)}_createCanvas(_){const t=document.createElement("canvas");return t.width=t.height=_,t}draw(_){const{width:t,actualBoundingBoxAscent:o,actualBoundingBoxDescent:h,actualBoundingBoxLeft:f,actualBoundingBoxRight:y}=this.ctx.measureText(_),b=Math.ceil(o),S=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-f))),C=Math.min(this.size-this.buffer,b+Math.ceil(h)),k=S+2*this.buffer,z=C+2*this.buffer,O=Math.max(k*z,0),L=new Uint8ClampedArray(O),j={data:L,width:k,height:z,glyphWidth:S,glyphHeight:C,glyphTop:b,glyphLeft:0,glyphAdvance:t};if(S===0||C===0)return j;const{ctx:q,buffer:se,gridInner:oe,gridOuter:ae}=this;q.clearRect(se,se,S,C),q.fillText(_,se,se+b);const ce=q.getImageData(se,se,S,C);ae.fill(Ie,0,O),oe.fill(0,0,O);for(let pe=0;pe<C;pe++)for(let ue=0;ue<S;ue++){const ve=ce.data[4*(pe*S+ue)+3]/255;if(ve===0)continue;const be=(pe+se)*k+ue+se;if(ve===1)ae[be]=0,oe[be]=Ie;else{const fe=.5-ve;ae[be]=fe>0?fe*fe:0,oe[be]=fe<0?fe*fe:0}}$e(ae,0,0,k,z,k,this.f,this.v,this.z),$e(oe,se,se,S,C,k,this.f,this.v,this.z);for(let pe=0;pe<O;pe++){const ue=Math.sqrt(ae[pe])-Math.sqrt(oe[pe]);L[pe]=Math.round(255-255*(ue/this.radius+this.cutoff))}return j}};class qe{constructor(){this.specification=l.v.light.position}possiblyEvaluate(t,o){return l.B(t.expression.evaluate(o))}interpolate(t,o,h){return{x:l.C.number(t.x,o.x,h),y:l.C.number(t.y,o.y,h),z:l.C.number(t.z,o.z,h)}}}let ht;class dt extends l.E{constructor(t){super(),ht=ht||new l.r({anchor:new l.D(l.v.light.anchor),position:new qe,color:new l.D(l.v.light.color),intensity:new l.D(l.v.light.intensity)}),this._transitionable=new l.t(ht),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,o={}){if(!this._validate(l.x,t,o))for(const h in t){const f=t[h];h.endsWith("-transition")?this._transitionable.setTransition(h.slice(0,-11),f):this._transitionable.setValue(h,f)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,o,h){return(!h||h.validate!==!1)&&l.y(this,t.call(l.z,{value:o,style:{glyphs:!0,sprite:!0},styleSpec:l.v}))}}const wt=new l.r({"sky-color":new l.D(l.v.sky["sky-color"]),"horizon-color":new l.D(l.v.sky["horizon-color"]),"fog-color":new l.D(l.v.sky["fog-color"]),"fog-ground-blend":new l.D(l.v.sky["fog-ground-blend"]),"horizon-fog-blend":new l.D(l.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new l.D(l.v.sky["sky-horizon-blend"]),"atmosphere-blend":new l.D(l.v.sky["atmosphere-blend"])});class Ze extends l.E{constructor(t){super(),this._transitionable=new l.t(wt),this.setSky(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new l.F(0))}setSky(t,o={}){if(!this._validate(l.G,t,o)){t||(t={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const h in t){const f=t[h];h.endsWith("-transition")?this._transitionable.setTransition(h.slice(0,-11),f):this._transitionable.setValue(h,f)}}}getSky(){return this._transitionable.serialize()}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,o,h={}){return(h==null?void 0:h.validate)!==!1&&l.y(this,t.call(l.z,l.e({value:o,style:{glyphs:!0,sprite:!0},styleSpec:l.v})))}calculateFogBlendOpacity(t){return t<60?0:t<70?(t-60)/10:1}}class He{constructor(t,o){this.width=t,this.height=o,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,o){const h=t.join(",")+String(o);return this.dashEntry[h]||(this.dashEntry[h]=this.addDash(t,o)),this.dashEntry[h]}getDashRanges(t,o,h){const f=[];let y=t.length%2==1?-t[t.length-1]*h:0,b=t[0]*h,S=!0;f.push({left:y,right:b,isDash:S,zeroLength:t[0]===0});let C=t[0];for(let k=1;k<t.length;k++){S=!S;const z=t[k];y=C*h,C+=z,b=C*h,f.push({left:y,right:b,isDash:S,zeroLength:z===0})}return f}addRoundDash(t,o,h){const f=o/2;for(let y=-h;y<=h;y++){const b=this.width*(this.nextRow+h+y);let S=0,C=t[S];for(let k=0;k<this.width;k++){k/C.right>1&&(C=t[++S]);const z=Math.abs(k-C.left),O=Math.abs(k-C.right),L=Math.min(z,O);let j;const q=y/h*(f+1);if(C.isDash){const se=f-Math.abs(q);j=Math.sqrt(L*L+se*se)}else j=f-Math.sqrt(L*L+q*q);this.data[b+k]=Math.max(0,Math.min(255,j+128))}}}addRegularDash(t){for(let S=t.length-1;S>=0;--S){const C=t[S],k=t[S+1];C.zeroLength?t.splice(S,1):k&&k.isDash===C.isDash&&(k.left=C.left,t.splice(S,1))}const o=t[0],h=t[t.length-1];o.isDash===h.isDash&&(o.left=h.left-this.width,h.right=o.right+this.width);const f=this.width*this.nextRow;let y=0,b=t[y];for(let S=0;S<this.width;S++){S/b.right>1&&(b=t[++y]);const C=Math.abs(S-b.left),k=Math.abs(S-b.right),z=Math.min(C,k);this.data[f+S]=Math.max(0,Math.min(255,(b.isDash?z:-z)+128))}}addDash(t,o){const h=o?7:0,f=2*h+1;if(this.nextRow+f>this.height)return l.w("LineAtlas out of space"),null;let y=0;for(let S=0;S<t.length;S++)y+=t[S];if(y!==0){const S=this.width/y,C=this.getDashRanges(t,this.width,S);o?this.addRoundDash(C,S,h):this.addRegularDash(C)}const b={y:(this.nextRow+h+.5)/this.height,height:2*h/this.height,width:y};return this.nextRow+=f,this.dirty=!0,b}bind(t){const o=t.gl;this.texture?(o.bindTexture(o.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,o.texSubImage2D(o.TEXTURE_2D,0,0,0,this.width,this.height,o.ALPHA,o.UNSIGNED_BYTE,this.data))):(this.texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,this.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.ALPHA,this.width,this.height,0,o.ALPHA,o.UNSIGNED_BYTE,this.data))}}const pt="maplibre_preloaded_worker_pool";class Ct{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<Ct.workerCount;)this.workers.push(new Worker(l.a.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach(o=>{o.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[pt]}numActive(){return Object.keys(this.active).length}}const ut=Math.floor(F.hardwareConcurrency/2);let At,kt;function nr(){return At||(At=new Ct),At}Ct.workerCount=l.H(globalThis)?Math.max(Math.min(ut,3),1):1;class dr{constructor(t,o){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=o;const h=this.workerPool.acquire(o);for(let f=0;f<h.length;f++){const y=new l.J(h[f],o);y.name=`Worker ${f}`,this.actors.push(y)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,o){const h=[];for(const f of this.actors)h.push(f.sendAsync({type:t,data:o}));return Promise.all(h)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach(o=>{o.remove()}),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,o){for(const h of this.actors)h.registerMessageHandler(t,o)}}function gt(){return kt||(kt=new dr(nr(),l.K),kt.registerMessageHandler("GR",(_,t,o)=>l.m(t,o))),kt}function sr(_,t){const o=l.L();return l.M(o,o,[1,1,0]),l.N(o,o,[.5*_.width,.5*_.height,1]),_.calculatePosMatrix?l.O(o,o,_.calculatePosMatrix(t.toUnwrapped())):o}function Vt(_,t,o,h,f,y,b){var S;const C=function(L,j,q){if(L)for(const se of L){const oe=j[se];if(oe&&oe.source===q&&oe.type==="fill-extrusion")return!0}else for(const se in j){const oe=j[se];if(oe.source===q&&oe.type==="fill-extrusion")return!0}return!1}((S=f==null?void 0:f.layers)!==null&&S!==void 0?S:null,t,_.id),k=y.maxPitchScaleFactor(),z=_.tilesIn(h,k,C);z.sort(tr);const O=[];for(const L of z)O.push({wrappedTileID:L.tileID.wrapped().key,queryResults:L.tile.queryRenderedFeatures(t,o,_._state,L.queryGeometry,L.cameraQueryGeometry,L.scale,f,y,k,sr(_.transform,L.tileID),b?(j,q)=>b(L.tileID,j,q):void 0)});return function(L,j){for(const q in L)for(const se of L[q])Dt(se,j);return L}(function(L){const j={},q={};for(const se of L){const oe=se.queryResults,ae=se.wrappedTileID,ce=q[ae]=q[ae]||{};for(const pe in oe){const ue=oe[pe],ve=ce[pe]=ce[pe]||{},be=j[pe]=j[pe]||[];for(const fe of ue)ve[fe.featureIndex]||(ve[fe.featureIndex]=!0,be.push(fe))}}return j}(O),_)}function tr(_,t){const o=_.tileID,h=t.tileID;return o.overscaledZ-h.overscaledZ||o.canonical.y-h.canonical.y||o.wrap-h.wrap||o.canonical.x-h.canonical.x}function Dt(_,t){const o=_.feature,h=t.getFeatureState(o.layer["source-layer"],o.id);o.source=o.layer.source,o.layer["source-layer"]&&(o.sourceLayer=o.layer["source-layer"]),o.state=h}function Qt(_,t,o){return l._(this,void 0,void 0,function*(){let h=_;if(_.url?h=(yield l.j(t.transformRequest(_.url,"Source"),o)).data:yield F.frameAsync(o),!h)return null;const f=l.Q(l.e(h,_),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in h&&h.vector_layers&&(f.vectorLayerIds=h.vector_layers.map(y=>y.id)),f})}class Gt{constructor(t,o){t&&(o?this.setSouthWest(t).setNorthEast(o):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof l.S?new l.S(t.lng,t.lat):l.S.convert(t),this}setSouthWest(t){return this._sw=t instanceof l.S?new l.S(t.lng,t.lat):l.S.convert(t),this}extend(t){const o=this._sw,h=this._ne;let f,y;if(t instanceof l.S)f=t,y=t;else{if(!(t instanceof Gt))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Gt.convert(t)):this.extend(l.S.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(l.S.convert(t)):this;if(f=t._sw,y=t._ne,!f||!y)return this}return o||h?(o.lng=Math.min(f.lng,o.lng),o.lat=Math.min(f.lat,o.lat),h.lng=Math.max(y.lng,h.lng),h.lat=Math.max(y.lat,h.lat)):(this._sw=new l.S(f.lng,f.lat),this._ne=new l.S(y.lng,y.lat)),this}getCenter(){return new l.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new l.S(this.getWest(),this.getNorth())}getSouthEast(){return new l.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:o,lat:h}=l.S.convert(t);let f=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&f}static convert(t){return t instanceof Gt?t:t&&new Gt(t)}static fromLngLat(t,o=0){const h=360*o/40075017,f=h/Math.cos(Math.PI/180*t.lat);return new Gt(new l.S(t.lng-f,t.lat-h),new l.S(t.lng+f,t.lat+h))}adjustAntiMeridian(){const t=new l.S(this._sw.lng,this._sw.lat),o=new l.S(this._ne.lng,this._ne.lat);return new Gt(t,t.lng>o.lng?new l.S(o.lng+360,o.lat):o)}}class Rr{constructor(t,o,h){this.bounds=Gt.convert(this.validateBounds(t)),this.minzoom=o||0,this.maxzoom=h||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const o=Math.pow(2,t.z),h=Math.floor(l.V(this.bounds.getWest())*o),f=Math.floor(l.U(this.bounds.getNorth())*o),y=Math.ceil(l.V(this.bounds.getEast())*o),b=Math.ceil(l.U(this.bounds.getSouth())*o);return t.x>=h&&t.x<y&&t.y>=f&&t.y<b}}class Yr extends l.E{constructor(t,o,h,f){if(super(),this.id=t,this.dispatcher=h,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.e(this,l.Q(o,["url","scheme","tileSize","promoteId"])),this._options=l.e({type:"vector"},o),this._collectResourceTiming=o.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f)}load(){return l._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new l.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield Qt(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t&&(l.e(this,t),t.bounds&&(this.tileBounds=new Rr(t.bounds,this.minzoom,this.maxzoom)),this.fire(new l.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.l("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this.fire(new l.k(t))}})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return l.e({},this._options)}loadTile(t){return l._(this,void 0,void 0,function*(){const o=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),h={request:this.map._requestManager.transformRequest(o,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};h.request.collectResourceTiming=this._collectResourceTiming;let f="RT";if(t.actor&&t.state!=="expired"){if(t.state==="loading")return new Promise((y,b)=>{t.reloadPromise={resolve:y,reject:b}})}else t.actor=this.dispatcher.getActor(),f="LT";t.abortController=new AbortController;try{const y=yield t.actor.sendAsync({type:f,data:h},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,y)}catch(y){if(delete t.abortController,t.aborted)return;if(y&&y.status!==404)throw y;this._afterTileLoadWorkerResponse(t,null)}})}_afterTileLoadWorkerResponse(t,o){if(o&&o.resourceTiming&&(t.resourceTiming=o.resourceTiming),o&&this.map._refreshExpiredTiles&&t.setExpiryData(o),t.loadVectorData(o,this.map.painter),t.reloadPromise){const h=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(h.resolve).catch(h.reject)}}abortTile(t){return l._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))})}unloadTile(t){return l._(this,void 0,void 0,function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Nn extends l.E{constructor(t,o,h,f){super(),this.id=t,this.dispatcher=h,this.setEventedParent(f),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.e({type:"raster"},o),l.e(this,l.Q(o,["url","scheme","tileSize"]))}load(){return l._(this,arguments,void 0,function*(t=!1){this._loaded=!1,this.fire(new l.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const o=yield Qt(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,o&&(l.e(this,o),o.bounds&&(this.tileBounds=new Rr(o.bounds,this.minzoom,this.maxzoom)),this.fire(new l.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:t})))}catch(o){this._tileJSONRequest=null,this.fire(new l.k(o))}})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load(!0)}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}serialize(){return l.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return l._(this,void 0,void 0,function*(){const o=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const h=yield re.getImage(this.map._requestManager.transformRequest(o,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(h&&h.data){this.map._refreshExpiredTiles&&(h.cacheControl||h.expires)&&t.setExpiryData({cacheControl:h.cacheControl,expires:h.expires});const f=this.map.painter.context,y=f.gl,b=h.data;t.texture=this.map.painter.getTileTexture(b.width),t.texture?t.texture.update(b,{useMipmap:!0}):(t.texture=new l.T(f,b,y.RGBA,{useMipmap:!0}),t.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE,y.LINEAR_MIPMAP_NEAREST)),t.state="loaded"}}catch(h){if(delete t.abortController,t.aborted)t.state="unloaded";else if(h)throw t.state="errored",h}})}abortTile(t){return l._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)})}unloadTile(t){return l._(this,void 0,void 0,function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)})}hasTransition(){return!1}}class Sr extends Nn{constructor(t,o,h,f){super(t,o,h,f),this.type="raster-dem",this.maxzoom=22,this._options=l.e({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox",this.redFactor=o.redFactor,this.greenFactor=o.greenFactor,this.blueFactor=o.blueFactor,this.baseShift=o.baseShift}loadTile(t){return l._(this,void 0,void 0,function*(){const o=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),h=this.map._requestManager.transformRequest(o,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const f=yield re.getImage(h,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(f&&f.data){const y=f.data;this.map._refreshExpiredTiles&&(f.cacheControl||f.expires)&&t.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const b=l.b(y)&&l.W()?y:yield this.readImageNow(y),S={type:this.type,uid:t.uid,source:this.id,rawImageData:b,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||t.state==="expired"){t.actor=this.dispatcher.getActor();const C=yield t.actor.sendAsync({type:"LDT",data:S});t.dem=C,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(f){if(delete t.abortController,t.aborted)t.state="unloaded";else if(f)throw t.state="errored",f}})}readImageNow(t){return l._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&l.X()){const o=t.width+2,h=t.height+2;try{return new l.R({width:o,height:h},yield l.Y(t,-1,-1,o,h))}catch{}}return F.getImageData(t,1)})}_getNeighboringTiles(t){const o=t.canonical,h=Math.pow(2,o.z),f=(o.x-1+h)%h,y=o.x===0?t.wrap-1:t.wrap,b=(o.x+1+h)%h,S=o.x+1===h?t.wrap+1:t.wrap,C={};return C[new l.Z(t.overscaledZ,y,o.z,f,o.y).key]={backfilled:!1},C[new l.Z(t.overscaledZ,S,o.z,b,o.y).key]={backfilled:!1},o.y>0&&(C[new l.Z(t.overscaledZ,y,o.z,f,o.y-1).key]={backfilled:!1},C[new l.Z(t.overscaledZ,t.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},C[new l.Z(t.overscaledZ,S,o.z,b,o.y-1).key]={backfilled:!1}),o.y+1<h&&(C[new l.Z(t.overscaledZ,y,o.z,f,o.y+1).key]={backfilled:!1},C[new l.Z(t.overscaledZ,t.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},C[new l.Z(t.overscaledZ,S,o.z,b,o.y+1).key]={backfilled:!1}),C}unloadTile(t){return l._(this,void 0,void 0,function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))})}}class sn extends l.E{constructor(t,o,h,f){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=h.getActor(),this.setEventedParent(f),this._data=o.data,this._options=l.e({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId,o.clusterMaxZoom!==void 0&&this.maxzoom<=o.clusterMaxZoom&&l.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${o.clusterMaxZoom}".`),this.workerOptions=l.e({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(o.buffer!==void 0?o.buffer:128),tolerance:this._pixelsToTileUnits(o.tolerance!==void 0?o.tolerance:.375),extent:l.$,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(o.clusterMaxZoom),minPoints:Math.max(2,o.clusterMinPoints||2),extent:l.$,radius:this._pixelsToTileUnits(o.clusterRadius||50),log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(t){return t*(l.$/this.tileSize)}_getClusterMaxZoom(t){const o=t?Math.round(t):this.maxzoom-1;return Number.isInteger(t)||t===void 0||l.w(`Integer expected for option 'clusterMaxZoom': provided value "${t}" rounded to "${o}"`),o}load(){return l._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._updateWorkerData(),this}updateData(t){return this._updateWorkerData(t),this}getData(){return l._(this,void 0,void 0,function*(){const t=l.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})})}getCoordinatesFromGeometry(t){return t.type==="GeometryCollection"?t.geometries.map(o=>o.coordinates).flat(1/0):t.coordinates.flat(1/0)}getBounds(){return l._(this,void 0,void 0,function*(){const t=new Gt,o=yield this.getData();let h;switch(o.type){case"FeatureCollection":h=o.features.map(f=>this.getCoordinatesFromGeometry(f.geometry)).flat(1/0);break;case"Feature":h=this.getCoordinatesFromGeometry(o.geometry);break;default:h=this.getCoordinatesFromGeometry(o)}if(h.length==0)return t;for(let f=0;f<h.length-1;f+=2)t.extend([h[f],h[f+1]]);return t})}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(t.clusterRadius)),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(t.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,o,h){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:o,offset:h}})}_updateWorkerData(t){return l._(this,void 0,void 0,function*(){const o=l.e({type:this.type},this.workerOptions);t?o.dataDiff=t:typeof this._data=="string"?(o.request=this.map._requestManager.transformRequest(F.resolveURL(this._data),"Source"),o.request.collectResourceTiming=this._collectResourceTiming):o.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new l.l("dataloading",{dataType:"source"}));try{const h=yield this.actor.sendAsync({type:"LD",data:o});if(this._pendingLoads--,this._removed||h.abandoned)return void this.fire(new l.l("dataabort",{dataType:"source"}));let f=null;h.resourceTiming&&h.resourceTiming[this.id]&&(f=h.resourceTiming[this.id].slice(0));const y={dataType:"source"};this._collectResourceTiming&&f&&f.length>0&&l.e(y,{resourceTiming:f}),this.fire(new l.l("data",Object.assign(Object.assign({},y),{sourceDataType:"metadata"}))),this.fire(new l.l("data",Object.assign(Object.assign({},y),{sourceDataType:"content"})))}catch(h){if(this._pendingLoads--,this._removed)return void this.fire(new l.l("dataabort",{dataType:"source"}));this.fire(new l.k(h))}})}loaded(){return this._pendingLoads===0}loadTile(t){return l._(this,void 0,void 0,function*(){const o=t.actor?"RT":"LT";t.actor=this.actor;const h={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};t.abortController=new AbortController;const f=yield this.actor.sendAsync({type:o,data:h},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(f,this.map.painter,o==="RT")})}abortTile(t){return l._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0})}unloadTile(t){return l._(this,void 0,void 0,function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return l.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Zr extends l.E{constructor(t,o,h,f){super(),this.flippedWindingOrder=!1,this.id=t,this.dispatcher=h,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(f),this.options=o}load(t){return l._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new l.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const o=yield re.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,o&&o.data&&(this.image=o.data,t&&(this.coordinates=t),this._finishLoading())}catch(o){this._request=null,this._loaded=!0,this.fire(new l.k(o))}})}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const o=t.map(l.a0.fromLngLat);var h;return this.tileID=function(f){const y=l.a1.fromPoints(f),b=y.width(),S=y.height(),C=Math.max(b,S),k=Math.max(0,Math.floor(-Math.log(C)/Math.LN2)),z=Math.pow(2,k);return new l.a3(k,Math.floor((y.minX+y.maxX)/2*z),Math.floor((y.minY+y.maxY)/2*z))}(o),this.terrainTileRanges=this._getOverlappingTileRanges(o),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=o.map(f=>this.tileID.getTilePoint(f)._round()),this.flippedWindingOrder=((h=this.tileCoords)[1].x-h[0].x)*(h[2].y-h[0].y)-(h[1].y-h[0].y)*(h[2].x-h[0].x)<0,this.fire(new l.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,o=t.gl;this.texture||(this.texture=new l.T(t,this.image,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let h=!1;for(const f in this.tiles){const y=this.tiles[f];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,h=!0)}h&&this.fire(new l.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return l._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(t){const{minX:o,minY:h,maxX:f,maxY:y}=l.a1.fromPoints(t),b={};for(let S=0;S<=l.a2;S++){const C=Math.pow(2,S),k=Math.floor(o*C),z=Math.floor(h*C),O=Math.floor(f*C),L=Math.floor(y*C);b[S]={minTileX:k,minTileY:z,maxTileX:O,maxTileY:L}}return b}}class no extends Zr{constructor(t,o,h,f){super(t,o,h,f),this.roundZoom=!0,this.type="video",this.options=o}load(){return l._(this,void 0,void 0,function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const o of t.urls)this.urls.push(this.map._requestManager.transformRequest(o,"Source").url);try{const o=yield l.a4(this.urls);if(this._loaded=!0,!o)return;this.video=o,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(o){this.fire(new l.k(o))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const o=this.video.seekable;t<o.start(0)||t>o.end(0)?this.fire(new l.k(new l.a5(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,o=t.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new l.T(t,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let h=!1;for(const f in this.tiles){const y=this.tiles[f];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,h=!0)}h&&this.fire(new l.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Yn extends Zr{constructor(t,o,h,f){super(t,o,h,f),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(y=>!Array.isArray(y)||y.length!==2||y.some(b=>typeof b!="number"))||this.fire(new l.k(new l.a5(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.k(new l.a5(`sources.${t}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new l.k(new l.a5(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new l.k(new l.a5(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.k(new l.a5(`sources.${t}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){return l._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context,h=o.gl;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new l.T(o,this.canvas,h.RGBA,{premultiply:!0});let f=!1;for(const y in this.tiles){const b=this.tiles[y];b.state!=="loaded"&&(b.state="loaded",b.texture=this.texture,f=!0)}f&&this.fire(new l.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const Yo={},Bn=_=>{switch(_){case"geojson":return sn;case"image":return Zr;case"raster":return Nn;case"raster-dem":return Sr;case"vector":return Yr;case"video":return no;case"canvas":return Yn}return Yo[_]},Fi="RTLPluginLoaded";class bo extends l.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=gt()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch(o=>{throw this.status="error",o})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return l._(this,arguments,void 0,function*(o,h=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=F.resolveURL(o),!this.url)throw new Error(`requested url ${o} is invalid`);if(this.status==="unavailable"){if(!h)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return l._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new l.l(Fi))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let jr=null;function Qr(){return jr||(jr=new bo),jr}class Si{constructor(t,o){this.timeAdded=0,this.fadeEndTime=0,this.tileID=t,this.uid=l.a6(),this.uses=0,this.tileSize=o,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const o=t+this.timeAdded;o<this.fadeEndTime||(this.fadeEndTime=o)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,o,h){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(f,y){const b={};if(!y)return b;for(const S of f){const C=S.layerIds.map(k=>y.getLayer(k)).filter(Boolean);if(C.length!==0){S.layers=C,S.stateDependentLayerIds&&(S.stateDependentLayers=S.stateDependentLayerIds.map(k=>C.filter(z=>z.id===k)[0]));for(const k of C)b[k.id]=S}}return b}(t.buckets,o==null?void 0:o.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const y=this.buckets[f];if(y instanceof l.a8){if(this.hasSymbolBuckets=!0,!h)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const y=this.buckets[f];if(y instanceof l.a8&&y.hasRTLText){this.hasRTLText=!0,Qr().lazyLoad();break}}this.queryPadding=0;for(const f in this.buckets){const y=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(f).queryRadius(y))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new l.a7}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const h in this.buckets){const f=this.buckets[h];f.uploadPending()&&f.upload(t)}const o=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new l.T(t,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new l.T(t,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,o,h,f,y,b,S,C,k,z,O){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:f,cameraQueryGeometry:y,scale:b,tileSize:this.tileSize,pixelPosMatrix:z,transform:C,params:S,queryPadding:this.queryPadding*k,getElevation:O},t,o,h):{}}querySourceFeatures(t,o){const h=this.latestFeatureIndex;if(!h||!h.rawTileData)return;const f=h.loadVTLayers(),y=o&&o.sourceLayer?o.sourceLayer:"",b=f._geojsonTileLayer||f[y];if(!b)return;const S=l.a9(o&&o.filter),{z:C,x:k,y:z}=this.tileID.canonical,O={z:C,x:k,y:z};for(let L=0;L<b.length;L++){const j=b.feature(L);if(S.needGeometry){const oe=l.aa(j,!0);if(!S.filter(new l.F(this.tileID.overscaledZ),oe,this.tileID.canonical))continue}else if(!S.filter(new l.F(this.tileID.overscaledZ),j))continue;const q=h.getId(j,y),se=new l.ab(j,C,k,z,q);se.tile=O,t.push(se)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const o=this.expirationTime;if(t.cacheControl){const h=l.ac(t.cacheControl);h["max-age"]&&(this.expirationTime=Date.now()+1e3*h["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const h=Date.now();let f=!1;if(this.expirationTime>h)f=!1;else if(o)if(this.expirationTime<o)f=!0;else{const y=this.expirationTime-o;y?this.expirationTime=h+Math.max(y,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,o){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const h=this.latestFeatureIndex.loadVTLayers();for(const f in this.buckets){if(!o.style.hasLayer(f))continue;const y=this.buckets[f],b=y.layers[0].sourceLayer||"_geojsonTileLayer",S=h[b],C=t[b];if(!S||!C||Object.keys(C).length===0)continue;y.update(C,S,this.imageAtlas&&this.imageAtlas.patternPositions||{});const k=o&&o.style&&o.style.getLayer(f);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(y)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<F.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=F.now()+t}setDependencies(t,o){const h={};for(const f of o)h[f]=!0;this.dependencies[t]=h}hasDependency(t,o){for(const h of t){const f=this.dependencies[h];if(f){for(const y of o)if(f[y])return!0}}return!1}}class Is{constructor(t,o){this.max=t,this.onRemove=o,this.reset()}reset(){for(const t in this.data)for(const o of this.data[t])o.timeout&&clearTimeout(o.timeout),this.onRemove(o.value);return this.data={},this.order=[],this}add(t,o,h){const f=t.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);const y={value:o,timeout:void 0};if(h!==void 0&&(y.timeout=setTimeout(()=>{this.remove(t,y)},h)),this.data[f].push(y),this.order.push(f),this.order.length>this.max){const b=this._getAndRemoveByKey(this.order[0]);b&&this.onRemove(b)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const o=this.data[t].shift();return o.timeout&&clearTimeout(o.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),o.value}getByKey(t){const o=this.data[t];return o?o[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,o){if(!this.has(t))return this;const h=t.wrapped().key,f=o===void 0?0:this.data[h].indexOf(o),y=this.data[h][f];return this.data[h].splice(f,1),y.timeout&&clearTimeout(y.timeout),this.data[h].length===0&&delete this.data[h],this.onRemove(y.value),this.order.splice(this.order.indexOf(h),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}filter(t){const o=[];for(const h in this.data)for(const f of this.data[h])t(f.value)||o.push(f);for(const h of o)this.remove(h.value.tileID,h)}}class wo{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,o,h){const f=String(o);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][f]=this.stateChanges[t][f]||{},l.e(this.stateChanges[t][f],h),this.deletedStates[t]===null){this.deletedStates[t]={};for(const y in this.state[t])y!==f&&(this.deletedStates[t][y]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][f]===null){this.deletedStates[t][f]={};for(const y in this.state[t][f])h[y]||(this.deletedStates[t][f][y]=null)}else for(const y in h)this.deletedStates[t]&&this.deletedStates[t][f]&&this.deletedStates[t][f][y]===null&&delete this.deletedStates[t][f][y]}removeFeatureState(t,o,h){if(this.deletedStates[t]===null)return;const f=String(o);if(this.deletedStates[t]=this.deletedStates[t]||{},h&&o!==void 0)this.deletedStates[t][f]!==null&&(this.deletedStates[t][f]=this.deletedStates[t][f]||{},this.deletedStates[t][f][h]=null);else if(o!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][f])for(h in this.deletedStates[t][f]={},this.stateChanges[t][f])this.deletedStates[t][f][h]=null;else this.deletedStates[t][f]=null;else this.deletedStates[t]=null}getState(t,o){const h=String(o),f=l.e({},(this.state[t]||{})[h],(this.stateChanges[t]||{})[h]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const y=this.deletedStates[t][o];if(y===null)return{};for(const b in y)delete f[b]}return f}initializeTileState(t,o){t.setFeatureState(this.state,o)}coalesceChanges(t,o){const h={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const y={};for(const b in this.stateChanges[f])this.state[f][b]||(this.state[f][b]={}),l.e(this.state[f][b],this.stateChanges[f][b]),y[b]=this.state[f][b];h[f]=y}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const y={};if(this.deletedStates[f]===null)for(const b in this.state[f])y[b]={},this.state[f][b]={};else for(const b in this.deletedStates[f]){if(this.deletedStates[f][b]===null)this.state[f][b]={};else for(const S of Object.keys(this.deletedStates[f][b]))delete this.state[f][b][S];y[b]=this.state[f][b]}h[f]=h[f]||{},l.e(h[f],y)}if(this.stateChanges={},this.deletedStates={},Object.keys(h).length!==0)for(const f in t)t[f].setFeatureState(h,o)}}const Ni=89.25;function Me(_,t){const o=l.ag(t.lat,-l.ah,l.ah);return new l.P(l.V(t.lng)*_,l.U(o)*_)}function Q(_,t){return new l.a0(t.x/_,t.y/_).toLngLat()}function J(_){return _.cameraToCenterDistance*Math.min(.85*Math.tan(l.ad(90-_.pitch)),Math.tan(l.ad(Ni-_.pitch)))}function ie(_,t){const o=_.canonical,h=t/l.ae(o.z),f=o.x+Math.pow(2,o.z)*_.wrap,y=l.af(new Float64Array(16));return l.M(y,y,[f*h,o.y*h,0]),l.N(y,y,[h/l.$,h/l.$,1]),y}function de(_,t,o,h,f){const y=l.a0.fromLngLat(_,t),b=f*l.ai(1,_.lat),S=b*Math.cos(l.ad(o)),C=Math.sqrt(b*b-S*S),k=C*Math.sin(l.ad(-h)),z=C*Math.cos(l.ad(-h));return new l.a0(y.x+k,y.y+z,y.z+S)}function we(_,t,o){const h=t.intersectsFrustum(_);if(!o||h===0)return h;const f=t.intersectsPlane(o);return f===0?0:h===2&&f===2?2:1}function Ee(_,t,o){let h=0;const f=(o-t)/10;for(let y=0;y<10;y++)h+=f*Math.pow(Math.cos(t+(y+.5)/10*(o-t)),_);return h}function De(_,t){return function(o,h,f,y,b){const S=2*((_-1)/l.aj(Math.cos(l.ad(Ni-b))/Math.cos(l.ad(Ni)))-1),C=Math.acos(f/y),k=2*Ee(S-1,0,l.ad(b/2)),z=Math.min(l.ad(Ni),C+l.ad(b/2)),O=Ee(S-1,Math.min(z,C-l.ad(b/2)),z),L=Math.atan(h/f),j=Math.hypot(h,f);let q=o;return q+=l.aj(y/j/Math.max(.5,Math.cos(l.ad(b/2)))),q+=S*l.aj(Math.cos(L))/2,q-=l.aj(Math.max(1,O/k/t))/2,q}}const Ce=De(9.314,3);function Ve(_,t){const o=(t.roundZoom?Math.round:Math.floor)(_.zoom+l.aj(_.tileSize/t.tileSize));return Math.max(0,o)}function je(_,t){const o=_.getCameraFrustum(),h=_.getClippingPlane(),f=_.screenPointToMercatorCoordinate(_.getCameraPoint()),y=l.a0.fromLngLat(_.center,_.elevation);f.z=y.z+Math.cos(_.pitchInRadians)*_.cameraToCenterDistance/_.worldSize;const b=_.getCoveringTilesDetailsProvider(),S=b.allowVariableZoom(_,t),C=Ve(_,t),k=t.minzoom||0,z=t.maxzoom!==void 0?t.maxzoom:_.maxZoom,O=Math.min(Math.max(0,C),z),L=Math.pow(2,O),j=[L*f.x,L*f.y,0],q=[L*y.x,L*y.y,0],se=Math.hypot(y.x-f.x,y.y-f.y),oe=Math.abs(y.z-f.z),ae=Math.hypot(se,oe),ce=ve=>({zoom:0,x:0,y:0,wrap:ve,fullyVisible:!1}),pe=[],ue=[];if(_.renderWorldCopies&&b.allowWorldCopies())for(let ve=1;ve<=3;ve++)pe.push(ce(-ve)),pe.push(ce(ve));for(pe.push(ce(0));pe.length>0;){const ve=pe.pop(),be=ve.x,fe=ve.y;let Pe=ve.fullyVisible;const Oe={x:be,y:fe,z:ve.zoom},Ae=b.getTileBoundingVolume(Oe,ve.wrap,_.elevation,t);if(!Pe){const it=we(o,Ae,h);if(it===0)continue;Pe=it===2}const Re=b.distanceToTile2d(f.x,f.y,Oe,Ae);let Fe=C;S&&(Fe=(t.calculateTileZoom||Ce)(_.zoom+l.aj(_.tileSize/t.tileSize),Re,oe,ae,_.fov)),Fe=(t.roundZoom?Math.round:Math.floor)(Fe),Fe=Math.max(0,Fe);const st=Math.min(Fe,z);if(ve.wrap=b.getWrap(y,Oe,ve.wrap),ve.zoom>=st){if(ve.zoom<k)continue;const it=O-ve.zoom,Ke=j[0]-.5-(be<<it),vt=j[1]-.5-(fe<<it),Ft=t.reparseOverscaled?Math.max(ve.zoom,Fe):ve.zoom;ue.push({tileID:new l.Z(ve.zoom===z?Ft:ve.zoom,ve.wrap,ve.zoom,be,fe),distanceSq:l.ak([q[0]-.5-be,q[1]-.5-fe]),tileDistanceToCamera:Math.sqrt(Ke*Ke+vt*vt)})}else for(let it=0;it<4;it++)pe.push({zoom:ve.zoom+1,x:(be<<1)+it%2,y:(fe<<1)+(it>>1),wrap:ve.wrap,fullyVisible:Pe})}return ue.sort((ve,be)=>ve.distanceSq-be.distanceSq).map(ve=>ve.tileID)}const ke=l.a1.fromPoints([new l.P(0,0),new l.P(l.$,l.$)]);class We extends l.E{constructor(t,o,h){super(),this.id=t,this.dispatcher=h,this.on("data",f=>this._dataHandler(f)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((f,y,b,S)=>{const C=new(Bn(y.type))(f,y,b,S);if(C.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${C.id}`);return C})(t,o,h,this),this._tiles={},this._cache=new Is(0,f=>this._unloadTile(f)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new wo,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const o=this._tiles[t];if(o.state!=="loaded"&&o.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,o,h){return l._(this,void 0,void 0,function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,o,h)}catch(f){t.state="errored",f.status!==404?this._source.fire(new l.k(f,{tile:t})):this.update(this.transform,this.terrain)}})}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new l.l("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const o in this._tiles){const h=this._tiles[o];h.upload(t),h.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(t=>t.tileID).sort(he).map(t=>t.key)}getRenderableIds(t){const o=[];for(const h in this._tiles)this._isIdRenderable(h,t)&&o.push(this._tiles[h]);return t?o.sort((h,f)=>{const y=h.tileID,b=f.tileID,S=new l.P(y.canonical.x,y.canonical.y)._rotate(-this.transform.bearingInRadians),C=new l.P(b.canonical.x,b.canonical.y)._rotate(-this.transform.bearingInRadians);return y.overscaledZ-b.overscaledZ||C.y-S.y||C.x-S.x}).map(h=>h.tileID.key):o.map(h=>h.tileID).sort(he).map(h=>h.key)}hasRenderableParent(t){const o=this.findLoadedParent(t,0);return!!o&&this._isIdRenderable(o.tileID.key)}_isIdRenderable(t,o){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(o||!this._tiles[t].holdingForFade())}reload(t){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)t?this._reloadTile(o,"expired"):this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")}}_reloadTile(t,o){return l._(this,void 0,void 0,function*(){const h=this._tiles[t];h&&(h.state!=="loading"&&(h.state=o),yield this._loadTile(h,t,o))})}_tileLoaded(t,o,h){t.timeAdded=F.now(),h==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(o,t),this.getSource().type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new l.l("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const o=this.getRenderableIds();for(let f=0;f<o.length;f++){const y=o[f];if(t.neighboringTiles&&t.neighboringTiles[y]){const b=this.getTileByID(y);h(t,b),h(b,t)}}function h(f,y){f.needsHillshadePrepare=!0,f.needsTerrainPrepare=!0;let b=y.tileID.canonical.x-f.tileID.canonical.x;const S=y.tileID.canonical.y-f.tileID.canonical.y,C=Math.pow(2,f.tileID.canonical.z),k=y.tileID.key;b===0&&S===0||Math.abs(S)>1||(Math.abs(b)>1&&(Math.abs(b+C)===1?b+=C:Math.abs(b-C)===1&&(b-=C)),y.dem&&f.dem&&(f.dem.backfillBorder(y.dem,b,S),f.neighboringTiles&&f.neighboringTiles[k]&&(f.neighboringTiles[k].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,o,h,f){for(const y in this._tiles){let b=this._tiles[y];if(f[y]||!b.hasData()||b.tileID.overscaledZ<=o||b.tileID.overscaledZ>h)continue;let S=b.tileID;for(;b&&b.tileID.overscaledZ>o+1;){const k=b.tileID.scaledTo(b.tileID.overscaledZ-1);b=this._tiles[k.key],b&&b.hasData()&&(S=k)}let C=S;for(;C.overscaledZ>o;)if(C=C.scaledTo(C.overscaledZ-1),t[C.key]||t[C.canonical.key]){f[S.key]=S;break}}}findLoadedParent(t,o){if(t.key in this._loadedParentTiles){const h=this._loadedParentTiles[t.key];return h&&h.tileID.overscaledZ>=o?h:null}for(let h=t.overscaledZ-1;h>=o;h--){const f=t.scaledTo(h),y=this._getLoadedTile(f);if(y)return y}}findLoadedSibling(t){return this._getLoadedTile(t)}_getLoadedTile(t){const o=this._tiles[t.key];return o&&o.hasData()?o:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const o=Math.ceil(t.width/this._source.tileSize)+1,h=Math.ceil(t.height/this._source.tileSize)+1,f=Math.floor(o*h*(this._maxTileCacheZoomLevels===null?l.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,f):f;this._cache.setMaxSize(y)}handleWrapJump(t){const o=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,o){const h={};for(const f in this._tiles){const y=this._tiles[f];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+o),h[y.tileID.key]=y}this._tiles=h;for(const f in this._timers)clearTimeout(this._timers[f]),delete this._timers[f];for(const f in this._tiles)this._setTileReloadTimer(f,this._tiles[f])}}_updateCoveredAndRetainedTiles(t,o,h,f,y,b){const S={},C={},k=Object.keys(t),z=F.now();for(const O of k){const L=t[O],j=this._tiles[O];if(!j||j.fadeEndTime!==0&&j.fadeEndTime<=z)continue;const q=this.findLoadedParent(L,o),se=this.findLoadedSibling(L),oe=q||se||null;oe&&(this._addTile(oe.tileID),S[oe.tileID.key]=oe.tileID),C[O]=L}this._retainLoadedChildren(C,f,h,t);for(const O in S)t[O]||(this._coveredTiles[O]=!0,t[O]=S[O]);if(b){const O={},L={};for(const j of y)this._tiles[j.key].hasData()?O[j.key]=j:L[j.key]=j;for(const j in L){const q=L[j].children(this._source.maxzoom);this._tiles[q[0].key]&&this._tiles[q[1].key]&&this._tiles[q[2].key]&&this._tiles[q[3].key]&&(O[q[0].key]=t[q[0].key]=q[0],O[q[1].key]=t[q[1].key]=q[1],O[q[2].key]=t[q[2].key]=q[2],O[q[3].key]=t[q[3].key]=q[3],delete L[j])}for(const j in L){const q=L[j],se=this.findLoadedParent(q,this._source.minzoom),oe=this.findLoadedSibling(q),ae=se||oe||null;if(ae){O[ae.tileID.key]=t[ae.tileID.key]=ae.tileID;for(const ce in O)O[ce].isChildOf(ae.tileID)&&delete O[ce]}}for(const j in this._tiles)O[j]||(this._coveredTiles[j]=!0)}}update(t,o){if(!this._sourceLoaded||this._paused)return;let h;this.transform=t,this.terrain=o,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?h=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(z=>new l.Z(z.canonical.z,z.wrap,z.canonical.z,z.canonical.x,z.canonical.y)):(h=je(t,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:o,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(h=h.filter(z=>this._source.hasTile(z)))):h=[];const f=Ve(t,this._source),y=Math.max(f-We.maxOverzooming,this._source.minzoom),b=Math.max(f+We.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const z={};for(const O of h)if(O.canonical.z>this._source.minzoom){const L=O.scaledTo(O.canonical.z-1);z[L.key]=L;const j=O.scaledTo(Math.max(this._source.minzoom,Math.min(O.canonical.z,5)));z[j.key]=j}h=h.concat(Object.values(z))}const S=h.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,S&&this.fire(new l.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const C=this._updateRetainedTiles(h,f);Qe(this._source.type)&&this._updateCoveredAndRetainedTiles(C,y,b,f,h,o);for(const z in C)this._tiles[z].clearFadeHold();const k=l.al(this._tiles,C);for(const z of k){const O=this._tiles[z];O.hasSymbolBuckets&&!O.holdingForFade()?O.setHoldDuration(this.map._fadeDuration):O.hasSymbolBuckets&&!O.symbolFadeFinished()||this._removeTile(z)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,o){var h;const f={},y={},b=Math.max(o-We.maxOverzooming,this._source.minzoom),S=Math.max(o+We.maxUnderzooming,this._source.minzoom),C={};for(const k of t){const z=this._addTile(k);f[k.key]=k,z.hasData()||o<this._source.maxzoom&&(C[k.key]=k)}this._retainLoadedChildren(C,o,S,f);for(const k of t){let z=this._tiles[k.key];if(z.hasData())continue;if(o+1>this._source.maxzoom){const L=k.children(this._source.maxzoom)[0],j=this.getTile(L);if(j&&j.hasData()){f[L.key]=L;continue}}else{const L=k.children(this._source.maxzoom);if(f[L[0].key]&&f[L[1].key]&&f[L[2].key]&&f[L[3].key])continue}let O=z.wasRequested();for(let L=k.overscaledZ-1;L>=b;--L){const j=k.scaledTo(L);if(y[j.key])break;if(y[j.key]=!0,z=this.getTile(j),!z&&O&&(z=this._addTile(j)),z){const q=z.hasData();if((q||!(!((h=this.map)===null||h===void 0)&&h.cancelPendingTileRequestsWhileZooming)||O)&&(f[j.key]=j),O=z.wasRequested(),q)break}}}return f}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const o=[];let h,f=this._tiles[t].tileID;for(;f.overscaledZ>0;){if(f.key in this._loadedParentTiles){h=this._loadedParentTiles[f.key];break}o.push(f.key);const y=f.scaledTo(f.overscaledZ-1);if(h=this._getLoadedTile(y),h)break;f=y}for(const y of o)this._loadedParentTiles[y]=h}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const t in this._tiles){const o=this._tiles[t].tileID,h=this._getLoadedTile(o);this._loadedSiblingTiles[o.key]=h}}_addTile(t){let o=this._tiles[t.key];if(o)return o;o=this._cache.getAndRemove(t),o&&(this._setTileReloadTimer(t.key,o),o.tileID=t,this._state.initializeTileState(o,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,o)));const h=o;return o||(o=new Si(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(o,t.key,o.state)),o.uses++,this._tiles[t.key]=o,h||this._source.fire(new l.l("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o}_setTileReloadTimer(t,o){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const h=o.getExpiryTimeout();h&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},h))}refreshTiles(t){for(const o in this._tiles)(this._isIdRenderable(o)||this._tiles[o].state=="errored")&&t.some(h=>h.equals(this._tiles[o].tileID.canonical))&&this._reloadTile(o,"expired")}_removeTile(t){const o=this._tiles[t];o&&(o.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),o.uses>0||(o.hasData()&&o.state!=="reloading"?this._cache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))}_dataHandler(t){const o=t.sourceDataType;t.dataType==="source"&&o==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&t.dataType==="source"&&o==="content"&&(this.reload(t.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,o,h){const f=[],y=this.transform;if(!y)return f;const b=y.getCoveringTilesDetailsProvider().allowWorldCopies(),S=h?y.getCameraQueryGeometry(t):t,C=j=>y.screenPointToMercatorCoordinate(j,this.terrain),k=this.transformBbox(t,C,!b),z=this.transformBbox(S,C,!b),O=this.getIds(),L=l.a1.fromPoints(z);for(let j=0;j<O.length;j++){const q=this._tiles[O[j]];if(q.holdingForFade())continue;const se=b?[q.tileID]:[q.tileID.unwrapTo(-1),q.tileID.unwrapTo(0)],oe=Math.pow(2,y.zoom-q.tileID.overscaledZ),ae=o*q.queryPadding*l.$/q.tileSize/oe;for(const ce of se){const pe=L.map(ue=>ce.getTilePoint(new l.a0(ue.x,ue.y)));if(pe.expandBy(ae),pe.intersects(ke)){const ue=k.map(be=>ce.getTilePoint(be)),ve=z.map(be=>ce.getTilePoint(be));f.push({tile:q,tileID:b?ce:ce.unwrapTo(0),queryGeometry:ue,cameraQueryGeometry:ve,scale:oe})}}}return f}transformBbox(t,o,h){let f=t.map(o);if(h){const y=l.a1.fromPoints(t);y.shrinkBy(.001*Math.min(y.width(),y.height()));const b=y.map(o);l.a1.fromPoints(f).covers(b)||(f=f.map(S=>S.x>.5?new l.a0(S.x-1,S.y,S.z):S))}return f}getVisibleCoordinates(t){const o=this.getRenderableIds(t).map(h=>this._tiles[h].tileID);return this.transform&&this.transform.populateCache(o),o}hasTransition(){if(this._source.hasTransition())return!0;if(Qe(this._source.type)){const t=F.now();for(const o in this._tiles)if(this._tiles[o].fadeEndTime>=t)return!0}return!1}setFeatureState(t,o,h){this._state.updateState(t=t||"_geojsonTileLayer",o,h)}removeFeatureState(t,o,h){this._state.removeFeatureState(t=t||"_geojsonTileLayer",o,h)}getFeatureState(t,o){return this._state.getState(t=t||"_geojsonTileLayer",o)}setDependencies(t,o,h){const f=this._tiles[t];f&&f.setDependencies(o,h)}reloadTilesForDependencies(t,o){for(const h in this._tiles)this._tiles[h].hasDependency(t,o)&&this._reloadTile(h,"reloading");this._cache.filter(h=>!h.hasDependency(t,o))}}function he(_,t){const o=Math.abs(2*_.wrap)-+(_.wrap<0),h=Math.abs(2*t.wrap)-+(t.wrap<0);return _.overscaledZ-t.overscaledZ||h-o||t.canonical.y-_.canonical.y||t.canonical.x-_.canonical.x}function Qe(_){return _==="raster"||_==="image"||_==="video"}We.maxOverzooming=10,We.maxUnderzooming=3;class mt{constructor(t,o){this.reset(t,o)}reset(t,o){this.points=t||[],this._distances=[0];for(let h=1;h<this.points.length;h++)this._distances[h]=this._distances[h-1]+this.points[h].dist(this.points[h-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(o||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=l.ag(t,0,1);let o=1,h=this._distances[o];const f=t*this.paddedLength+this.padding;for(;h<f&&o<this._distances.length;)h=this._distances[++o];const y=o-1,b=this._distances[y],S=h-b,C=S>0?(f-b)/S:0;return this.points[y].mult(1-C).add(this.points[o].mult(C))}}function ct(_,t){let o=!0;return _==="always"||_!=="never"&&t!=="never"||(o=!1),o}class yt{constructor(t,o,h){const f=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(t/h),this.yCellCount=Math.ceil(o/h);for(let b=0;b<this.xCellCount*this.yCellCount;b++)f.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=o,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/o,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,o,h,f,y){this._forEachCell(o,h,f,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(o),this.bboxes.push(h),this.bboxes.push(f),this.bboxes.push(y)}insertCircle(t,o,h,f){this._forEachCell(o-f,h-f,o+f,h+f,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(o),this.circles.push(h),this.circles.push(f)}_insertBoxCell(t,o,h,f,y,b){this.boxCells[y].push(b)}_insertCircleCell(t,o,h,f,y,b){this.circleCells[y].push(b)}_query(t,o,h,f,y,b,S){if(h<0||t>this.width||f<0||o>this.height)return[];const C=[];if(t<=0&&o<=0&&this.width<=h&&this.height<=f){if(y)return[{key:null,x1:t,y1:o,x2:h,y2:f}];for(let k=0;k<this.boxKeys.length;k++)C.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(let k=0;k<this.circleKeys.length;k++){const z=this.circles[3*k],O=this.circles[3*k+1],L=this.circles[3*k+2];C.push({key:this.circleKeys[k],x1:z-L,y1:O-L,x2:z+L,y2:O+L})}}else this._forEachCell(t,o,h,f,this._queryCell,C,{hitTest:y,overlapMode:b,seenUids:{box:{},circle:{}}},S);return C}query(t,o,h,f){return this._query(t,o,h,f,!1,null)}hitTest(t,o,h,f,y,b){return this._query(t,o,h,f,!0,y,b).length>0}hitTestCircle(t,o,h,f,y){const b=t-h,S=t+h,C=o-h,k=o+h;if(S<0||b>this.width||k<0||C>this.height)return!1;const z=[];return this._forEachCell(b,C,S,k,this._queryCellCircle,z,{hitTest:!0,overlapMode:f,circle:{x:t,y:o,radius:h},seenUids:{box:{},circle:{}}},y),z.length>0}_queryCell(t,o,h,f,y,b,S,C){const{seenUids:k,hitTest:z,overlapMode:O}=S,L=this.boxCells[y];if(L!==null){const q=this.bboxes;for(const se of L)if(!k.box[se]){k.box[se]=!0;const oe=4*se,ae=this.boxKeys[se];if(t<=q[oe+2]&&o<=q[oe+3]&&h>=q[oe+0]&&f>=q[oe+1]&&(!C||C(ae))&&(!z||!ct(O,ae.overlapMode))&&(b.push({key:ae,x1:q[oe],y1:q[oe+1],x2:q[oe+2],y2:q[oe+3]}),z))return!0}}const j=this.circleCells[y];if(j!==null){const q=this.circles;for(const se of j)if(!k.circle[se]){k.circle[se]=!0;const oe=3*se,ae=this.circleKeys[se];if(this._circleAndRectCollide(q[oe],q[oe+1],q[oe+2],t,o,h,f)&&(!C||C(ae))&&(!z||!ct(O,ae.overlapMode))){const ce=q[oe],pe=q[oe+1],ue=q[oe+2];if(b.push({key:ae,x1:ce-ue,y1:pe-ue,x2:ce+ue,y2:pe+ue}),z)return!0}}}return!1}_queryCellCircle(t,o,h,f,y,b,S,C){const{circle:k,seenUids:z,overlapMode:O}=S,L=this.boxCells[y];if(L!==null){const q=this.bboxes;for(const se of L)if(!z.box[se]){z.box[se]=!0;const oe=4*se,ae=this.boxKeys[se];if(this._circleAndRectCollide(k.x,k.y,k.radius,q[oe+0],q[oe+1],q[oe+2],q[oe+3])&&(!C||C(ae))&&!ct(O,ae.overlapMode))return b.push(!0),!0}}const j=this.circleCells[y];if(j!==null){const q=this.circles;for(const se of j)if(!z.circle[se]){z.circle[se]=!0;const oe=3*se,ae=this.circleKeys[se];if(this._circlesCollide(q[oe],q[oe+1],q[oe+2],k.x,k.y,k.radius)&&(!C||C(ae))&&!ct(O,ae.overlapMode))return b.push(!0),!0}}}_forEachCell(t,o,h,f,y,b,S,C){const k=this._convertToXCellCoord(t),z=this._convertToYCellCoord(o),O=this._convertToXCellCoord(h),L=this._convertToYCellCoord(f);for(let j=k;j<=O;j++)for(let q=z;q<=L;q++)if(y.call(this,t,o,h,f,this.xCellCount*q+j,b,S,C))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,o,h,f,y,b){const S=f-t,C=y-o,k=h+b;return k*k>S*S+C*C}_circleAndRectCollide(t,o,h,f,y,b,S){const C=(b-f)/2,k=Math.abs(t-(f+C));if(k>C+h)return!1;const z=(S-y)/2,O=Math.abs(o-(y+z));if(O>z+h)return!1;if(k<=C||O<=z)return!0;const L=k-C,j=O-z;return L*L+j*j<=h*h}}function Et(_,t,o){const h=l.L();if(!_){const{vecSouth:O,vecEast:L}=Nt(t),j=P();j[0]=L[0],j[1]=L[1],j[2]=O[0],j[3]=O[1],f=j,(z=(b=(y=j)[0])*(k=y[3])-(C=y[2])*(S=y[1]))&&(f[0]=k*(z=1/z),f[1]=-S*z,f[2]=-C*z,f[3]=b*z),h[0]=j[0],h[1]=j[1],h[4]=j[2],h[5]=j[3]}var f,y,b,S,C,k,z;return l.N(h,h,[1/o,1/o,1]),h}function ir(_,t,o,h){if(_){const f=l.L();if(!t){const{vecSouth:y,vecEast:b}=Nt(o);f[0]=b[0],f[1]=b[1],f[4]=y[0],f[5]=y[1]}return l.N(f,f,[h,h,1]),f}return o.pixelsToClipSpaceMatrix}function Nt(_){const t=Math.cos(_.rollInRadians),o=Math.sin(_.rollInRadians),h=Math.cos(_.pitchInRadians),f=Math.cos(_.bearingInRadians),y=Math.sin(_.bearingInRadians),b=l.aq();b[0]=-f*h*o-y*t,b[1]=-y*h*o+f*t;const S=l.ar(b);S<1e-9?l.as(b):l.at(b,b,1/S);const C=l.aq();C[0]=f*h*t-y*o,C[1]=y*h*t+f*o;const k=l.ar(C);return k<1e-9?l.as(C):l.at(C,C,1/k),{vecEast:C,vecSouth:b}}function Bt(_,t,o,h){let f;h?(f=[_,t,h(_,t),1],l.av(f,f,o)):(f=[_,t,0,1],zs(f,f,o));const y=f[3];return{point:new l.P(f[0]/y,f[1]/y),signedDistanceFromCamera:y,isOccluded:!1}}function Rt(_,t){return .5+_/t*.5}function Jt(_,t){return _.x>=-t[0]&&_.x<=t[0]&&_.y>=-t[1]&&_.y<=t[1]}function hn(_,t,o,h,f,y,b,S,C,k,z,O,L){const j=o?_.textSizeData:_.iconSizeData,q=l.am(j,t.transform.zoom),se=[256/t.width*2+1,256/t.height*2+1],oe=o?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;oe.clear();const ae=_.lineVertexArray,ce=o?_.text.placedSymbolArray:_.icon.placedSymbolArray,pe=t.transform.width/t.transform.height;let ue=!1;for(let ve=0;ve<ce.length;ve++){const be=ce.get(ve);if(be.hidden||be.writingMode===l.an.vertical&&!ue){So(be.numGlyphs,oe);continue}ue=!1;const fe=new l.P(be.anchorX,be.anchorY),Pe={getElevation:L,pitchedLabelPlaneMatrix:h,lineVertexArray:ae,pitchWithMap:y,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:t.transform,tileAnchorPoint:fe,unwrappedTileID:C,width:k,height:z,translation:O},Oe=$t(be.anchorX,be.anchorY,Pe);if(!Jt(Oe.point,se)){So(be.numGlyphs,oe);continue}const Ae=Rt(t.transform.cameraToCenterDistance,Oe.signedDistanceFromCamera),Re=l.ao(j,q,be),Fe=y?Re*t.transform.getPitchedTextCorrection(be.anchorX,be.anchorY,C)/Ae:Re*Ae,st=Cr({projectionContext:Pe,pitchedLabelPlaneMatrixInverse:f,symbol:be,fontSize:Fe,flip:!1,keepUpright:b,glyphOffsetArray:_.glyphOffsetArray,dynamicLayoutVertexArray:oe,aspectRatio:pe,rotateToLine:S});ue=st.useVertical,(st.notEnoughRoom||ue||st.needsFlipping&&Cr({projectionContext:Pe,pitchedLabelPlaneMatrixInverse:f,symbol:be,fontSize:Fe,flip:!0,keepUpright:b,glyphOffsetArray:_.glyphOffsetArray,dynamicLayoutVertexArray:oe,aspectRatio:pe,rotateToLine:S}).notEnoughRoom)&&So(be.numGlyphs,oe)}o?_.text.dynamicLayoutVertexBuffer.updateData(oe):_.icon.dynamicLayoutVertexBuffer.updateData(oe)}function nt(_,t,o,h,f,y,b,S){const C=y.glyphStartIndex+y.numGlyphs,k=y.lineStartIndex,z=y.lineStartIndex+y.lineLength,O=t.getoffsetX(y.glyphStartIndex),L=t.getoffsetX(C-1),j=io(_*O,o,h,f,y.segment,k,z,S,b);if(!j)return null;const q=io(_*L,o,h,f,y.segment,k,z,S,b);return q?S.projectionCache.anyProjectionOccluded?null:{first:j,last:q}:null}function bn(_,t,o,h){return _===l.an.horizontal&&Math.abs(o.y-t.y)>Math.abs(o.x-t.x)*h?{useVertical:!0}:(_===l.an.vertical?t.y<o.y:t.x>o.x)?{needsFlipping:!0}:null}function Cr(_){const{projectionContext:t,pitchedLabelPlaneMatrixInverse:o,symbol:h,fontSize:f,flip:y,keepUpright:b,glyphOffsetArray:S,dynamicLayoutVertexArray:C,aspectRatio:k,rotateToLine:z}=_,O=f/24,L=h.lineOffsetX*O,j=h.lineOffsetY*O;let q;if(h.numGlyphs>1){const se=h.glyphStartIndex+h.numGlyphs,oe=h.lineStartIndex,ae=h.lineStartIndex+h.lineLength,ce=nt(O,S,L,j,y,h,z,t);if(!ce)return{notEnoughRoom:!0};const pe=jt(ce.first.point.x,ce.first.point.y,t,o),ue=jt(ce.last.point.x,ce.last.point.y,t,o);if(b&&!y){const ve=bn(h.writingMode,pe,ue,k);if(ve)return ve}q=[ce.first];for(let ve=h.glyphStartIndex+1;ve<se-1;ve++){const be=io(O*S.getoffsetX(ve),L,j,y,h.segment,oe,ae,t,z);if(!be)return{notEnoughRoom:!0};q.push(be)}q.push(ce.last)}else{if(b&&!y){const oe=at(t.tileAnchorPoint.x,t.tileAnchorPoint.y,t).point,ae=h.lineStartIndex+h.segment+1,ce=new l.P(t.lineVertexArray.getx(ae),t.lineVertexArray.gety(ae)),pe=at(ce.x,ce.y,t),ue=pe.signedDistanceFromCamera>0?pe.point:Qo(t.tileAnchorPoint,ce,oe,1,t),ve=jt(oe.x,oe.y,t,o),be=jt(ue.x,ue.y,t,o),fe=bn(h.writingMode,ve,be,k);if(fe)return fe}const se=io(O*S.getoffsetX(h.glyphStartIndex),L,j,y,h.segment,h.lineStartIndex,h.lineStartIndex+h.lineLength,t,z);if(!se||t.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};q=[se]}for(const se of q)l.au(C,se.point,se.angle);return{}}function Qo(_,t,o,h,f){const y=_.add(_.sub(t)._unit()),b=at(y.x,y.y,f).point,S=o.sub(b);return o.add(S._mult(h/S.mag()))}function As(_,t,o){const h=t.projectionCache;if(h.projections[_])return h.projections[_];const f=new l.P(t.lineVertexArray.getx(_),t.lineVertexArray.gety(_)),y=at(f.x,f.y,t);if(y.signedDistanceFromCamera>0)return h.projections[_]=y.point,h.anyProjectionOccluded=h.anyProjectionOccluded||y.isOccluded,y.point;const b=_-o.direction;return Qo(o.distanceFromAnchor===0?t.tileAnchorPoint:new l.P(t.lineVertexArray.getx(b),t.lineVertexArray.gety(b)),f,o.previousVertex,o.absOffsetX-o.distanceFromAnchor+1,t)}function at(_,t,o){const h=_+o.translation[0],f=t+o.translation[1];let y;return o.pitchWithMap?(y=Bt(h,f,o.pitchedLabelPlaneMatrix,o.getElevation),y.isOccluded=!1):(y=o.transform.projectTileCoordinates(h,f,o.unwrappedTileID,o.getElevation),y.point.x=(.5*y.point.x+.5)*o.width,y.point.y=(.5*-y.point.y+.5)*o.height),y}function jt(_,t,o,h){if(o.pitchWithMap){const f=[_,t,0,1];return l.av(f,f,h),o.transform.projectTileCoordinates(f[0]/f[3],f[1]/f[3],o.unwrappedTileID,o.getElevation).point}return{x:_/o.width*2-1,y:1-t/o.height*2}}function $t(_,t,o){return o.transform.projectTileCoordinates(_,t,o.unwrappedTileID,o.getElevation)}function ui(_,t,o){return _._unit()._perp()._mult(t*o)}function Qc(_,t,o,h,f,y,b,S,C){if(S.projectionCache.offsets[_])return S.projectionCache.offsets[_];const k=o.add(t);if(_+C.direction<h||_+C.direction>=f)return S.projectionCache.offsets[_]=k,k;const z=As(_+C.direction,S,C),O=ui(z.sub(o),b,C.direction),L=o.add(O),j=z.add(O);return S.projectionCache.offsets[_]=l.aw(y,k,L,j)||k,S.projectionCache.offsets[_]}function io(_,t,o,h,f,y,b,S,C){const k=h?_-t:_+t;let z=k>0?1:-1,O=0;h&&(z*=-1,O=Math.PI),z<0&&(O+=Math.PI);let L,j=z>0?y+f:y+f+1;S.projectionCache.cachedAnchorPoint?L=S.projectionCache.cachedAnchorPoint:(L=at(S.tileAnchorPoint.x,S.tileAnchorPoint.y,S).point,S.projectionCache.cachedAnchorPoint=L);let q,se,oe=L,ae=L,ce=0,pe=0;const ue=Math.abs(k),ve=[];let be;for(;ce+pe<=ue;){if(j+=z,j<y||j>=b)return null;ce+=pe,ae=oe,se=q;const Oe={absOffsetX:ue,direction:z,distanceFromAnchor:ce,previousVertex:ae};if(oe=As(j,S,Oe),o===0)ve.push(ae),be=oe.sub(ae);else{let Ae;const Re=oe.sub(ae);Ae=Re.mag()===0?ui(As(j+z,S,Oe).sub(oe),o,z):ui(Re,o,z),se||(se=ae.add(Ae)),q=Qc(j,Ae,oe,y,b,se,o,S,Oe),ve.push(se),be=q.sub(se)}pe=be.mag()}const fe=be._mult((ue-ce)/pe)._add(se||ae),Pe=O+Math.atan2(oe.y-ae.y,oe.x-ae.x);return ve.push(fe),{point:fe,angle:C?Pe:0,path:ve}}const Ut=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function So(_,t){for(let o=0;o<_;o++){const h=t.length;t.resize(h+4),t.float32.set(Ut,3*h)}}function zs(_,t,o){const h=t[0],f=t[1];return _[0]=o[0]*h+o[4]*f+o[12],_[1]=o[1]*h+o[5]*f+o[13],_[3]=o[3]*h+o[7]*f+o[15],_}const Gr=100;class kl{constructor(t,o=new yt(t.width+200,t.height+200,25),h=new yt(t.width+200,t.height+200,25)){this.transform=t,this.grid=o,this.ignoredGrid=h,this.pitchFactor=Math.cos(t.pitch*Math.PI/180)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+Gr,this.screenBottomBoundary=t.height+Gr,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,o,h,f,y,b,S,C,k,z,O,L){const j=this.projectAndGetPerspectiveRatio(t.anchorPointX+C[0],t.anchorPointY+C[1],y,z,L),q=h*j.perspectiveRatio;let se;if(b||S)se=this._projectCollisionBox(t,q,f,y,b,S,C,j,z,O,L);else{const be=j.x+(O?O.x*q:0),fe=j.y+(O?O.y*q:0);se={allPointsOccluded:!1,box:[be+t.x1*q,fe+t.y1*q,be+t.x2*q,fe+t.y2*q]}}const[oe,ae,ce,pe]=se.box,ue=b?se.allPointsOccluded:j.isOccluded;let ve=ue;return ve||(ve=j.perspectiveRatio<this.perspectiveRatioCutoff),ve||(ve=!this.isInsideGrid(oe,ae,ce,pe)),ve||o!=="always"&&this.grid.hitTest(oe,ae,ce,pe,o,k)?{box:[oe,ae,ce,pe],placeable:!1,offscreen:!1,occluded:ue}:{box:[oe,ae,ce,pe],placeable:!0,offscreen:this.isOffscreen(oe,ae,ce,pe),occluded:ue}}placeCollisionCircles(t,o,h,f,y,b,S,C,k,z,O,L,j,q){const se=[],oe=new l.P(o.anchorX,o.anchorY),ae=this.getPerspectiveRatio(oe.x,oe.y,b,q),ce=(k?y*this.transform.getPitchedTextCorrection(o.anchorX,o.anchorY,b)/ae:y*ae)/l.aA,pe={getElevation:q,pitchedLabelPlaneMatrix:S,lineVertexArray:h,pitchWithMap:k,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:oe,unwrappedTileID:b,width:this.transform.width,height:this.transform.height,translation:j},ue=nt(ce,f,o.lineOffsetX*ce,o.lineOffsetY*ce,!1,o,!1,pe);let ve=!1,be=!1,fe=!0;if(ue){const Pe=.5*O*ae+L,Oe=new l.P(-100,-100),Ae=new l.P(this.screenRightBoundary,this.screenBottomBoundary),Re=new mt,Fe=ue.first,st=ue.last;let it=[];for(let Ft=Fe.path.length-1;Ft>=1;Ft--)it.push(Fe.path[Ft]);for(let Ft=1;Ft<st.path.length;Ft++)it.push(st.path[Ft]);const Ke=2.5*Pe;if(k){const Ft=this.projectPathToScreenSpace(it,pe);it=Ft.some(cr=>cr.signedDistanceFromCamera<=0)?[]:Ft.map(cr=>cr.point)}let vt=[];if(it.length>0){const Ft=it[0].clone(),cr=it[0].clone();for(let kr=1;kr<it.length;kr++)Ft.x=Math.min(Ft.x,it[kr].x),Ft.y=Math.min(Ft.y,it[kr].y),cr.x=Math.max(cr.x,it[kr].x),cr.y=Math.max(cr.y,it[kr].y);vt=Ft.x>=Oe.x&&cr.x<=Ae.x&&Ft.y>=Oe.y&&cr.y<=Ae.y?[it]:cr.x<Oe.x||Ft.x>Ae.x||cr.y<Oe.y||Ft.y>Ae.y?[]:l.ax([it],Oe.x,Oe.y,Ae.x,Ae.y)}for(const Ft of vt){Re.reset(Ft,.25*Pe);let cr=0;cr=Re.length<=.5*Pe?1:Math.ceil(Re.paddedLength/Ke)+1;for(let kr=0;kr<cr;kr++){const pr=kr/Math.max(cr-1,1),Ir=Re.lerp(pr),_r=Ir.x+Gr,mr=Ir.y+Gr;se.push(_r,mr,Pe,0);const yr=_r-Pe,Sn=mr-Pe,rr=_r+Pe,pn=mr+Pe;if(fe=fe&&this.isOffscreen(yr,Sn,rr,pn),be=be||this.isInsideGrid(yr,Sn,rr,pn),t!=="always"&&this.grid.hitTestCircle(_r,mr,Pe,t,z)&&(ve=!0,!C))return{circles:[],offscreen:!1,collisionDetected:ve}}}}return{circles:!C&&ve||!be||ae<this.perspectiveRatioCutoff?[]:se,offscreen:fe,collisionDetected:ve}}projectPathToScreenSpace(t,o){const h=function(f,y){const b=l.L();return l.ap(b,y.pitchedLabelPlaneMatrix),f.map(S=>{const C=Bt(S.x,S.y,b,y.getElevation),k=y.transform.projectTileCoordinates(C.point.x,C.point.y,y.unwrappedTileID,y.getElevation);return k.point.x=(.5*k.point.x+.5)*y.width,k.point.y=(.5*-k.point.y+.5)*y.height,k})}(t,o);return function(f){let y=0,b=0,S=0,C=0;for(let k=0;k<f.length;k++)f[k].isOccluded?(S=k+1,C=0):(C++,C>b&&(b=C,y=S));return f.slice(y,y+b)}(h)}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const o=[],h=new l.a1;for(const O of t){const L=new l.P(O.x+Gr,O.y+Gr);h.extend(L),o.push(L)}const{minX:f,minY:y,maxX:b,maxY:S}=h,C=this.grid.query(f,y,b,S).concat(this.ignoredGrid.query(f,y,b,S)),k={},z={};for(const O of C){const L=O.key;if(k[L.bucketInstanceId]===void 0&&(k[L.bucketInstanceId]={}),k[L.bucketInstanceId][L.featureIndex])continue;const j=[new l.P(O.x1,O.y1),new l.P(O.x2,O.y1),new l.P(O.x2,O.y2),new l.P(O.x1,O.y2)];l.ay(o,j)&&(k[L.bucketInstanceId][L.featureIndex]=!0,z[L.bucketInstanceId]===void 0&&(z[L.bucketInstanceId]=[]),z[L.bucketInstanceId].push(L.featureIndex))}return z}insertCollisionBox(t,o,h,f,y,b){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:y,collisionGroupID:b,overlapMode:o},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,o,h,f,y,b){const S=h?this.ignoredGrid:this.grid,C={bucketInstanceId:f,featureIndex:y,collisionGroupID:b,overlapMode:o};for(let k=0;k<t.length;k+=4)S.insertCircle(C,t[k],t[k+1],t[k+2])}projectAndGetPerspectiveRatio(t,o,h,f,y){if(y){let b;f?(b=[t,o,f(t,o),1],l.av(b,b,y)):(b=[t,o,0,1],zs(b,b,y));const S=b[3];return{x:(b[0]/S+1)/2*this.transform.width+Gr,y:(-b[1]/S+1)/2*this.transform.height+Gr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/S*.5,isOccluded:!1,signedDistanceFromCamera:S}}{const b=this.transform.projectTileCoordinates(t,o,h,f);return{x:(b.point.x+1)/2*this.transform.width+Gr,y:(1-b.point.y)/2*this.transform.height+Gr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/b.signedDistanceFromCamera*.5,isOccluded:b.isOccluded,signedDistanceFromCamera:b.signedDistanceFromCamera}}}getPerspectiveRatio(t,o,h,f){const y=this.transform.projectTileCoordinates(t,o,h,f);return .5+this.transform.cameraToCenterDistance/y.signedDistanceFromCamera*.5}isOffscreen(t,o,h,f){return h<Gr||t>=this.screenRightBoundary||f<Gr||o>this.screenBottomBoundary}isInsideGrid(t,o,h,f){return h>=0&&t<this.gridRightBoundary&&f>=0&&o<this.gridBottomBoundary}getViewportMatrix(){const t=l.af([]);return l.M(t,t,[-100,-100,0]),t}_projectCollisionBox(t,o,h,f,y,b,S,C,k,z,O){let L=1,j=0,q=0,se=1;const oe=t.anchorPointX+S[0],ae=t.anchorPointY+S[1];if(b&&!y){const it=this.projectAndGetPerspectiveRatio(oe+1,ae,f,k,O),Ke=it.x-C.x,vt=Math.atan((it.y-C.y)/Ke)+(Ke<0?Math.PI:0),Ft=Math.sin(vt),cr=Math.cos(vt);L=cr,j=Ft,q=-Ft,se=cr}else if(!b&&y){const it=Nt(this.transform);L=it.vecEast[0],j=it.vecEast[1],q=it.vecSouth[0],se=it.vecSouth[1]}let ce=C.x,pe=C.y,ue=o;y&&(ce=oe,pe=ae,ue=Math.pow(2,-(this.transform.zoom-h.overscaledZ)),ue*=this.transform.getPitchedTextCorrection(oe,ae,f),z||(ue*=l.ag(.5+C.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),z&&(ce+=L*z.x*ue+q*z.y*ue,pe+=j*z.x*ue+se*z.y*ue);const ve=t.x1*ue,be=t.x2*ue,fe=(ve+be)/2,Pe=t.y1*ue,Oe=t.y2*ue,Ae=(Pe+Oe)/2,Re=[{offsetX:ve,offsetY:Pe},{offsetX:fe,offsetY:Pe},{offsetX:be,offsetY:Pe},{offsetX:be,offsetY:Ae},{offsetX:be,offsetY:Oe},{offsetX:fe,offsetY:Oe},{offsetX:ve,offsetY:Oe},{offsetX:ve,offsetY:Ae}];let Fe=[];for(const{offsetX:it,offsetY:Ke}of Re)Fe.push(new l.P(ce+L*it+q*Ke,pe+j*it+se*Ke));let st=!1;if(y){const it=Fe.map(Ke=>this.projectAndGetPerspectiveRatio(Ke.x,Ke.y,f,k,O));st=it.some(Ke=>!Ke.isOccluded),Fe=it.map(Ke=>new l.P(Ke.x,Ke.y))}else st=!0;return{box:l.az(Fe),allPointsOccluded:!st}}}class Il{constructor(t,o,h,f){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?o:-o))):f&&h?1:0,this.placed=h}isHidden(){return this.opacity===0&&!this.placed}}class To{constructor(t,o,h,f,y){this.text=new Il(t?t.text:null,o,h,y),this.icon=new Il(t?t.icon:null,o,f,y)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Al{constructor(t,o,h){this.text=t,this.icon=o,this.skipFade=h}}class hi{constructor(t,o,h,f,y){this.bucketInstanceId=t,this.featureIndex=o,this.sourceLayerIndex=h,this.bucketIndex=f,this.tileID=y}}class Pr{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const o=++this.maxGroupID;this.collisionGroups[t]={ID:o,predicate:h=>h.collisionGroupID===o}}return this.collisionGroups[t]}}function Bp(_,t,o,h,f){const{horizontalAlign:y,verticalAlign:b}=l.aG(_);return new l.P(-(y-.5)*t+h[0]*f,-(b-.5)*o+h[1]*f)}class zl{constructor(t,o,h,f,y){this.transform=t.clone(),this.terrain=o,this.collisionIndex=new kl(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new Pr(f),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const o=this.terrain;return o?(h,f)=>o.getElevation(t,h,f):null}getBucketParts(t,o,h,f){const y=h.getBucket(o),b=h.latestFeatureIndex;if(!y||!b||o.id!==y.layerIds[0])return;const S=h.collisionBoxArray,C=y.layers[0].layout,k=y.layers[0].paint,z=Math.pow(2,this.transform.zoom-h.tileID.overscaledZ),O=h.tileSize/l.$,L=h.tileID.toUnwrapped(),j=C.get("text-rotation-alignment")==="map",q=l.aB(h,1,this.transform.zoom),se=l.aC(this.collisionIndex.transform,h,k.get("text-translate"),k.get("text-translate-anchor")),oe=l.aC(this.collisionIndex.transform,h,k.get("icon-translate"),k.get("icon-translate-anchor")),ae=Et(j,this.transform,q);this.retainedQueryData[y.bucketInstanceId]=new hi(y.bucketInstanceId,b,y.sourceLayerIndex,y.index,h.tileID);const ce={bucket:y,layout:C,translationText:se,translationIcon:oe,unwrappedTileID:L,pitchedLabelPlaneMatrix:ae,scale:z,textPixelRatio:O,holdingForFade:h.holdingForFade(),collisionBoxArray:S,partiallyEvaluatedTextSize:l.am(y.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(f)for(const pe of y.sortKeyRanges){const{sortKey:ue,symbolInstanceStart:ve,symbolInstanceEnd:be}=pe;t.push({sortKey:ue,symbolInstanceStart:ve,symbolInstanceEnd:be,parameters:ce})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:ce})}attemptAnchorPlacement(t,o,h,f,y,b,S,C,k,z,O,L,j,q,se,oe,ae,ce,pe,ue){const ve=l.aD[t.textAnchor],be=[t.textOffset0,t.textOffset1],fe=Bp(ve,h,f,be,y),Pe=this.collisionIndex.placeCollisionBox(o,L,C,k,z,S,b,oe,O.predicate,pe,fe,ue);if((!ce||this.collisionIndex.placeCollisionBox(ce,L,C,k,z,S,b,ae,O.predicate,pe,fe,ue).placeable)&&Pe.placeable){let Oe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[j.crossTileID]&&this.prevPlacement.placements[j.crossTileID]&&this.prevPlacement.placements[j.crossTileID].text&&(Oe=this.prevPlacement.variableOffsets[j.crossTileID].anchor),j.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[j.crossTileID]={textOffset:be,width:h,height:f,anchor:ve,textBoxScale:y,prevAnchor:Oe},this.markUsedJustification(q,ve,j,se),q.allowVerticalPlacement&&(this.markUsedOrientation(q,se,j),this.placedOrientations[j.crossTileID]=se),{shift:fe,placedGlyphBoxes:Pe}}}placeLayerBucketPart(t,o,h){const{bucket:f,layout:y,translationText:b,translationIcon:S,unwrappedTileID:C,pitchedLabelPlaneMatrix:k,textPixelRatio:z,holdingForFade:O,collisionBoxArray:L,partiallyEvaluatedTextSize:j,collisionGroup:q}=t.parameters,se=y.get("text-optional"),oe=y.get("icon-optional"),ae=l.aE(y,"text-overlap","text-allow-overlap"),ce=ae==="always",pe=l.aE(y,"icon-overlap","icon-allow-overlap"),ue=pe==="always",ve=y.get("text-rotation-alignment")==="map",be=y.get("text-pitch-alignment")==="map",fe=y.get("icon-text-fit")!=="none",Pe=y.get("symbol-z-order")==="viewport-y",Oe=ce&&(ue||!f.hasIconData()||oe),Ae=ue&&(ce||!f.hasTextData()||se);!f.collisionArrays&&L&&f.deserializeCollisionBoxes(L);const Re=this.retainedQueryData[f.bucketInstanceId].tileID,Fe=this._getTerrainElevationFunc(Re),st=this.transform.getFastPathSimpleProjectionMatrix(Re),it=(Ke,vt,Ft)=>{var cr,kr;if(o[Ke.crossTileID])return;if(O)return void(this.placements[Ke.crossTileID]=new Al(!1,!1,!1));let pr=!1,Ir=!1,_r=!0,mr=null,yr={box:null,placeable:!1,offscreen:null,occluded:!1},Sn={placeable:!1},rr=null,pn=null,Tn=null,ss=0,as=0,ls=0;vt.textFeatureIndex?ss=vt.textFeatureIndex:Ke.useRuntimeCollisionCircles&&(ss=Ke.featureIndex),vt.verticalTextFeatureIndex&&(as=vt.verticalTextFeatureIndex);const uo=vt.textBox;if(uo){const ri=$r=>{let xr=l.an.horizontal;if(f.allowVerticalPlacement&&!$r&&this.prevPlacement){const Zn=this.prevPlacement.placedOrientations[Ke.crossTileID];Zn&&(this.placedOrientations[Ke.crossTileID]=Zn,xr=Zn,this.markUsedOrientation(f,xr,Ke))}return xr},Ui=($r,xr)=>{if(f.allowVerticalPlacement&&Ke.numVerticalGlyphVertices>0&&vt.verticalTextBox){for(const Zn of f.writingModes)if(Zn===l.an.vertical?(yr=xr(),Sn=yr):yr=$r(),yr&&yr.placeable)break}else yr=$r()},cs=Ke.textAnchorOffsetStartIndex,Zs=Ke.textAnchorOffsetEndIndex;if(Zs===cs){const $r=(xr,Zn)=>{const an=this.collisionIndex.placeCollisionBox(xr,ae,z,Re,C,be,ve,b,q.predicate,Fe,void 0,st);return an&&an.placeable&&(this.markUsedOrientation(f,Zn,Ke),this.placedOrientations[Ke.crossTileID]=Zn),an};Ui(()=>$r(uo,l.an.horizontal),()=>{const xr=vt.verticalTextBox;return f.allowVerticalPlacement&&Ke.numVerticalGlyphVertices>0&&xr?$r(xr,l.an.vertical):{box:null,offscreen:null}}),ri(yr&&yr.placeable)}else{let $r=l.aD[(kr=(cr=this.prevPlacement)===null||cr===void 0?void 0:cr.variableOffsets[Ke.crossTileID])===null||kr===void 0?void 0:kr.anchor];const xr=(an,zm,Ky)=>{const Hd=an.x2-an.x1,cc=an.y2-an.y1,Na=Ke.textBoxScale,ko=fe&&pe==="never"?zm:null;let Cn=null,Io=ae==="never"?1:2,Wd="never";$r&&Io++;for(let us=0;us<Io;us++){for(let qd=cs;qd<Zs;qd++){const Xd=f.textAnchorOffsets.get(qd);if($r&&Xd.textAnchor!==$r)continue;const uc=this.attemptAnchorPlacement(Xd,an,Hd,cc,Na,ve,be,z,Re,C,q,Wd,Ke,f,Ky,b,S,ko,Fe);if(uc&&(Cn=uc.placedGlyphBoxes,Cn&&Cn.placeable))return pr=!0,mr=uc.shift,Cn}$r?$r=null:Wd=ae}return h&&!Cn&&(Cn={box:this.collisionIndex.placeCollisionBox(uo,"always",z,Re,C,be,ve,b,q.predicate,Fe,void 0,st).box,offscreen:!1,placeable:!1,occluded:!1}),Cn};Ui(()=>xr(uo,vt.iconBox,l.an.horizontal),()=>{const an=vt.verticalTextBox;return f.allowVerticalPlacement&&(!yr||!yr.placeable)&&Ke.numVerticalGlyphVertices>0&&an?xr(an,vt.verticalIconBox,l.an.vertical):{box:null,occluded:!0,offscreen:null}}),yr&&(pr=yr.placeable,_r=yr.offscreen);const Zn=ri(yr&&yr.placeable);if(!pr&&this.prevPlacement){const an=this.prevPlacement.variableOffsets[Ke.crossTileID];an&&(this.variableOffsets[Ke.crossTileID]=an,this.markUsedJustification(f,an.anchor,Ke,Zn))}}}if(rr=yr,pr=rr&&rr.placeable,_r=rr&&rr.offscreen,Ke.useRuntimeCollisionCircles){const ri=f.text.placedSymbolArray.get(Ke.centerJustifiedTextSymbolIndex),Ui=l.ao(f.textSizeData,j,ri),cs=y.get("text-padding");pn=this.collisionIndex.placeCollisionCircles(ae,ri,f.lineVertexArray,f.glyphOffsetArray,Ui,C,k,h,be,q.predicate,Ke.collisionCircleDiameter,cs,b,Fe),pn.circles.length&&pn.collisionDetected&&!h&&l.w("Collisions detected, but collision boxes are not shown"),pr=ce||pn.circles.length>0&&!pn.collisionDetected,_r=_r&&pn.offscreen}if(vt.iconFeatureIndex&&(ls=vt.iconFeatureIndex),vt.iconBox){const ri=Ui=>this.collisionIndex.placeCollisionBox(Ui,pe,z,Re,C,be,ve,S,q.predicate,Fe,fe&&mr?mr:void 0,st);Sn&&Sn.placeable&&vt.verticalIconBox?(Tn=ri(vt.verticalIconBox),Ir=Tn.placeable):(Tn=ri(vt.iconBox),Ir=Tn.placeable),_r=_r&&Tn.offscreen}const ac=se||Ke.numHorizontalGlyphVertices===0&&Ke.numVerticalGlyphVertices===0,lc=oe||Ke.numIconVertices===0;ac||lc?lc?ac||(Ir=Ir&&pr):pr=Ir&&pr:Ir=pr=Ir&&pr;const Fa=Ir&&Tn.placeable;if(pr&&rr.placeable&&this.collisionIndex.insertCollisionBox(rr.box,ae,y.get("text-ignore-placement"),f.bucketInstanceId,Sn&&Sn.placeable&&as?as:ss,q.ID),Fa&&this.collisionIndex.insertCollisionBox(Tn.box,pe,y.get("icon-ignore-placement"),f.bucketInstanceId,ls,q.ID),pn&&pr&&this.collisionIndex.insertCollisionCircles(pn.circles,ae,y.get("text-ignore-placement"),f.bucketInstanceId,ss,q.ID),h&&this.storeCollisionData(f.bucketInstanceId,Ft,vt,rr,Tn,pn),Ke.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(f.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ke.crossTileID]=new Al((pr||Oe)&&!(rr!=null&&rr.occluded),(Ir||Ae)&&!(Tn!=null&&Tn.occluded),_r||f.justReloaded),o[Ke.crossTileID]=!0};if(Pe){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ke=f.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let vt=Ke.length-1;vt>=0;--vt){const Ft=Ke[vt];it(f.symbolInstances.get(Ft),f.collisionArrays[Ft],Ft)}}else for(let Ke=t.symbolInstanceStart;Ke<t.symbolInstanceEnd;Ke++)it(f.symbolInstances.get(Ke),f.collisionArrays[Ke],Ke);f.justReloaded=!1}storeCollisionData(t,o,h,f,y,b){if(h.textBox||h.iconBox){let S,C;this.collisionBoxArrays.has(t)?S=this.collisionBoxArrays.get(t):(S=new Map,this.collisionBoxArrays.set(t,S)),S.has(o)?C=S.get(o):(C={text:null,icon:null},S.set(o,C)),h.textBox&&(C.text=f.box),h.iconBox&&(C.icon=y.box)}if(b){let S=this.collisionCircleArrays[t];S===void 0&&(S=this.collisionCircleArrays[t]=[]);for(let C=0;C<b.circles.length;C+=4)S.push(b.circles[C+0]-Gr),S.push(b.circles[C+1]-Gr),S.push(b.circles[C+2]),S.push(b.collisionDetected?1:0)}}markUsedJustification(t,o,h,f){let y;y=f===l.an.vertical?h.verticalPlacedTextSymbolIndex:{left:h.leftJustifiedTextSymbolIndex,center:h.centerJustifiedTextSymbolIndex,right:h.rightJustifiedTextSymbolIndex}[l.aF(o)];const b=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex,h.verticalPlacedTextSymbolIndex];for(const S of b)S>=0&&(t.text.placedSymbolArray.get(S).crossTileID=y>=0&&S!==y?0:h.crossTileID)}markUsedOrientation(t,o,h){const f=o===l.an.horizontal||o===l.an.horizontalOnly?o:0,y=o===l.an.vertical?o:0,b=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex];for(const S of b)t.text.placedSymbolArray.get(S).placedOrientation=f;h.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(h.verticalPlacedTextSymbolIndex).placedOrientation=y)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const o=this.prevPlacement;let h=!1;this.prevZoomAdjustment=o?o.zoomAdjustment(this.transform.zoom):0;const f=o?o.symbolFadeChange(t):1,y=o?o.opacities:{},b=o?o.variableOffsets:{},S=o?o.placedOrientations:{};for(const C in this.placements){const k=this.placements[C],z=y[C];z?(this.opacities[C]=new To(z,f,k.text,k.icon),h=h||k.text!==z.text.placed||k.icon!==z.icon.placed):(this.opacities[C]=new To(null,f,k.text,k.icon,k.skipFade),h=h||k.text||k.icon)}for(const C in y){const k=y[C];if(!this.opacities[C]){const z=new To(k,f,!1,!1);z.isHidden()||(this.opacities[C]=z,h=h||k.text.placed||k.icon.placed)}}for(const C in b)this.variableOffsets[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.variableOffsets[C]=b[C]);for(const C in S)this.placedOrientations[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.placedOrientations[C]=S[C]);if(o&&o.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");h?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=o?o.lastPlacementChangeTime:t)}updateLayerOpacities(t,o){const h={};for(const f of o){const y=f.getBucket(t);y&&f.latestFeatureIndex&&t.id===y.layerIds[0]&&this.updateBucketOpacities(y,f.tileID,h,f.collisionBoxArray)}}updateBucketOpacities(t,o,h,f){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const y=t.layers[0],b=y.layout,S=new To(null,0,!1,!1,!0),C=b.get("text-allow-overlap"),k=b.get("icon-allow-overlap"),z=y._unevaluatedLayout.hasValue("text-variable-anchor")||y._unevaluatedLayout.hasValue("text-variable-anchor-offset"),O=b.get("text-rotation-alignment")==="map",L=b.get("text-pitch-alignment")==="map",j=b.get("icon-text-fit")!=="none",q=new To(null,0,C&&(k||!t.hasIconData()||b.get("icon-optional")),k&&(C||!t.hasTextData()||b.get("text-optional")),!0);!t.collisionArrays&&f&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(f);const se=(ae,ce,pe)=>{for(let ue=0;ue<ce/4;ue++)ae.opacityVertexArray.emplaceBack(pe);ae.hasVisibleVertices=ae.hasVisibleVertices||pe!==Rl},oe=this.collisionBoxArrays.get(t.bucketInstanceId);for(let ae=0;ae<t.symbolInstances.length;ae++){const ce=t.symbolInstances.get(ae),{numHorizontalGlyphVertices:pe,numVerticalGlyphVertices:ue,crossTileID:ve}=ce;let be=this.opacities[ve];h[ve]?be=S:be||(be=q,this.opacities[ve]=be),h[ve]=!0;const fe=ce.numIconVertices>0,Pe=this.placedOrientations[ce.crossTileID],Oe=Pe===l.an.vertical,Ae=Pe===l.an.horizontal||Pe===l.an.horizontalOnly;if(pe>0||ue>0){const Fe=Zp(be.text);se(t.text,pe,Oe?Rl:Fe),se(t.text,ue,Ae?Rl:Fe);const st=be.text.isHidden();[ce.rightJustifiedTextSymbolIndex,ce.centerJustifiedTextSymbolIndex,ce.leftJustifiedTextSymbolIndex].forEach(vt=>{vt>=0&&(t.text.placedSymbolArray.get(vt).hidden=st||Oe?1:0)}),ce.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(ce.verticalPlacedTextSymbolIndex).hidden=st||Ae?1:0);const it=this.variableOffsets[ce.crossTileID];it&&this.markUsedJustification(t,it.anchor,ce,Pe);const Ke=this.placedOrientations[ce.crossTileID];Ke&&(this.markUsedJustification(t,"left",ce,Ke),this.markUsedOrientation(t,Ke,ce))}if(fe){const Fe=Zp(be.icon),st=!(j&&ce.verticalPlacedIconSymbolIndex&&Oe);ce.placedIconSymbolIndex>=0&&(se(t.icon,ce.numIconVertices,st?Fe:Rl),t.icon.placedSymbolArray.get(ce.placedIconSymbolIndex).hidden=be.icon.isHidden()),ce.verticalPlacedIconSymbolIndex>=0&&(se(t.icon,ce.numVerticalIconVertices,st?Rl:Fe),t.icon.placedSymbolArray.get(ce.verticalPlacedIconSymbolIndex).hidden=be.icon.isHidden())}const Re=oe&&oe.has(ae)?oe.get(ae):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Fe=t.collisionArrays[ae];if(Fe){let st=new l.P(0,0);if(Fe.textBox||Fe.verticalTextBox){let it=!0;if(z){const Ke=this.variableOffsets[ve];Ke?(st=Bp(Ke.anchor,Ke.width,Ke.height,Ke.textOffset,Ke.textBoxScale),O&&st._rotate(L?-this.transform.bearingInRadians:this.transform.bearingInRadians)):it=!1}if(Fe.textBox||Fe.verticalTextBox){let Ke;Fe.textBox&&(Ke=Oe),Fe.verticalTextBox&&(Ke=Ae),Jc(t.textCollisionBox.collisionVertexArray,be.text.placed,!it||Ke,Re.text,st.x,st.y)}}if(Fe.iconBox||Fe.verticalIconBox){const it=!!(!Ae&&Fe.verticalIconBox);let Ke;Fe.iconBox&&(Ke=it),Fe.verticalIconBox&&(Ke=!it),Jc(t.iconCollisionBox.collisionVertexArray,be.icon.placed,Ke,Re.icon,j?st.x:0,j?st.y:0)}}}}if(t.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);t.bucketInstanceId in this.collisionCircleArrays&&(t.collisionCircleArray=this.collisionCircleArrays[t.bucketInstanceId],delete this.collisionCircleArrays[t.bucketInstanceId])}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,o){const h=this.zoomAtLastRecencyCheck===o?1-this.zoomAdjustment(o):1;return this.zoomAtLastRecencyCheck=o,this.commitTime+this.fadeDuration*h>t}setStale(){this.stale=!0}}function Jc(_,t,o,h,f,y){h&&h.length!==0||(h=[0,0,0,0]);const b=h[0]-Gr,S=h[1]-Gr,C=h[2]-Gr,k=h[3]-Gr;_.emplaceBack(t?1:0,o?1:0,f||0,y||0,b,S),_.emplaceBack(t?1:0,o?1:0,f||0,y||0,C,S),_.emplaceBack(t?1:0,o?1:0,f||0,y||0,C,k),_.emplaceBack(t?1:0,o?1:0,f||0,y||0,b,k)}const Rs=Math.pow(2,25),Jo=Math.pow(2,24),jp=Math.pow(2,17),$p=Math.pow(2,16),Up=Math.pow(2,9),ha=Math.pow(2,8),Vp=Math.pow(2,1);function Zp(_){if(_.opacity===0&&!_.placed)return 0;if(_.opacity===1&&_.placed)return 4294967295;const t=_.placed?1:0,o=Math.floor(127*_.opacity);return o*Rs+t*Jo+o*jp+t*$p+o*Up+t*ha+o*Vp+t}const Rl=0;class Ty{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,o,h,f,y){const b=this._bucketParts;for(;this._currentTileIndex<t.length;)if(o.getBucketParts(b,f,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,b.sort((S,C)=>S.sortKey-C.sortKey));this._currentPartIndex<b.length;)if(o.placeLayerBucketPart(b[this._currentPartIndex],this._seenCrossTileIDs,h),this._currentPartIndex++,y())return!0;return!1}}class Gp{constructor(t,o,h,f,y,b,S,C){this.placement=new zl(t,o,b,S,C),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(t,o,h){const f=F.now(),y=()=>!this._forceFullPlacement&&F.now()-f>2;for(;this._currentPlacementIndex>=0;){const b=o[t[this._currentPlacementIndex]],S=this.placement.collisionIndex.transform.zoom;if(b.type==="symbol"&&(!b.minzoom||b.minzoom<=S)&&(!b.maxzoom||b.maxzoom>S)){if(this._inProgressLayer||(this._inProgressLayer=new Ty(b)),this._inProgressLayer.continuePlacement(h[b.source],this.placement,this._showCollisionBoxes,b,y))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const da=512/l.$/2;class td{constructor(t,o,h){this.tileID=t,this.bucketInstanceId=h,this._symbolsByKey={};const f=new Map;for(let y=0;y<o.length;y++){const b=o.get(y),S=b.key,C=f.get(S);C?C.push(b):f.set(S,[b])}for(const[y,b]of f){const S={positions:b.map(C=>({x:Math.floor(C.anchorX*da),y:Math.floor(C.anchorY*da)})),crossTileIDs:b.map(C=>C.crossTileID)};if(S.positions.length>128){const C=new l.aH(S.positions.length,16,Uint16Array);for(const{x:k,y:z}of S.positions)C.add(k,z);C.finish(),delete S.positions,S.index=C}this._symbolsByKey[y]=S}}getScaledCoordinates(t,o){const{x:h,y:f,z:y}=this.tileID.canonical,{x:b,y:S,z:C}=o.canonical,k=da/Math.pow(2,C-y),z=(S*l.$+t.anchorY)*k,O=f*l.$*da;return{x:Math.floor((b*l.$+t.anchorX)*k-h*l.$*da),y:Math.floor(z-O)}}findMatches(t,o,h){const f=this.tileID.canonical.z<o.canonical.z?1:Math.pow(2,this.tileID.canonical.z-o.canonical.z);for(let y=0;y<t.length;y++){const b=t.get(y);if(b.crossTileID)continue;const S=this._symbolsByKey[b.key];if(!S)continue;const C=this.getScaledCoordinates(b,o);if(S.index){const k=S.index.range(C.x-f,C.y-f,C.x+f,C.y+f).sort();for(const z of k){const O=S.crossTileIDs[z];if(!h[O]){h[O]=!0,b.crossTileID=O;break}}}else if(S.positions)for(let k=0;k<S.positions.length;k++){const z=S.positions[k],O=S.crossTileIDs[k];if(Math.abs(z.x-C.x)<=f&&Math.abs(z.y-C.y)<=f&&!h[O]){h[O]=!0,b.crossTileID=O;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:t})=>t)}}class rd{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Hp{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const o=Math.round((t-this.lng)/360);if(o!==0)for(const h in this.indexes){const f=this.indexes[h],y={};for(const b in f){const S=f[b];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+o),y[S.tileID.key]=S}this.indexes[h]=y}this.lng=t}addBucket(t,o,h){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===o.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let y=0;y<o.symbolInstances.length;y++)o.symbolInstances.get(y).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const f=this.usedCrossTileIDs[t.overscaledZ];for(const y in this.indexes){const b=this.indexes[y];if(Number(y)>t.overscaledZ)for(const S in b){const C=b[S];C.tileID.isChildOf(t)&&C.findMatches(o.symbolInstances,t,f)}else{const S=b[t.scaledTo(Number(y)).key];S&&S.findMatches(o.symbolInstances,t,f)}}for(let y=0;y<o.symbolInstances.length;y++){const b=o.symbolInstances.get(y);b.crossTileID||(b.crossTileID=h.generate(),f[b.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new td(t,o.symbolInstances,o.bucketInstanceId),!0}removeBucketCrossTileIDs(t,o){for(const h of o.getCrossTileIDsLists())for(const f of h)delete this.usedCrossTileIDs[t][f]}removeStaleBuckets(t){let o=!1;for(const h in this.indexes){const f=this.indexes[h];for(const y in f)t[f[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(h,f[y]),delete f[y],o=!0)}return o}}class eu{constructor(){this.layerIndexes={},this.crossTileIDs=new rd,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,o,h){let f=this.layerIndexes[t.id];f===void 0&&(f=this.layerIndexes[t.id]=new Hp);let y=!1;const b={};f.handleWrapJump(h);for(const S of o){const C=S.getBucket(t);C&&t.id===C.layerIds[0]&&(C.bucketInstanceId||(C.bucketInstanceId=++this.maxBucketInstanceId),f.addBucket(S.tileID,C,this.crossTileIDs)&&(y=!0),b[C.bucketInstanceId]=!0)}return f.removeStaleBuckets(b)&&(y=!0),y}pruneUnusedLayers(t){const o={};t.forEach(h=>{o[h]=!0});for(const h in this.layerIndexes)o[h]||delete this.layerIndexes[h]}}var tu="void main() {fragColor=vec4(1.0);}";const oo={prelude:Ht(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Ht("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Ht("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Ht(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Ht(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Ht(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Ht(tu,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Ht(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Ht(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Ht("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Ht("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:Ht(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:Ht("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Ht(tu,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Ht(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Ht(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Ht(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Ht(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Ht(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Ht(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Ht(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ht(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Ht(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Ht(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Ht(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Ht(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Ht(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Ht(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Ht(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Ht(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Ht("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Ht("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Ht("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Ht("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Ht(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Ht("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Ht(_,t){const o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,h=t.match(/in ([\w]+) ([\w]+)/g),f=_.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),b=y?y.concat(f):f,S={};return{fragmentSource:_=_.replace(o,(C,k,z,O,L)=>(S[L]=!0,k==="define"?`
#ifndef HAS_UNIFORM_u_${L}
in ${z} ${O} ${L};
#else
uniform ${z} ${O} u_${L};
#endif
`:`
#ifdef HAS_UNIFORM_u_${L}
    ${z} ${O} ${L} = u_${L};
#endif
`)),vertexSource:t=t.replace(o,(C,k,z,O,L)=>{const j=O==="float"?"vec2":"vec4",q=L.match(/color/)?"color":j;return S[L]?k==="define"?`
#ifndef HAS_UNIFORM_u_${L}
uniform lowp float u_${L}_t;
in ${z} ${j} a_${L};
out ${z} ${O} ${L};
#else
uniform ${z} ${O} u_${L};
#endif
`:q==="vec4"?`
#ifndef HAS_UNIFORM_u_${L}
    ${L} = a_${L};
#else
    ${z} ${O} ${L} = u_${L};
#endif
`:`
#ifndef HAS_UNIFORM_u_${L}
    ${L} = unpack_mix_${q}(a_${L}, u_${L}_t);
#else
    ${z} ${O} ${L} = u_${L};
#endif
`:k==="define"?`
#ifndef HAS_UNIFORM_u_${L}
uniform lowp float u_${L}_t;
in ${z} ${j} a_${L};
#else
uniform ${z} ${O} u_${L};
#endif
`:q==="vec4"?`
#ifndef HAS_UNIFORM_u_${L}
    ${z} ${O} ${L} = a_${L};
#else
    ${z} ${O} ${L} = u_${L};
#endif
`:`
#ifndef HAS_UNIFORM_u_${L}
    ${z} ${O} ${L} = unpack_mix_${q}(a_${L}, u_${L}_t);
#else
    ${z} ${O} ${L} = u_${L};
#endif
`}),staticAttributes:h,staticUniforms:b}}class Co{constructor(t,o,h){this.vertexBuffer=t,this.indexBuffer=o,this.segments=h}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Po=l.aI([{name:"a_pos",type:"Int16",components:2}]);const Ds="#define PROJECTION_MERCATOR",nd="mercator";class id{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return nd}get shaderDefine(){return Ds}get shaderPreludeCode(){return oo.projectionMercator}get vertexShaderPreludeCode(){return oo.projectionMercator.vertexSource}get subdivisionGranularity(){return l.aJ.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(t){}getMeshFromTileID(t,o,h,f,y){if(this._cachedMesh)return this._cachedMesh;const b=new l.aK;b.emplaceBack(0,0),b.emplaceBack(l.$,0),b.emplaceBack(0,l.$),b.emplaceBack(l.$,l.$);const S=t.createVertexBuffer(b,Po.members),C=l.aL.simpleSegment(0,0,4,2),k=new l.aM;k.emplaceBack(1,0,2),k.emplaceBack(1,2,3);const z=t.createIndexBuffer(k);return this._cachedMesh=new Co(S,z,C),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(t){}}class Ti{constructor(t=0,o=0,h=0,f=0){if(isNaN(t)||t<0||isNaN(o)||o<0||isNaN(h)||h<0||isNaN(f)||f<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=o,this.left=h,this.right=f}interpolate(t,o,h){return o.top!=null&&t.top!=null&&(this.top=l.C.number(t.top,o.top,h)),o.bottom!=null&&t.bottom!=null&&(this.bottom=l.C.number(t.bottom,o.bottom,h)),o.left!=null&&t.left!=null&&(this.left=l.C.number(t.left,o.left,h)),o.right!=null&&t.right!=null&&(this.right=l.C.number(t.right,o.right,h)),this}getCenter(t,o){const h=l.ag((this.left+t-this.right)/2,0,t),f=l.ag((this.top+o-this.bottom)/2,0,o);return new l.P(h,f)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new Ti(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Eo(_,t){if(!_.renderWorldCopies||_.lngRange)return;const o=t.lng-_.center.lng;t.lng+=o>180?-360:o<-180?360:0}function Wt(_){return Math.max(0,Math.floor(_))}class Dl{constructor(t,o,h,f,y,b){this._callbacks=t,this._tileSize=512,this._renderWorldCopies=b===void 0||!!b,this._minZoom=o||0,this._maxZoom=h||22,this._minPitch=f??0,this._maxPitch=y??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new l.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Wt(this._zoom),this._scale=l.ae(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Ti,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(t,o,h){this._latRange=t.latRange,this._lngRange=t.lngRange,this._width=t.width,this._height=t.height,this._center=t.center,this._elevation=t.elevation,this._minElevationForCurrentTile=t.minElevationForCurrentTile,this._zoom=t.zoom,this._tileZoom=Wt(this._zoom),this._scale=l.ae(this._zoom),this._bearingInRadians=t.bearingInRadians,this._fovInRadians=t.fovInRadians,this._pitchInRadians=t.pitchInRadians,this._rollInRadians=t.rollInRadians,this._unmodified=t.unmodified,this._edgeInsets=new Ti(t.padding.top,t.padding.bottom,t.padding.left,t.padding.right),this._minZoom=t.minZoom,this._maxZoom=t.maxZoom,this._minPitch=t.minPitch,this._maxPitch=t.maxPitch,this._renderWorldCopies=t.renderWorldCopies,this._cameraToCenterDistance=t.cameraToCenterDistance,this._nearZ=t.nearZ,this._farZ=t.farZ,this._autoCalculateNearFarZ=!h&&t.autoCalculateNearFarZ,o&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(t){this._minElevationForCurrentTile=t}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(t){this._minZoom!==t&&(this._minZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(t){this._minPitch!==t&&(this._minPitch=t,this.setPitch(Math.max(this.pitch,t)))}get maxPitch(){return this._maxPitch}setMaxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.setPitch(Math.min(this.pitch,t)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(t){const o=l.aN(t,-180,180)*Math.PI/180;var h,f,y,b,S,C,k,z,O;this._bearingInRadians!==o&&(this._unmodified=!1,this._bearingInRadians=o,this._calcMatrices(),this._rotationMatrix=P(),h=this._rotationMatrix,y=-this._bearingInRadians,b=(f=this._rotationMatrix)[0],S=f[1],C=f[2],k=f[3],z=Math.sin(y),O=Math.cos(y),h[0]=b*O+C*z,h[1]=S*O+k*z,h[2]=b*-z+C*O,h[3]=S*-z+k*O)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(t){const o=l.ag(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==o&&(this._unmodified=!1,this._pitchInRadians=o,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(t){const o=t/180*Math.PI;this._rollInRadians!==o&&(this._unmodified=!1,this._rollInRadians=o,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return l.aO(this._fovInRadians)}setFov(t){t=l.ag(t,.1,150),this.fov!==t&&(this._unmodified=!1,this._fovInRadians=l.ad(t),this._calcMatrices())}get zoom(){return this._zoom}setZoom(t){const o=this.getConstrained(this._center,t).zoom;this._zoom!==o&&(this._unmodified=!1,this._zoom=o,this._tileZoom=Math.max(0,Math.floor(o)),this._scale=l.ae(o),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(t,o){this._autoCalculateNearFarZ=!1,this._nearZ=t,this._farZ=o,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,o,h){this._unmodified=!1,this._edgeInsets.interpolate(t,o,h),this._constrain(),this._calcMatrices()}resize(t,o,h=!0){this._width=t,this._height=o,h&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Gt([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(t){t?(this._lngRange=[t.getWest(),t.getEast()],this._latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-l.ah,l.ah])}getConstrained(t,o){return this._callbacks.getConstrained(t,o)}getCameraQueryGeometry(t,o){if(o.length===1)return[o[0],t];{const{minX:h,minY:f,maxX:y,maxY:b}=l.a1.fromPoints(o).extend(t);return[new l.P(h,f),new l.P(y,f),new l.P(y,b),new l.P(h,b),new l.P(h,f)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:o,zoom:h}=this.getConstrained(this.center,this.zoom);this.setCenter(o),this.setZoom(h),this._unmodified=t,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let t=l.af(new Float64Array(16));l.N(t,t,[this._width/2,-this._height/2,1]),l.M(t,t,[1,-1,0]),this._clipSpaceToPixelsMatrix=t,t=l.af(new Float64Array(16)),l.N(t,t,[1,-1,1]),l.M(t,t,[-1,-1,0]),l.N(t,t,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=t,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(t,o,h,f){const y=h!==void 0?h:this.bearing,b=f=f!==void 0?f:this.pitch,S=l.a0.fromLngLat(t,o),C=-Math.cos(l.ad(b)),k=Math.sin(l.ad(b)),z=k*Math.sin(l.ad(y)),O=-k*Math.cos(l.ad(y));let L=this.elevation;const j=o-L;let q;C*j>=0||Math.abs(C)<.1?(q=1e4,L=o+q*C):q=-j/C;let se,oe,ae=l.aP(1,S.y),ce=0;do{if(ce+=1,ce>10)break;oe=q/ae,se=new l.a0(S.x+z*oe,S.y+O*oe),ae=1/se.meterInMercatorCoordinateUnits()}while(Math.abs(q-oe*ae)>1e-12);return{center:se.toLngLat(),elevation:L,zoom:l.aj(this.height/2/Math.tan(this.fovInRadians/2)/oe/this.tileSize)}}recalculateZoomAndCenter(t){if(this.elevation-t==0)return;const o=l.ai(1,this.center.lat)*this.worldSize,h=this.cameraToCenterDistance/o,f=l.a0.fromLngLat(this.center,this.elevation),y=de(this.center,this.elevation,this.pitch,this.bearing,h);this._elevation=t;const b=this.calculateCenterFromCameraLngLatAlt(y.toLngLat(),l.aP(y.z,f.y),this.bearing,this.pitch);this._elevation=b.elevation,this._center=b.center,this.setZoom(b.zoom)}getCameraPoint(){const t=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.P(t*Math.sin(this.rollInRadians),t*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const t=l.ai(1,this.center.lat)*this.worldSize;return de(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/t).toLngLat()}getMercatorTileCoordinates(t){if(!t)return[0,0,1,1];const o=t.canonical.z>=0?1<<t.canonical.z:Math.pow(2,t.canonical.z);return[t.canonical.x/o,t.canonical.y/o,1/o/l.$,1/o/l.$]}}class ru{constructor(t,o){this.min=t,this.max=o,this.center=l.aQ([],l.aR([],this.min,this.max),.5)}quadrant(t){const o=[t%2==0,t<2],h=l.aS(this.min),f=l.aS(this.max);for(let y=0;y<o.length;y++)h[y]=o[y]?this.min[y]:this.center[y],f[y]=o[y]?this.center[y]:this.max[y];return f[2]=this.max[2],new ru(h,f)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersectsFrustum(t){let o=!0;for(let h=0;h<t.planes.length;h++){const f=this.intersectsPlane(t.planes[h]);if(f===0)return 0;f===1&&(o=!1)}return o?2:t.aabb.min[0]>this.max[0]||t.aabb.min[1]>this.max[1]||t.aabb.min[2]>this.max[2]||t.aabb.max[0]<this.min[0]||t.aabb.max[1]<this.min[1]||t.aabb.max[2]<this.min[2]?0:1}intersectsPlane(t){let o=t[3],h=t[3];for(let f=0;f<3;f++)t[f]>0?(o+=t[f]*this.min[f],h+=t[f]*this.max[f]):(h+=t[f]*this.min[f],o+=t[f]*this.max[f]);return o>=0?2:h<0?0:1}}class od{distanceToTile2d(t,o,h,f){const y=f.distanceX([t,o]),b=f.distanceY([t,o]);return Math.hypot(y,b)}getWrap(t,o,h){return h}getTileBoundingVolume(t,o,h,f){var y,b;let S=h,C=h;if(f!=null&&f.terrain){const z=new l.Z(t.z,o,t.z,t.x,t.y),O=f.terrain.getMinMaxElevation(z);S=(y=O.minElevation)!==null&&y!==void 0?y:h,C=(b=O.maxElevation)!==null&&b!==void 0?b:h}const k=1<<t.z;return new ru([o+t.x/k,t.y/k,S],[o+(t.x+1)/k,(t.y+1)/k,C])}allowVariableZoom(t,o){const h=t.fov*(Math.abs(Math.cos(t.rollInRadians))*t.height+Math.abs(Math.sin(t.rollInRadians))*t.width)/t.height,f=l.ag(78.5-h/2,0,60);return!!o.terrain||t.pitch>f}allowWorldCopies(){return!0}prepareNextFrame(){}}class An{constructor(t,o,h){this.points=t,this.planes=o,this.aabb=h}static fromInvProjectionMatrix(t,o=1,h=0,f,y){const b=y?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],S=Math.pow(2,h),C=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(L=>function(j,q,se,oe){const ae=l.av([],j,q),ce=1/ae[3]/se*oe;return l.aX(ae,ae,[ce,ce,1/ae[3],ce])}(L,t,o,S));f&&function(L,j,q,se){const oe=se?4:0,ae=se?0:4;let ce=0;const pe=[],ue=[];for(let fe=0;fe<4;fe++){const Pe=l.aT([],L[fe+ae],L[fe+oe]),Oe=l.aY(Pe);l.aQ(Pe,Pe,1/Oe),pe.push(Oe),ue.push(Pe)}for(let fe=0;fe<4;fe++){const Pe=l.aZ(L[fe+oe],ue[fe],q);ce=Pe!==null&&Pe>=0?Math.max(ce,Pe):Math.max(ce,pe[fe])}const ve=function(fe,Pe){const Oe=l.aT([],fe[Pe[0]],fe[Pe[1]]),Ae=l.aT([],fe[Pe[2]],fe[Pe[1]]),Re=[0,0,0,0];return l.aU(Re,l.aV([],Oe,Ae)),Re[3]=-l.aW(Re,fe[Pe[0]]),Re}(L,j),be=function(fe,Pe){const Oe=l.a_(fe),Ae=l.a$([],fe,1/Oe),Re=l.aT([],Pe,l.aQ([],Ae,l.aW(Pe,Ae))),Fe=l.a_(Re);if(Fe>0){const st=Math.sqrt(1-Ae[3]*Ae[3]),it=l.aQ([],Ae,-Ae[3]),Ke=l.aR([],it,l.aQ([],Re,st/Fe));return l.b0(Pe,Ke)}return null}(q,ve);if(be!==null){const fe=be/l.aW(ue[0],ve);ce=Math.min(ce,fe)}for(let fe=0;fe<4;fe++){const Pe=Math.min(ce,pe[fe]);L[fe+ae]=[L[fe+oe][0]+ue[fe][0]*Pe,L[fe+oe][1]+ue[fe][1]*Pe,L[fe+oe][2]+ue[fe][2]*Pe,1]}}(C,b[0],f,y);const k=b.map(L=>{const j=l.aT([],C[L[0]],C[L[1]]),q=l.aT([],C[L[2]],C[L[1]]),se=l.aU([],l.aV([],j,q)),oe=-l.aW(se,C[L[1]]);return se.concat(oe)}),z=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],O=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const L of C)for(let j=0;j<3;j++)z[j]=Math.min(z[j],L[j]),O[j]=Math.max(O[j],L[j]);return new An(C,k,new ru(z,O))}}class Jr{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,o,h){return this._helper.interpolatePadding(t,o,h)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,o,h=!0){this._helper.resize(t,o,h)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,o){this._helper.overrideNearFarZ(t,o)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t,o){}constructor(t,o,h,f,y){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Dl({calcMatrices:()=>{this._calcMatrices()},getConstrained:(b,S)=>this.getConstrained(b,S)},t,o,h,f,y),this._coveringTilesDetailsProvider=new od}clone(){const t=new Jr;return t.apply(this),t}apply(t,o,h){this._helper.apply(t,o,h)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(t){const o=[new l.b1(0,t)];if(this._helper._renderWorldCopies){const h=this.screenPointToMercatorCoordinate(new l.P(0,0)),f=this.screenPointToMercatorCoordinate(new l.P(this._helper._width,0)),y=this.screenPointToMercatorCoordinate(new l.P(this._helper._width,this._helper._height)),b=this.screenPointToMercatorCoordinate(new l.P(0,this._helper._height)),S=Math.floor(Math.min(h.x,f.x,y.x,b.x)),C=Math.floor(Math.max(h.x,f.x,y.x,b.x)),k=1;for(let z=S-k;z<=C+k;z++)z!==0&&o.push(new l.b1(z,t))}return o}getCameraFrustum(){return An.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){const o=this.screenPointToLocation(this.centerPoint,t),h=t?t.getElevationForLngLatZoom(o,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(h)}setLocationAtPoint(t,o){const h=l.ai(this.elevation,this.center.lat),f=this.screenPointToMercatorCoordinateAtZ(o,h),y=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,h),b=l.a0.fromLngLat(t),S=new l.a0(b.x-(f.x-y.x),b.y-(f.y-y.y));this.setCenter(S==null?void 0:S.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(t,o){return o?this.coordinatePoint(l.a0.fromLngLat(t),o.getElevationForLngLatZoom(t,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(l.a0.fromLngLat(t))}screenPointToLocation(t,o){var h;return(h=this.screenPointToMercatorCoordinate(t,o))===null||h===void 0?void 0:h.toLngLat()}screenPointToMercatorCoordinate(t,o){if(o){const h=o.pointCoordinate(t);if(h!=null)return h}return this.screenPointToMercatorCoordinateAtZ(t)}screenPointToMercatorCoordinateAtZ(t,o){const h=o||0,f=[t.x,t.y,0,1],y=[t.x,t.y,1,1];l.av(f,f,this._pixelMatrixInverse),l.av(y,y,this._pixelMatrixInverse);const b=f[3],S=y[3],C=f[1]/b,k=y[1]/S,z=f[2]/b,O=y[2]/S,L=z===O?0:(h-z)/(O-z);return new l.a0(l.C.number(f[0]/b,y[0]/S,L)/this.worldSize,l.C.number(C,k,L)/this.worldSize,h)}coordinatePoint(t,o=0,h=this._pixelMatrix){const f=[t.x*this.worldSize,t.y*this.worldSize,o,1];return l.av(f,f,h),new l.P(f[0]/f[3],f[1]/f[3])}getBounds(){const t=Math.max(0,this._helper._height/2-J(this));return new Gt().extend(this.screenPointToLocation(new l.P(0,t))).extend(this.screenPointToLocation(new l.P(this._helper._width,t))).extend(this.screenPointToLocation(new l.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new l.P(0,this._helper._height)))}isPointOnMapSurface(t,o){return o?o.pointCoordinate(t)!=null:t.y>this.height/2-J(this)}calculatePosMatrix(t,o=!1,h){var f;const y=(f=t.key)!==null&&f!==void 0?f:l.b2(t.wrap,t.canonical.z,t.canonical.z,t.canonical.x,t.canonical.y),b=o?this._alignedPosMatrixCache:this._posMatrixCache;if(b.has(y)){const k=b.get(y);return h?k.f32:k.f64}const S=ie(t,this.worldSize);l.O(S,o?this._alignedProjMatrix:this._viewProjMatrix,S);const C={f64:S,f32:new Float32Array(S)};return b.set(y,C),h?C.f32:C.f64}calculateFogMatrix(t){const o=t.key,h=this._fogMatrixCacheF32;if(h.has(o))return h.get(o);const f=ie(t,this.worldSize);return l.O(f,this._fogMatrix,f),h.set(o,new Float32Array(f)),h.get(o)}getConstrained(t,o){o=l.ag(+o,this.minZoom,this.maxZoom);const h={center:new l.S(t.lng,t.lat),zoom:o};let f=this._helper._lngRange;if(!this._helper._renderWorldCopies&&f===null){const pe=179.9999999999;f=[-pe,pe]}const y=this.tileSize*l.ae(h.zoom);let b=0,S=y,C=0,k=y,z=0,O=0;const{x:L,y:j}=this.size;if(this._helper._latRange){const pe=this._helper._latRange;b=l.U(pe[1])*y,S=l.U(pe[0])*y,S-b<j&&(z=j/(S-b))}f&&(C=l.aN(l.V(f[0])*y,0,y),k=l.aN(l.V(f[1])*y,0,y),k<C&&(k+=y),k-C<L&&(O=L/(k-C)));const{x:q,y:se}=Me(y,t);let oe,ae;const ce=Math.max(O||0,z||0);if(ce){const pe=new l.P(O?(k+C)/2:q,z?(S+b)/2:se);return h.center=Q(y,pe).wrap(),h.zoom+=l.aj(ce),h}if(this._helper._latRange){const pe=j/2;se-pe<b&&(ae=b+pe),se+pe>S&&(ae=S-pe)}if(f){const pe=(C+k)/2;let ue=q;this._helper._renderWorldCopies&&(ue=l.aN(q,pe-y/2,pe+y/2));const ve=L/2;ue-ve<C&&(oe=C+ve),ue+ve>k&&(oe=k-ve)}if(oe!==void 0||ae!==void 0){const pe=new l.P(oe??q,ae??se);h.center=Q(y,pe).wrap()}return h}calculateCenterFromCameraLngLatAlt(t,o,h,f){return this._helper.calculateCenterFromCameraLngLatAlt(t,o,h,f)}_calculateNearFarZIfNeeded(t,o,h){if(!this._helper.autoCalculateNearFarZ)return;const f=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),y=t-f*this._helper._pixelPerMeter/Math.cos(o),b=f<0?y:t,S=Math.PI/2+this.pitchInRadians,C=l.ad(this.fov)*(Math.abs(Math.cos(l.ad(this.roll)))*this.height+Math.abs(Math.sin(l.ad(this.roll)))*this.width)/this.height*(.5+h.y/this.height),k=Math.sin(C)*b/Math.sin(l.ag(Math.PI-S-C,.01,Math.PI-.01)),z=J(this),O=Math.atan(z/this._helper.cameraToCenterDistance),L=l.ad(.75),j=O>L?2*O*(.5+h.y/(2*z)):L,q=Math.sin(j)*b/Math.sin(l.ag(Math.PI-S-j,.01,Math.PI-.01)),se=Math.min(k,q);this._helper._farZ=1.01*(Math.cos(Math.PI/2-o)*se+b),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const t=this.centerOffset,o=Me(this.worldSize,this.center),h=o.x,f=o.y;this._helper._pixelPerMeter=l.ai(1,this.center.lat)*this.worldSize;const y=l.ad(Math.min(this.pitch,Ni)),b=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(y));let S;this._calculateNearFarZIfNeeded(b,y,t),S=new Float64Array(16),l.b3(S,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),l.ap(this._invProjMatrix,S),S[8]=2*-t.x/this._helper._width,S[9]=2*t.y/this._helper._height,this._projectionMatrix=l.b4(S),l.N(S,S,[1,-1,1]),l.M(S,S,[0,0,-this._helper.cameraToCenterDistance]),l.b5(S,S,-this.rollInRadians),l.b6(S,S,this.pitchInRadians),l.b5(S,S,-this.bearingInRadians),l.M(S,S,[-h,-f,0]),this._mercatorMatrix=l.N([],S,[this.worldSize,this.worldSize,this.worldSize]),l.N(S,S,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=l.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,S),l.M(S,S,[0,0,-this.elevation]),this._viewProjMatrix=S,this._invViewProjMatrix=l.ap([],S);const C=[0,0,-1,1];l.av(C,C,this._invViewProjMatrix),this._cameraPosition=[C[0]/C[3],C[1]/C[3],C[2]/C[3]],this._fogMatrix=new Float64Array(16),l.b3(this._fogMatrix,this.fovInRadians,this.width/this.height,b,this._helper._farZ),this._fogMatrix[8]=2*-t.x/this.width,this._fogMatrix[9]=2*t.y/this.height,l.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),l.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),l.b5(this._fogMatrix,this._fogMatrix,-this.rollInRadians),l.b6(this._fogMatrix,this._fogMatrix,this.pitchInRadians),l.b5(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),l.M(this._fogMatrix,this._fogMatrix,[-h,-f,0]),l.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),l.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=l.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,S);const k=this._helper._width%2/2,z=this._helper._height%2/2,O=Math.cos(this.bearingInRadians),L=Math.sin(-this.bearingInRadians),j=h-Math.round(h)+O*k+L*z,q=f-Math.round(f)+O*z+L*k,se=new Float64Array(S);if(l.M(se,se,[j>.5?j-1:j,q>.5?q-1:q,0]),this._alignedProjMatrix=se,S=l.ap(new Float64Array(16),this._pixelMatrix),!S)throw new Error("failed to invert matrix");this._pixelMatrixInverse=S,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const t=this.screenPointToMercatorCoordinate(new l.P(0,0)),o=[t.x*this.worldSize,t.y*this.worldSize,0,1];return l.av(o,o,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const t=l.ai(1,this.center.lat)*this.worldSize;return de(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/t).toLngLat()}lngLatToCameraDepth(t,o){const h=l.a0.fromLngLat(t),f=[h.x*this.worldSize,h.y*this.worldSize,o,1];return l.av(f,f,this._viewProjMatrix),f[2]/f[3]}getProjectionData(t){const{overscaledTileID:o,aligned:h,applyTerrainMatrix:f}=t,y=this._helper.getMercatorTileCoordinates(o),b=o?this.calculatePosMatrix(o,h,!0):null;let S;return S=o&&o.terrainRttPosMatrix32f&&f?o.terrainRttPosMatrix32f:b||l.b7(),{mainMatrix:S,tileMercatorCoords:y,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:S}}isLocationOccluded(t){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(t,o,h){return 1}transformLightDirection(t){return l.aS(t)}getRayDirectionFromPixel(t){throw new Error("Not implemented.")}projectTileCoordinates(t,o,h,f){const y=this.calculatePosMatrix(h);let b;f?(b=[t,o,f(t,o),1],l.av(b,b,y)):(b=[t,o,0,1],zs(b,b,y));const S=b[3];return{point:new l.P(b[0]/S,b[1]/S),signedDistanceFromCamera:S,isOccluded:!1}}populateCache(t){for(const o of t)this.calculatePosMatrix(o)}getMatrixForModel(t,o){const h=l.a0.fromLngLat(t,o),f=h.meterInMercatorCoordinateUnits(),y=l.b8();return l.M(y,y,[h.x,h.y,h.z]),l.b5(y,y,Math.PI),l.b6(y,y,Math.PI/2),l.N(y,y,[-f,f,f]),y}getProjectionDataForCustomLayer(t=!0){const o=new l.Z(0,0,0,0,0),h=this.getProjectionData({overscaledTileID:o,applyGlobeMatrix:t}),f=ie(o,this.worldSize);l.O(f,this._viewProjMatrix,f),h.tileMercatorCoords=[0,0,1,1];const y=[l.$,l.$,this.worldSize/this._helper.pixelsPerMeter],b=l.b9();return l.N(b,f,y),h.fallbackMatrix=b,h.mainMatrix=b,h}getFastPathSimpleProjectionMatrix(t){return this.calculatePosMatrix(t)}}function zn(){l.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function dn(_){if(_.useSlerp)if(_.k<1){const t=l.ba(_.startEulerAngles.roll,_.startEulerAngles.pitch,_.startEulerAngles.bearing),o=l.ba(_.endEulerAngles.roll,_.endEulerAngles.pitch,_.endEulerAngles.bearing),h=new Float64Array(4);l.bb(h,t,o,_.k);const f=l.bc(h);_.tr.setRoll(f.roll),_.tr.setPitch(f.pitch),_.tr.setBearing(f.bearing)}else _.tr.setRoll(_.endEulerAngles.roll),_.tr.setPitch(_.endEulerAngles.pitch),_.tr.setBearing(_.endEulerAngles.bearing);else _.tr.setRoll(l.C.number(_.startEulerAngles.roll,_.endEulerAngles.roll,_.k)),_.tr.setPitch(l.C.number(_.startEulerAngles.pitch,_.endEulerAngles.pitch,_.k)),_.tr.setBearing(l.C.number(_.startEulerAngles.bearing,_.endEulerAngles.bearing,_.k))}function Er(_,t,o,h,f){const y=f.padding,b=Me(f.worldSize,o.getNorthWest()),S=Me(f.worldSize,o.getNorthEast()),C=Me(f.worldSize,o.getSouthEast()),k=Me(f.worldSize,o.getSouthWest()),z=l.ad(-h),O=b.rotate(z),L=S.rotate(z),j=C.rotate(z),q=k.rotate(z),se=new l.P(Math.max(O.x,L.x,q.x,j.x),Math.max(O.y,L.y,q.y,j.y)),oe=new l.P(Math.min(O.x,L.x,q.x,j.x),Math.min(O.y,L.y,q.y,j.y)),ae=se.sub(oe),ce=(f.width-(y.left+y.right+t.left+t.right))/ae.x,pe=(f.height-(y.top+y.bottom+t.top+t.bottom))/ae.y;if(pe<0||ce<0)return void zn();const ue=Math.min(l.aj(f.scale*Math.min(ce,pe)),_.maxZoom),ve=l.P.convert(_.offset),be=new l.P((t.left-t.right)/2,(t.top-t.bottom)/2).rotate(l.ad(h)),fe=ve.add(be).mult(f.scale/l.ae(ue));return{center:Q(f.worldSize,b.add(C).div(2).sub(fe)),zoom:ue,bearing:h}}class nu{get useGlobeControls(){return!1}handlePanInertia(t,o){return{easingOffset:t,easingCenter:o.center}}handleMapControlsRollPitchBearingZoom(t,o){t.bearingDelta&&o.setBearing(o.bearing+t.bearingDelta),t.pitchDelta&&o.setPitch(o.pitch+t.pitchDelta),t.rollDelta&&o.setRoll(o.roll+t.rollDelta),t.zoomDelta&&o.setZoom(o.zoom+t.zoomDelta)}handleMapControlsPan(t,o,h){t.around.distSqr(o.centerPoint)<.01||o.setLocationAtPoint(h,t.around)}cameraForBoxAndBearing(t,o,h,f,y){return Er(t,o,h,f,y)}handleJumpToCenterZoom(t,o){t.zoom!==(o.zoom!==void 0?+o.zoom:t.zoom)&&t.setZoom(+o.zoom),o.center!==void 0&&t.setCenter(l.S.convert(o.center))}handleEaseTo(t,o){const h=t.zoom,f=t.padding,y={roll:t.roll,pitch:t.pitch,bearing:t.bearing},b={roll:o.roll===void 0?t.roll:o.roll,pitch:o.pitch===void 0?t.pitch:o.pitch,bearing:o.bearing===void 0?t.bearing:o.bearing},S=o.zoom!==void 0,C=!t.isPaddingEqual(o.padding);let k=!1;const z=S?+o.zoom:t.zoom;let O=t.centerPoint.add(o.offsetAsPoint);const L=t.screenPointToLocation(O),{center:j,zoom:q}=t.getConstrained(l.S.convert(o.center||L),z??h);Eo(t,j);const se=Me(t.worldSize,L),oe=Me(t.worldSize,j).sub(se),ae=l.ae(q-h);return k=q!==h,{easeFunc:ce=>{if(k&&t.setZoom(l.C.number(h,q,ce)),l.bd(y,b)||dn({startEulerAngles:y,endEulerAngles:b,tr:t,k:ce,useSlerp:y.roll!=b.roll}),C&&(t.interpolatePadding(f,o.padding,ce),O=t.centerPoint.add(o.offsetAsPoint)),o.around)t.setLocationAtPoint(o.around,o.aroundPoint);else{const pe=l.ae(t.zoom-h),ue=q>h?Math.min(2,ae):Math.max(.5,ae),ve=Math.pow(ue,1-ce),be=Q(t.worldSize,se.add(oe.mult(ce*ve)).mult(pe));t.setLocationAtPoint(t.renderWorldCopies?be.wrap():be,O)}},isZooming:k,elevationCenter:j}}handleFlyTo(t,o){const h=o.zoom!==void 0,f=t.zoom,y=t.getConstrained(l.S.convert(o.center||o.locationAtOffset),h?+o.zoom:f),b=y.center,S=y.zoom;Eo(t,b);const C=Me(t.worldSize,o.locationAtOffset),k=Me(t.worldSize,b).sub(C),z=k.mag(),O=l.ae(S-f);let L;if(o.minZoom!==void 0){const j=Math.min(+o.minZoom,f,S),q=t.getConstrained(b,j).zoom;L=l.ae(q-f)}return{easeFunc:(j,q,se,oe)=>{t.setZoom(j===1?S:f+l.aj(q));const ae=j===1?b:Q(t.worldSize,C.add(k.mult(se)).mult(q));t.setLocationAtPoint(t.renderWorldCopies?ae.wrap():ae,oe)},scaleOfZoom:O,targetCenter:b,scaleOfMinZoom:L,pixelPathLength:z}}}class er{constructor(t,o,h){this.blendFunction=t,this.blendColor=o,this.mask=h}}er.Replace=[1,0],er.disabled=new er(er.Replace,l.be.transparent,[!1,!1,!1,!1]),er.unblended=new er(er.Replace,l.be.transparent,[!0,!0,!0,!0]),er.alphaBlended=new er([1,771],l.be.transparent,[!0,!0,!0,!0]);const Qn=2305;class Lt{constructor(t,o,h){this.enable=t,this.mode=o,this.frontFace=h}}Lt.disabled=new Lt(!1,1029,Qn),Lt.backCCW=new Lt(!0,1029,Qn),Lt.frontCCW=new Lt(!0,1028,Qn);class Ot{constructor(t,o,h){this.func=t,this.mask=o,this.range=h}}Ot.ReadOnly=!1,Ot.ReadWrite=!0,Ot.disabled=new Ot(519,Ot.ReadOnly,[0,1]);const Ls=7680;class zt{constructor(t,o,h,f,y,b){this.test=t,this.ref=o,this.mask=h,this.fail=f,this.depthFail=y,this.pass=b}}zt.disabled=new zt({func:519,mask:0},0,0,Ls,Ls,Ls);const Os=new WeakMap;function jn(_){var t;if(Os.has(_))return Os.get(_);{const o=(t=_.getParameter(_.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return Os.set(_,o),o}}class fa{get awaitingQuery(){return!!this._readbackQueue}constructor(t){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=t;const o=t.context,h=o.gl;this._texFormat=h.RGBA,this._texType=h.UNSIGNED_BYTE;const f=new l.aK;f.emplaceBack(-1,-1),f.emplaceBack(2,-1),f.emplaceBack(-1,2);const y=new l.aM;y.emplaceBack(0,1,2),this._fullscreenTriangle=new Co(o.createVertexBuffer(f,Po.members),o.createIndexBuffer(y),l.aL.simpleSegment(0,0,f.length,y.length)),this._resultBuffer=new Uint8Array(4),o.activeTexture.set(h.TEXTURE1);const b=h.createTexture();h.bindTexture(h.TEXTURE_2D,b),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.NEAREST),h.texImage2D(h.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=o.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(b),jn(h)&&(this._pbo=h.createBuffer(),h.bindBuffer(h.PIXEL_PACK_BUFFER,this._pbo),h.bufferData(h.PIXEL_PACK_BUFFER,4,h.STREAM_READ),h.bindBuffer(h.PIXEL_PACK_BUFFER,null))}destroy(){const t=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),t.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(t,o){const h=this._updateCount;return this._readbackQueue?h>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():h>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(t,o),this._updateCount++,this._measuredError}_bindFramebuffer(){const t=this._cachedRenderContext.context,o=t.gl;t.activeTexture.set(o.TEXTURE1),o.bindTexture(o.TEXTURE_2D,this._fbo.colorAttachment.get()),t.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(t,o){const h=this._cachedRenderContext.context,f=h.gl;if(this._bindFramebuffer(),h.viewport.set([0,0,this._texWidth,this._texHeight]),h.clear({color:l.be.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(h,f.TRIANGLES,Ot.disabled,zt.disabled,er.unblended,Lt.disabled,((y,b)=>({u_input:y,u_output_expected:b}))(t,o),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&jn(f)){f.bindBuffer(f.PIXEL_PACK_BUFFER,this._pbo),f.readBuffer(f.COLOR_ATTACHMENT0),f.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),f.bindBuffer(f.PIXEL_PACK_BUFFER,null);const y=f.fenceSync(f.SYNC_GPU_COMMANDS_COMPLETE,0);f.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:y}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const t=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&jn(t)){const o=t.clientWaitSync(this._readbackQueue.sync,0,0);if(o===t.WAIT_FAILED)return l.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(o===t.TIMEOUT_EXPIRED)return;t.bindBuffer(t.PIXEL_PACK_BUFFER,this._pbo),t.getBufferSubData(t.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),t.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=fa._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(t){let o=0;return o+=t[0]/256,o+=t[1]/65536,o+=t[2]/16777216,t[3]<127&&(o=-o),o/128}}const Jn=l.$/128;function sd(_,t){const o=_.granularity!==void 0?Math.max(_.granularity,1):1,h=o+(_.generateBorders?2:0),f=o+(_.extendToNorthPole||_.generateBorders?1:0)+(_.extendToSouthPole||_.generateBorders?1:0),y=h+1,b=f+1,S=_.generateBorders?-1:0,C=_.generateBorders||_.extendToNorthPole?-1:0,k=o+(_.generateBorders?1:0),z=o+(_.generateBorders||_.extendToSouthPole?1:0),O=y*b,L=h*f*6,j=y*b>65536;if(j&&t==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const q=j||t==="32bit",se=new Int16Array(2*O);let oe=0;for(let pe=C;pe<=z;pe++)for(let ue=S;ue<=k;ue++){let ve=ue/o*l.$;ue===-1&&(ve=-Jn),ue===o+1&&(ve=l.$+Jn);let be=pe/o*l.$;pe===-1&&(be=_.extendToNorthPole?l.bg:-Jn),pe===o+1&&(be=_.extendToSouthPole?l.bh:l.$+Jn),se[oe++]=ve,se[oe++]=be}const ae=q?new Uint32Array(L):new Uint16Array(L);let ce=0;for(let pe=0;pe<f;pe++)for(let ue=0;ue<h;ue++){const ve=ue+1+pe*y,be=ue+(pe+1)*y,fe=ue+1+(pe+1)*y;ae[ce++]=ue+pe*y,ae[ce++]=be,ae[ce++]=ve,ae[ce++]=ve,ae[ce++]=be,ae[ce++]=fe}return{vertices:se.buffer.slice(0),indices:ae.buffer.slice(0),uses32bitIndices:q}}const so=new l.aJ({fill:new l.bi(128,2),line:new l.bi(512,0),tile:new l.bi(128,32),stencil:new l.bi(128,1),circle:3});class Wp{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return oo.projectionGlobe}get vertexShaderPreludeCode(){return oo.projectionMercator.vertexSource}get subdivisionGranularity(){return so}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(t){this._errorMeasurement||(this._errorMeasurement=new fa(t));const o=l.U(this._errorQueryLatitudeDegrees),h=2*Math.atan(Math.exp(Math.PI-o*Math.PI*2))-.5*Math.PI,f=this._errorMeasurement.updateErrorLoop(o,h),y=F.now();f!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=f,this._errorMeasurementLastChangeTime=y);const b=Math.min(Math.max((y-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=l.bj(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,l.bk(b))}_getMeshKey(t){return`${t.granularity.toString(36)}_${t.generateBorders?"b":""}${t.extendToNorthPole?"n":""}${t.extendToSouthPole?"s":""}`}getMeshFromTileID(t,o,h,f,y){const b=(y==="stencil"?so.stencil:so.tile).getGranularityForZoomLevel(o.z);return this._getMesh(t,{granularity:b,generateBorders:h,extendToNorthPole:o.y===0&&f,extendToSouthPole:o.y===(1<<o.z)-1&&f})}_getMesh(t,o){const h=this._getMeshKey(o);if(h in this._tileMeshCache)return this._tileMeshCache[h];const f=function(y,b){const S=sd(b,"16bit"),C=l.aK.deserialize({arrayBuffer:S.vertices,length:S.vertices.byteLength/2/2}),k=l.aM.deserialize({arrayBuffer:S.indices,length:S.indices.byteLength/2/3});return new Co(y.createVertexBuffer(C,Po.members),y.createIndexBuffer(k),l.aL.simpleSegment(0,0,C.length,k.length))}(t,o);return this._tileMeshCache[h]=f,f}recalculate(t){}hasTransition(){const t=F.now();let o=!1;return o=o||(t-this._errorMeasurementLastChangeTime)/1e3<.7,o=o||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,o}setErrorQueryLatitudeDegrees(t){this._errorQueryLatitudeDegrees=t}}const qp=new l.r({type:new l.D(l.v.projection.type)});class Ll extends l.E{constructor(t){super(),this._transitionable=new l.t(qp),this.setProjection(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new l.F(0)),this._mercatorProjection=new id,this._verticalPerspectiveProjection=new Wp}get transitionState(){const t=this.properties.get("type");if(typeof t=="string"&&t==="mercator")return 0;if(typeof t=="string"&&t==="vertical-perspective")return 1;if(t instanceof l.bl){if(t.from==="vertical-perspective"&&t.to==="mercator")return 1-t.transition;if(t.from==="mercator"&&t.to==="vertical-perspective")return t.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(t){this._mercatorProjection.updateGPUdependent(t),this._verticalPerspectiveProjection.updateGPUdependent(t)}getMeshFromTileID(t,o,h,f,y){return this.currentProjection.getMeshFromTileID(t,o,h,f,y)}setProjection(t){this._transitionable.setValue("type",(t==null?void 0:t.type)||"mercator")}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}setErrorQueryLatitudeDegrees(t){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(t),this._mercatorProjection.setErrorQueryLatitudeDegrees(t)}}function Ol(_){const t=pa(_.worldSize,_.center.lat);return 2*Math.PI*t}function Bi(_,t,o,h,f){const y=1/(1<<f),b=t/l.$*y+h*y,S=l.bn((_/l.$*y+o*y)*Math.PI*2+Math.PI,2*Math.PI),C=2*Math.atan(Math.exp(Math.PI-b*Math.PI*2))-.5*Math.PI,k=Math.cos(C),z=new Float64Array(3);return z[0]=Math.sin(S)*k,z[1]=Math.sin(C),z[2]=Math.cos(S)*k,z}function fn(_){return function(t,o){const h=Math.cos(o),f=new Float64Array(3);return f[0]=Math.sin(t)*h,f[1]=Math.sin(o),f[2]=Math.cos(t)*h,f}(_.lng*Math.PI/180,_.lat*Math.PI/180)}function pa(_,t){return _/(2*Math.PI)/Math.cos(t*Math.PI/180)}function Fl(_){const t=Math.asin(_[1])/Math.PI*180,o=Math.sqrt(_[0]*_[0]+_[2]*_[2]);if(o>1e-6){const h=_[0]/o,f=Math.acos(_[2]/o),y=(h>0?f:-f)/Math.PI*180;return new l.S(l.aN(y,-180,180),t)}return new l.S(0,t)}function ma(_){return Math.cos(_*Math.PI/180)}function en(_,t){const o=ma(_),h=ma(t);return l.aj(h/o)}function Nl(_,t){const o=_.rotate(t.bearingInRadians),h=t.zoom+en(t.center.lat,0),f=l.bj(1/ma(t.center.lat),1/ma(Math.min(Math.abs(t.center.lat),60)),l.bm(h,7,3,0,1)),y=360/Ol({worldSize:t.worldSize,center:{lat:t.center.lat}});return new l.S(t.center.lng-o.x*y*f,l.ag(t.center.lat+o.y*y,-l.ah,l.ah))}function ga(_){const t=.5*_,o=Math.sin(t),h=Math.cos(t);return Math.log(o+h)-Math.log(h-o)}function _a(_,t,o,h){const f=_.lat+o*h;if(Math.abs(o)>1){const y=(Math.sign(_.lat+o)!==Math.sign(_.lat)?-Math.abs(_.lat):Math.abs(_.lat))*Math.PI/180,b=Math.abs(_.lat+o)*Math.PI/180,S=ga(y+h*(b-y)),C=ga(y),k=ga(b);return new l.S(_.lng+t*((S-C)/(k-C)),f)}return new l.S(_.lng+t*h,f)}class Cy{constructor(t){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=t}swapBuffers(){if(!this._hadAnyChanges)return;const t=this._cachePrevious;this._cachePrevious=this._cache,this._cache=t,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(t,o,h,f){const y=`${t.z}_${t.x}_${t.y}_${f!=null&&f.terrain?"t":""}`,b=this._cache.get(y);if(b)return b;const S=this._cachePrevious.get(y);if(S)return this._cache.set(y,S),S;const C=this._boundingVolumeFactory(t,o,h,f);return this._cache.set(y,C),this._hadAnyChanges=!0,C}}class es{constructor(t,o,h,f){this.min=h,this.max=f,this.points=t,this.planes=o}static fromAabb(t,o){const h=[];for(let f=0;f<8;f++)h.push([1&~f?t[0]:o[0],(f>>1&1)==1?o[1]:t[1],(f>>2&1)==1?o[2]:t[2]]);return new es(h,[[-1,0,0,o[0]],[1,0,0,-t[0]],[0,-1,0,o[1]],[0,1,0,-t[1]],[0,0,-1,o[2]],[0,0,1,-t[2]]],t,o)}static fromCenterSizeAngles(t,o,h){const f=l.bq([],h[0],h[1],h[2]),y=l.br([],[o[0],0,0],f),b=l.br([],[0,o[1],0],f),S=l.br([],[0,0,o[2]],f),C=[...t],k=[...t];for(let O=0;O<8;O++)for(let L=0;L<3;L++){const j=t[L]+y[L]*(1&~O?-1:1)+b[L]*((O>>1&1)==1?1:-1)+S[L]*((O>>2&1)==1?1:-1);C[L]=Math.min(C[L],j),k[L]=Math.max(k[L],j)}const z=[];for(let O=0;O<8;O++){const L=[...t];l.aR(L,L,l.aQ([],y,1&~O?-1:1)),l.aR(L,L,l.aQ([],b,(O>>1&1)==1?1:-1)),l.aR(L,L,l.aQ([],S,(O>>2&1)==1?1:-1)),z.push(L)}return new es(z,[[...y,-l.aW(y,z[0])],[...b,-l.aW(b,z[0])],[...S,-l.aW(S,z[0])],[-y[0],-y[1],-y[2],-l.aW(y,z[7])],[-b[0],-b[1],-b[2],-l.aW(b,z[7])],[-S[0],-S[1],-S[2],-l.aW(S,z[7])]],C,k)}intersectsFrustum(t){let o=!0;const h=this.points.length,f=this.planes.length,y=t.planes.length,b=t.points.length;for(let S=0;S<y;S++){const C=t.planes[S];let k=0;for(let z=0;z<h;z++){const O=this.points[z];C[0]*O[0]+C[1]*O[1]+C[2]*O[2]+C[3]>=0&&k++}if(k===0)return 0;k<h&&(o=!1)}if(o)return 2;for(let S=0;S<f;S++){const C=this.planes[S];let k=0;for(let z=0;z<b;z++){const O=t.points[z];C[0]*O[0]+C[1]*O[1]+C[2]*O[2]+C[3]>=0&&k++}if(k===0)return 0}return 1}intersectsPlane(t){const o=this.points.length;let h=0;for(let f=0;f<o;f++){const y=this.points[f];t[0]*y[0]+t[1]*y[1]+t[2]*y[2]+t[3]>=0&&h++}return h===o?2:h===0?0:1}}function Bl(_,t,o){const h=_-t;return h<0?-h:Math.max(0,h-o)}function ad(_,t,o,h,f){const y=_-o;let b;return b=y<0?Math.min(-y,1+y-f):y>1?Math.min(Math.max(y-f,0),1-y):0,Math.max(b,Bl(t,h,f))}class Py{constructor(){this._boundingVolumeCache=new Cy(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(t,o,h,f){const y=1<<h.z,b=1/y,S=h.x/y,C=h.y/y;let k=2;return k=Math.min(k,ad(t,o,S,C,b)),k=Math.min(k,ad(t,o,S+.5,-C-b,b)),k=Math.min(k,ad(t,o,S+.5,2-C-b,b)),k}getWrap(t,o,h){const f=1<<o.z,y=1/f,b=o.x/f,S=Bl(t.x,b,y),C=Bl(t.x,b-1,y),k=Bl(t.x,b+1,y),z=Math.min(S,C,k);return z===k?1:z===C?-1:0}allowVariableZoom(t,o){return Ve(t,o)>4}allowWorldCopies(){return!1}getTileBoundingVolume(t,o,h,f){return this._boundingVolumeCache.getTileBoundingVolume(t,o,h,f)}_computeTileBoundingVolume(t,o,h,f){var y,b;let S=h,C=h;if(f!=null&&f.terrain){const k=new l.Z(t.z,o,t.z,t.x,t.y),z=f.terrain.getMinMaxElevation(k);S=(y=z.minElevation)!==null&&y!==void 0?y:h,C=(b=z.maxElevation)!==null&&b!==void 0?b:h}if(S/=l.bt,C/=l.bt,S+=1,C+=1,t.z<=0)return es.fromAabb([-C,-C,-C],[C,C,C]);if(t.z===1)return es.fromAabb([t.x===0?-C:0,t.y===0?0:-C,-C],[t.x===0?0:C,t.y===0?C:0,C]);{const k=[Bi(0,0,t.x,t.y,t.z),Bi(l.$,0,t.x,t.y,t.z),Bi(l.$,l.$,t.x,t.y,t.z),Bi(0,l.$,t.x,t.y,t.z)],z=[];for(const Re of k)z.push(l.aQ([],Re,C));if(C!==S)for(const Re of k)z.push(l.aQ([],Re,S));t.y===0&&z.push([0,1,0]),t.y===(1<<t.z)-1&&z.push([0,-1,0]);const O=[1,1,1],L=[-1,-1,-1];for(const Re of z)for(let Fe=0;Fe<3;Fe++)O[Fe]=Math.min(O[Fe],Re[Fe]),L[Fe]=Math.max(L[Fe],Re[Fe]);const j=Bi(l.$/2,l.$/2,t.x,t.y,t.z),q=l.aV([],[0,1,0],j);l.aU(q,q);const se=l.aV([],j,q);l.aU(se,se);const oe=l.aV([],k[2],k[1]);l.aU(oe,oe);const ae=l.aV([],k[0],k[3]);l.aU(ae,ae),z.push(l.aQ([],j,C)),t.y>=(1<<t.z)/2&&z.push(l.aQ([],Bi(l.$/2,0,t.x,t.y,t.z),C)),t.y<(1<<t.z)/2&&z.push(l.aQ([],Bi(l.$/2,l.$,t.x,t.y,t.z),C));const ce=$n(j,z),pe=$n(se,z),ue=[-j[0],-j[1],-j[2],ce.max],ve=[j[0],j[1],j[2],-ce.min],be=[-se[0],-se[1],-se[2],pe.max],fe=[se[0],se[1],se[2],-pe.min],Pe=[...oe,0],Oe=[...ae,0],Ae=[];return t.y===0?Ae.push(l.bs(Oe,Pe,ue),l.bs(Oe,Pe,ve)):Ae.push(l.bs(be,Pe,ue),l.bs(be,Pe,ve),l.bs(be,Oe,ue),l.bs(be,Oe,ve)),t.y===(1<<t.z)-1?Ae.push(l.bs(Oe,Pe,ue),l.bs(Oe,Pe,ve)):Ae.push(l.bs(fe,Pe,ue),l.bs(fe,Pe,ve),l.bs(fe,Oe,ue),l.bs(fe,Oe,ve)),new es(Ae,[ue,ve,be,fe,Pe,Oe],O,L)}}}function $n(_,t){let o=1/0,h=-1/0;for(const f of t){const y=l.aW(_,f);o=Math.min(o,y),h=Math.max(h,y)}return{min:o,max:h}}class ya{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,o,h){return this._helper.interpolatePadding(t,o,h)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,o){this._helper.resize(t,o)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,o){this._helper.overrideNearFarZ(t,o)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t){}constructor(){this._cachedClippingPlane=l.bu(),this._projectionMatrix=l.b8(),this._globeViewProjMatrix32f=l.b7(),this._globeViewProjMatrixNoCorrection=l.b8(),this._globeViewProjMatrixNoCorrectionInverted=l.b8(),this._globeProjMatrixInverted=l.b8(),this._cameraPosition=l.bo(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Dl({calcMatrices:()=>{this._calcMatrices()},getConstrained:(t,o)=>this.getConstrained(t,o)}),this._coveringTilesDetailsProvider=new Py}clone(){const t=new ya;return t.apply(this),t}apply(t,o){this._globeLatitudeErrorCorrectionRadians=o||0,this._helper.apply(t)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const t=l.bo();return t[0]=this._cameraPosition[0],t[1]=this._cameraPosition[1],t[2]=this._cameraPosition[2],t}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(t){const{overscaledTileID:o,applyGlobeMatrix:h}=t,f=this._helper.getMercatorTileCoordinates(o);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:f,clippingPlane:this._cachedClippingPlane,projectionTransition:h?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(t){const o=this.pitchInRadians,h=this.cameraToCenterDistance/t,f=Math.sin(o)*h,y=Math.cos(o)*h+1,b=1/Math.sqrt(f*f+y*y)*1;let S=-f,C=y;const k=Math.sqrt(S*S+C*C);S/=k,C/=k;const z=[0,S,C];l.bv(z,z,[0,0,0],-this.bearingInRadians),l.bw(z,z,[0,0,0],-1*this.center.lat*Math.PI/180),l.bx(z,z,[0,0,0],this.center.lng*Math.PI/180);const O=1/l.aY(z);return l.aQ(z,z,O),[...z,-b*O]}isLocationOccluded(t){return!this.isSurfacePointVisible(fn(t))}transformLightDirection(t){const o=this._helper._center.lng*Math.PI/180,h=this._helper._center.lat*Math.PI/180,f=Math.cos(h),y=[Math.sin(o)*f,Math.sin(h),Math.cos(o)*f],b=[y[2],0,-y[0]],S=[0,0,0];l.aV(S,b,y),l.aU(b,b),l.aU(S,S);const C=[0,0,0];return l.aU(C,[b[0]*t[0]+S[0]*t[1]+y[0]*t[2],b[1]*t[0]+S[1]*t[1]+y[1]*t[2],b[2]*t[0]+S[2]*t[1]+y[2]*t[2]]),C}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(t,o,h){const f=function(S,C,k){const z=1/(1<<k.z);return new l.a0(S/l.$*z+k.x*z,C/l.$*z+k.y*z)}(t,o,h.canonical),y=(b=f.y,[l.bn(f.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-b*Math.PI*2))-.5*Math.PI]);var b;return this.getCircleRadiusCorrection()/Math.cos(y[1])}projectTileCoordinates(t,o,h,f){const y=h.canonical,b=Bi(t,o,y.x,y.y,y.z),S=1+(f?f(t,o):0)/l.bt,C=[b[0]*S,b[1]*S,b[2]*S,1];l.av(C,C,this._globeViewProjMatrixNoCorrection);const k=this._cachedClippingPlane,z=k[0]*b[0]+k[1]*b[1]+k[2]*b[2]+k[3]<0;return{point:new l.P(C[0]/C[3],C[1]/C[3]),signedDistanceFromCamera:C[3],isOccluded:z}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const t=pa(this.worldSize,this.center.lat),o=l.b9(),h=l.b9();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*t),l.b3(o,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const f=this.centerOffset;o[8]=2*-f.x/this._helper._width,o[9]=2*f.y/this._helper._height,this._projectionMatrix=l.b4(o),this._globeProjMatrixInverted=l.b9(),l.ap(this._globeProjMatrixInverted,o),l.M(o,o,[0,0,-this.cameraToCenterDistance]),l.b5(o,o,this.rollInRadians),l.b6(o,o,-this.pitchInRadians),l.b5(o,o,this.bearingInRadians),l.M(o,o,[0,0,-t]);const y=l.bo();y[0]=t,y[1]=t,y[2]=t,l.b6(h,o,this.center.lat*Math.PI/180),l.by(h,h,-this.center.lng*Math.PI/180),l.N(h,h,y),this._globeViewProjMatrixNoCorrection=h,l.b6(o,o,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),l.by(o,o,-this.center.lng*Math.PI/180),l.N(o,o,y),this._globeViewProjMatrix32f=new Float32Array(o),this._globeViewProjMatrixNoCorrectionInverted=l.b9(),l.ap(this._globeViewProjMatrixNoCorrectionInverted,h);const b=l.bo();this._cameraPosition=l.bo(),this._cameraPosition[2]=this.cameraToCenterDistance/t,l.bv(this._cameraPosition,this._cameraPosition,b,-this.rollInRadians),l.bw(this._cameraPosition,this._cameraPosition,b,this.pitchInRadians),l.bv(this._cameraPosition,this._cameraPosition,b,-this.bearingInRadians),l.aR(this._cameraPosition,this._cameraPosition,[0,0,1]),l.bw(this._cameraPosition,this._cameraPosition,b,-this.center.lat*Math.PI/180),l.bx(this._cameraPosition,this._cameraPosition,b,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(t);const S=l.b4(this._globeViewProjMatrixNoCorrectionInverted);l.N(S,S,[1,1,-1]),this._cachedFrustum=An.fromInvProjectionMatrix(S,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(t){l.w("calculateFogMatrix is not supported on globe projection.");const o=l.b9();return l.af(o),o}getVisibleUnwrappedCoordinates(t){return[new l.b1(0,t)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){t&&l.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,o){if(!this._globeViewProjMatrixNoCorrection)return 1;const h=fn(t);l.aQ(h,h,1+o/l.bt);const f=l.bu();return l.av(f,[h[0],h[1],h[2],1],this._globeViewProjMatrixNoCorrection),f[2]/f[3]}populateCache(t){}getBounds(){const t=.5*this.width,o=.5*this.height,h=[new l.P(0,0),new l.P(t,0),new l.P(this.width,0),new l.P(this.width,o),new l.P(this.width,this.height),new l.P(t,this.height),new l.P(0,this.height),new l.P(0,o)],f=[];for(const O of h)f.push(this.unprojectScreenPoint(O));let y=0,b=0,S=0,C=0;const k=this.center;for(const O of f){const L=l.bz(k.lng,O.lng),j=l.bz(k.lat,O.lat);L<b&&(b=L),L>y&&(y=L),j<C&&(C=j),j>S&&(S=j)}const z=[k.lng+b,k.lat+C,k.lng+y,k.lat+S];return this.isSurfacePointOnScreen([0,1,0])&&(z[3]=90,z[0]=-180,z[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(z[1]=-90,z[0]=-180,z[2]=180),new Gt(z)}getConstrained(t,o){const h=l.ag(t.lat,-l.ah,l.ah),f=l.ag(+o,this.minZoom+en(0,h),this.maxZoom);return{center:new l.S(t.lng,h),zoom:f}}calculateCenterFromCameraLngLatAlt(t,o,h,f){return this._helper.calculateCenterFromCameraLngLatAlt(t,o,h,f)}setLocationAtPoint(t,o){const h=fn(this.unprojectScreenPoint(o)),f=fn(t),y=l.bo();l.bA(y);const b=l.bo();l.bx(b,h,y,-this.center.lng*Math.PI/180),l.bw(b,b,y,this.center.lat*Math.PI/180);const S=f[0]*f[0]+f[2]*f[2],C=b[0]*b[0];if(S<C)return;const k=Math.sqrt(S-C),z=-k,O=l.bB(f[0],f[2],b[0],k),L=l.bB(f[0],f[2],b[0],z),j=l.bo();l.bx(j,f,y,-O);const q=l.bB(j[1],j[2],b[1],b[2]),se=l.bo();l.bx(se,f,y,-L);const oe=l.bB(se[1],se[2],b[1],b[2]),ae=.5*Math.PI,ce=q>=-ae&&q<=ae,pe=oe>=-ae&&oe<=ae;let ue,ve;if(ce&&pe){const Oe=this.center.lng*Math.PI/180,Ae=this.center.lat*Math.PI/180;l.bC(O,Oe)+l.bC(q,Ae)<l.bC(L,Oe)+l.bC(oe,Ae)?(ue=O,ve=q):(ue=L,ve=oe)}else if(ce)ue=O,ve=q;else{if(!pe)return;ue=L,ve=oe}const be=ue/Math.PI*180,fe=ve/Math.PI*180,Pe=this.center.lat;this.setCenter(new l.S(be,l.ag(fe,-90,90))),this.setZoom(this.zoom+en(Pe,this.center.lat))}locationToScreenPoint(t,o){const h=fn(t);if(o){const f=o.getElevationForLngLatZoom(t,this._helper._tileZoom);l.aQ(h,h,1+f/l.bt)}return this._projectSurfacePointToScreen(h)}_projectSurfacePointToScreen(t){const o=l.bu();return l.av(o,[...t,1],this._globeViewProjMatrixNoCorrection),o[0]/=o[3],o[1]/=o[3],new l.P((.5*o[0]+.5)*this.width,(.5*-o[1]+.5)*this.height)}screenPointToMercatorCoordinate(t,o){if(o){const h=o.pointCoordinate(t);if(h)return h}return l.a0.fromLngLat(this.unprojectScreenPoint(t))}screenPointToLocation(t,o){var h;return(h=this.screenPointToMercatorCoordinate(t,o))===null||h===void 0?void 0:h.toLngLat()}isPointOnMapSurface(t,o){const h=this._cameraPosition,f=this.getRayDirectionFromPixel(t);return!!this.rayPlanetIntersection(h,f)}getRayDirectionFromPixel(t){const o=l.bu();o[0]=t.x/this.width*2-1,o[1]=-1*(t.y/this.height*2-1),o[2]=1,o[3]=1,l.av(o,o,this._globeViewProjMatrixNoCorrectionInverted),o[0]/=o[3],o[1]/=o[3],o[2]/=o[3];const h=l.bo();h[0]=o[0]-this._cameraPosition[0],h[1]=o[1]-this._cameraPosition[1],h[2]=o[2]-this._cameraPosition[2];const f=l.bo();return l.aU(f,h),f}isSurfacePointVisible(t){const o=this._cachedClippingPlane;return o[0]*t[0]+o[1]*t[1]+o[2]*t[2]+o[3]>=0}isSurfacePointOnScreen(t){if(!this.isSurfacePointVisible(t))return!1;const o=l.bu();return l.av(o,[...t,1],this._globeViewProjMatrixNoCorrection),o[0]/=o[3],o[1]/=o[3],o[2]/=o[3],o[0]>-1&&o[0]<1&&o[1]>-1&&o[1]<1&&o[2]>-1&&o[2]<1}rayPlanetIntersection(t,o){const h=l.aW(t,o),f=l.bo(),y=l.bo();l.aQ(y,o,h),l.aT(f,t,y);const b=1-l.aW(f,f);if(b<0)return null;const S=l.aW(t,t)-1,C=-h+(h<0?1:-1)*Math.sqrt(b),k=S/C,z=C;return{tMin:Math.min(k,z),tMax:Math.max(k,z)}}unprojectScreenPoint(t){const o=this._cameraPosition,h=this.getRayDirectionFromPixel(t),f=this.rayPlanetIntersection(o,h);if(f){const z=l.bo();l.aR(z,o,[h[0]*f.tMin,h[1]*f.tMin,h[2]*f.tMin]);const O=l.bo();return l.aU(O,z),Fl(O)}const y=this._cachedClippingPlane,b=y[0]*h[0]+y[1]*h[1]+y[2]*h[2],S=-l.b0(y,o)/b,C=l.bo();if(S>0)l.aR(C,o,[h[0]*S,h[1]*S,h[2]*S]);else{const z=l.bo();l.aR(z,o,[2*h[0],2*h[1],2*h[2]]);const O=l.b0(this._cachedClippingPlane,z);l.aT(C,z,[this._cachedClippingPlane[0]*O,this._cachedClippingPlane[1]*O,this._cachedClippingPlane[2]*O])}const k=function(z){const O=l.bo();return O[0]=z[0]*-z[3],O[1]=z[1]*-z[3],O[2]=z[2]*-z[3],{center:O,radius:Math.sqrt(1-z[3]*z[3])}}(y);return Fl(function(z,O,L){const j=l.bo();l.aT(j,L,z);const q=l.bo();return l.bp(q,z,j,O/l.a_(j)),q}(k.center,k.radius,C))}getMatrixForModel(t,o){const h=l.S.convert(t),f=1/l.bt,y=l.b8();return l.by(y,y,h.lng/180*Math.PI),l.b6(y,y,-h.lat/180*Math.PI),l.M(y,y,[0,0,1+o/l.bt]),l.b6(y,y,.5*Math.PI),l.N(y,y,[f,f,f]),y}getProjectionDataForCustomLayer(t=!0){const o=this.getProjectionData({overscaledTileID:new l.Z(0,0,0,0,0),applyGlobeMatrix:t});return o.tileMercatorCoords=[0,0,1,1],o}getFastPathSimpleProjectionMatrix(t){}}class di{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,o,h){return this._helper.interpolatePadding(t,o,h)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,o,h=!0){this._helper.resize(t,o,h)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,o){this._helper.overrideNearFarZ(t,o)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(t,o){this._globeness=t,this._globeLatitudeErrorCorrectionRadians=o,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Dl({calcMatrices:()=>{this._calcMatrices()},getConstrained:(t,o)=>this.getConstrained(t,o)}),this._globeness=1,this._mercatorTransform=new Jr,this._verticalPerspectiveTransform=new ya}clone(){const t=new di;return t._globeness=this._globeness,t._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,t.apply(this),t}apply(t){this._helper.apply(t),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(t){const o=this._mercatorTransform.getProjectionData(t),h=this._verticalPerspectiveTransform.getProjectionData(t);return{mainMatrix:this.isGlobeRendering?h.mainMatrix:o.mainMatrix,clippingPlane:h.clippingPlane,tileMercatorCoords:h.tileMercatorCoords,projectionTransition:t.applyGlobeMatrix?this._globeness:0,fallbackMatrix:o.fallbackMatrix}}isLocationOccluded(t){return this.currentTransform.isLocationOccluded(t)}transformLightDirection(t){return this.currentTransform.transformLightDirection(t)}getPixelScale(){return l.bj(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return l.bj(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(t,o,h){const f=this._mercatorTransform.getPitchedTextCorrection(t,o,h),y=this._verticalPerspectiveTransform.getPitchedTextCorrection(t,o,h);return l.bj(f,y,this._globeness)}projectTileCoordinates(t,o,h,f){return this.currentTransform.projectTileCoordinates(t,o,h,f)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(t){return this.currentTransform.calculateFogMatrix(t)}getVisibleUnwrappedCoordinates(t){return this.currentTransform.getVisibleUnwrappedCoordinates(t)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(t){this._mercatorTransform.recalculateZoomAndCenter(t),this._verticalPerspectiveTransform.recalculateZoomAndCenter(t)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,o){return this.currentTransform.lngLatToCameraDepth(t,o)}populateCache(t){this._mercatorTransform.populateCache(t),this._verticalPerspectiveTransform.populateCache(t)}getBounds(){return this.currentTransform.getBounds()}getConstrained(t,o){return this.currentTransform.getConstrained(t,o)}calculateCenterFromCameraLngLatAlt(t,o,h,f){return this._helper.calculateCenterFromCameraLngLatAlt(t,o,h,f)}setLocationAtPoint(t,o){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(t,o),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(t,o),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(t,o){return this.currentTransform.locationToScreenPoint(t,o)}screenPointToMercatorCoordinate(t,o){return this.currentTransform.screenPointToMercatorCoordinate(t,o)}screenPointToLocation(t,o){return this.currentTransform.screenPointToLocation(t,o)}isPointOnMapSurface(t,o){return this.currentTransform.isPointOnMapSurface(t,o)}getRayDirectionFromPixel(t){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(t)}getMatrixForModel(t,o){return this.currentTransform.getMatrixForModel(t,o)}getProjectionDataForCustomLayer(t=!0){const o=this._mercatorTransform.getProjectionDataForCustomLayer(t);if(!this.isGlobeRendering)return o;const h=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(t);return h.fallbackMatrix=o.mainMatrix,h}getFastPathSimpleProjectionMatrix(t){return this.currentTransform.getFastPathSimpleProjectionMatrix(t)}}class ei{get useGlobeControls(){return!0}handlePanInertia(t,o){const h=Nl(t,o);return Math.abs(h.lng-o.center.lng)>180&&(h.lng=o.center.lng+179.5*Math.sign(h.lng-o.center.lng)),{easingCenter:h,easingOffset:new l.P(0,0)}}handleMapControlsRollPitchBearingZoom(t,o){const h=t.around,f=o.screenPointToLocation(h);t.bearingDelta&&o.setBearing(o.bearing+t.bearingDelta),t.pitchDelta&&o.setPitch(o.pitch+t.pitchDelta),t.rollDelta&&o.setRoll(o.roll+t.rollDelta);const y=o.zoom;t.zoomDelta&&o.setZoom(o.zoom+t.zoomDelta);const b=o.zoom-y;if(b===0)return;const S=l.bz(o.center.lng,f.lng),C=S/(Math.abs(S/180)+1),k=l.bz(o.center.lat,f.lat),z=o.getRayDirectionFromPixel(h),O=o.cameraPosition,L=-1*l.aW(O,z),j=l.bo();l.aR(j,O,[z[0]*L,z[1]*L,z[2]*L]);const q=l.aY(j)-1,se=Math.exp(.5*-Math.max(q-.3,0)),oe=pa(o.worldSize,o.center.lat)/Math.min(o.width,o.height),ae=l.bm(oe,.9,.5,1,.25),ce=(1-l.ae(-b))*Math.min(se,ae),pe=o.center.lat,ue=o.zoom,ve=new l.S(o.center.lng+C*ce,l.ag(o.center.lat+k*ce,-l.ah,l.ah));o.setLocationAtPoint(f,h);const be=o.center,fe=l.bm(Math.abs(S),45,85,0,1),Pe=l.bm(oe,.75,.35,0,1),Oe=Math.pow(Math.max(fe,Pe),.25),Ae=l.bz(be.lng,ve.lng),Re=l.bz(be.lat,ve.lat);o.setCenter(new l.S(be.lng+Ae*Oe,be.lat+Re*Oe).wrap()),o.setZoom(ue+en(pe,o.center.lat))}handleMapControlsPan(t,o,h){if(!t.panDelta)return;const f=o.center.lat,y=o.zoom;o.setCenter(Nl(t.panDelta,o).wrap()),o.setZoom(y+en(f,o.center.lat))}cameraForBoxAndBearing(t,o,h,f,y){const b=Er(t,o,h,f,y),S=o.left/y.width*2-1,C=(y.width-o.right)/y.width*2-1,k=o.top/y.height*-2+1,z=(y.height-o.bottom)/y.height*-2+1,O=l.bz(h.getWest(),h.getEast())<0,L=O?h.getEast():h.getWest(),j=O?h.getWest():h.getEast(),q=Math.max(h.getNorth(),h.getSouth()),se=Math.min(h.getNorth(),h.getSouth()),oe=L+.5*l.bz(L,j),ae=q+.5*l.bz(q,se),ce=y.clone();ce.setCenter(b.center),ce.setBearing(b.bearing),ce.setPitch(0),ce.setRoll(0),ce.setZoom(b.zoom);const pe=ce.modelViewProjectionMatrix,ue=[fn(h.getNorthWest()),fn(h.getNorthEast()),fn(h.getSouthWest()),fn(h.getSouthEast()),fn(new l.S(j,ae)),fn(new l.S(L,ae)),fn(new l.S(oe,q)),fn(new l.S(oe,se))],ve=fn(b.center);let be=Number.POSITIVE_INFINITY;for(const fe of ue)S<0&&(be=ei.getLesserNonNegativeNonNull(be,ei.solveVectorScale(fe,ve,pe,"x",S))),C>0&&(be=ei.getLesserNonNegativeNonNull(be,ei.solveVectorScale(fe,ve,pe,"x",C))),k>0&&(be=ei.getLesserNonNegativeNonNull(be,ei.solveVectorScale(fe,ve,pe,"y",k))),z<0&&(be=ei.getLesserNonNegativeNonNull(be,ei.solveVectorScale(fe,ve,pe,"y",z)));if(Number.isFinite(be)&&be!==0)return b.zoom=ce.zoom+l.aj(be),b;zn()}handleJumpToCenterZoom(t,o){const h=t.center.lat,f=t.getConstrained(o.center?l.S.convert(o.center):t.center,t.zoom).center;t.setCenter(f.wrap());const y=o.zoom!==void 0?+o.zoom:t.zoom+en(h,f.lat);t.zoom!==y&&t.setZoom(y)}handleEaseTo(t,o){const h=t.zoom,f=t.center,y=t.padding,b={roll:t.roll,pitch:t.pitch,bearing:t.bearing},S={roll:o.roll===void 0?t.roll:o.roll,pitch:o.pitch===void 0?t.pitch:o.pitch,bearing:o.bearing===void 0?t.bearing:o.bearing},C=o.zoom!==void 0,k=!t.isPaddingEqual(o.padding);let z=!1;const O=o.center?l.S.convert(o.center):f,L=t.getConstrained(O,h).center;Eo(t,L);const j=t.clone();j.setCenter(L),j.setZoom(C?+o.zoom:h+en(f.lat,O.lat)),j.setBearing(o.bearing);const q=new l.P(l.ag(t.centerPoint.x+o.offsetAsPoint.x,0,t.width),l.ag(t.centerPoint.y+o.offsetAsPoint.y,0,t.height));j.setLocationAtPoint(L,q);const se=(o.offset&&o.offsetAsPoint.mag())>0?j.center:L,oe=C?+o.zoom:h+en(f.lat,se.lat),ae=h+en(f.lat,0),ce=oe+en(se.lat,0),pe=l.bz(f.lng,se.lng),ue=l.bz(f.lat,se.lat),ve=l.ae(ce-ae);return z=oe!==h,{easeFunc:be=>{if(l.bd(b,S)||dn({startEulerAngles:b,endEulerAngles:S,tr:t,k:be,useSlerp:b.roll!=S.roll}),k&&t.interpolatePadding(y,o.padding,be),o.around)l.w("Easing around a point is not supported under globe projection."),t.setLocationAtPoint(o.around,o.aroundPoint);else{const fe=ce>ae?Math.min(2,ve):Math.max(.5,ve),Pe=Math.pow(fe,1-be),Oe=_a(f,pe,ue,be*Pe);t.setCenter(Oe.wrap())}if(z){const fe=l.C.number(ae,ce,be)+en(0,t.center.lat);t.setZoom(fe)}},isZooming:z,elevationCenter:se}}handleFlyTo(t,o){const h=o.zoom!==void 0,f=t.center,y=t.zoom,b=t.padding,S=!t.isPaddingEqual(o.padding),C=t.getConstrained(l.S.convert(o.center||o.locationAtOffset),y).center,k=h?+o.zoom:t.zoom+en(t.center.lat,C.lat),z=t.clone();z.setCenter(C),z.setZoom(k),z.setBearing(o.bearing);const O=new l.P(l.ag(t.centerPoint.x+o.offsetAsPoint.x,0,t.width),l.ag(t.centerPoint.y+o.offsetAsPoint.y,0,t.height));z.setLocationAtPoint(C,O);const L=z.center;Eo(t,L);const j=function(ue,ve,be){const fe=fn(ve),Pe=fn(be),Oe=l.aW(fe,Pe),Ae=Math.acos(Oe),Re=Ol(ue);return Ae/(2*Math.PI)*Re}(t,f,L),q=y+en(f.lat,0),se=k+en(L.lat,0),oe=l.ae(se-q);let ae;if(typeof o.minZoom=="number"){const ue=+o.minZoom+en(L.lat,0),ve=Math.min(ue,q,se)+en(0,L.lat),be=t.getConstrained(L,ve).zoom+en(L.lat,0);ae=l.ae(be-q)}const ce=l.bz(f.lng,L.lng),pe=l.bz(f.lat,L.lat);return{easeFunc:(ue,ve,be,fe)=>{const Pe=_a(f,ce,pe,be);S&&t.interpolatePadding(b,o.padding,ue);const Oe=ue===1?L:Pe;t.setCenter(Oe.wrap());const Ae=q+l.aj(ve);t.setZoom(ue===1?k:Ae+en(0,Oe.lat))},scaleOfZoom:oe,targetCenter:L,scaleOfMinZoom:ae,pixelPathLength:j}}static solveVectorScale(t,o,h,f,y){const b=f==="x"?[h[0],h[4],h[8],h[12]]:[h[1],h[5],h[9],h[13]],S=[h[3],h[7],h[11],h[15]],C=t[0]*b[0]+t[1]*b[1]+t[2]*b[2],k=t[0]*S[0]+t[1]*S[1]+t[2]*S[2],z=o[0]*b[0]+o[1]*b[1]+o[2]*b[2],O=o[0]*S[0]+o[1]*S[1]+o[2]*S[2];return z+y*k===C+y*O||S[3]*(C-z)+b[3]*(O-k)+C*O==z*k?null:(z+b[3]-y*O-y*S[3])/(z-C-y*O+y*k)}static getLesserNonNegativeNonNull(t,o){return o!==null&&o>=0&&o<t?o:t}}class ld{constructor(t){this._globe=t,this._mercatorCameraHelper=new nu,this._verticalPerspectiveCameraHelper=new ei}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(t,o){return this.currentHelper.handlePanInertia(t,o)}handleMapControlsRollPitchBearingZoom(t,o){return this.currentHelper.handleMapControlsRollPitchBearingZoom(t,o)}handleMapControlsPan(t,o,h){this.currentHelper.handleMapControlsPan(t,o,h)}cameraForBoxAndBearing(t,o,h,f,y){return this.currentHelper.cameraForBoxAndBearing(t,o,h,f,y)}handleJumpToCenterZoom(t,o){this.currentHelper.handleJumpToCenterZoom(t,o)}handleEaseTo(t,o){return this.currentHelper.handleEaseTo(t,o)}handleFlyTo(t,o){return this.currentHelper.handleFlyTo(t,o)}}const jl=(_,t)=>l.y(_,t&&t.filter(o=>o.identifier!=="source.canvas")),va=l.bD();class cd extends l.E{constructor(t,o={}){super(),this._rtlPluginLoaded=()=>{for(const h in this.sourceCaches){const f=this.sourceCaches[h].getSource().type;f!=="vector"&&f!=="geojson"||this.sourceCaches[h].reload()}},this.map=t,this.dispatcher=new dr(nr(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",(h,f)=>this.getGlyphs(h,f)),this.dispatcher.registerMessageHandler("GI",(h,f)=>this.getImages(h,f)),this.imageManager=new Ne,this.imageManager.setEventedParent(this),this.glyphManager=new ot(t._requestManager,o.localIdeographFontFamily),this.lineAtlas=new He(256,512),this.crossTileSymbolIndex=new eu,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new l.bE,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",l.bF()),Qr().on(Fi,this._rtlPluginLoaded),this.on("data",h=>{if(h.dataType!=="source"||h.sourceDataType!=="metadata")return;const f=this.sourceCaches[h.sourceId];if(!f)return;const y=f.getSource();if(y&&y.vectorLayerIds)for(const b in this._layers){const S=this._layers[b];S.source===y.id&&this._validateLayer(S)}})}setGlobalStateProperty(t,o){var h,f,y;this._checkLoaded();const b=o===null?(y=(f=(h=this.stylesheet.state)===null||h===void 0?void 0:h[t])===null||f===void 0?void 0:f.default)!==null&&y!==void 0?y:null:o;if(l.bG(b,this._globalState[t]))return this;this._globalState[t]=b;const S=this._findGlobalStateAffectedSources([t]);for(const C in this.sourceCaches)S.has(C)&&(this._reloadSource(C),this._changed=!0)}getGlobalState(){return this._globalState}setGlobalState(t){this._checkLoaded();const o=[];for(const f in t)!l.bG(this._globalState[f],t[f].default)&&(o.push(f),this._globalState[f]=t[f].default);const h=this._findGlobalStateAffectedSources(o);for(const f in this.sourceCaches)h.has(f)&&(this._reloadSource(f),this._changed=!0)}_findGlobalStateAffectedSources(t){if(t.length===0)return new Set;const o=new Set;for(const h in this._layers){const f=this._layers[h],y=f.getLayoutAffectingGlobalStateRefs();for(const b of t)y.has(b)&&o.add(f.source)}return o}loadURL(t,o={},h){this.fire(new l.l("dataloading",{dataType:"style"})),o.validate=typeof o.validate!="boolean"||o.validate;const f=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController;const y=this._loadStyleRequest;l.j(f,this._loadStyleRequest).then(b=>{this._loadStyleRequest=null,this._load(b.data,o,h)}).catch(b=>{this._loadStyleRequest=null,b&&!y.signal.aborted&&this.fire(new l.k(b))})}loadJSON(t,o={},h){this.fire(new l.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,F.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,o.validate=o.validate!==!1,this._load(t,o,h)}).catch(()=>{})}loadEmpty(){this.fire(new l.l("dataloading",{dataType:"style"})),this._load(va,{validate:!1})}_load(t,o,h){var f,y,b;const S=o.transformStyle?o.transformStyle(h,t):t;if(!o.validate||!jl(this,l.z(S))){this._loaded=!0,this.stylesheet=S;for(const C in S.sources)this.addSource(C,S.sources[C],{validate:!1});S.sprite?this._loadSprite(S.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(S.glyphs),this._createLayers(),this.light=new dt(this.stylesheet.light),this._setProjectionInternal(((f=this.stylesheet.projection)===null||f===void 0?void 0:f.type)||"mercator"),this.sky=new Ze(this.stylesheet.sky),this.map.setTerrain((y=this.stylesheet.terrain)!==null&&y!==void 0?y:null),this.setGlobalState((b=this.stylesheet.state)!==null&&b!==void 0?b:null),this.fire(new l.l("data",{dataType:"style"})),this.fire(new l.l("style.load"))}}_createLayers(){const t=l.bH(this.stylesheet.layers);this.dispatcher.broadcast("SL",t),this._order=t.map(o=>o.id),this._layers={},this._serializedLayers=null;for(const o of t){const h=l.bI(o);h.setEventedParent(this,{layer:{id:o.id}}),this._layers[o.id]=h}}_loadSprite(t,o=!1,h=void 0){let f;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(y,b,S,C){return l._(this,void 0,void 0,function*(){const k=Te(y),z=S>1?"@2x":"",O={},L={};for(const{id:j,url:q}of k){const se=b.transformRequest(xe(q,z,".json"),"SpriteJSON");O[j]=l.j(se,C);const oe=b.transformRequest(xe(q,z,".png"),"SpriteImage");L[j]=re.getImage(oe,C)}return yield Promise.all([...Object.values(O),...Object.values(L)]),function(j,q){return l._(this,void 0,void 0,function*(){const se={};for(const oe in j){se[oe]={};const ae=F.getImageCanvasContext((yield q[oe]).data),ce=(yield j[oe]).data;for(const pe in ce){const{width:ue,height:ve,x:be,y:fe,sdf:Pe,pixelRatio:Oe,stretchX:Ae,stretchY:Re,content:Fe,textFitWidth:st,textFitHeight:it}=ce[pe];se[oe][pe]={data:null,pixelRatio:Oe,sdf:Pe,stretchX:Ae,stretchY:Re,content:Fe,textFitWidth:st,textFitHeight:it,spriteData:{width:ue,height:ve,x:be,y:fe,context:ae}}}}return se})}(O,L)})}(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(y=>{if(this._spriteRequest=null,y)for(const b in y){this._spritesImagesIds[b]=[];const S=this._spritesImagesIds[b]?this._spritesImagesIds[b].filter(C=>!(C in y)):[];for(const C of S)this.imageManager.removeImage(C),this._changedImages[C]=!0;for(const C in y[b]){const k=b==="default"?C:`${b}:${C}`;this._spritesImagesIds[b].push(k),k in this.imageManager.images?this.imageManager.updateImage(k,y[b][C],!1):this.imageManager.addImage(k,y[b][C]),o&&(this._changedImages[k]=!0)}}}).catch(y=>{this._spriteRequest=null,f=y,this.fire(new l.k(f))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),o&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"})),h&&h(f)})}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"}))}_validateLayer(t){const o=this.sourceCaches[t.source];if(!o)return;const h=t.sourceLayer;if(!h)return;const f=o.getSource();(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(h)===-1)&&this.fire(new l.k(new Error(`Source layer "${h}" does not exist on source "${f.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t,o=!1){const h=this._serializedAllLayers();if(!t||t.length===0)return Object.values(o?l.bJ(h):h);const f=[];for(const y of t)if(h[y]){const b=o?l.bJ(h[y]):h[y];f.push(b)}return f}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const o=Object.keys(this._layers);for(const h of o){const f=this._layers[h];f.type!=="custom"&&(t[h]=f.serialize())}return t}hasTransitions(){var t,o,h;if(!((t=this.light)===null||t===void 0)&&t.hasTransition()||!((o=this.sky)===null||o===void 0)&&o.hasTransition()||!((h=this.projection)===null||h===void 0)&&h.hasTransition())return!0;for(const f in this.sourceCaches)if(this.sourceCaches[f].hasTransition())return!0;for(const f in this._layers)if(this._layers[f].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const o=this._changed;if(o){const f=Object.keys(this._updatedLayers),y=Object.keys(this._removedLayers);(f.length||y.length)&&this._updateWorkerLayers(f,y);for(const b in this._updatedSources){const S=this._updatedSources[b];if(S==="reload")this._reloadSource(b);else{if(S!=="clear")throw new Error(`Invalid action ${S}`);this._clearSource(b)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const b in this._updatedPaintProps)this._layers[b].updateTransitions(t);this.light.updateTransitions(t),this.sky.updateTransitions(t),this._resetUpdates()}const h={};for(const f in this.sourceCaches){const y=this.sourceCaches[f];h[f]=y.used,y.used=!1}for(const f of this._order){const y=this._layers[f];y.recalculate(t,this._availableImages),!y.isHidden(t.zoom)&&y.source&&(this.sourceCaches[y.source].used=!0)}for(const f in h){const y=this.sourceCaches[f];!!h[f]!=!!y.used&&y.fire(new l.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:f}))}this.light.recalculate(t),this.sky.recalculate(t),this.projection.recalculate(t),this.z=t.zoom,o&&this.fire(new l.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,o){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t,!1),removedIds:o})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,o={}){var h;this._checkLoaded();const f=this.serialize();if(t=o.transformStyle?o.transformStyle(f,t):t,((h=o.validate)===null||h===void 0||h)&&jl(this,l.z(t)))return!1;(t=l.bJ(t)).layers=l.bH(t.layers);const y=l.bK(f,t),b=this._getOperationsToPerform(y);if(b.unimplemented.length>0)throw new Error(`Unimplemented: ${b.unimplemented.join(", ")}.`);if(b.operations.length===0)return!1;for(const S of b.operations)S();return this.stylesheet=t,this._serializedLayers=null,!0}_getOperationsToPerform(t){const o=[],h=[];for(const f of t)switch(f.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":o.push(()=>this.addLayer.apply(this,f.args));break;case"removeLayer":o.push(()=>this.removeLayer.apply(this,f.args));break;case"setPaintProperty":o.push(()=>this.setPaintProperty.apply(this,f.args));break;case"setLayoutProperty":o.push(()=>this.setLayoutProperty.apply(this,f.args));break;case"setFilter":o.push(()=>this.setFilter.apply(this,f.args));break;case"addSource":o.push(()=>this.addSource.apply(this,f.args));break;case"removeSource":o.push(()=>this.removeSource.apply(this,f.args));break;case"setLayerZoomRange":o.push(()=>this.setLayerZoomRange.apply(this,f.args));break;case"setLight":o.push(()=>this.setLight.apply(this,f.args));break;case"setGeoJSONSourceData":o.push(()=>this.setGeoJSONSourceData.apply(this,f.args));break;case"setGlyphs":o.push(()=>this.setGlyphs.apply(this,f.args));break;case"setSprite":o.push(()=>this.setSprite.apply(this,f.args));break;case"setTerrain":o.push(()=>this.map.setTerrain.apply(this,f.args));break;case"setSky":o.push(()=>this.setSky.apply(this,f.args));break;case"setProjection":this.setProjection.apply(this,f.args);break;case"setGlobalState":o.push(()=>this.setGlobalState.apply(this,f.args));break;case"setTransition":o.push(()=>{});break;default:h.push(f.command)}return{operations:o,unimplemented:h}}addImage(t,o){if(this.getImage(t))return this.fire(new l.k(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,o),this._afterImageUpdated(t)}updateImage(t,o){this.imageManager.updateImage(t,o)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new l.k(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,o,h={}){if(this._checkLoaded(),this.sourceCaches[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!o.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(o).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(o.type)>=0&&this._validate(l.z.source,`sources.${t}`,o,null,h))return;this.map&&this.map._collectResourceTiming&&(o.collectResourceTiming=!0);const f=this.sourceCaches[t]=new We(t,o,this.dispatcher);f.style=this,f.setEventedParent(this,()=>({isSourceLoaded:f.loaded(),source:f.serialize(),sourceId:t})),f.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error("There is no source with this ID");for(const h in this._layers)if(this._layers[h].source===t)return this.fire(new l.k(new Error(`Source "${t}" cannot be removed while layer "${h}" is using it.`)));const o=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],o.fire(new l.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),o.setEventedParent(null),o.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,o){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const h=this.sourceCaches[t].getSource();if(h.type!=="geojson")throw new Error(`geojsonSource.type is ${h.type}, which is !== 'geojson`);h.setData(o),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,o,h={}){this._checkLoaded();const f=t.id;if(this.getLayer(f))return void this.fire(new l.k(new Error(`Layer "${f}" already exists on this map.`)));let y;if(t.type==="custom"){if(jl(this,l.bL(t)))return;y=l.bI(t)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(f,t.source),t=l.bJ(t),t=l.e(t,{source:f})),this._validate(l.z.layer,`layers.${f}`,t,{arrayIndex:-1},h))return;y=l.bI(t),this._validateLayer(y),y.setEventedParent(this,{layer:{id:f}})}const b=o?this._order.indexOf(o):this._order.length;if(o&&b===-1)this.fire(new l.k(new Error(`Cannot add layer "${f}" before non-existing layer "${o}".`)));else{if(this._order.splice(b,0,f),this._layerOrderChanged=!0,this._layers[f]=y,this._removedLayers[f]&&y.source&&y.type!=="custom"){const S=this._removedLayers[f];delete this._removedLayers[f],S.type!==y.type?this._updatedSources[y.source]="clear":(this._updatedSources[y.source]="reload",this.sourceCaches[y.source].pause())}this._updateLayer(y),y.onAdd&&y.onAdd(this.map)}}moveLayer(t,o){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new l.k(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===o)return;const h=this._order.indexOf(t);this._order.splice(h,1);const f=o?this._order.indexOf(o):this._order.length;o&&f===-1?this.fire(new l.k(new Error(`Cannot move layer "${t}" before non-existing layer "${o}".`))):(this._order.splice(f,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const o=this._layers[t];if(!o)return void this.fire(new l.k(new Error(`Cannot remove non-existing layer "${t}".`)));o.setEventedParent(null);const h=this._order.indexOf(t);this._order.splice(h,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=o,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],o.onRemove&&o.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,o,h){this._checkLoaded();const f=this.getLayer(t);f?f.minzoom===o&&f.maxzoom===h||(o!=null&&(f.minzoom=o),h!=null&&(f.maxzoom=h),this._updateLayer(f)):this.fire(new l.k(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,o,h={}){this._checkLoaded();const f=this.getLayer(t);if(f){if(!l.bG(f.filter,o))return o==null?(f.setFilter(void 0),void this._updateLayer(f)):void(this._validate(l.z.filter,`layers.${f.id}.filter`,o,null,h)||(f.setFilter(l.bJ(o)),this._updateLayer(f)))}else this.fire(new l.k(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return l.bJ(this.getLayer(t).filter)}setLayoutProperty(t,o,h,f={}){this._checkLoaded();const y=this.getLayer(t);y?l.bG(y.getLayoutProperty(o),h)||(y.setLayoutProperty(o,h,f),this._updateLayer(y)):this.fire(new l.k(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,o){const h=this.getLayer(t);if(h)return h.getLayoutProperty(o);this.fire(new l.k(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,o,h,f={}){this._checkLoaded();const y=this.getLayer(t);y?l.bG(y.getPaintProperty(o),h)||(y.setPaintProperty(o,h,f)&&this._updateLayer(y),this._changed=!0,this._updatedPaintProps[t]=!0,this._serializedLayers=null):this.fire(new l.k(new Error(`Cannot style non-existing layer "${t}".`)))}getPaintProperty(t,o){return this.getLayer(t).getPaintProperty(o)}setFeatureState(t,o){this._checkLoaded();const h=t.source,f=t.sourceLayer,y=this.sourceCaches[h];if(y===void 0)return void this.fire(new l.k(new Error(`The source '${h}' does not exist in the map's style.`)));const b=y.getSource().type;b==="geojson"&&f?this.fire(new l.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):b!=="vector"||f?(t.id===void 0&&this.fire(new l.k(new Error("The feature id parameter must be provided."))),y.setFeatureState(f,t.id,o)):this.fire(new l.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,o){this._checkLoaded();const h=t.source,f=this.sourceCaches[h];if(f===void 0)return void this.fire(new l.k(new Error(`The source '${h}' does not exist in the map's style.`)));const y=f.getSource().type,b=y==="vector"?t.sourceLayer:void 0;y!=="vector"||b?o&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new l.k(new Error("A feature id is required to remove its specific state property."))):f.removeFeatureState(b,t.id,o):this.fire(new l.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const o=t.source,h=t.sourceLayer,f=this.sourceCaches[o];if(f!==void 0)return f.getSource().type!=="vector"||h?(t.id===void 0&&this.fire(new l.k(new Error("The feature id parameter must be provided."))),f.getFeatureState(h,t.id)):void this.fire(new l.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new l.k(new Error(`The source '${o}' does not exist in the map's style.`)))}getTransition(){return l.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=l.bM(this.sourceCaches,y=>y.serialize()),o=this._serializeByIds(this._order,!0),h=this.map.getTerrain()||void 0,f=this.stylesheet;return l.bN({version:f.version,name:f.name,metadata:f.metadata,light:f.light,sky:f.sky,center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,sprite:f.sprite,glyphs:f.glyphs,transition:f.transition,projection:f.projection,sources:t,layers:o,terrain:h},y=>y!==void 0)}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.sourceCaches[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const o=b=>this._layers[b].type==="fill-extrusion",h={},f=[];for(let b=this._order.length-1;b>=0;b--){const S=this._order[b];if(o(S)){h[S]=b;for(const C of t){const k=C[S];if(k)for(const z of k)f.push(z)}}}f.sort((b,S)=>S.intersectionZ-b.intersectionZ);const y=[];for(let b=this._order.length-1;b>=0;b--){const S=this._order[b];if(o(S))for(let C=f.length-1;C>=0;C--){const k=f[C].feature;if(h[k.layer.id]<b)break;y.push(k),f.pop()}else for(const C of t){const k=C[S];if(k)for(const z of k)y.push(z.feature)}}return y}queryRenderedFeatures(t,o,h){o&&o.filter&&this._validate(l.z.filter,"queryRenderedFeatures.filter",o.filter,null,o);const f={};if(o&&o.layers){if(!(Array.isArray(o.layers)||o.layers instanceof Set))return this.fire(new l.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const k of o.layers){const z=this._layers[k];if(!z)return this.fire(new l.k(new Error(`The layer '${k}' does not exist in the map's style and cannot be queried for features.`))),[];f[z.source]=!0}}const y=[];o.availableImages=this._availableImages;const b=this._serializedAllLayers(),S=o.layers instanceof Set?o.layers:Array.isArray(o.layers)?new Set(o.layers):null,C=Object.assign(Object.assign({},o),{layers:S});for(const k in this.sourceCaches)o.layers&&!f[k]||y.push(Vt(this.sourceCaches[k],this._layers,b,t,C,h,this.map.terrain?(z,O,L)=>this.map.terrain.getElevation(z,O,L):void 0));return this.placement&&y.push(function(k,z,O,L,j,q,se){const oe={},ae=q.queryRenderedSymbols(L),ce=[];for(const pe of Object.keys(ae).map(Number))ce.push(se[pe]);ce.sort(tr);for(const pe of ce){const ue=pe.featureIndex.lookupSymbolFeatures(ae[pe.bucketInstanceId],z,pe.bucketIndex,pe.sourceLayerIndex,j.filter,j.layers,j.availableImages,k);for(const ve in ue){const be=oe[ve]=oe[ve]||[],fe=ue[ve];fe.sort((Pe,Oe)=>{const Ae=pe.featureSortOrder;if(Ae){const Re=Ae.indexOf(Pe.featureIndex);return Ae.indexOf(Oe.featureIndex)-Re}return Oe.featureIndex-Pe.featureIndex});for(const Pe of fe)be.push(Pe)}}return function(pe,ue,ve){for(const be in pe)for(const fe of pe[be])Dt(fe,ve[ue[be].source]);return pe}(oe,k,O)}(this._layers,b,this.sourceCaches,t,C,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(y)}querySourceFeatures(t,o){o&&o.filter&&this._validate(l.z.filter,"querySourceFeatures.filter",o.filter,null,o);const h=this.sourceCaches[t];return h?function(f,y){const b=f.getRenderableIds().map(k=>f.getTileByID(k)),S=[],C={};for(let k=0;k<b.length;k++){const z=b[k],O=z.tileID.canonical.key;C[O]||(C[O]=!0,z.querySourceFeatures(S,y))}return S}(h,o):[]}getLight(){return this.light.getLight()}setLight(t,o={}){this._checkLoaded();const h=this.light.getLight();let f=!1;for(const b in t)if(!l.bG(t[b],h[b])){f=!0;break}if(!f)return;const y={now:F.now(),transition:l.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,o),this.light.updateTransitions(y)}getProjection(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.projection}setProjection(t){if(this._checkLoaded(),this.projection){if(this.projection.name===t.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=t,this._setProjectionInternal(t.type)}getSky(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.sky}setSky(t,o={}){this._checkLoaded();const h=this.getSky();let f=!1;if(!t&&!h)return;if(t&&!h)f=!0;else if(!t&&h)f=!0;else for(const b in t)if(!l.bG(t[b],h[b])){f=!0;break}if(!f)return;const y={now:F.now(),transition:l.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=t,this.sky.setSky(t,o),this.sky.updateTransitions(y)}_setProjectionInternal(t){const o=function(h){if(Array.isArray(h)){const f=new Ll({type:h});return{projection:f,transform:new di,cameraHelper:new ld(f)}}switch(h){case"mercator":return{projection:new id,transform:new Jr,cameraHelper:new nu};case"globe":{const f=new Ll({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:f,transform:new di,cameraHelper:new ld(f)}}case"vertical-perspective":return{projection:new Wp,transform:new ya,cameraHelper:new ei};default:return l.w(`Unknown projection name: ${h}. Falling back to mercator projection.`),{projection:new id,transform:new Jr,cameraHelper:new nu}}}(t);this.projection=o.projection,this.map.migrateProjection(o.transform,o.cameraHelper);for(const h in this.sourceCaches)this.sourceCaches[h].reload()}_validate(t,o,h,f,y={}){return(!y||y.validate!==!1)&&jl(this,t.call(l.z,l.e({key:o,style:this.serialize(),value:h,styleSpec:l.v},f)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Qr().off(Fi,this._rtlPluginLoaded);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this.sourceCaches){const h=this.sourceCaches[o];h.setEventedParent(null),h.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const o in this.sourceCaches)this.sourceCaches[o].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,o,h,f,y=!1){let b=!1,S=!1;const C={};for(const k of this._order){const z=this._layers[k];if(z.type!=="symbol")continue;if(!C[z.source]){const L=this.sourceCaches[z.source];C[z.source]=L.getRenderableIds(!0).map(j=>L.getTileByID(j)).sort((j,q)=>q.tileID.overscaledZ-j.tileID.overscaledZ||(j.tileID.isLessThan(q.tileID)?-1:1))}const O=this.crossTileSymbolIndex.addLayer(z,C[z.source],t.center.lng);b=b||O}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((y=y||this._layerOrderChanged||h===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(F.now(),t.zoom))&&(this.pauseablePlacement=new Gp(t,this.map.terrain,this._order,y,o,h,f,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,C),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(F.now()),S=!0),b&&this.pauseablePlacement.placement.setStale()),S||b)for(const k of this._order){const z=this._layers[k];z.type==="symbol"&&this.placement.updateLayerOpacities(z,C[z.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(F.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,o){return l._(this,void 0,void 0,function*(){const h=yield this.imageManager.getImages(o.icons);this._updateTilesForChangedImages();const f=this.sourceCaches[o.source];return f&&f.setDependencies(o.tileID.key,o.type,o.icons),h})}getGlyphs(t,o){return l._(this,void 0,void 0,function*(){const h=yield this.glyphManager.getGlyphs(o.stacks),f=this.sourceCaches[o.source];return f&&f.setDependencies(o.tileID.key,o.type,[""]),h})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,o={}){this._checkLoaded(),t&&this._validate(l.z.glyphs,"glyphs",t,null,o)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}addSprite(t,o,h={},f){this._checkLoaded();const y=[{id:t,url:o}],b=[...Te(this.stylesheet.sprite),...y];this._validate(l.z.sprite,"sprite",b,null,h)||(this.stylesheet.sprite=b,this._loadSprite(y,!0,f))}removeSprite(t){this._checkLoaded();const o=Te(this.stylesheet.sprite);if(o.find(h=>h.id===t)){if(this._spritesImagesIds[t])for(const h of this._spritesImagesIds[t])this.imageManager.removeImage(h),this._changedImages[h]=!0;o.splice(o.findIndex(h=>h.id===t),1),this.stylesheet.sprite=o.length>0?o:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"}))}else this.fire(new l.k(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return Te(this.stylesheet.sprite)}setSprite(t,o={},h){this._checkLoaded(),t&&this._validate(l.z.sprite,"sprite",t,null,o)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,h):(this._unloadSprite(),h&&h(null)))}}var Ey=l.aI([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class My{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,o,h,f,y,b,S,C,k){this.context=t;let z=this.boundPaintVertexBuffers.length!==f.length;for(let O=0;!z&&O<f.length;O++)this.boundPaintVertexBuffers[O]!==f[O]&&(z=!0);!this.vao||this.boundProgram!==o||this.boundLayoutVertexBuffer!==h||z||this.boundIndexBuffer!==y||this.boundVertexOffset!==b||this.boundDynamicVertexBuffer!==S||this.boundDynamicVertexBuffer2!==C||this.boundDynamicVertexBuffer3!==k?this.freshBind(o,h,f,y,b,S,C,k):(t.bindVertexArray.set(this.vao),S&&S.bind(),y&&y.dynamicDraw&&y.bind(),C&&C.bind(),k&&k.bind())}freshBind(t,o,h,f,y,b,S,C){const k=t.numAttributes,z=this.context,O=z.gl;this.vao&&this.destroy(),this.vao=z.createVertexArray(),z.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=o,this.boundPaintVertexBuffers=h,this.boundIndexBuffer=f,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=b,this.boundDynamicVertexBuffer2=S,this.boundDynamicVertexBuffer3=C,o.enableAttributes(O,t);for(const L of h)L.enableAttributes(O,t);b&&b.enableAttributes(O,t),S&&S.enableAttributes(O,t),C&&C.enableAttributes(O,t),o.bind(),o.setVertexAttribPointers(O,t,y);for(const L of h)L.bind(),L.setVertexAttribPointers(O,t,y);b&&(b.bind(),b.setVertexAttribPointers(O,t,y)),f&&f.bind(),S&&(S.bind(),S.setVertexAttribPointers(O,t,y)),C&&(C.bind(),C.setVertexAttribPointers(O,t,y)),z.currentNumAttributes=k}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const ky=(_,t,o,h,f)=>({u_texture:0,u_ele_delta:_,u_fog_matrix:t,u_fog_color:o?o.properties.get("fog-color"):l.be.white,u_fog_ground_blend:o?o.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:f?0:o?o.calculateFogBlendOpacity(h):0,u_horizon_color:o?o.properties.get("horizon-color"):l.be.white,u_horizon_fog_blend:o?o.properties.get("horizon-fog-blend"):1,u_is_globe_mode:f?1:0}),Iy={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function iu(_){const t=[];for(let o=0;o<_.length;o++){if(_[o]===null)continue;const h=_[o].split(" ");t.push(h.pop())}return t}class ou{constructor(t,o,h,f,y,b,S,C,k=[]){const z=t.gl;this.program=z.createProgram();const O=iu(o.staticAttributes),L=h?h.getBinderAttributes():[],j=O.concat(L),q=oo.prelude.staticUniforms?iu(oo.prelude.staticUniforms):[],se=S.staticUniforms?iu(S.staticUniforms):[],oe=o.staticUniforms?iu(o.staticUniforms):[],ae=h?h.getBinderUniforms():[],ce=q.concat(se).concat(oe).concat(ae),pe=[];for(const Ae of ce)pe.indexOf(Ae)<0&&pe.push(Ae);const ue=h?h.defines():[];jn(z)&&ue.unshift("#version 300 es"),y&&ue.push("#define OVERDRAW_INSPECTOR;"),b&&ue.push("#define TERRAIN3D;"),C&&ue.push(C),k&&ue.push(...k);let ve=ue.concat(oo.prelude.fragmentSource,S.fragmentSource,o.fragmentSource).join(`
`),be=ue.concat(oo.prelude.vertexSource,S.vertexSource,o.vertexSource).join(`
`);jn(z)||(ve=function(Ae){return Ae.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(ve),be=function(Ae){return Ae.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(be));const fe=z.createShader(z.FRAGMENT_SHADER);if(z.isContextLost())return void(this.failedToCreate=!0);if(z.shaderSource(fe,ve),z.compileShader(fe),!z.getShaderParameter(fe,z.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${z.getShaderInfoLog(fe)}`);z.attachShader(this.program,fe);const Pe=z.createShader(z.VERTEX_SHADER);if(z.isContextLost())return void(this.failedToCreate=!0);if(z.shaderSource(Pe,be),z.compileShader(Pe),!z.getShaderParameter(Pe,z.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${z.getShaderInfoLog(Pe)}`);z.attachShader(this.program,Pe),this.attributes={};const Oe={};this.numAttributes=j.length;for(let Ae=0;Ae<this.numAttributes;Ae++)j[Ae]&&(z.bindAttribLocation(this.program,Ae,j[Ae]),this.attributes[j[Ae]]=Ae);if(z.linkProgram(this.program),!z.getProgramParameter(this.program,z.LINK_STATUS))throw new Error(`Program failed to link: ${z.getProgramInfoLog(this.program)}`);z.deleteShader(Pe),z.deleteShader(fe);for(let Ae=0;Ae<pe.length;Ae++){const Re=pe[Ae];if(Re&&!Oe[Re]){const Fe=z.getUniformLocation(this.program,Re);Fe&&(Oe[Re]=Fe)}}this.fixedUniforms=f(t,Oe),this.terrainUniforms=((Ae,Re)=>({u_depth:new l.bO(Ae,Re.u_depth),u_terrain:new l.bO(Ae,Re.u_terrain),u_terrain_dim:new l.bf(Ae,Re.u_terrain_dim),u_terrain_matrix:new l.bQ(Ae,Re.u_terrain_matrix),u_terrain_unpack:new l.bR(Ae,Re.u_terrain_unpack),u_terrain_exaggeration:new l.bf(Ae,Re.u_terrain_exaggeration)}))(t,Oe),this.projectionUniforms=((Ae,Re)=>({u_projection_matrix:new l.bQ(Ae,Re.u_projection_matrix),u_projection_tile_mercator_coords:new l.bR(Ae,Re.u_projection_tile_mercator_coords),u_projection_clipping_plane:new l.bR(Ae,Re.u_projection_clipping_plane),u_projection_transition:new l.bf(Ae,Re.u_projection_transition),u_projection_fallback_matrix:new l.bQ(Ae,Re.u_projection_fallback_matrix)}))(t,Oe),this.binderUniforms=h?h.getUniforms(t,Oe):[]}draw(t,o,h,f,y,b,S,C,k,z,O,L,j,q,se,oe,ae,ce,pe){const ue=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(h),t.setStencilMode(f),t.setColorMode(y),t.setCullFace(b),C){t.activeTexture.set(ue.TEXTURE2),ue.bindTexture(ue.TEXTURE_2D,C.depthTexture),t.activeTexture.set(ue.TEXTURE3),ue.bindTexture(ue.TEXTURE_2D,C.texture);for(const be in this.terrainUniforms)this.terrainUniforms[be].set(C[be])}if(k)for(const be in k)this.projectionUniforms[Iy[be]].set(k[be]);if(S)for(const be in this.fixedUniforms)this.fixedUniforms[be].set(S[be]);oe&&oe.setUniforms(t,this.binderUniforms,q,{zoom:se});let ve=0;switch(o){case ue.LINES:ve=2;break;case ue.TRIANGLES:ve=3;break;case ue.LINE_STRIP:ve=1}for(const be of j.get()){const fe=be.vaos||(be.vaos={});(fe[z]||(fe[z]=new My)).bind(t,this,O,oe?oe.getPaintVertexBuffers():[],L,be.vertexOffset,ae,ce,pe),ue.drawElements(o,be.primitiveLength*ve,ue.UNSIGNED_SHORT,be.primitiveOffset*ve*2)}}}function su(_,t,o){const h=1/l.aB(o,1,t.transform.tileZoom),f=Math.pow(2,o.tileID.overscaledZ),y=o.tileSize*Math.pow(2,t.transform.tileZoom)/f,b=y*(o.tileID.canonical.x+o.tileID.wrap*f),S=y*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[h,_.fromScale,_.toScale],u_fade:_.t,u_pixel_coord_upper:[b>>16,S>>16],u_pixel_coord_lower:[65535&b,65535&S]}}const $l=(_,t,o,h)=>{const f=_.style.light,y=f.properties.get("position"),b=[y.x,y.y,y.z],S=l.bU();f.properties.get("anchor")==="viewport"&&l.bV(S,_.transform.bearingInRadians),l.bW(b,b,S);const C=_.transform.transformLightDirection(b),k=f.properties.get("color");return{u_lightpos:b,u_lightpos_globe:C,u_lightintensity:f.properties.get("intensity"),u_lightcolor:[k.r,k.g,k.b],u_vertical_gradient:+t,u_opacity:o,u_fill_translate:h}},ud=(_,t,o,h,f,y,b)=>l.e($l(_,t,o,h),su(y,_,b),{u_height_factor:-Math.pow(2,f.overscaledZ)/b.tileSize/8}),au=(_,t,o,h)=>l.e(su(t,_,o),{u_fill_translate:h}),ao=(_,t)=>({u_world:_,u_fill_translate:t}),Ay=(_,t,o,h,f)=>l.e(au(_,t,o,f),{u_world:h}),hd=(_,t,o,h,f)=>{const y=_.transform;let b,S,C=0;if(o.paint.get("circle-pitch-alignment")==="map"){const k=l.aB(t,1,y.zoom);b=!0,S=[k,k],C=k/(l.$*Math.pow(2,t.tileID.overscaledZ))*2*Math.PI*f}else b=!1,S=y.pixelsToGLUnits;return{u_camera_to_center_distance:y.cameraToCenterDistance,u_scale_with_map:+(o.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+b,u_device_pixel_ratio:_.pixelRatio,u_extrude_scale:S,u_globe_extrude_scale:C,u_translate:h}},Ul=_=>({u_pixel_extrude_scale:[1/_.width,1/_.height]}),Vl=_=>({u_viewport_size:[_.width,_.height]}),Xp=(_,t=1)=>({u_color:_,u_overlay:0,u_overlay_scale:t}),Zl=(_,t,o,h)=>{const f=l.aB(_,1,t)/(l.$*Math.pow(2,_.tileID.overscaledZ))*2*Math.PI*h;return{u_extrude_scale:l.aB(_,1,t),u_intensity:o,u_globe_extrude_scale:f}},Kp=(_,t,o,h)=>{const f=l.L();l.bX(f,0,_.width,_.height,0,0,1);const y=_.context.gl;return{u_matrix:f,u_world:[y.drawingBufferWidth,y.drawingBufferHeight],u_image:o,u_color_ramp:h,u_opacity:t.paint.get("heatmap-opacity")}},xa=(_,t,o)=>{const h=o.paint.get("hillshade-accent-color");let f;switch(o.paint.get("hillshade-method")){case"basic":f=4;break;case"combined":f=1;break;case"igor":f=2;break;case"multidirectional":f=3;break;default:f=0}const y=o.getIlluminationProperties();for(let b=0;b<y.directionRadians.length;b++)o.paint.get("hillshade-illumination-anchor")==="viewport"&&(y.directionRadians[b]+=_.transform.bearingInRadians);return{u_image:0,u_latrange:Yp(0,t.tileID),u_exaggeration:o.paint.get("hillshade-exaggeration"),u_altitudes:y.altitudeRadians,u_azimuths:y.directionRadians,u_accent:h,u_method:f,u_highlights:y.highlightColor,u_shadows:y.shadowColor}},zy=(_,t)=>{const o=t.stride,h=l.L();return l.bX(h,0,l.$,-l.$,0,0,1),l.M(h,h,[0,-l.$,0]),{u_matrix:h,u_image:1,u_dimension:[o,o],u_zoom:_.overscaledZ,u_unpack:t.getUnpackVector()}};function Yp(_,t){const o=Math.pow(2,t.canonical.z),h=t.canonical.y;return[new l.a0(0,h/o).toLngLat().lat,new l.a0(0,(h+1)/o).toLngLat().lat]}const Ry=(_,t,o=0)=>({u_image:0,u_unpack:t.getUnpackVector(),u_dimension:[t.stride,t.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:o,u_opacity:_.paint.get("color-relief-opacity")}),lu=(_,t,o,h)=>{const f=_.transform;return{u_translation:pd(_,t,o),u_ratio:h/l.aB(t,1,f.zoom),u_device_pixel_ratio:_.pixelRatio,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},dd=(_,t,o,h,f)=>l.e(lu(_,t,o,h),{u_image:0,u_image_height:f}),Qp=(_,t,o,h,f)=>{const y=_.transform,b=fd(t,y);return{u_translation:pd(_,t,o),u_texsize:t.imageAtlasTexture.size,u_ratio:h/l.aB(t,1,y.zoom),u_device_pixel_ratio:_.pixelRatio,u_image:0,u_scale:[b,f.fromScale,f.toScale],u_fade:f.t,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},Jp=(_,t,o,h,f,y)=>{const b=_.lineAtlas,S=fd(t,_.transform),C=o.layout.get("line-cap")==="round",k=b.getDash(f.from,C),z=b.getDash(f.to,C),O=k.width*y.fromScale,L=z.width*y.toScale;return l.e(lu(_,t,o,h),{u_patternscale_a:[S/O,-k.height/2],u_patternscale_b:[S/L,-z.height/2],u_sdfgamma:b.width/(256*Math.min(O,L)*_.pixelRatio)/2,u_image:0,u_tex_y_a:k.y,u_tex_y_b:z.y,u_mix:y.t})};function fd(_,t){return 1/l.aB(_,1,t.tileZoom)}function pd(_,t,o){return l.aC(_.transform,t,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const Fs=(_,t,o,h,f)=>{return{u_tl_parent:_,u_scale_parent:t,u_buffer_scale:1,u_fade_t:o.mix,u_opacity:o.opacity*h.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:h.paint.get("raster-brightness-min"),u_brightness_high:h.paint.get("raster-brightness-max"),u_saturation_factor:(b=h.paint.get("raster-saturation"),b>0?1-1/(1.001-b):-b),u_contrast_factor:(y=h.paint.get("raster-contrast"),y>0?1/(1-y):1+y),u_spin_weights:em(h.paint.get("raster-hue-rotate")),u_coords_top:[f[0].x,f[0].y,f[1].x,f[1].y],u_coords_bottom:[f[3].x,f[3].y,f[2].x,f[2].y]};var y,b};function em(_){_*=Math.PI/180;const t=Math.sin(_),o=Math.cos(_);return[(2*o+1)/3,(-Math.sqrt(3)*t-o+1)/3,(Math.sqrt(3)*t-o+1)/3]}const md=(_,t,o,h,f,y,b,S,C,k,z,O,L)=>{const j=b.transform;return{u_is_size_zoom_constant:+(_==="constant"||_==="source"),u_is_size_feature_constant:+(_==="constant"||_==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:j.cameraToCenterDistance,u_pitch:j.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:j.width/j.height,u_fade_change:b.options.fadeDuration?b.symbolFadeChange:1,u_label_plane_matrix:S,u_coord_matrix:C,u_is_text:+z,u_pitch_with_map:+h,u_is_along_line:f,u_is_variable_anchor:y,u_texsize:O,u_texture:0,u_translation:k,u_pitched_scale:L}},ba=(_,t,o,h,f,y,b,S,C,k,z,O,L,j)=>{const q=b.transform;return l.e(md(_,t,o,h,f,y,b,S,C,k,z,O,j),{u_gamma_scale:h?Math.cos(q.pitch*Math.PI/180)*q.cameraToCenterDistance:1,u_device_pixel_ratio:b.pixelRatio,u_is_halo:1})},Dy=(_,t,o,h,f,y,b,S,C,k,z,O,L)=>l.e(ba(_,t,o,h,f,y,b,S,C,k,!0,z,0,L),{u_texsize_icon:O,u_texture_icon:1}),cu=(_,t)=>({u_opacity:_,u_color:t}),Ly=(_,t,o,h,f)=>l.e(function(y,b,S,C){const k=S.imageManager.getPattern(y.from.toString()),z=S.imageManager.getPattern(y.to.toString()),{width:O,height:L}=S.imageManager.getPixelSize(),j=Math.pow(2,C.tileID.overscaledZ),q=C.tileSize*Math.pow(2,S.transform.tileZoom)/j,se=q*(C.tileID.canonical.x+C.tileID.wrap*j),oe=q*C.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:k.tl,u_pattern_br_a:k.br,u_pattern_tl_b:z.tl,u_pattern_br_b:z.br,u_texsize:[O,L],u_mix:b.t,u_pattern_size_a:k.displaySize,u_pattern_size_b:z.displaySize,u_scale_a:b.fromScale,u_scale_b:b.toScale,u_tile_units_to_pixels:1/l.aB(C,1,S.transform.tileZoom),u_pixel_coord_upper:[se>>16,oe>>16],u_pixel_coord_lower:[65535&se,65535&oe]}}(o,f,t,h),{u_opacity:_}),tm=(_,t)=>{},rm={fillExtrusion:(_,t)=>({u_lightpos:new l.bS(_,t.u_lightpos),u_lightpos_globe:new l.bS(_,t.u_lightpos_globe),u_lightintensity:new l.bf(_,t.u_lightintensity),u_lightcolor:new l.bS(_,t.u_lightcolor),u_vertical_gradient:new l.bf(_,t.u_vertical_gradient),u_opacity:new l.bf(_,t.u_opacity),u_fill_translate:new l.bT(_,t.u_fill_translate)}),fillExtrusionPattern:(_,t)=>({u_lightpos:new l.bS(_,t.u_lightpos),u_lightpos_globe:new l.bS(_,t.u_lightpos_globe),u_lightintensity:new l.bf(_,t.u_lightintensity),u_lightcolor:new l.bS(_,t.u_lightcolor),u_vertical_gradient:new l.bf(_,t.u_vertical_gradient),u_height_factor:new l.bf(_,t.u_height_factor),u_opacity:new l.bf(_,t.u_opacity),u_fill_translate:new l.bT(_,t.u_fill_translate),u_image:new l.bO(_,t.u_image),u_texsize:new l.bT(_,t.u_texsize),u_pixel_coord_upper:new l.bT(_,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.bT(_,t.u_pixel_coord_lower),u_scale:new l.bS(_,t.u_scale),u_fade:new l.bf(_,t.u_fade)}),fill:(_,t)=>({u_fill_translate:new l.bT(_,t.u_fill_translate)}),fillPattern:(_,t)=>({u_image:new l.bO(_,t.u_image),u_texsize:new l.bT(_,t.u_texsize),u_pixel_coord_upper:new l.bT(_,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.bT(_,t.u_pixel_coord_lower),u_scale:new l.bS(_,t.u_scale),u_fade:new l.bf(_,t.u_fade),u_fill_translate:new l.bT(_,t.u_fill_translate)}),fillOutline:(_,t)=>({u_world:new l.bT(_,t.u_world),u_fill_translate:new l.bT(_,t.u_fill_translate)}),fillOutlinePattern:(_,t)=>({u_world:new l.bT(_,t.u_world),u_image:new l.bO(_,t.u_image),u_texsize:new l.bT(_,t.u_texsize),u_pixel_coord_upper:new l.bT(_,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.bT(_,t.u_pixel_coord_lower),u_scale:new l.bS(_,t.u_scale),u_fade:new l.bf(_,t.u_fade),u_fill_translate:new l.bT(_,t.u_fill_translate)}),circle:(_,t)=>({u_camera_to_center_distance:new l.bf(_,t.u_camera_to_center_distance),u_scale_with_map:new l.bO(_,t.u_scale_with_map),u_pitch_with_map:new l.bO(_,t.u_pitch_with_map),u_extrude_scale:new l.bT(_,t.u_extrude_scale),u_device_pixel_ratio:new l.bf(_,t.u_device_pixel_ratio),u_globe_extrude_scale:new l.bf(_,t.u_globe_extrude_scale),u_translate:new l.bT(_,t.u_translate)}),collisionBox:(_,t)=>({u_pixel_extrude_scale:new l.bT(_,t.u_pixel_extrude_scale)}),collisionCircle:(_,t)=>({u_viewport_size:new l.bT(_,t.u_viewport_size)}),debug:(_,t)=>({u_color:new l.bP(_,t.u_color),u_overlay:new l.bO(_,t.u_overlay),u_overlay_scale:new l.bf(_,t.u_overlay_scale)}),depth:tm,clippingMask:tm,heatmap:(_,t)=>({u_extrude_scale:new l.bf(_,t.u_extrude_scale),u_intensity:new l.bf(_,t.u_intensity),u_globe_extrude_scale:new l.bf(_,t.u_globe_extrude_scale)}),heatmapTexture:(_,t)=>({u_matrix:new l.bQ(_,t.u_matrix),u_world:new l.bT(_,t.u_world),u_image:new l.bO(_,t.u_image),u_color_ramp:new l.bO(_,t.u_color_ramp),u_opacity:new l.bf(_,t.u_opacity)}),hillshade:(_,t)=>({u_image:new l.bO(_,t.u_image),u_latrange:new l.bT(_,t.u_latrange),u_exaggeration:new l.bf(_,t.u_exaggeration),u_altitudes:new l.bZ(_,t.u_altitudes),u_azimuths:new l.bZ(_,t.u_azimuths),u_accent:new l.bP(_,t.u_accent),u_method:new l.bO(_,t.u_method),u_shadows:new l.bY(_,t.u_shadows),u_highlights:new l.bY(_,t.u_highlights)}),hillshadePrepare:(_,t)=>({u_matrix:new l.bQ(_,t.u_matrix),u_image:new l.bO(_,t.u_image),u_dimension:new l.bT(_,t.u_dimension),u_zoom:new l.bf(_,t.u_zoom),u_unpack:new l.bR(_,t.u_unpack)}),colorRelief:(_,t)=>({u_image:new l.bO(_,t.u_image),u_unpack:new l.bR(_,t.u_unpack),u_dimension:new l.bT(_,t.u_dimension),u_elevation_stops:new l.bO(_,t.u_elevation_stops),u_color_stops:new l.bO(_,t.u_color_stops),u_color_ramp_size:new l.bO(_,t.u_color_ramp_size),u_opacity:new l.bf(_,t.u_opacity)}),line:(_,t)=>({u_translation:new l.bT(_,t.u_translation),u_ratio:new l.bf(_,t.u_ratio),u_device_pixel_ratio:new l.bf(_,t.u_device_pixel_ratio),u_units_to_pixels:new l.bT(_,t.u_units_to_pixels)}),lineGradient:(_,t)=>({u_translation:new l.bT(_,t.u_translation),u_ratio:new l.bf(_,t.u_ratio),u_device_pixel_ratio:new l.bf(_,t.u_device_pixel_ratio),u_units_to_pixels:new l.bT(_,t.u_units_to_pixels),u_image:new l.bO(_,t.u_image),u_image_height:new l.bf(_,t.u_image_height)}),linePattern:(_,t)=>({u_translation:new l.bT(_,t.u_translation),u_texsize:new l.bT(_,t.u_texsize),u_ratio:new l.bf(_,t.u_ratio),u_device_pixel_ratio:new l.bf(_,t.u_device_pixel_ratio),u_image:new l.bO(_,t.u_image),u_units_to_pixels:new l.bT(_,t.u_units_to_pixels),u_scale:new l.bS(_,t.u_scale),u_fade:new l.bf(_,t.u_fade)}),lineSDF:(_,t)=>({u_translation:new l.bT(_,t.u_translation),u_ratio:new l.bf(_,t.u_ratio),u_device_pixel_ratio:new l.bf(_,t.u_device_pixel_ratio),u_units_to_pixels:new l.bT(_,t.u_units_to_pixels),u_patternscale_a:new l.bT(_,t.u_patternscale_a),u_patternscale_b:new l.bT(_,t.u_patternscale_b),u_sdfgamma:new l.bf(_,t.u_sdfgamma),u_image:new l.bO(_,t.u_image),u_tex_y_a:new l.bf(_,t.u_tex_y_a),u_tex_y_b:new l.bf(_,t.u_tex_y_b),u_mix:new l.bf(_,t.u_mix)}),raster:(_,t)=>({u_tl_parent:new l.bT(_,t.u_tl_parent),u_scale_parent:new l.bf(_,t.u_scale_parent),u_buffer_scale:new l.bf(_,t.u_buffer_scale),u_fade_t:new l.bf(_,t.u_fade_t),u_opacity:new l.bf(_,t.u_opacity),u_image0:new l.bO(_,t.u_image0),u_image1:new l.bO(_,t.u_image1),u_brightness_low:new l.bf(_,t.u_brightness_low),u_brightness_high:new l.bf(_,t.u_brightness_high),u_saturation_factor:new l.bf(_,t.u_saturation_factor),u_contrast_factor:new l.bf(_,t.u_contrast_factor),u_spin_weights:new l.bS(_,t.u_spin_weights),u_coords_top:new l.bR(_,t.u_coords_top),u_coords_bottom:new l.bR(_,t.u_coords_bottom)}),symbolIcon:(_,t)=>({u_is_size_zoom_constant:new l.bO(_,t.u_is_size_zoom_constant),u_is_size_feature_constant:new l.bO(_,t.u_is_size_feature_constant),u_size_t:new l.bf(_,t.u_size_t),u_size:new l.bf(_,t.u_size),u_camera_to_center_distance:new l.bf(_,t.u_camera_to_center_distance),u_pitch:new l.bf(_,t.u_pitch),u_rotate_symbol:new l.bO(_,t.u_rotate_symbol),u_aspect_ratio:new l.bf(_,t.u_aspect_ratio),u_fade_change:new l.bf(_,t.u_fade_change),u_label_plane_matrix:new l.bQ(_,t.u_label_plane_matrix),u_coord_matrix:new l.bQ(_,t.u_coord_matrix),u_is_text:new l.bO(_,t.u_is_text),u_pitch_with_map:new l.bO(_,t.u_pitch_with_map),u_is_along_line:new l.bO(_,t.u_is_along_line),u_is_variable_anchor:new l.bO(_,t.u_is_variable_anchor),u_texsize:new l.bT(_,t.u_texsize),u_texture:new l.bO(_,t.u_texture),u_translation:new l.bT(_,t.u_translation),u_pitched_scale:new l.bf(_,t.u_pitched_scale)}),symbolSDF:(_,t)=>({u_is_size_zoom_constant:new l.bO(_,t.u_is_size_zoom_constant),u_is_size_feature_constant:new l.bO(_,t.u_is_size_feature_constant),u_size_t:new l.bf(_,t.u_size_t),u_size:new l.bf(_,t.u_size),u_camera_to_center_distance:new l.bf(_,t.u_camera_to_center_distance),u_pitch:new l.bf(_,t.u_pitch),u_rotate_symbol:new l.bO(_,t.u_rotate_symbol),u_aspect_ratio:new l.bf(_,t.u_aspect_ratio),u_fade_change:new l.bf(_,t.u_fade_change),u_label_plane_matrix:new l.bQ(_,t.u_label_plane_matrix),u_coord_matrix:new l.bQ(_,t.u_coord_matrix),u_is_text:new l.bO(_,t.u_is_text),u_pitch_with_map:new l.bO(_,t.u_pitch_with_map),u_is_along_line:new l.bO(_,t.u_is_along_line),u_is_variable_anchor:new l.bO(_,t.u_is_variable_anchor),u_texsize:new l.bT(_,t.u_texsize),u_texture:new l.bO(_,t.u_texture),u_gamma_scale:new l.bf(_,t.u_gamma_scale),u_device_pixel_ratio:new l.bf(_,t.u_device_pixel_ratio),u_is_halo:new l.bO(_,t.u_is_halo),u_translation:new l.bT(_,t.u_translation),u_pitched_scale:new l.bf(_,t.u_pitched_scale)}),symbolTextAndIcon:(_,t)=>({u_is_size_zoom_constant:new l.bO(_,t.u_is_size_zoom_constant),u_is_size_feature_constant:new l.bO(_,t.u_is_size_feature_constant),u_size_t:new l.bf(_,t.u_size_t),u_size:new l.bf(_,t.u_size),u_camera_to_center_distance:new l.bf(_,t.u_camera_to_center_distance),u_pitch:new l.bf(_,t.u_pitch),u_rotate_symbol:new l.bO(_,t.u_rotate_symbol),u_aspect_ratio:new l.bf(_,t.u_aspect_ratio),u_fade_change:new l.bf(_,t.u_fade_change),u_label_plane_matrix:new l.bQ(_,t.u_label_plane_matrix),u_coord_matrix:new l.bQ(_,t.u_coord_matrix),u_is_text:new l.bO(_,t.u_is_text),u_pitch_with_map:new l.bO(_,t.u_pitch_with_map),u_is_along_line:new l.bO(_,t.u_is_along_line),u_is_variable_anchor:new l.bO(_,t.u_is_variable_anchor),u_texsize:new l.bT(_,t.u_texsize),u_texsize_icon:new l.bT(_,t.u_texsize_icon),u_texture:new l.bO(_,t.u_texture),u_texture_icon:new l.bO(_,t.u_texture_icon),u_gamma_scale:new l.bf(_,t.u_gamma_scale),u_device_pixel_ratio:new l.bf(_,t.u_device_pixel_ratio),u_is_halo:new l.bO(_,t.u_is_halo),u_translation:new l.bT(_,t.u_translation),u_pitched_scale:new l.bf(_,t.u_pitched_scale)}),background:(_,t)=>({u_opacity:new l.bf(_,t.u_opacity),u_color:new l.bP(_,t.u_color)}),backgroundPattern:(_,t)=>({u_opacity:new l.bf(_,t.u_opacity),u_image:new l.bO(_,t.u_image),u_pattern_tl_a:new l.bT(_,t.u_pattern_tl_a),u_pattern_br_a:new l.bT(_,t.u_pattern_br_a),u_pattern_tl_b:new l.bT(_,t.u_pattern_tl_b),u_pattern_br_b:new l.bT(_,t.u_pattern_br_b),u_texsize:new l.bT(_,t.u_texsize),u_mix:new l.bf(_,t.u_mix),u_pattern_size_a:new l.bT(_,t.u_pattern_size_a),u_pattern_size_b:new l.bT(_,t.u_pattern_size_b),u_scale_a:new l.bf(_,t.u_scale_a),u_scale_b:new l.bf(_,t.u_scale_b),u_pixel_coord_upper:new l.bT(_,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.bT(_,t.u_pixel_coord_lower),u_tile_units_to_pixels:new l.bf(_,t.u_tile_units_to_pixels)}),terrain:(_,t)=>({u_texture:new l.bO(_,t.u_texture),u_ele_delta:new l.bf(_,t.u_ele_delta),u_fog_matrix:new l.bQ(_,t.u_fog_matrix),u_fog_color:new l.bP(_,t.u_fog_color),u_fog_ground_blend:new l.bf(_,t.u_fog_ground_blend),u_fog_ground_blend_opacity:new l.bf(_,t.u_fog_ground_blend_opacity),u_horizon_color:new l.bP(_,t.u_horizon_color),u_horizon_fog_blend:new l.bf(_,t.u_horizon_fog_blend),u_is_globe_mode:new l.bf(_,t.u_is_globe_mode)}),terrainDepth:(_,t)=>({u_ele_delta:new l.bf(_,t.u_ele_delta)}),terrainCoords:(_,t)=>({u_texture:new l.bO(_,t.u_texture),u_terrain_coords_id:new l.bf(_,t.u_terrain_coords_id),u_ele_delta:new l.bf(_,t.u_ele_delta)}),projectionErrorMeasurement:(_,t)=>({u_input:new l.bf(_,t.u_input),u_output_expected:new l.bf(_,t.u_output_expected)}),atmosphere:(_,t)=>({u_sun_pos:new l.bS(_,t.u_sun_pos),u_atmosphere_blend:new l.bf(_,t.u_atmosphere_blend),u_globe_position:new l.bS(_,t.u_globe_position),u_globe_radius:new l.bf(_,t.u_globe_radius),u_inv_proj_matrix:new l.bQ(_,t.u_inv_proj_matrix)}),sky:(_,t)=>({u_sky_color:new l.bP(_,t.u_sky_color),u_horizon_color:new l.bP(_,t.u_horizon_color),u_horizon:new l.bT(_,t.u_horizon),u_horizon_normal:new l.bT(_,t.u_horizon_normal),u_sky_horizon_blend:new l.bf(_,t.u_sky_horizon_blend),u_sky_blend:new l.bf(_,t.u_sky_blend)})};class nm{constructor(t,o,h){this.context=t;const f=t.gl;this.buffer=f.createBuffer(),this.dynamicDraw=!!h,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const o=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),o.bufferSubData(o.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const im={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class gd{constructor(t,o,h,f){this.length=o.length,this.attributes=h,this.itemSize=o.bytesPerElement,this.dynamicDraw=f,this.context=t;const y=t.gl;this.buffer=y.createBuffer(),t.bindVertexBuffer.set(this.buffer),y.bufferData(y.ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const o=this.context.gl;this.bind(),o.bufferSubData(o.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,o){for(let h=0;h<this.attributes.length;h++){const f=o.attributes[this.attributes[h].name];f!==void 0&&t.enableVertexAttribArray(f)}}setVertexAttribPointers(t,o,h){for(let f=0;f<this.attributes.length;f++){const y=this.attributes[f],b=o.attributes[y.name];b!==void 0&&t.vertexAttribPointer(b,y.components,t[im[y.type]],!1,this.itemSize,y.offset+this.itemSize*(h||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class lr{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class uu extends lr{getDefault(){return l.be.transparent}set(t){const o=this.current;(t.r!==o.r||t.g!==o.g||t.b!==o.b||t.a!==o.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Mo extends lr{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class _d extends lr{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class yd extends lr{getDefault(){return[!0,!0,!0,!0]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||t[3]!==o[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class vd extends lr{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class om extends lr{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class xd extends lr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const o=this.current;(t.func!==o.func||t.ref!==o.ref||t.mask!==o.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class Ns extends lr{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class bd extends lr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.STENCIL_TEST):o.disable(o.STENCIL_TEST),this.current=t,this.dirty=!1}}class Oy extends lr{getDefault(){return[0,1]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class Fy extends lr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.DEPTH_TEST):o.disable(o.DEPTH_TEST),this.current=t,this.dirty=!1}}class Ny extends lr{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class By extends lr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.BLEND):o.disable(o.BLEND),this.current=t,this.dirty=!1}}class sm extends lr{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class jy extends lr{getDefault(){return l.be.transparent}set(t){const o=this.current;(t.r!==o.r||t.g!==o.g||t.b!==o.b||t.a!==o.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class am extends lr{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class hu extends lr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.CULL_FACE):o.disable(o.CULL_FACE),this.current=t,this.dirty=!1}}class du extends lr{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class fu extends lr{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class wd extends lr{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class Bs extends lr{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class Gl extends lr{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||t[3]!==o[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class wa extends lr{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindFramebuffer(o.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class Ci extends lr{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindRenderbuffer(o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class lm extends lr{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindTexture(o.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class cm extends lr{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindBuffer(o.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Sd extends lr{getDefault(){return null}set(t){const o=this.gl;o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class js extends lr{getDefault(){return null}set(t){var o;if(t===this.current&&!this.dirty)return;const h=this.gl;jn(h)?h.bindVertexArray(t):(o=h.getExtension("OES_vertex_array_object"))===null||o===void 0||o.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class pu extends lr{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class mu extends lr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class Hl extends lr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class Sa extends lr{constructor(t,o){super(t),this.context=t,this.parent=o}getDefault(){return null}}class um extends Sa{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class Ta extends Sa{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Ca extends Sa{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}const Td="Framebuffer is not complete";class Cd{constructor(t,o,h,f,y){this.context=t,this.width=o,this.height=h;const b=t.gl,S=this.framebuffer=b.createFramebuffer();if(this.colorAttachment=new um(t,S),f)this.depthAttachment=y?new Ca(t,S):new Ta(t,S);else if(y)throw new Error("Stencil cannot be set without depth");if(b.checkFramebufferStatus(b.FRAMEBUFFER)!==b.FRAMEBUFFER_COMPLETE)throw new Error(Td)}destroy(){const t=this.context.gl,o=this.colorAttachment.get();if(o&&t.deleteTexture(o),this.depthAttachment){const h=this.depthAttachment.get();h&&t.deleteRenderbuffer(h)}t.deleteFramebuffer(this.framebuffer)}}class qt{constructor(t){var o,h;if(this.gl=t,this.clearColor=new uu(this),this.clearDepth=new Mo(this),this.clearStencil=new _d(this),this.colorMask=new yd(this),this.depthMask=new vd(this),this.stencilMask=new om(this),this.stencilFunc=new xd(this),this.stencilOp=new Ns(this),this.stencilTest=new bd(this),this.depthRange=new Oy(this),this.depthTest=new Fy(this),this.depthFunc=new Ny(this),this.blend=new By(this),this.blendFunc=new sm(this),this.blendColor=new jy(this),this.blendEquation=new am(this),this.cullFace=new hu(this),this.cullFaceSide=new du(this),this.frontFace=new fu(this),this.program=new wd(this),this.activeTexture=new Bs(this),this.viewport=new Gl(this),this.bindFramebuffer=new wa(this),this.bindRenderbuffer=new Ci(this),this.bindTexture=new lm(this),this.bindVertexBuffer=new cm(this),this.bindElementBuffer=new Sd(this),this.bindVertexArray=new js(this),this.pixelStoreUnpack=new pu(this),this.pixelStoreUnpackPremultiplyAlpha=new mu(this),this.pixelStoreUnpackFlipY=new Hl(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),jn(t)){this.HALF_FLOAT=t.HALF_FLOAT;const f=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(o=t.RGBA16F)!==null&&o!==void 0?o:f==null?void 0:f.RGBA16F_EXT,this.RGB16F=(h=t.RGB16F)!==null&&h!==void 0?h:f==null?void 0:f.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const f=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=f==null?void 0:f.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,o){return new nm(this,t,o)}createVertexBuffer(t,o,h){return new gd(this,t,o,h)}createRenderbuffer(t,o,h){const f=this.gl,y=f.createRenderbuffer();return this.bindRenderbuffer.set(y),f.renderbufferStorage(f.RENDERBUFFER,t,o,h),this.bindRenderbuffer.set(null),y}createFramebuffer(t,o,h,f){return new Cd(this,t,o,h,f)}clear({color:t,depth:o,stencil:h}){const f=this.gl;let y=0;t&&(y|=f.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(y|=f.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),h!==void 0&&(y|=f.STENCIL_BUFFER_BIT,this.clearStencil.set(h),this.stencilMask.set(255)),f.clear(y)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){l.bG(t.blendFunction,er.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return jn(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var o;return jn(this.gl)?this.gl.deleteVertexArray(t):(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}let $s;function hm(_,t,o,h,f){const y=_.context,b=_.transform,S=y.gl,C=_.useProgram("collisionBox"),k=[];let z=0,O=0;for(let ae=0;ae<h.length;ae++){const ce=h[ae],pe=t.getTile(ce).getBucket(o);if(!pe)continue;const ue=f?pe.textCollisionBox:pe.iconCollisionBox,ve=pe.collisionCircleArray;ve.length>0&&(k.push({circleArray:ve,circleOffset:O,coord:ce}),z+=ve.length/4,O=z),ue&&C.draw(y,S.LINES,Ot.disabled,zt.disabled,_.colorModeForRenderPass(),Lt.disabled,Ul(_.transform),_.style.map.terrain&&_.style.map.terrain.getTerrainData(ce),b.getProjectionData({overscaledTileID:ce,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),o.id,ue.layoutVertexBuffer,ue.indexBuffer,ue.segments,null,_.transform.zoom,null,null,ue.collisionVertexBuffer)}if(!f||!k.length)return;const L=_.useProgram("collisionCircle"),j=new l.b_;j.resize(4*z),j._trim();let q=0;for(const ae of k)for(let ce=0;ce<ae.circleArray.length/4;ce++){const pe=4*ce,ue=ae.circleArray[pe+0],ve=ae.circleArray[pe+1],be=ae.circleArray[pe+2],fe=ae.circleArray[pe+3];j.emplace(q++,ue,ve,be,fe,0),j.emplace(q++,ue,ve,be,fe,1),j.emplace(q++,ue,ve,be,fe,2),j.emplace(q++,ue,ve,be,fe,3)}(!$s||$s.length<2*z)&&($s=function(ae){const ce=2*ae,pe=new l.c0;pe.resize(ce),pe._trim();for(let ue=0;ue<ce;ue++){const ve=6*ue;pe.uint16[ve+0]=4*ue+0,pe.uint16[ve+1]=4*ue+1,pe.uint16[ve+2]=4*ue+2,pe.uint16[ve+3]=4*ue+2,pe.uint16[ve+4]=4*ue+3,pe.uint16[ve+5]=4*ue+0}return pe}(z));const se=y.createIndexBuffer($s,!0),oe=y.createVertexBuffer(j,l.b$.members,!0);for(const ae of k){const ce=Vl(_.transform);L.draw(y,S.TRIANGLES,Ot.disabled,zt.disabled,_.colorModeForRenderPass(),Lt.disabled,ce,_.style.map.terrain&&_.style.map.terrain.getTerrainData(ae.coord),null,o.id,oe,se,l.aL.simpleSegment(0,2*ae.circleOffset,ae.circleArray.length,ae.circleArray.length/2),null,_.transform.zoom,null,null,null)}oe.destroy(),se.destroy()}const dm=l.af(new Float32Array(16));function Wl(_,t,o,h,f,y){const{horizontalAlign:b,verticalAlign:S}=l.aG(_);return new l.P((-(b-.5)*t/f+h[0])*y,(-(S-.5)*o/f+h[1])*y)}function $y(_,t,o,h,f,y){const b=t.tileAnchorPoint.add(new l.P(t.translation[0],t.translation[1]));if(t.pitchWithMap){let S=h.mult(y);o||(S=S.rotate(-f));const C=b.add(S);return Bt(C.x,C.y,t.pitchedLabelPlaneMatrix,t.getElevation).point}if(o){const S=at(t.tileAnchorPoint.x+1,t.tileAnchorPoint.y,t).point.sub(_),C=Math.atan(S.y/S.x)+(S.x<0?Math.PI:0);return _.add(h.rotate(C))}return _.add(h)}function Uy(_,t,o,h,f,y,b,S,C,k,z,O){const L=_.text.placedSymbolArray,j=_.text.dynamicLayoutVertexArray,q=_.icon.dynamicLayoutVertexArray,se={};j.clear();for(let oe=0;oe<L.length;oe++){const ae=L.get(oe),ce=ae.hidden||!ae.crossTileID||_.allowVerticalPlacement&&!ae.placedOrientation?null:h[ae.crossTileID];if(ce){const pe=new l.P(ae.anchorX,ae.anchorY),ue={getElevation:O,width:f.width,height:f.height,pitchedLabelPlaneMatrix:y,pitchWithMap:o,transform:f,tileAnchorPoint:pe,translation:k,unwrappedTileID:z},ve=o?$t(pe.x,pe.y,ue):at(pe.x,pe.y,ue),be=Rt(f.cameraToCenterDistance,ve.signedDistanceFromCamera);let fe=l.ao(_.textSizeData,S,ae)*be/l.aA;o&&(fe*=_.tilePixelRatio/b);const{width:Pe,height:Oe,anchor:Ae,textOffset:Re,textBoxScale:Fe}=ce,st=Wl(Ae,Pe,Oe,Re,Fe,fe),it=f.getPitchedTextCorrection(pe.x+k[0],pe.y+k[1],z),Ke=$y(ve.point,ue,t,st,-f.bearingInRadians,it),vt=_.allowVerticalPlacement&&ae.placedOrientation===l.an.vertical?Math.PI/2:0;for(let Ft=0;Ft<ae.numGlyphs;Ft++)l.au(j,Ke,vt);C&&ae.associatedIconIndex>=0&&(se[ae.associatedIconIndex]={shiftedAnchor:Ke,angle:vt})}else So(ae.numGlyphs,j)}if(C){q.clear();const oe=_.icon.placedSymbolArray;for(let ae=0;ae<oe.length;ae++){const ce=oe.get(ae);if(ce.hidden)So(ce.numGlyphs,q);else{const pe=se[ae];if(pe)for(let ue=0;ue<ce.numGlyphs;ue++)l.au(q,pe.shiftedAnchor,pe.angle);else So(ce.numGlyphs,q)}}_.icon.dynamicLayoutVertexBuffer.updateData(q)}_.text.dynamicLayoutVertexBuffer.updateData(j)}function fm(_,t,o){return o.iconsInText&&t?"symbolTextAndIcon":_?"symbolSDF":"symbolIcon"}function pm(_,t,o,h,f,y,b,S,C,k,z,O,L){const j=_.context,q=j.gl,se=_.transform,oe=S==="map",ae=C==="map",ce=S!=="viewport"&&o.layout.get("symbol-placement")!=="point",pe=oe&&!ae&&!ce,ue=!o.layout.get("symbol-sort-key").isConstant();let ve=!1;const be=_.getDepthModeForSublayer(0,Ot.ReadOnly),fe=o._unevaluatedLayout.hasValue("text-variable-anchor")||o._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Pe=[],Oe=se.getCircleRadiusCorrection();for(const Ae of h){const Re=t.getTile(Ae),Fe=Re.getBucket(o);if(!Fe)continue;const st=f?Fe.text:Fe.icon;if(!st||!st.segments.get().length||!st.hasVisibleVertices)continue;const it=st.programConfigurations.get(o.id),Ke=f||Fe.sdfIcons,vt=f?Fe.textSizeData:Fe.iconSizeData,Ft=ae||se.pitch!==0,cr=_.useProgram(fm(Ke,f,Fe),it),kr=l.am(vt,se.zoom),pr=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Ae);let Ir,_r,mr,yr,Sn=[0,0],rr=null;if(f)_r=Re.glyphAtlasTexture,mr=q.LINEAR,Ir=Re.glyphAtlasTexture.size,Fe.iconsInText&&(Sn=Re.imageAtlasTexture.size,rr=Re.imageAtlasTexture,yr=Ft||_.options.rotating||_.options.zooming||vt.kind==="composite"||vt.kind==="camera"?q.LINEAR:q.NEAREST);else{const $r=o.layout.get("icon-size").constantOr(0)!==1||Fe.iconsNeedLinear;_r=Re.imageAtlasTexture,mr=Ke||_.options.rotating||_.options.zooming||$r||Ft?q.LINEAR:q.NEAREST,Ir=Re.imageAtlasTexture.size}const pn=l.aB(Re,1,_.transform.zoom),Tn=Et(oe,_.transform,pn),ss=l.L();l.ap(ss,Tn);const as=ir(ae,oe,_.transform,pn),ls=l.aC(se,Re,y,b),uo=se.getProjectionData({overscaledTileID:Ae,applyGlobeMatrix:!L,applyTerrainMatrix:!0}),ac=fe&&Fe.hasTextData(),lc=o.layout.get("icon-text-fit")!=="none"&&ac&&Fe.hasIconData();if(ce){const $r=_.style.map.terrain?(Zn,an)=>_.style.map.terrain.getElevation(Ae,Zn,an):null,xr=o.layout.get("text-rotation-alignment")==="map";hn(Fe,_,f,Tn,ss,ae,k,xr,Ae.toUnwrapped(),se.width,se.height,ls,$r)}const Fa=f&&fe||lc,ri=ce||Fa?dm:ae?Tn:_.transform.clipSpaceToPixelsMatrix,Ui=Ke&&o.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let cs;cs=Ke?Fe.iconsInText?Dy(vt.kind,kr,pe,ae,ce,Fa,_,ri,as,ls,Ir,Sn,Oe):ba(vt.kind,kr,pe,ae,ce,Fa,_,ri,as,ls,f,Ir,0,Oe):md(vt.kind,kr,pe,ae,ce,Fa,_,ri,as,ls,f,Ir,Oe);const Zs={program:cr,buffers:st,uniformValues:cs,projectionData:uo,atlasTexture:_r,atlasTextureIcon:rr,atlasInterpolation:mr,atlasInterpolationIcon:yr,isSDF:Ke,hasHalo:Ui};if(ue&&Fe.canOverlap){ve=!0;const $r=st.segments.get();for(const xr of $r)Pe.push({segments:new l.aL([xr]),sortKey:xr.sortKey,state:Zs,terrainData:pr})}else Pe.push({segments:st.segments,sortKey:0,state:Zs,terrainData:pr})}ve&&Pe.sort((Ae,Re)=>Ae.sortKey-Re.sortKey);for(const Ae of Pe){const Re=Ae.state;if(j.activeTexture.set(q.TEXTURE0),Re.atlasTexture.bind(Re.atlasInterpolation,q.CLAMP_TO_EDGE),Re.atlasTextureIcon&&(j.activeTexture.set(q.TEXTURE1),Re.atlasTextureIcon&&Re.atlasTextureIcon.bind(Re.atlasInterpolationIcon,q.CLAMP_TO_EDGE)),Re.isSDF){const Fe=Re.uniformValues;Re.hasHalo&&(Fe.u_is_halo=1,gu(Re.buffers,Ae.segments,o,_,Re.program,be,z,O,Fe,Re.projectionData,Ae.terrainData)),Fe.u_is_halo=0}gu(Re.buffers,Ae.segments,o,_,Re.program,be,z,O,Re.uniformValues,Re.projectionData,Ae.terrainData)}}function gu(_,t,o,h,f,y,b,S,C,k,z){const O=h.context;f.draw(O,O.gl.TRIANGLES,y,b,S,Lt.backCCW,C,z,k,o.id,_.layoutVertexBuffer,_.indexBuffer,t,o.paint,h.transform.zoom,_.programConfigurations.get(o.id),_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer)}function _u(_,t,o,h,f){const y=_.context,b=y.gl,S=zt.disabled,C=new er([b.ONE,b.ONE],l.be.transparent,[!0,!0,!0,!0]),k=t.getBucket(o);if(!k)return;const z=h.key;let O=o.heatmapFbos.get(z);O||(O=ql(y,t.tileSize,t.tileSize),o.heatmapFbos.set(z,O)),y.bindFramebuffer.set(O.framebuffer),y.viewport.set([0,0,t.tileSize,t.tileSize]),y.clear({color:l.be.transparent});const L=k.programConfigurations.get(o.id),j=_.useProgram("heatmap",L,!f),q=_.transform.getProjectionData({overscaledTileID:t.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),se=_.style.map.terrain.getTerrainData(h);j.draw(y,b.TRIANGLES,Ot.disabled,S,C,Lt.disabled,Zl(t,_.transform.zoom,o.paint.get("heatmap-intensity"),1),se,q,o.id,k.layoutVertexBuffer,k.indexBuffer,k.segments,o.paint,_.transform.zoom,L)}function yu(_,t,o,h,f){const y=_.context,b=y.gl,S=_.transform;y.setColorMode(_.colorModeForRenderPass());const C=vu(y,t),k=o.key,z=t.heatmapFbos.get(k);if(!z)return;y.activeTexture.set(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,z.colorAttachment.get()),y.activeTexture.set(b.TEXTURE1),C.bind(b.LINEAR,b.CLAMP_TO_EDGE);const O=S.getProjectionData({overscaledTileID:o,applyTerrainMatrix:f,applyGlobeMatrix:!h});_.useProgram("heatmapTexture").draw(y,b.TRIANGLES,Ot.disabled,zt.disabled,_.colorModeForRenderPass(),Lt.disabled,Kp(_,t,0,1),null,O,t.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments,t.paint,S.zoom),z.destroy(),t.heatmapFbos.delete(k)}function ql(_,t,o){var h,f;const y=_.gl,b=y.createTexture();y.bindTexture(y.TEXTURE_2D,b),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.LINEAR),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,y.LINEAR);const S=(h=_.HALF_FLOAT)!==null&&h!==void 0?h:y.UNSIGNED_BYTE,C=(f=_.RGBA16F)!==null&&f!==void 0?f:y.RGBA;y.texImage2D(y.TEXTURE_2D,0,C,t,o,0,y.RGBA,S,null);const k=_.createFramebuffer(t,o,!1,!1);return k.colorAttachment.set(b),k}function vu(_,t){return t.colorRampTexture||(t.colorRampTexture=new l.T(_,t.colorRamp,_.gl.RGBA)),t.colorRampTexture}function Pd(_,t,o,h,f){if(!o||!h||!h.imageAtlas)return;const y=h.imageAtlas.patternPositions;let b=y[o.to.toString()],S=y[o.from.toString()];if(!b&&S&&(b=S),!S&&b&&(S=b),!b||!S){const C=f.getPaintProperty(t);b=y[C],S=y[C]}b&&S&&_.setConstantPatternPositions(b,S)}function Xl(_,t,o,h,f,y,b,S){const C=_.context.gl,k="fill-pattern",z=o.paint.get(k),O=z&&z.constantOr(1),L=o.getCrossfadeParameters();let j,q,se,oe,ae;const ce=_.transform,pe=o.paint.get("fill-translate"),ue=o.paint.get("fill-translate-anchor");b?(q=O&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",j=C.LINES):(q=O?"fillPattern":"fill",j=C.TRIANGLES);const ve=z.constantOr(null);for(const be of h){const fe=t.getTile(be);if(O&&!fe.patternsLoaded())continue;const Pe=fe.getBucket(o);if(!Pe)continue;const Oe=Pe.programConfigurations.get(o.id),Ae=_.useProgram(q,Oe),Re=_.style.map.terrain&&_.style.map.terrain.getTerrainData(be);O&&(_.context.activeTexture.set(C.TEXTURE0),fe.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),Oe.updatePaintBuffers(L)),Pd(Oe,k,ve,fe,o);const Fe=ce.getProjectionData({overscaledTileID:be,applyGlobeMatrix:!S,applyTerrainMatrix:!0}),st=l.aC(ce,fe,pe,ue);if(b){oe=Pe.indexBuffer2,ae=Pe.segments2;const Ke=[C.drawingBufferWidth,C.drawingBufferHeight];se=q==="fillOutlinePattern"&&O?Ay(_,L,fe,Ke,st):ao(Ke,st)}else oe=Pe.indexBuffer,ae=Pe.segments,se=O?au(_,L,fe,st):{u_fill_translate:st};const it=_.stencilModeForClipping(be);Ae.draw(_.context,j,f,it,y,Lt.backCCW,se,Re,Fe,o.id,Pe.layoutVertexBuffer,oe,ae,o.paint,_.transform.zoom,Oe)}}function Pa(_,t,o,h,f,y,b,S){const C=_.context,k=C.gl,z="fill-extrusion-pattern",O=o.paint.get(z),L=O.constantOr(1),j=o.getCrossfadeParameters(),q=o.paint.get("fill-extrusion-opacity"),se=O.constantOr(null),oe=_.transform;for(const ae of h){const ce=t.getTile(ae),pe=ce.getBucket(o);if(!pe)continue;const ue=_.style.map.terrain&&_.style.map.terrain.getTerrainData(ae),ve=pe.programConfigurations.get(o.id),be=_.useProgram(L?"fillExtrusionPattern":"fillExtrusion",ve);L&&(_.context.activeTexture.set(k.TEXTURE0),ce.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),ve.updatePaintBuffers(j));const fe=oe.getProjectionData({overscaledTileID:ae,applyGlobeMatrix:!S,applyTerrainMatrix:!0});Pd(ve,z,se,ce,o);const Pe=l.aC(oe,ce,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),Oe=o.paint.get("fill-extrusion-vertical-gradient"),Ae=L?ud(_,Oe,q,Pe,ae,j,ce):$l(_,Oe,q,Pe);be.draw(C,C.gl.TRIANGLES,f,y,b,Lt.backCCW,Ae,ue,fe,o.id,pe.layoutVertexBuffer,pe.indexBuffer,pe.segments,o.paint,_.transform.zoom,ve,_.style.map.terrain&&pe.centroidVertexBuffer)}}function Ea(_,t,o,h,f,y,b,S,C){var k;const z=_.style.projection,O=_.context,L=_.transform,j=O.gl,q=[`#define NUM_ILLUMINATION_SOURCES ${o.paint.get("hillshade-highlight-color").values.length}`],se=_.useProgram("hillshade",null,!1,q),oe=!_.options.moving;for(const ae of h){const ce=t.getTile(ae),pe=ce.fbo;if(!pe)continue;const ue=z.getMeshFromTileID(O,ae.canonical,S,!0,"raster"),ve=(k=_.style.map.terrain)===null||k===void 0?void 0:k.getTerrainData(ae);O.activeTexture.set(j.TEXTURE0),j.bindTexture(j.TEXTURE_2D,pe.colorAttachment.get());const be=L.getProjectionData({overscaledTileID:ae,aligned:oe,applyGlobeMatrix:!C,applyTerrainMatrix:!0});se.draw(O,j.TRIANGLES,y,f[ae.overscaledZ],b,Lt.backCCW,xa(_,ce,o),ve,be,o.id,ue.vertexBuffer,ue.indexBuffer,ue.segments)}}function Kl(_,t,o,h,f,y,b,S,C){var k;const z=_.style.projection,O=_.context,L=_.transform,j=O.gl,q=_.useProgram("colorRelief"),se=!_.options.moving;let oe=!0,ae=0;for(const ce of h){const pe=t.getTile(ce),ue=pe.dem;if(oe){const Ae=j.getParameter(j.MAX_TEXTURE_SIZE),{elevationTexture:Re,colorTexture:Fe}=o.getColorRampTextures(O,Ae,ue.getUnpackVector());O.activeTexture.set(j.TEXTURE1),Re.bind(j.NEAREST,j.CLAMP_TO_EDGE),O.activeTexture.set(j.TEXTURE4),Fe.bind(j.LINEAR,j.CLAMP_TO_EDGE),oe=!1,ae=Re.size[0]}if(!ue||!ue.data)continue;const ve=ue.stride,be=ue.getPixels();if(O.activeTexture.set(j.TEXTURE0),O.pixelStoreUnpackPremultiplyAlpha.set(!1),pe.demTexture=pe.demTexture||_.getTileTexture(ve),pe.demTexture){const Ae=pe.demTexture;Ae.update(be,{premultiply:!1}),Ae.bind(j.LINEAR,j.CLAMP_TO_EDGE)}else pe.demTexture=new l.T(O,be,j.RGBA,{premultiply:!1}),pe.demTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE);const fe=z.getMeshFromTileID(O,ce.canonical,S,!0,"raster"),Pe=(k=_.style.map.terrain)===null||k===void 0?void 0:k.getTerrainData(ce),Oe=L.getProjectionData({overscaledTileID:ce,aligned:se,applyGlobeMatrix:!C,applyTerrainMatrix:!0});q.draw(O,j.TRIANGLES,y,f[ce.overscaledZ],b,Lt.backCCW,Ry(o,pe.dem,ae),Pe,Oe,o.id,fe.vertexBuffer,fe.indexBuffer,fe.segments)}}const Ed=[new l.P(0,0),new l.P(l.$,0),new l.P(l.$,l.$),new l.P(0,l.$)];function ts(_,t,o,h,f,y,b,S,C=!1,k=!1){const z=h[h.length-1].overscaledZ,O=_.context,L=O.gl,j=_.useProgram("raster"),q=_.transform,se=_.style.projection,oe=_.colorModeForRenderPass(),ae=!_.options.moving;for(const ce of h){const pe=_.getDepthModeForSublayer(ce.overscaledZ-z,o.paint.get("raster-opacity")===1?Ot.ReadWrite:Ot.ReadOnly,L.LESS),ue=t.getTile(ce);ue.registerFadeDuration(o.paint.get("raster-fade-duration"));const ve=t.findLoadedParent(ce,0),be=t.findLoadedSibling(ce),fe=Vy(ue,ve||be||null,t,o,_.transform,_.style.map.terrain);let Pe,Oe;const Ae=o.paint.get("raster-resampling")==="nearest"?L.NEAREST:L.LINEAR;O.activeTexture.set(L.TEXTURE0),ue.texture.bind(Ae,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),O.activeTexture.set(L.TEXTURE1),ve?(ve.texture.bind(Ae,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),Pe=Math.pow(2,ve.tileID.overscaledZ-ue.tileID.overscaledZ),Oe=[ue.tileID.canonical.x*Pe%1,ue.tileID.canonical.y*Pe%1]):ue.texture.bind(Ae,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),ue.texture.useMipmap&&O.extTextureFilterAnisotropic&&_.transform.pitch>20&&L.texParameterf(L.TEXTURE_2D,O.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,O.extTextureFilterAnisotropicMax);const Re=_.style.map.terrain&&_.style.map.terrain.getTerrainData(ce),Fe=q.getProjectionData({overscaledTileID:ce,aligned:ae,applyGlobeMatrix:!k,applyTerrainMatrix:!0}),st=Fs(Oe||[0,0],Pe||1,fe,o,S),it=se.getMeshFromTileID(O,ce.canonical,y,b,"raster");j.draw(O,L.TRIANGLES,pe,f?f[ce.overscaledZ]:zt.disabled,oe,C?Lt.frontCCW:Lt.backCCW,st,Re,Fe,o.id,it.vertexBuffer,it.indexBuffer,it.segments)}}function Vy(_,t,o,h,f,y){const b=h.paint.get("raster-fade-duration");if(!y&&b>0){const S=F.now(),C=(S-_.timeAdded)/b,k=t?(S-t.timeAdded)/b:-1,z=o.getSource(),O=Ve(f,{tileSize:z.tileSize,roundZoom:z.roundZoom}),L=!t||Math.abs(t.tileID.overscaledZ-O)>Math.abs(_.tileID.overscaledZ-O),j=L&&_.refreshedUponExpiration?1:l.ag(L?C:1-k,0,1);return _.refreshedUponExpiration&&C>=1&&(_.refreshedUponExpiration=!1),t?{opacity:1,mix:1-j}:{opacity:j,mix:0}}return{opacity:1,mix:0}}const mm=new l.be(1,0,0,1),xu=new l.be(0,1,0,1),Md=new l.be(0,0,1,1),gm=new l.be(1,0,1,1),_m=new l.be(0,1,1,1);function Yl(_,t,o,h){wu(_,0,t+o/2,_.transform.width,o,h)}function bu(_,t,o,h){wu(_,t-o/2,0,o,_.transform.height,h)}function wu(_,t,o,h,f,y){const b=_.context,S=b.gl;S.enable(S.SCISSOR_TEST),S.scissor(t*_.pixelRatio,o*_.pixelRatio,h*_.pixelRatio,f*_.pixelRatio),b.clear({color:y}),S.disable(S.SCISSOR_TEST)}function ym(_,t,o){const h=_.context,f=h.gl,y=_.useProgram("debug"),b=Ot.disabled,S=zt.disabled,C=_.colorModeForRenderPass(),k="$debug",z=_.style.map.terrain&&_.style.map.terrain.getTerrainData(o);h.activeTexture.set(f.TEXTURE0);const O=t.getTileByID(o.key).latestRawTileData,L=Math.floor((O&&O.byteLength||0)/1024),j=t.getTile(o).tileSize,q=512/Math.min(j,512)*(o.overscaledZ/_.transform.zoom)*.5;let se=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(se+=` => ${o.overscaledZ}`),function(ae,ce){ae.initDebugOverlayCanvas();const pe=ae.debugOverlayCanvas,ue=ae.context.gl,ve=ae.debugOverlayCanvas.getContext("2d");ve.clearRect(0,0,pe.width,pe.height),ve.shadowColor="white",ve.shadowBlur=2,ve.lineWidth=1.5,ve.strokeStyle="white",ve.textBaseline="top",ve.font="bold 36px Open Sans, sans-serif",ve.fillText(ce,5,5),ve.strokeText(ce,5,5),ae.debugOverlayTexture.update(pe),ae.debugOverlayTexture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE)}(_,`${se} ${L}kB`);const oe=_.transform.getProjectionData({overscaledTileID:o,applyGlobeMatrix:!0,applyTerrainMatrix:!0});y.draw(h,f.TRIANGLES,b,S,er.alphaBlended,Lt.disabled,Xp(l.be.transparent,q),null,oe,k,_.debugBuffer,_.quadTriangleIndexBuffer,_.debugSegments),y.draw(h,f.LINE_STRIP,b,S,C,Lt.disabled,Xp(l.be.red),z,oe,k,_.debugBuffer,_.tileBorderIndexBuffer,_.debugSegments)}function Dr(_,t,o,h){const{isRenderingGlobe:f}=h,y=_.context,b=y.gl,S=_.transform,C=_.colorModeForRenderPass(),k=_.getDepthModeFor3D(),z=_.useProgram("terrain");y.bindFramebuffer.set(null),y.viewport.set([0,0,_.width,_.height]);for(const O of o){const L=t.getTerrainMesh(O.tileID),j=_.renderToTexture.getTexture(O),q=t.getTerrainData(O.tileID);y.activeTexture.set(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,j.texture);const se=t.getMeshFrameDelta(S.zoom),oe=S.calculateFogMatrix(O.tileID.toUnwrapped()),ae=ky(se,oe,_.style.sky,S.pitch,f),ce=S.getProjectionData({overscaledTileID:O.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});z.draw(y,b.TRIANGLES,k,zt.disabled,C,Lt.backCCW,ae,q,ce,"terrain",L.vertexBuffer,L.indexBuffer,L.segments)}}function rs(_,t){if(!t.mesh){const o=new l.aK;o.emplaceBack(-1,-1),o.emplaceBack(1,-1),o.emplaceBack(1,1),o.emplaceBack(-1,1);const h=new l.aM;h.emplaceBack(0,1,2),h.emplaceBack(0,2,3),t.mesh=new Co(_.createVertexBuffer(o,Po.members),_.createIndexBuffer(h),l.aL.simpleSegment(0,0,o.length,h.length))}return t.mesh}class Pi{constructor(t,o){this.context=new qt(t),this.transform=o,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:l.af(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=We.maxUnderzooming+We.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new eu}resize(t,o,h){if(this.width=Math.floor(t*h),this.height=Math.floor(o*h),this.pixelRatio=h,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const f of this.style._order)this.style._layers[f].resize()}setup(){const t=this.context,o=new l.aK;o.emplaceBack(0,0),o.emplaceBack(l.$,0),o.emplaceBack(0,l.$),o.emplaceBack(l.$,l.$),this.tileExtentBuffer=t.createVertexBuffer(o,Po.members),this.tileExtentSegments=l.aL.simpleSegment(0,0,4,2);const h=new l.aK;h.emplaceBack(0,0),h.emplaceBack(l.$,0),h.emplaceBack(0,l.$),h.emplaceBack(l.$,l.$),this.debugBuffer=t.createVertexBuffer(h,Po.members),this.debugSegments=l.aL.simpleSegment(0,0,4,5);const f=new l.c5;f.emplaceBack(0,0,0,0),f.emplaceBack(l.$,0,l.$,0),f.emplaceBack(0,l.$,0,l.$),f.emplaceBack(l.$,l.$,l.$,l.$),this.rasterBoundsBuffer=t.createVertexBuffer(f,Ey.members),this.rasterBoundsSegments=l.aL.simpleSegment(0,0,4,2);const y=new l.aK;y.emplaceBack(0,0),y.emplaceBack(l.$,0),y.emplaceBack(0,l.$),y.emplaceBack(l.$,l.$),this.rasterBoundsBufferPosOnly=t.createVertexBuffer(y,Po.members),this.rasterBoundsSegmentsPosOnly=l.aL.simpleSegment(0,0,4,5);const b=new l.aK;b.emplaceBack(0,0),b.emplaceBack(1,0),b.emplaceBack(0,1),b.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(b,Po.members),this.viewportSegments=l.aL.simpleSegment(0,0,4,2);const S=new l.c6;S.emplaceBack(0),S.emplaceBack(1),S.emplaceBack(3),S.emplaceBack(2),S.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(S);const C=new l.aM;C.emplaceBack(1,0,2),C.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(C);const k=this.context.gl;this.stencilClearMode=new zt({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO),this.tileExtentMesh=new Co(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const t=this.context,o=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const h=l.L();l.bX(h,0,this.width,this.height,0,0,1),l.N(h,h,[o.drawingBufferWidth,o.drawingBufferHeight,0]);const f={mainMatrix:h,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:h};this.useProgram("clippingMask",null,!0).draw(t,o.TRIANGLES,Ot.disabled,this.stencilClearMode,er.disabled,Lt.disabled,null,null,f,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,o,h){if(this.currentStencilSource===t.source||!t.isTileClipped()||!o||!o.length)return;this.currentStencilSource=t.source,this.nextStencilID+o.length>256&&this.clearStencil();const f=this.context;f.setColorMode(er.disabled),f.setDepthMode(Ot.disabled);const y={};for(const b of o)y[b.key]=this.nextStencilID++;this._renderTileMasks(y,o,h,!0),this._renderTileMasks(y,o,h,!1),this._tileClippingMaskIDs=y}_renderTileMasks(t,o,h,f){const y=this.context,b=y.gl,S=this.style.projection,C=this.transform,k=this.useProgram("clippingMask");for(const z of o){const O=t[z.key],L=this.style.map.terrain&&this.style.map.terrain.getTerrainData(z),j=S.getMeshFromTileID(this.context,z.canonical,f,!0,"stencil"),q=C.getProjectionData({overscaledTileID:z,applyGlobeMatrix:!h,applyTerrainMatrix:!0});k.draw(y,b.TRIANGLES,Ot.disabled,new zt({func:b.ALWAYS,mask:0},O,255,b.KEEP,b.KEEP,b.REPLACE),er.disabled,h?Lt.disabled:Lt.backCCW,null,L,q,"$clipping",j.vertexBuffer,j.indexBuffer,j.segments)}}_renderTilesDepthBuffer(){const t=this.context,o=t.gl,h=this.style.projection,f=this.transform,y=this.useProgram("depth"),b=this.getDepthModeFor3D(),S=je(f,{tileSize:f.tileSize});for(const C of S){const k=this.style.map.terrain&&this.style.map.terrain.getTerrainData(C),z=h.getMeshFromTileID(this.context,C.canonical,!0,!0,"raster"),O=f.getProjectionData({overscaledTileID:C,applyGlobeMatrix:!0,applyTerrainMatrix:!0});y.draw(t,o.TRIANGLES,b,zt.disabled,er.disabled,Lt.backCCW,null,k,O,"$clipping",z.vertexBuffer,z.indexBuffer,z.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,o=this.context.gl;return new zt({func:o.NOTEQUAL,mask:255},t,255,o.KEEP,o.KEEP,o.REPLACE)}stencilModeForClipping(t){const o=this.context.gl;return new zt({func:o.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,o.KEEP,o.KEEP,o.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(t){const o=this.context.gl,h=t.sort((b,S)=>S.overscaledZ-b.overscaledZ),f=h[h.length-1].overscaledZ,y=h[0].overscaledZ-f+1;if(y>1){this.currentStencilSource=void 0,this.nextStencilID+y>256&&this.clearStencil();const b={};for(let S=0;S<y;S++)b[S+f]=new zt({func:o.GEQUAL,mask:255},S+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=y,[b,h]}return[{[f]:zt.disabled},h]}stencilConfigForOverlapTwoPass(t){const o=this.context.gl,h=t.sort((b,S)=>S.overscaledZ-b.overscaledZ),f=h[h.length-1].overscaledZ,y=h[0].overscaledZ-f+1;if(this.clearStencil(),y>1){const b={},S={};for(let C=0;C<y;C++)b[C+f]=new zt({func:o.GREATER,mask:255},y+1+C,255,o.KEEP,o.KEEP,o.REPLACE),S[C+f]=new zt({func:o.GREATER,mask:255},1+C,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID=2*y+1,[b,S,h]}return this.nextStencilID=3,[{[f]:new zt({func:o.GREATER,mask:255},2,255,o.KEEP,o.KEEP,o.REPLACE)},{[f]:new zt({func:o.GREATER,mask:255},1,255,o.KEEP,o.KEEP,o.REPLACE)},h]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new er([t.CONSTANT_COLOR,t.ONE],new l.be(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?er.unblended:er.alphaBlended}getDepthModeForSublayer(t,o,h){if(!this.opaquePassEnabledForLayer())return Ot.disabled;const f=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new Ot(h||this.context.gl.LEQUAL,o,[f,f])}getDepthModeFor3D(){return new Ot(this.context.gl.LEQUAL,Ot.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,o){var h,f;this.style=t,this.options=o,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(F.now()),this.imageManager.beginFrame();const y=this.style._order,b=this.style.sourceCaches,S={},C={},k={},z={isRenderingToTexture:!1,isRenderingGlobe:((h=t.projection)===null||h===void 0?void 0:h.transitionState)>0};for(const L in b){const j=b[L];j.used&&j.prepare(this.context),S[L]=j.getVisibleCoordinates(!1),C[L]=S[L].slice().reverse(),k[L]=j.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let L=0;L<y.length;L++)if(this.style._layers[y[L]].is3D()){this.opaquePassCutoff=L;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const L of y){const j=this.style._layers[L];if(!j.hasOffscreenPass()||j.isHidden(this.transform.zoom))continue;const q=C[j.source];(j.type==="custom"||q.length)&&this.renderLayer(this,b[j.source],j,q,z)}if((f=this.style.projection)===null||f===void 0||f.updateGPUdependent({context:this.context,useProgram:L=>this.useProgram(L)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:o.showOverdrawInspector?l.be.black:l.be.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(L,j){const q=L.context,se=q.gl,oe=((be,fe,Pe)=>{const Oe=Math.cos(fe.rollInRadians),Ae=Math.sin(fe.rollInRadians),Re=J(fe),Fe=fe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:be.properties.get("sky-color"),u_horizon_color:be.properties.get("horizon-color"),u_horizon:[(fe.width/2-Re*Ae)*Pe,(fe.height/2+Re*Oe)*Pe],u_horizon_normal:[-Ae,Oe],u_sky_horizon_blend:be.properties.get("sky-horizon-blend")*fe.height/2*Pe,u_sky_blend:Fe}})(j,L.style.map.transform,L.pixelRatio),ae=new Ot(se.LEQUAL,Ot.ReadWrite,[0,1]),ce=zt.disabled,pe=L.colorModeForRenderPass(),ue=L.useProgram("sky"),ve=rs(q,j);ue.draw(q,se.TRIANGLES,ae,ce,pe,Lt.disabled,oe,null,void 0,"sky",ve.vertexBuffer,ve.indexBuffer,ve.segments)}(this,this.style.sky),this._showOverdrawInspector=o.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=y.length-1;this.currentLayer>=0;this.currentLayer--){const L=this.style._layers[y[this.currentLayer]],j=b[L.source],q=S[L.source];this._renderTileClippingMasks(L,q,!1),this.renderLayer(this,j,L,q,z)}this.renderPass="translucent";let O=!1;for(this.currentLayer=0;this.currentLayer<y.length;this.currentLayer++){const L=this.style._layers[y[this.currentLayer]],j=b[L.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(L,z))continue;this.opaquePassEnabledForLayer()||O||(O=!0,z.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const q=(L.type==="symbol"?k:C)[L.source];this._renderTileClippingMasks(L,S[L.source],!!this.renderToTexture),this.renderLayer(this,j,L,q,z)}if(z.isRenderingGlobe&&function(L,j,q){const se=L.context,oe=se.gl,ae=L.useProgram("atmosphere"),ce=new Ot(oe.LEQUAL,Ot.ReadOnly,[0,1]),pe=L.transform,ue=function(Fe,st){const it=Fe.properties.get("position"),Ke=[-it.x,-it.y,-it.z],vt=l.af(new Float64Array(16));return Fe.properties.get("anchor")==="map"&&(l.b5(vt,vt,st.rollInRadians),l.b6(vt,vt,-st.pitchInRadians),l.b5(vt,vt,st.bearingInRadians),l.b6(vt,vt,st.center.lat*Math.PI/180),l.by(vt,vt,-st.center.lng*Math.PI/180)),l.c4(Ke,Ke,vt),Ke}(q,L.transform),ve=pe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),be=j.properties.get("atmosphere-blend")*ve.projectionTransition;if(be===0)return;const fe=pa(pe.worldSize,pe.center.lat),Pe=pe.inverseProjectionMatrix,Oe=new Float64Array(4);Oe[3]=1,l.av(Oe,Oe,pe.modelViewProjectionMatrix),Oe[0]/=Oe[3],Oe[1]/=Oe[3],Oe[2]/=Oe[3],Oe[3]=1,l.av(Oe,Oe,Pe),Oe[0]/=Oe[3],Oe[1]/=Oe[3],Oe[2]/=Oe[3],Oe[3]=1;const Ae=((Fe,st,it,Ke,vt)=>({u_sun_pos:Fe,u_atmosphere_blend:st,u_globe_position:it,u_globe_radius:Ke,u_inv_proj_matrix:vt}))(ue,be,[Oe[0],Oe[1],Oe[2]],fe,Pe),Re=rs(se,j);ae.draw(se,oe.TRIANGLES,ce,zt.disabled,er.alphaBlended,Lt.disabled,Ae,null,null,"atmosphere",Re.vertexBuffer,Re.indexBuffer,Re.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const L=function(j,q){let se=null;const oe=Object.values(j._layers).flatMap(ue=>ue.source&&!ue.isHidden(q)?[j.sourceCaches[ue.source]]:[]),ae=oe.filter(ue=>ue.getSource().type==="vector"),ce=oe.filter(ue=>ue.getSource().type!=="vector"),pe=ue=>{(!se||se.getSource().maxzoom<ue.getSource().maxzoom)&&(se=ue)};return ae.forEach(ue=>pe(ue)),se||ce.forEach(ue=>pe(ue)),se}(this.style,this.transform.zoom);L&&function(j,q,se){for(let oe=0;oe<se.length;oe++)ym(j,q,se[oe])}(this,L,L.getVisibleCoordinates())}this.options.showPadding&&function(L){const j=L.transform.padding;Yl(L,L.transform.height-(j.top||0),3,mm),Yl(L,j.bottom||0,3,xu),bu(L,j.left||0,3,Md),bu(L,L.transform.width-(j.right||0),3,gm);const q=L.transform.centerPoint;(function(se,oe,ae,ce){wu(se,oe-1,ae-10,2,20,ce),wu(se,oe-10,ae-1,20,2,ce)})(L,q.x,L.transform.height-q.y,_m)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const o=this.terrainFacilitator.matrix,h=this.transform.modelViewProjectionMatrix;let f=this.terrainFacilitator.dirty;f||(f=t?!l.c7(o,h):!l.c8(o,h)),f||(f=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),f&&(l.c9(o,h),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(y,b){const S=y.context,C=S.gl,k=y.transform,z=er.unblended,O=new Ot(C.LEQUAL,Ot.ReadWrite,[0,1]),L=b.sourceCache.getRenderableTiles(),j=y.useProgram("terrainDepth");S.bindFramebuffer.set(b.getFramebuffer("depth").framebuffer),S.viewport.set([0,0,y.width/devicePixelRatio,y.height/devicePixelRatio]),S.clear({color:l.be.transparent,depth:1});for(const q of L){const se=b.getTerrainMesh(q.tileID),oe=b.getTerrainData(q.tileID),ae=k.getProjectionData({overscaledTileID:q.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),ce={u_ele_delta:b.getMeshFrameDelta(k.zoom)};j.draw(S,C.TRIANGLES,O,zt.disabled,z,Lt.backCCW,ce,oe,ae,"terrain",se.vertexBuffer,se.indexBuffer,se.segments)}S.bindFramebuffer.set(null),S.viewport.set([0,0,y.width,y.height])}(this,this.style.map.terrain),function(y,b){const S=y.context,C=S.gl,k=y.transform,z=er.unblended,O=new Ot(C.LEQUAL,Ot.ReadWrite,[0,1]),L=b.getCoordsTexture(),j=b.sourceCache.getRenderableTiles(),q=y.useProgram("terrainCoords");S.bindFramebuffer.set(b.getFramebuffer("coords").framebuffer),S.viewport.set([0,0,y.width/devicePixelRatio,y.height/devicePixelRatio]),S.clear({color:l.be.transparent,depth:1}),b.coordsIndex=[];for(const se of j){const oe=b.getTerrainMesh(se.tileID),ae=b.getTerrainData(se.tileID);S.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,L.texture);const ce={u_terrain_coords_id:(255-b.coordsIndex.length)/255,u_texture:0,u_ele_delta:b.getMeshFrameDelta(k.zoom)},pe=k.getProjectionData({overscaledTileID:se.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});q.draw(S,C.TRIANGLES,O,zt.disabled,z,Lt.backCCW,ce,ae,pe,"terrain",oe.vertexBuffer,oe.indexBuffer,oe.segments),b.coordsIndex.push(se.tileID.key)}S.bindFramebuffer.set(null),S.viewport.set([0,0,y.width,y.height])}(this,this.style.map.terrain))}renderLayer(t,o,h,f,y){h.isHidden(this.transform.zoom)||(h.type==="background"||h.type==="custom"||(f||[]).length)&&(this.id=h.id,l.ca(h)?function(b,S,C,k,z,O){if(b.renderPass!=="translucent")return;const{isRenderingToTexture:L}=O,j=zt.disabled,q=b.colorModeForRenderPass();(C._unevaluatedLayout.hasValue("text-variable-anchor")||C._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(se,oe,ae,ce,pe,ue,ve,be,fe){const Pe=oe.transform,Oe=oe.style.map.terrain,Ae=pe==="map",Re=ue==="map";for(const Fe of se){const st=ce.getTile(Fe),it=st.getBucket(ae);if(!it||!it.text||!it.text.segments.get().length)continue;const Ke=l.am(it.textSizeData,Pe.zoom),vt=l.aB(st,1,oe.transform.zoom),Ft=Et(Ae,oe.transform,vt),cr=ae.layout.get("icon-text-fit")!=="none"&&it.hasIconData();if(Ke){const kr=Math.pow(2,Pe.zoom-st.tileID.overscaledZ),pr=Oe?(Ir,_r)=>Oe.getElevation(Fe,Ir,_r):null;Uy(it,Ae,Re,fe,Pe,Ft,kr,Ke,cr,l.aC(Pe,st,ve,be),Fe.toUnwrapped(),pr)}}}(k,b,C,S,C.layout.get("text-rotation-alignment"),C.layout.get("text-pitch-alignment"),C.paint.get("text-translate"),C.paint.get("text-translate-anchor"),z),C.paint.get("icon-opacity").constantOr(1)!==0&&pm(b,S,C,k,!1,C.paint.get("icon-translate"),C.paint.get("icon-translate-anchor"),C.layout.get("icon-rotation-alignment"),C.layout.get("icon-pitch-alignment"),C.layout.get("icon-keep-upright"),j,q,L),C.paint.get("text-opacity").constantOr(1)!==0&&pm(b,S,C,k,!0,C.paint.get("text-translate"),C.paint.get("text-translate-anchor"),C.layout.get("text-rotation-alignment"),C.layout.get("text-pitch-alignment"),C.layout.get("text-keep-upright"),j,q,L),S.map.showCollisionBoxes&&(hm(b,S,C,k,!0),hm(b,S,C,k,!1))}(t,o,h,f,this.style.placement.variableOffsets,y):l.cb(h)?function(b,S,C,k,z){if(b.renderPass!=="translucent")return;const{isRenderingToTexture:O}=z,L=C.paint.get("circle-opacity"),j=C.paint.get("circle-stroke-width"),q=C.paint.get("circle-stroke-opacity"),se=!C.layout.get("circle-sort-key").isConstant();if(L.constantOr(1)===0&&(j.constantOr(1)===0||q.constantOr(1)===0))return;const oe=b.context,ae=oe.gl,ce=b.transform,pe=b.getDepthModeForSublayer(0,Ot.ReadOnly),ue=zt.disabled,ve=b.colorModeForRenderPass(),be=[],fe=ce.getCircleRadiusCorrection();for(let Pe=0;Pe<k.length;Pe++){const Oe=k[Pe],Ae=S.getTile(Oe),Re=Ae.getBucket(C);if(!Re)continue;const Fe=C.paint.get("circle-translate"),st=C.paint.get("circle-translate-anchor"),it=l.aC(ce,Ae,Fe,st),Ke=Re.programConfigurations.get(C.id),vt=b.useProgram("circle",Ke),Ft=Re.layoutVertexBuffer,cr=Re.indexBuffer,kr=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Oe),pr={programConfiguration:Ke,program:vt,layoutVertexBuffer:Ft,indexBuffer:cr,uniformValues:hd(b,Ae,C,it,fe),terrainData:kr,projectionData:ce.getProjectionData({overscaledTileID:Oe,applyGlobeMatrix:!O,applyTerrainMatrix:!0})};if(se){const Ir=Re.segments.get();for(const _r of Ir)be.push({segments:new l.aL([_r]),sortKey:_r.sortKey,state:pr})}else be.push({segments:Re.segments,sortKey:0,state:pr})}se&&be.sort((Pe,Oe)=>Pe.sortKey-Oe.sortKey);for(const Pe of be){const{programConfiguration:Oe,program:Ae,layoutVertexBuffer:Re,indexBuffer:Fe,uniformValues:st,terrainData:it,projectionData:Ke}=Pe.state;Ae.draw(oe,ae.TRIANGLES,pe,ue,ve,Lt.backCCW,st,it,Ke,C.id,Re,Fe,Pe.segments,C.paint,b.transform.zoom,Oe)}}(t,o,h,f,y):l.cc(h)?function(b,S,C,k,z){if(C.paint.get("heatmap-opacity")===0)return;const O=b.context,{isRenderingToTexture:L,isRenderingGlobe:j}=z;if(b.style.map.terrain){for(const q of k){const se=S.getTile(q);S.hasRenderableParent(q)||(b.renderPass==="offscreen"?_u(b,se,C,q,j):b.renderPass==="translucent"&&yu(b,C,q,L,j))}O.viewport.set([0,0,b.width,b.height])}else b.renderPass==="offscreen"?function(q,se,oe,ae){const ce=q.context,pe=ce.gl,ue=q.transform,ve=zt.disabled,be=new er([pe.ONE,pe.ONE],l.be.transparent,[!0,!0,!0,!0]);(function(fe,Pe,Oe){const Ae=fe.gl;fe.activeTexture.set(Ae.TEXTURE1),fe.viewport.set([0,0,Pe.width/4,Pe.height/4]);let Re=Oe.heatmapFbos.get(l.c1);Re?(Ae.bindTexture(Ae.TEXTURE_2D,Re.colorAttachment.get()),fe.bindFramebuffer.set(Re.framebuffer)):(Re=ql(fe,Pe.width/4,Pe.height/4),Oe.heatmapFbos.set(l.c1,Re))})(ce,q,oe),ce.clear({color:l.be.transparent});for(let fe=0;fe<ae.length;fe++){const Pe=ae[fe];if(se.hasRenderableParent(Pe))continue;const Oe=se.getTile(Pe),Ae=Oe.getBucket(oe);if(!Ae)continue;const Re=Ae.programConfigurations.get(oe.id),Fe=q.useProgram("heatmap",Re),st=ue.getProjectionData({overscaledTileID:Pe,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),it=ue.getCircleRadiusCorrection();Fe.draw(ce,pe.TRIANGLES,Ot.disabled,ve,be,Lt.backCCW,Zl(Oe,ue.zoom,oe.paint.get("heatmap-intensity"),it),null,st,oe.id,Ae.layoutVertexBuffer,Ae.indexBuffer,Ae.segments,oe.paint,ue.zoom,Re)}ce.viewport.set([0,0,q.width,q.height])}(b,S,C,k):b.renderPass==="translucent"&&function(q,se){const oe=q.context,ae=oe.gl;oe.setColorMode(q.colorModeForRenderPass());const ce=se.heatmapFbos.get(l.c1);ce&&(oe.activeTexture.set(ae.TEXTURE0),ae.bindTexture(ae.TEXTURE_2D,ce.colorAttachment.get()),oe.activeTexture.set(ae.TEXTURE1),vu(oe,se).bind(ae.LINEAR,ae.CLAMP_TO_EDGE),q.useProgram("heatmapTexture").draw(oe,ae.TRIANGLES,Ot.disabled,zt.disabled,q.colorModeForRenderPass(),Lt.disabled,Kp(q,se,0,1),null,null,se.id,q.viewportBuffer,q.quadTriangleIndexBuffer,q.viewportSegments,se.paint,q.transform.zoom))}(b,C)}(t,o,h,f,y):l.cd(h)?function(b,S,C,k,z){if(b.renderPass!=="translucent")return;const{isRenderingToTexture:O}=z,L=C.paint.get("line-opacity"),j=C.paint.get("line-width");if(L.constantOr(1)===0||j.constantOr(1)===0)return;const q=b.getDepthModeForSublayer(0,Ot.ReadOnly),se=b.colorModeForRenderPass(),oe=C.paint.get("line-dasharray"),ae=C.paint.get("line-pattern"),ce=ae.constantOr(1),pe=C.paint.get("line-gradient"),ue=C.getCrossfadeParameters(),ve=ce?"linePattern":oe?"lineSDF":pe?"lineGradient":"line",be=b.context,fe=be.gl,Pe=b.transform;let Oe=!0;for(const Ae of k){const Re=S.getTile(Ae);if(ce&&!Re.patternsLoaded())continue;const Fe=Re.getBucket(C);if(!Fe)continue;const st=Fe.programConfigurations.get(C.id),it=b.context.program.get(),Ke=b.useProgram(ve,st),vt=Oe||Ke.program!==it,Ft=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Ae),cr=ae.constantOr(null);if(cr&&Re.imageAtlas){const mr=Re.imageAtlas,yr=mr.patternPositions[cr.to.toString()],Sn=mr.patternPositions[cr.from.toString()];yr&&Sn&&st.setConstantPatternPositions(yr,Sn)}const kr=Pe.getProjectionData({overscaledTileID:Ae,applyGlobeMatrix:!O,applyTerrainMatrix:!0}),pr=Pe.getPixelScale(),Ir=ce?Qp(b,Re,C,pr,ue):oe?Jp(b,Re,C,pr,oe,ue):pe?dd(b,Re,C,pr,Fe.lineClipsArray.length):lu(b,Re,C,pr);if(ce)be.activeTexture.set(fe.TEXTURE0),Re.imageAtlasTexture.bind(fe.LINEAR,fe.CLAMP_TO_EDGE),st.updatePaintBuffers(ue);else if(oe&&(vt||b.lineAtlas.dirty))be.activeTexture.set(fe.TEXTURE0),b.lineAtlas.bind(be);else if(pe){const mr=Fe.gradients[C.id];let yr=mr.texture;if(C.gradientVersion!==mr.version){let Sn=256;if(C.stepInterpolant){const rr=S.getSource().maxzoom,pn=Ae.canonical.z===rr?Math.ceil(1<<b.transform.maxZoom-Ae.canonical.z):1;Sn=l.ag(l.c2(Fe.maxLineLength/l.$*1024*pn),256,be.maxTextureSize)}mr.gradient=l.c3({expression:C.gradientExpression(),evaluationKey:"lineProgress",resolution:Sn,image:mr.gradient||void 0,clips:Fe.lineClipsArray}),mr.texture?mr.texture.update(mr.gradient):mr.texture=new l.T(be,mr.gradient,fe.RGBA),mr.version=C.gradientVersion,yr=mr.texture}be.activeTexture.set(fe.TEXTURE0),yr.bind(C.stepInterpolant?fe.NEAREST:fe.LINEAR,fe.CLAMP_TO_EDGE)}const _r=b.stencilModeForClipping(Ae);Ke.draw(be,fe.TRIANGLES,q,_r,se,Lt.disabled,Ir,Ft,kr,C.id,Fe.layoutVertexBuffer,Fe.indexBuffer,Fe.segments,C.paint,b.transform.zoom,st,Fe.layoutVertexBuffer2),Oe=!1}}(t,o,h,f,y):l.ce(h)?function(b,S,C,k,z){const O=C.paint.get("fill-color"),L=C.paint.get("fill-opacity");if(L.constantOr(1)===0)return;const{isRenderingToTexture:j}=z,q=b.colorModeForRenderPass(),se=C.paint.get("fill-pattern"),oe=b.opaquePassEnabledForLayer()&&!se.constantOr(1)&&O.constantOr(l.be.transparent).a===1&&L.constantOr(0)===1?"opaque":"translucent";if(b.renderPass===oe){const ae=b.getDepthModeForSublayer(1,b.renderPass==="opaque"?Ot.ReadWrite:Ot.ReadOnly);Xl(b,S,C,k,ae,q,!1,j)}if(b.renderPass==="translucent"&&C.paint.get("fill-antialias")){const ae=b.getDepthModeForSublayer(C.getPaintProperty("fill-outline-color")?2:0,Ot.ReadOnly);Xl(b,S,C,k,ae,q,!0,j)}}(t,o,h,f,y):l.cf(h)?function(b,S,C,k,z){const O=C.paint.get("fill-extrusion-opacity");if(O===0)return;const{isRenderingToTexture:L}=z;if(b.renderPass==="translucent"){const j=new Ot(b.context.gl.LEQUAL,Ot.ReadWrite,b.depthRangeFor3D);if(O!==1||C.paint.get("fill-extrusion-pattern").constantOr(1))Pa(b,S,C,k,j,zt.disabled,er.disabled,L),Pa(b,S,C,k,j,b.stencilModeFor3D(),b.colorModeForRenderPass(),L);else{const q=b.colorModeForRenderPass();Pa(b,S,C,k,j,zt.disabled,q,L)}}}(t,o,h,f,y):l.cg(h)?function(b,S,C,k,z){if(b.renderPass!=="offscreen"&&b.renderPass!=="translucent")return;const{isRenderingToTexture:O}=z,L=b.context,j=b.style.projection.useSubdivision,q=b.getDepthModeForSublayer(0,Ot.ReadOnly),se=b.colorModeForRenderPass();if(b.renderPass==="offscreen")(function(oe,ae,ce,pe,ue,ve,be){const fe=oe.context,Pe=fe.gl;for(const Oe of ce){const Ae=ae.getTile(Oe),Re=Ae.dem;if(!Re||!Re.data||!Ae.needsHillshadePrepare)continue;const Fe=Re.dim,st=Re.stride,it=Re.getPixels();if(fe.activeTexture.set(Pe.TEXTURE1),fe.pixelStoreUnpackPremultiplyAlpha.set(!1),Ae.demTexture=Ae.demTexture||oe.getTileTexture(st),Ae.demTexture){const vt=Ae.demTexture;vt.update(it,{premultiply:!1}),vt.bind(Pe.NEAREST,Pe.CLAMP_TO_EDGE)}else Ae.demTexture=new l.T(fe,it,Pe.RGBA,{premultiply:!1}),Ae.demTexture.bind(Pe.NEAREST,Pe.CLAMP_TO_EDGE);fe.activeTexture.set(Pe.TEXTURE0);let Ke=Ae.fbo;if(!Ke){const vt=new l.T(fe,{width:Fe,height:Fe,data:null},Pe.RGBA);vt.bind(Pe.LINEAR,Pe.CLAMP_TO_EDGE),Ke=Ae.fbo=fe.createFramebuffer(Fe,Fe,!0,!1),Ke.colorAttachment.set(vt.texture)}fe.bindFramebuffer.set(Ke.framebuffer),fe.viewport.set([0,0,Fe,Fe]),oe.useProgram("hillshadePrepare").draw(fe,Pe.TRIANGLES,ue,ve,be,Lt.disabled,zy(Ae.tileID,Re),null,null,pe.id,oe.rasterBoundsBuffer,oe.quadTriangleIndexBuffer,oe.rasterBoundsSegments),Ae.needsHillshadePrepare=!1}})(b,S,k,C,q,zt.disabled,se),L.viewport.set([0,0,b.width,b.height]);else if(b.renderPass==="translucent")if(j){const[oe,ae,ce]=b.stencilConfigForOverlapTwoPass(k);Ea(b,S,C,ce,oe,q,se,!1,O),Ea(b,S,C,ce,ae,q,se,!0,O)}else{const[oe,ae]=b.getStencilConfigForOverlapAndUpdateStencilID(k);Ea(b,S,C,ae,oe,q,se,!1,O)}}(t,o,h,f,y):l.ch(h)?function(b,S,C,k,z){if(b.renderPass!=="translucent"||!k.length)return;const{isRenderingToTexture:O}=z,L=b.style.projection.useSubdivision,j=b.getDepthModeForSublayer(0,Ot.ReadOnly),q=b.colorModeForRenderPass();if(L){const[se,oe,ae]=b.stencilConfigForOverlapTwoPass(k);Kl(b,S,C,ae,se,j,q,!1,O),Kl(b,S,C,ae,oe,j,q,!0,O)}else{const[se,oe]=b.getStencilConfigForOverlapAndUpdateStencilID(k);Kl(b,S,C,oe,se,j,q,!1,O)}}(t,o,h,f,y):l.ci(h)?function(b,S,C,k,z){if(b.renderPass!=="translucent"||C.paint.get("raster-opacity")===0||!k.length)return;const{isRenderingToTexture:O}=z,L=S.getSource(),j=b.style.projection.useSubdivision;if(L instanceof Zr)ts(b,S,C,k,null,!1,!1,L.tileCoords,L.flippedWindingOrder,O);else if(j){const[q,se,oe]=b.stencilConfigForOverlapTwoPass(k);ts(b,S,C,oe,q,!1,!0,Ed,!1,O),ts(b,S,C,oe,se,!0,!0,Ed,!1,O)}else{const[q,se]=b.getStencilConfigForOverlapAndUpdateStencilID(k);ts(b,S,C,se,q,!1,!0,Ed,!1,O)}}(t,o,h,f,y):l.cj(h)?function(b,S,C,k,z){const O=C.paint.get("background-color"),L=C.paint.get("background-opacity");if(L===0)return;const{isRenderingToTexture:j}=z,q=b.context,se=q.gl,oe=b.style.projection,ae=b.transform,ce=ae.tileSize,pe=C.paint.get("background-pattern");if(b.isPatternMissing(pe))return;const ue=!pe&&O.a===1&&L===1&&b.opaquePassEnabledForLayer()?"opaque":"translucent";if(b.renderPass!==ue)return;const ve=zt.disabled,be=b.getDepthModeForSublayer(0,ue==="opaque"?Ot.ReadWrite:Ot.ReadOnly),fe=b.colorModeForRenderPass(),Pe=b.useProgram(pe?"backgroundPattern":"background"),Oe=k||je(ae,{tileSize:ce,terrain:b.style.map.terrain});pe&&(q.activeTexture.set(se.TEXTURE0),b.imageManager.bind(b.context));const Ae=C.getCrossfadeParameters();for(const Re of Oe){const Fe=ae.getProjectionData({overscaledTileID:Re,applyGlobeMatrix:!j,applyTerrainMatrix:!0}),st=pe?Ly(L,b,pe,{tileID:Re,tileSize:ce},Ae):cu(L,O),it=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Re),Ke=oe.getMeshFromTileID(q,Re.canonical,!1,!0,"raster");Pe.draw(q,se.TRIANGLES,be,ve,fe,Lt.backCCW,st,it,Fe,C.id,Ke.vertexBuffer,Ke.indexBuffer,Ke.segments)}}(t,0,h,f,y):l.ck(h)&&function(b,S,C,k){const{isRenderingGlobe:z}=k,O=b.context,L=C.implementation,j=b.style.projection,q=b.transform,se=q.getProjectionDataForCustomLayer(z),oe={farZ:q.farZ,nearZ:q.nearZ,fov:q.fov*Math.PI/180,modelViewProjectionMatrix:q.modelViewProjectionMatrix,projectionMatrix:q.projectionMatrix,shaderData:{variantName:j.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${j.shaderPreludeCode.vertexSource}`,define:j.shaderDefine},defaultProjectionData:se},ae=L.renderingMode?L.renderingMode:"2d";if(b.renderPass==="offscreen"){const ce=L.prerender;ce&&(b.setCustomLayerDefaults(),O.setColorMode(b.colorModeForRenderPass()),ce.call(L,O.gl,oe),O.setDirty(),b.setBaseState())}else if(b.renderPass==="translucent"){b.setCustomLayerDefaults(),O.setColorMode(b.colorModeForRenderPass()),O.setStencilMode(zt.disabled);const ce=ae==="3d"?b.getDepthModeFor3D():b.getDepthModeForSublayer(0,Ot.ReadOnly);O.setDepthMode(ce),L.render(O.gl,oe),O.setDirty(),b.setBaseState(),O.bindFramebuffer.set(null)}}(t,0,h,y))}saveTileTexture(t){const o=this._tileTextures[t.size[0]];o?o.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const o=this._tileTextures[t];return o&&o.length>0?o.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const o=this.imageManager.getPattern(t.from.toString()),h=this.imageManager.getPattern(t.to.toString());return!o||!h}useProgram(t,o,h=!1,f=[]){this.cache=this.cache||{};const y=!!this.style.map.terrain,b=this.style.projection,S=h?oo.projectionMercator:b.shaderPreludeCode,C=h?Ds:b.shaderDefine,k=t+(o?o.cacheKey:"")+`/${h?nd:b.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(y?"/terrain":"")+(f?`/${f.join("/")}`:"");return this.cache[k]||(this.cache[k]=new ou(this.context,oo[t],o,rm[t],this._showOverdrawInspector,y,S,C,f)),this.cache[k]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new l.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:o}=this.context.gl;return this.width!==t||this.height!==o}}function Su(_,t){let o,h=!1,f=null,y=null;const b=()=>{f=null,h&&(_.apply(y,o),f=setTimeout(b,t),h=!1)};return(...S)=>(h=!0,y=this,o=S,f||b(),f)}class Ql{constructor(t){this._getCurrentHash=()=>{const o=window.location.hash.replace("#","");if(this._hashName){let h;return o.split("&").map(f=>f.split("=")).forEach(f=>{f[0]===this._hashName&&(h=f)}),(h&&h[1]||"").split("/")}return o.split("/")},this._onHashChange=()=>{const o=this._getCurrentHash();if(!this._isValidHash(o))return!1;const h=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(o[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+o[2],+o[1]],zoom:+o[0],bearing:h,pitch:+(o[4]||0)}),!0},this._updateHashUnthrottled=()=>{const o=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,o)},this._removeHash=()=>{const o=this._getCurrentHash();if(o.length===0)return;const h=o.join("/");let f=h;f.split("&").length>0&&(f=f.split("&")[0]),this._hashName&&(f=`${this._hashName}=${h}`);let y=window.location.hash.replace(f,"");y.startsWith("#&")?y=y.slice(0,1)+y.slice(2):y==="#"&&(y="");let b=window.location.href.replace(/(#.+)?$/,y);b=b.replace("&&","&"),window.history.replaceState(window.history.state,null,b)},this._updateHash=Su(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(t){const o=this._map.getCenter(),h=Math.round(100*this._map.getZoom())/100,f=Math.ceil((h*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,f),b=Math.round(o.lng*y)/y,S=Math.round(o.lat*y)/y,C=this._map.getBearing(),k=this._map.getPitch();let z="";if(z+=t?`/${b}/${S}/${h}`:`${h}/${S}/${b}`,(C||k)&&(z+="/"+Math.round(10*C)/10),k&&(z+=`/${Math.round(k)}`),this._hashName){const O=this._hashName;let L=!1;const j=window.location.hash.slice(1).split("&").map(q=>{const se=q.split("=")[0];return se===O?(L=!0,`${se}=${z}`):q}).filter(q=>q);return L||j.push(`${O}=${z}`),`#${j.join("&")}`}return`#${z}`}_isValidHash(t){if(t.length<3||t.some(isNaN))return!1;try{new l.S(+t[2],+t[1])}catch{return!1}const o=+t[0],h=+(t[3]||0),f=+(t[4]||0);return o>=this._map.getMinZoom()&&o<=this._map.getMaxZoom()&&h>=-180&&h<=180&&f>=this._map.getMinPitch()&&f<=this._map.getMaxPitch()}}const Ma={linearity:.3,easing:l.cl(0,0,.3,1)},ka=l.e({deceleration:2500,maxSpeed:1400},Ma),kd=l.e({deceleration:20,maxSpeed:1400},Ma),Jl=l.e({deceleration:1e3,maxSpeed:360},Ma),Id=l.e({deceleration:1e3,maxSpeed:90},Ma),vm=l.e({deceleration:1e3,maxSpeed:360},Ma);class xm{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:F.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,o=F.now();for(;t.length>0&&o-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const o={zoom:0,bearing:0,pitch:0,roll:0,pan:new l.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:y}of this._inertiaBuffer)o.zoom+=y.zoomDelta||0,o.bearing+=y.bearingDelta||0,o.pitch+=y.pitchDelta||0,o.roll+=y.rollDelta||0,y.panDelta&&o.pan._add(y.panDelta),y.around&&(o.around=y.around),y.pinchAround&&(o.pinchAround=y.pinchAround);const h=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,f={};if(o.pan.mag()){const y=Aa(o.pan.mag(),h,l.e({},ka,t||{})),b=o.pan.mult(y.amount/o.pan.mag()),S=this._map.cameraHelper.handlePanInertia(b,this._map.transform);f.center=S.easingCenter,f.offset=S.easingOffset,Ia(f,y)}if(o.zoom){const y=Aa(o.zoom,h,kd);f.zoom=this._map.transform.zoom+y.amount,Ia(f,y)}if(o.bearing){const y=Aa(o.bearing,h,Jl);f.bearing=this._map.transform.bearing+l.ag(y.amount,-179,179),Ia(f,y)}if(o.pitch){const y=Aa(o.pitch,h,Id);f.pitch=this._map.transform.pitch+y.amount,Ia(f,y)}if(o.roll){const y=Aa(o.roll,h,vm);f.roll=this._map.transform.roll+l.ag(y.amount,-179,179),Ia(f,y)}if(f.zoom||f.bearing){const y=o.pinchAround===void 0?o.around:o.pinchAround;f.around=y?this._map.unproject(y):this._map.getCenter()}return this.clear(),l.e(f,{noMoveStart:!0})}}function Ia(_,t){(!_.duration||_.duration<t.duration)&&(_.duration=t.duration,_.easing=t.easing)}function Aa(_,t,o){const{maxSpeed:h,linearity:f,deceleration:y}=o,b=l.ag(_*f/(t/1e3),-h,h),S=Math.abs(b)/(y*f);return{easing:o.easing,duration:1e3*S,amount:b*(S/2)}}class ti extends l.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,h,f={}){h=h instanceof MouseEvent?h:new MouseEvent(t,h);const y=A.mousePos(o.getCanvas(),h),b=o.unproject(y);super(t,l.e({point:y,lngLat:b,originalEvent:h},f)),this._defaultPrevented=!1,this.target=o}}class ji extends l.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,h){const f=t==="touchend"?h.changedTouches:h.touches,y=A.touchPos(o.getCanvasContainer(),f),b=y.map(C=>o.unproject(C)),S=y.reduce((C,k,z,O)=>C.add(k.div(O.length)),new l.P(0,0));super(t,{points:y,point:S,lngLats:b,lngLat:o.unproject(S),originalEvent:h}),this._defaultPrevented=!1}}class Ad extends l.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,h){super(t,{originalEvent:h}),this._defaultPrevented=!1}}class bm{constructor(t,o){this._map=t,this._clickTolerance=o.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new Ad(t.type,this._map,t))}mousedown(t,o){return this._mousedownPos=o,this._firePreventable(new ti(t.type,this._map,t))}mouseup(t){this._map.fire(new ti(t.type,this._map,t))}click(t,o){this._mousedownPos&&this._mousedownPos.dist(o)>=this._clickTolerance||this._map.fire(new ti(t.type,this._map,t))}dblclick(t){return this._firePreventable(new ti(t.type,this._map,t))}mouseover(t){this._map.fire(new ti(t.type,this._map,t))}mouseout(t){this._map.fire(new ti(t.type,this._map,t))}touchstart(t){return this._firePreventable(new ji(t.type,this._map,t))}touchmove(t){this._map.fire(new ji(t.type,this._map,t))}touchend(t){this._map.fire(new ji(t.type,this._map,t))}touchcancel(t){this._map.fire(new ji(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class wm{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new ti(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ti("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new ti(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class za{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.screenPointToLocation(l.P.convert(t),this._map.terrain)}}class zd{constructor(t,o){this._map=t,this._tr=new za(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=o.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,o){this.isEnabled()&&t.shiftKey&&t.button===0&&(A.disableDrag(),this._startPos=this._lastPos=o,this._active=!0)}mousemoveWindow(t,o){if(!this._active)return;const h=o;if(this._lastPos.equals(h)||!this._box&&h.dist(this._startPos)<this._clickTolerance)return;const f=this._startPos;this._lastPos=h,this._box||(this._box=A.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const y=Math.min(f.x,h.x),b=Math.max(f.x,h.x),S=Math.min(f.y,h.y),C=Math.max(f.y,h.y);A.setTransform(this._box,`translate(${y}px,${S}px)`),this._box.style.width=b-y+"px",this._box.style.height=C-S+"px"}mouseupWindow(t,o){if(!this._active||t.button!==0)return;const h=this._startPos,f=o;if(this.reset(),A.suppressClick(),h.x!==f.x||h.y!==f.y)return this._map.fire(new l.l("boxzoomend",{originalEvent:t})),{cameraAnimation:y=>y.fitScreenCoordinates(h,f,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(A.remove(this._box),this._box=null),A.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,o){return this._map.fire(new l.l(t,{originalEvent:o}))}}function Tu(_,t){if(_.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${_.length}, points ${t.length}`);const o={};for(let h=0;h<_.length;h++)o[_[h].identifier]=t[h];return o}class Sm{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,o,h){(this.centroid||h.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),h.length===this.numTouches&&(this.centroid=function(f){const y=new l.P(0,0);for(const b of f)y._add(b);return y.div(f.length)}(o),this.touches=Tu(h,o)))}touchmove(t,o,h){if(this.aborted||!this.centroid)return;const f=Tu(h,o);for(const y in this.touches){const b=f[y];(!b||b.dist(this.touches[y])>30)&&(this.aborted=!0)}}touchend(t,o,h){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),h.length===0){const f=!this.aborted&&this.centroid;if(this.reset(),f)return f}}}class Cu{constructor(t){this.singleTap=new Sm(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,o,h){this.singleTap.touchstart(t,o,h)}touchmove(t,o,h){this.singleTap.touchmove(t,o,h)}touchend(t,o,h){const f=this.singleTap.touchend(t,o,h);if(f){const y=t.timeStamp-this.lastTime<500,b=!this.lastTap||this.lastTap.dist(f)<30;if(y&&b||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=f,this.count===this.numTaps)return this.reset(),f}}}class Pu{constructor(t){this._tr=new za(t),this._zoomIn=new Cu({numTouches:1,numTaps:2}),this._zoomOut=new Cu({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,o,h){this._zoomIn.touchstart(t,o,h),this._zoomOut.touchstart(t,o,h)}touchmove(t,o,h){this._zoomIn.touchmove(t,o,h),this._zoomOut.touchmove(t,o,h)}touchend(t,o,h){const f=this._zoomIn.touchend(t,o,h),y=this._zoomOut.touchend(t,o,h),b=this._tr;return f?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:b.zoom+1,around:b.unproject(f)},{originalEvent:t})}):y?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:b.zoom-1,around:b.unproject(y)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ra{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const o=this._moveFunction(...t);if(o.bearingDelta||o.pitchDelta||o.rollDelta||o.around||o.panDelta)return this._active=!0,o}dragStart(t,o){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=Array.isArray(o)?o[0]:o,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,o){if(!this.isEnabled())return;const h=this._lastPoint;if(!h)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const f=Array.isArray(o)?o[0]:o;return!this._moved&&f.dist(h)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=f,this._move(h,f))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&A.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Ei=0,$i=2,Tm={[Ei]:1,[$i]:2};class Un{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const o=A.mouseButton(t);this._eventButton=o}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!function(o,h){const f=Tm[h];return o.buttons===void 0||(o.buttons&f)!==f}(t,this._eventButton)}isValidEndEvent(t){return A.mouseButton(t)===this._eventButton}}class Da{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}class Zy{constructor(t=new Un({checkCorrectEvent:()=>!0}),o=new Da){this.mouseMoveStateManager=t,this.oneFingerTouchMoveStateManager=o}_executeRelevantHandler(t,o,h){return t instanceof MouseEvent?o(t):typeof TouchEvent<"u"&&t instanceof TouchEvent?h(t):void 0}startMove(t){this._executeRelevantHandler(t,o=>this.mouseMoveStateManager.startMove(o),o=>this.oneFingerTouchMoveStateManager.startMove(o))}endMove(t){this._executeRelevantHandler(t,o=>this.mouseMoveStateManager.endMove(o),o=>this.oneFingerTouchMoveStateManager.endMove(o))}isValidStartEvent(t){return this._executeRelevantHandler(t,o=>this.mouseMoveStateManager.isValidStartEvent(o),o=>this.oneFingerTouchMoveStateManager.isValidStartEvent(o))}isValidMoveEvent(t){return this._executeRelevantHandler(t,o=>this.mouseMoveStateManager.isValidMoveEvent(o),o=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(o))}isValidEndEvent(t){return this._executeRelevantHandler(t,o=>this.mouseMoveStateManager.isValidEndEvent(o),o=>this.oneFingerTouchMoveStateManager.isValidEndEvent(o))}}const Eu=_=>{_.mousedown=_.dragStart,_.mousemoveWindow=_.dragMove,_.mouseup=_.dragEnd,_.contextmenu=t=>{t.preventDefault()}};class Gy{constructor(t,o){this._clickTolerance=t.clickTolerance||1,this._map=o,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new l.P(0,0)}_shouldBePrevented(t){return t<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(t,o,h){return this._calculateTransform(t,o,h)}touchmove(t,o,h){if(this._active){if(!this._shouldBePrevented(h.length))return t.preventDefault(),this._calculateTransform(t,o,h);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",t)}}touchend(t,o,h){this._calculateTransform(t,o,h),this._active&&this._shouldBePrevented(h.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,o,h){h.length>0&&(this._active=!0);const f=Tu(h,o),y=new l.P(0,0),b=new l.P(0,0);let S=0;for(const k in f){const z=f[k],O=this._touches[k];O&&(y._add(z),b._add(z.sub(O)),S++,f[k]=z)}if(this._touches=f,this._shouldBePrevented(S)||!b.mag())return;const C=b.div(S);return this._sum._add(C),this._sum.mag()<this._clickTolerance?void 0:{around:y.div(S),panDelta:C}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Rd{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,o,h){this._firstTwoTouches||h.length<2||(this._firstTwoTouches=[h[0].identifier,h[1].identifier],this._start([o[0],o[1]]))}touchmove(t,o,h){if(!this._firstTwoTouches)return;t.preventDefault();const[f,y]=this._firstTwoTouches,b=ec(h,o,f),S=ec(h,o,y);if(!b||!S)return;const C=this._aroundCenter?null:b.add(S).div(2);return this._move([b,S],C,t)}touchend(t,o,h){if(!this._firstTwoTouches)return;const[f,y]=this._firstTwoTouches,b=ec(h,o,f),S=ec(h,o,y);b&&S||(this._active&&A.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function ec(_,t,o){for(let h=0;h<_.length;h++)if(_[h].identifier===o)return t[h]}function La(_,t){return Math.log(_/t)/Math.LN2}class lo extends Rd{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,o){const h=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(La(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:La(this._distance,h),pinchAround:o}}}function _t(_,t){return 180*_.angleWith(t)/Math.PI}class Dd extends Rd{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,o,h){const f=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:_t(this._vector,f),pinchAround:o}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const o=25/(Math.PI*this._minDiameter)*360,h=_t(t,this._startVector);return Math.abs(h)<o}}function tc(_){return Math.abs(_.y)>Math.abs(_.x)}class Ld extends Rd{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,o,h){super.touchstart(t,o,h),this._currentTouchCount=h.length}_start(t){this._lastPoints=t,tc(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,o,h){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const f=t[0].sub(this._lastPoints[0]),y=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(f,y,h.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(f.y+y.y)/2*-.5}):void 0}gestureBeginsVertically(t,o,h){if(this._valid!==void 0)return this._valid;const f=t.mag()>=2,y=o.mag()>=2;if(!f&&!y)return;if(!f||!y)return this._firstMove===void 0&&(this._firstMove=h),h-this._firstMove<100&&void 0;const b=t.y>0==o.y>0;return tc(t)&&tc(o)&&b}}const rc={panStep:100,bearingStep:15,pitchStep:10};class Oa{constructor(t){this._tr=new za(t);const o=rc;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let o=0,h=0,f=0,y=0,b=0;switch(t.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:t.shiftKey?h=-1:(t.preventDefault(),y=-1);break;case 39:t.shiftKey?h=1:(t.preventDefault(),y=1);break;case 38:t.shiftKey?f=1:(t.preventDefault(),b=-1);break;case 40:t.shiftKey?f=-1:(t.preventDefault(),b=1);break;default:return}return this._rotationDisabled&&(h=0,f=0),{cameraAnimation:S=>{const C=this._tr;S.easeTo({duration:300,easeId:"keyboardHandler",easing:Od,zoom:o?Math.round(C.zoom)+o*(t.shiftKey?2:1):C.zoom,bearing:C.bearing+h*this._bearingStep,pitch:C.pitch+f*this._pitchStep,offset:[-y*this._panStep,-b*this._panStep],center:C.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Od(_){return _*(2-_)}const Xt=4.000244140625,Fd=1/450;class Cm{constructor(t,o){this._onTimeout=h=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(h)},this._map=t,this._tr=new za(t),this._triggerRenderFrame=o,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Fd}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(t){return!!this._map.cooperativeGestures.isEnabled()&&!(t.ctrlKey||this._map.cooperativeGestures.isBypassed(t))}wheel(t){if(!this.isEnabled())return;if(this._shouldBePrevented(t))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",t);let o=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const h=F.now(),f=h-(this._lastWheelEventTime||0);this._lastWheelEventTime=h,o!==0&&o%Xt==0?this._type="wheel":o!==0&&Math.abs(o)<4?this._type="trackpad":f>400?(this._type=null,this._lastValue=o,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(f*o)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,o+=this._lastValue)),t.shiftKey&&o&&(o/=4),this._type&&(this._lastWheelEvent=t,this._delta-=o,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const o=A.mousePos(this._map.getCanvas(),t),h=this._tr;this._aroundPoint=this._aroundCenter?h.transform.locationToScreenPoint(l.S.convert(h.center)):o,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const S=t.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=S),typeof this._targetZoom=="number"&&(this._targetZoom+=S)}if(this._delta!==0){const S=this._type==="wheel"&&Math.abs(this._delta)>Xt?this._wheelZoomRate:this._defaultZoomRate;let C=2/(1+Math.exp(-Math.abs(this._delta*S)));this._delta<0&&C!==0&&(C=1/C);const k=typeof this._targetZoom!="number"?t.scale:l.ae(this._targetZoom);this._targetZoom=t.getConstrained(t.getCameraLngLat(),l.aj(k*C)).zoom,this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const o=typeof this._targetZoom!="number"?t.zoom:this._targetZoom,h=this._startZoom,f=this._easing;let y,b=!1;if(this._type==="wheel"&&h&&f){const S=F.now()-this._lastWheelEventTime,C=Math.min((S+5)/200,1),k=f(C);y=l.C.number(h,o,k),C<1?this._frameId||(this._frameId=!0):b=!0}else y=o,b=!0;return this._active=!0,b&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=y,{noInertia:!0,needsRenderFrame:!b,zoomDelta:y-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let o=l.cn;if(this._prevEase){const h=this._prevEase,f=(F.now()-h.start)/h.duration,y=h.easing(f+.01)-h.easing(f),b=.27/Math.sqrt(y*y+1e-4)*.01,S=Math.sqrt(.0729-b*b);o=l.cl(b,S,.25,1)}return this._prevEase={start:F.now(),duration:t,easing:o},o}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Mu{constructor(t,o){this._clickZoom=t,this._tapZoom=o}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Hy{constructor(t){this._tr=new za(t),this.reset()}reset(){this._active=!1}dblclick(t,o){return t.preventDefault(),{cameraAnimation:h=>{h.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(o)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Wy{constructor(){this._tap=new Cu({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,o,h){if(!this._swipePoint)if(this._tapTime){const f=o[0],y=t.timeStamp-this._tapTime<500,b=this._tapPoint.dist(f)<30;y&&b?h.length>0&&(this._swipePoint=f,this._swipeTouch=h[0].identifier):this.reset()}else this._tap.touchstart(t,o,h)}touchmove(t,o,h){if(this._tapTime){if(this._swipePoint){if(h[0].identifier!==this._swipeTouch)return;const f=o[0],y=f.y-this._swipePoint.y;return this._swipePoint=f,t.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(t,o,h)}touchend(t,o,h){if(this._tapTime)this._swipePoint&&h.length===0&&this.reset();else{const f=this._tap.touchend(t,o,h);f&&(this._tapTime=t.timeStamp,this._tapPoint=f)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Nd{constructor(t,o,h){this._el=t,this._mousePan=o,this._touchPan=h}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ku{constructor(t,o,h,f){this._pitchWithRotate=t.pitchWithRotate,this._rollEnabled=t.rollEnabled,this._mouseRotate=o,this._mousePitch=h,this._mouseRoll=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Bd{constructor(t,o,h,f){this._el=t,this._touchZoom=o,this._touchRotate=h,this._tapDragZoom=f,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Pm{constructor(t,o){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=t,this._options=o,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=A.create("div","maplibregl-cooperative-gesture-screen",t);let o=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(o=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const h=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),f=document.createElement("div");f.className="maplibregl-desktop-message",f.textContent=o,this._container.appendChild(f);const y=document.createElement("div");y.className="maplibregl-mobile-message",y.textContent=h,this._container.appendChild(y),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(A.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(t){return t[this._bypassKey]}notifyGestureBlocked(t,o){this._enabled&&(this._map.fire(new l.l("cooperativegestureprevented",{gestureType:t,originalEvent:o})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const nc=_=>_.zoom||_.drag||_.roll||_.pitch||_.rotate;class qy extends l.l{}function jd(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta||_.rollDelta}class ns{constructor(t,o){this.handleWindowEvent=f=>{this.handleEvent(f,`${f.type}Window`)},this.handleEvent=(f,y)=>{if(f.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const b=f.type==="renderFrame"?void 0:f,S={needsRenderFrame:!1},C={},k={};for(const{handlerName:L,handler:j,allowed:q}of this._handlers){if(!j.isEnabled())continue;let se;if(this._blockedByActive(k,q,L))j.reset();else if(j[y||f.type]){if(l.co(f,y||f.type)){const oe=A.mousePos(this._map.getCanvas(),f);se=j[y||f.type](f,oe)}else if(l.cp(f,y||f.type)){const oe=this._getMapTouches(f.touches),ae=A.touchPos(this._map.getCanvas(),oe);se=j[y||f.type](f,ae,oe)}else l.cq(y||f.type)||(se=j[y||f.type](f));this.mergeHandlerResult(S,C,se,L,b),se&&se.needsRenderFrame&&this._triggerRenderFrame()}(se||j.isActive())&&(k[L]=j)}const z={};for(const L in this._previousActiveHandlers)k[L]||(z[L]=b);this._previousActiveHandlers=k,(Object.keys(z).length||jd(S))&&(this._changes.push([S,C,z]),this._triggerRenderFrame()),(Object.keys(k).length||jd(S))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:O}=S;O&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],O(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new xm(t),this._bearingSnap=o.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(o);const h=this._el;this._listeners=[[h,"touchstart",{passive:!0}],[h,"touchmove",{passive:!1}],[h,"touchend",void 0],[h,"touchcancel",void 0],[h,"mousedown",void 0],[h,"mousemove",void 0],[h,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[h,"mouseover",void 0],[h,"mouseout",void 0],[h,"dblclick",void 0],[h,"click",void 0],[h,"keydown",{capture:!1}],[h,"keyup",void 0],[h,"wheel",{passive:!1}],[h,"contextmenu",void 0],[window,"blur",void 0]];for(const[f,y,b]of this._listeners)A.addEventListener(f,y,f===document?this.handleWindowEvent:this.handleEvent,b)}destroy(){for(const[t,o,h]of this._listeners)A.removeEventListener(t,o,t===document?this.handleWindowEvent:this.handleEvent,h)}_addDefaultHandlers(t){const o=this._map,h=o.getCanvasContainer();this._add("mapEvent",new bm(o,t));const f=o.boxZoom=new zd(o,t);this._add("boxZoom",f),t.interactive&&t.boxZoom&&f.enable();const y=o.cooperativeGestures=new Pm(o,t.cooperativeGestures);this._add("cooperativeGestures",y),t.cooperativeGestures&&y.enable();const b=new Pu(o),S=new Hy(o);o.doubleClickZoom=new Mu(S,b),this._add("tapZoom",b),this._add("clickZoom",S),t.interactive&&t.doubleClickZoom&&o.doubleClickZoom.enable();const C=new Wy;this._add("tapDragZoom",C);const k=o.touchPitch=new Ld(o);this._add("touchPitch",k),t.interactive&&t.touchPitch&&o.touchPitch.enable(t.touchPitch);const z=()=>o.project(o.getCenter()),O=function({enable:ue,clickTolerance:ve,aroundCenter:be=!0,minPixelCenterThreshold:fe=100,rotateDegreesPerPixelMoved:Pe=.8},Oe){const Ae=new Un({checkCorrectEvent:Re=>A.mouseButton(Re)===0&&Re.ctrlKey||A.mouseButton(Re)===2&&!Re.ctrlKey});return new Ra({clickTolerance:ve,move:(Re,Fe)=>{const st=Oe();if(be&&Math.abs(st.y-Re.y)>fe)return{bearingDelta:l.cm(new l.P(Re.x,Fe.y),Fe,st)};let it=(Fe.x-Re.x)*Pe;return be&&Fe.y<st.y&&(it=-it),{bearingDelta:it}},moveStateManager:Ae,enable:ue,assignEvents:Eu})}(t,z),L=function({enable:ue,clickTolerance:ve,pitchDegreesPerPixelMoved:be=-.5}){const fe=new Un({checkCorrectEvent:Pe=>A.mouseButton(Pe)===0&&Pe.ctrlKey||A.mouseButton(Pe)===2});return new Ra({clickTolerance:ve,move:(Pe,Oe)=>({pitchDelta:(Oe.y-Pe.y)*be}),moveStateManager:fe,enable:ue,assignEvents:Eu})}(t),j=function({enable:ue,clickTolerance:ve,rollDegreesPerPixelMoved:be=.3},fe){const Pe=new Un({checkCorrectEvent:Oe=>A.mouseButton(Oe)===2&&Oe.ctrlKey});return new Ra({clickTolerance:ve,move:(Oe,Ae)=>{const Re=fe();let Fe=(Ae.x-Oe.x)*be;return Ae.y<Re.y&&(Fe=-Fe),{rollDelta:Fe}},moveStateManager:Pe,enable:ue,assignEvents:Eu})}(t,z);o.dragRotate=new ku(t,O,L,j),this._add("mouseRotate",O,["mousePitch"]),this._add("mousePitch",L,["mouseRotate","mouseRoll"]),this._add("mouseRoll",j,["mousePitch"]),t.interactive&&t.dragRotate&&o.dragRotate.enable();const q=function({enable:ue,clickTolerance:ve}){const be=new Un({checkCorrectEvent:fe=>A.mouseButton(fe)===0&&!fe.ctrlKey});return new Ra({clickTolerance:ve,move:(fe,Pe)=>({around:Pe,panDelta:Pe.sub(fe)}),activateOnStart:!0,moveStateManager:be,enable:ue,assignEvents:Eu})}(t),se=new Gy(t,o);o.dragPan=new Nd(h,q,se),this._add("mousePan",q),this._add("touchPan",se,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&o.dragPan.enable(t.dragPan);const oe=new Dd,ae=new lo;o.touchZoomRotate=new Bd(h,ae,oe,C),this._add("touchRotate",oe,["touchPan","touchZoom"]),this._add("touchZoom",ae,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&o.touchZoomRotate.enable(t.touchZoomRotate);const ce=o.scrollZoom=new Cm(o,()=>this._triggerRenderFrame());this._add("scrollZoom",ce,["mousePan"]),t.interactive&&t.scrollZoom&&o.scrollZoom.enable(t.scrollZoom);const pe=o.keyboard=new Oa(o);this._add("keyboard",pe),t.interactive&&t.keyboard&&o.keyboard.enable(),this._add("blockableMapEvent",new wm(o))}_add(t,o,h){this._handlers.push({handlerName:t,handler:o,allowed:h}),this._handlersById[t]=o}stop(t){if(!this._updatingCamera){for(const{handler:o}of this._handlers)o.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!nc(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,o,h){for(const f in t)if(f!==h&&(!o||o.indexOf(f)<0))return!0;return!1}_getMapTouches(t){const o=[];for(const h of t)this._el.contains(h.target)&&o.push(h);return o}mergeHandlerResult(t,o,h,f,y){if(!h)return;l.e(t,h);const b={handlerName:f,originalEvent:h.originalEvent||y};h.zoomDelta!==void 0&&(o.zoom=b),h.panDelta!==void 0&&(o.drag=b),h.rollDelta!==void 0&&(o.roll=b),h.pitchDelta!==void 0&&(o.pitch=b),h.bearingDelta!==void 0&&(o.rotate=b)}_applyChanges(){const t={},o={},h={};for(const[f,y,b]of this._changes)f.panDelta&&(t.panDelta=(t.panDelta||new l.P(0,0))._add(f.panDelta)),f.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+f.zoomDelta),f.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+f.bearingDelta),f.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+f.pitchDelta),f.rollDelta&&(t.rollDelta=(t.rollDelta||0)+f.rollDelta),f.around!==void 0&&(t.around=f.around),f.pinchAround!==void 0&&(t.pinchAround=f.pinchAround),f.noInertia&&(t.noInertia=f.noInertia),l.e(o,y),l.e(h,b);this._updateMapTransform(t,o,h),this._changes=[]}_updateMapTransform(t,o,h){const f=this._map,y=f._getTransformForUpdate(),b=f.terrain;if(!(jd(t)||b&&this._terrainMovement))return this._fireEvents(o,h,!0);f._stop(!0);let{panDelta:S,zoomDelta:C,bearingDelta:k,pitchDelta:z,rollDelta:O,around:L,pinchAround:j}=t;j!==void 0&&(L=j),L=L||f.transform.centerPoint,b&&!y.isPointOnMapSurface(L)&&(L=y.centerPoint);const q={panDelta:S,zoomDelta:C,rollDelta:O,pitchDelta:z,bearingDelta:k,around:L};this._map.cameraHelper.useGlobeControls&&!y.isPointOnMapSurface(L)&&(L=y.centerPoint);const se=L.distSqr(y.centerPoint)<.01?y.center:y.screenPointToLocation(S?L.sub(S):L);b?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(q,y),this._terrainMovement||!o.drag&&!o.zoom?o.drag&&this._terrainMovement?y.setCenter(y.screenPointToLocation(y.centerPoint.sub(S))):this._map.cameraHelper.handleMapControlsPan(q,y,se):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(q,y,se))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(q,y),this._map.cameraHelper.handleMapControlsPan(q,y,se)),f._applyUpdatedTransform(y),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(o,h,!0)}_fireEvents(t,o,h){const f=nc(this._eventsInProgress),y=nc(t),b={};for(const O in t){const{originalEvent:L}=t[O];this._eventsInProgress[O]||(b[`${O}start`]=L),this._eventsInProgress[O]=t[O]}!f&&y&&this._fireEvent("movestart",y.originalEvent);for(const O in b)this._fireEvent(O,b[O]);y&&this._fireEvent("move",y.originalEvent);for(const O in t){const{originalEvent:L}=t[O];this._fireEvent(O,L)}const S={};let C;for(const O in this._eventsInProgress){const{handlerName:L,originalEvent:j}=this._eventsInProgress[O];this._handlersById[L].isActive()||(delete this._eventsInProgress[O],C=o[L]||j,S[`${O}end`]=C)}for(const O in S)this._fireEvent(O,S[O]);const k=nc(this._eventsInProgress),z=(f||y)&&!k;if(z&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const O=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&O.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(O)}if(h&&z){this._updatingCamera=!0;const O=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),L=j=>j!==0&&-this._bearingSnap<j&&j<this._bearingSnap;!O||!O.essential&&F.prefersReducedMotion?(this._map.fire(new l.l("moveend",{originalEvent:C})),L(this._map.getBearing())&&this._map.resetNorth()):(L(O.bearing||this._map.getBearing())&&(O.bearing=0),O.freezeElevation=!0,this._map.easeTo(O,{originalEvent:C})),this._updatingCamera=!1}}_fireEvent(t,o){this._map.fire(new l.l(t,o?{originalEvent:o}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{delete this._frameId,this.handleEvent(new qy("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Tr extends l.E{constructor(t,o,h){super(),this._renderFrameCallback=()=>{const f=Math.min((F.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(f)),f<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=h.bearingSnap,this.cameraHelper=o,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(t,o){t.apply(this.transform),this.transform=t,this.cameraHelper=o}getCenter(){return new l.S(this.transform.center.lng,this.transform.center.lat)}setCenter(t,o){return this.jumpTo({center:t},o)}getCenterElevation(){return this.transform.elevation}setCenterElevation(t,o){return this.jumpTo({elevation:t},o),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(t){this._centerClampedToGround=t}panBy(t,o,h){return t=l.P.convert(t).mult(-1),this.panTo(this.transform.center,l.e({offset:t},o),h)}panTo(t,o,h){return this.easeTo(l.e({center:t},o),h)}getZoom(){return this.transform.zoom}setZoom(t,o){return this.jumpTo({zoom:t},o),this}zoomTo(t,o,h){return this.easeTo(l.e({zoom:t},o),h)}zoomIn(t,o){return this.zoomTo(this.getZoom()+1,t,o),this}zoomOut(t,o){return this.zoomTo(this.getZoom()-1,t,o),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(t,o){return t!=this.transform.fov&&(this.transform.setFov(t),this.fire(new l.l("movestart",o)).fire(new l.l("move",o)).fire(new l.l("moveend",o))),this}getBearing(){return this.transform.bearing}setBearing(t,o){return this.jumpTo({bearing:t},o),this}getPadding(){return this.transform.padding}setPadding(t,o){return this.jumpTo({padding:t},o),this}rotateTo(t,o,h){return this.easeTo(l.e({bearing:t},o),h)}resetNorth(t,o){return this.rotateTo(0,l.e({duration:1e3},t),o),this}resetNorthPitch(t,o){return this.easeTo(l.e({bearing:0,pitch:0,roll:0,duration:1e3},t),o),this}snapToNorth(t,o){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,o):this}getPitch(){return this.transform.pitch}setPitch(t,o){return this.jumpTo({pitch:t},o),this}getRoll(){return this.transform.roll}setRoll(t,o){return this.jumpTo({roll:t},o),this}cameraForBounds(t,o){t=Gt.convert(t).adjustAntiMeridian();const h=o&&o.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),h,o)}_cameraForBoxAndBearing(t,o,h,f){const y={top:0,bottom:0,right:0,left:0};if(typeof(f=l.e({padding:y,offset:[0,0],maxZoom:this.transform.maxZoom},f)).padding=="number"){const k=f.padding;f.padding={top:k,bottom:k,right:k,left:k}}const b=l.e(y,f.padding);f.padding=b;const S=this.transform,C=new Gt(t,o);return this.cameraHelper.cameraForBoxAndBearing(f,b,C,h,S)}fitBounds(t,o,h){return this._fitInternal(this.cameraForBounds(t,o),o,h)}fitScreenCoordinates(t,o,h,f,y){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(l.P.convert(t)),this.transform.screenPointToLocation(l.P.convert(o)),h,f),f,y)}_fitInternal(t,o,h){return t?(delete(o=l.e(t,o)).padding,o.linear?this.easeTo(o,h):this.flyTo(o,h)):this}jumpTo(t,o){this.stop();const h=this._getTransformForUpdate();let f=!1,y=!1,b=!1;const S=h.zoom;this.cameraHelper.handleJumpToCenterZoom(h,t);const C=h.zoom!==S;return"elevation"in t&&h.elevation!==+t.elevation&&h.setElevation(+t.elevation),"bearing"in t&&h.bearing!==+t.bearing&&(f=!0,h.setBearing(+t.bearing)),"pitch"in t&&h.pitch!==+t.pitch&&(y=!0,h.setPitch(+t.pitch)),"roll"in t&&h.roll!==+t.roll&&(b=!0,h.setRoll(+t.roll)),t.padding==null||h.isPaddingEqual(t.padding)||h.setPadding(t.padding),this._applyUpdatedTransform(h),this.fire(new l.l("movestart",o)).fire(new l.l("move",o)),C&&this.fire(new l.l("zoomstart",o)).fire(new l.l("zoom",o)).fire(new l.l("zoomend",o)),f&&this.fire(new l.l("rotatestart",o)).fire(new l.l("rotate",o)).fire(new l.l("rotateend",o)),y&&this.fire(new l.l("pitchstart",o)).fire(new l.l("pitch",o)).fire(new l.l("pitchend",o)),b&&this.fire(new l.l("rollstart",o)).fire(new l.l("roll",o)).fire(new l.l("rollend",o)),this.fire(new l.l("moveend",o))}calculateCameraOptionsFromTo(t,o,h,f=0){const y=l.a0.fromLngLat(t,o),b=l.a0.fromLngLat(h,f),S=b.x-y.x,C=b.y-y.y,k=b.z-y.z,z=Math.hypot(S,C,k);if(z===0)throw new Error("Can't calculate camera options with same From and To");const O=Math.hypot(S,C),L=l.aj(this.transform.cameraToCenterDistance/z/this.transform.tileSize),j=180*Math.atan2(S,-C)/Math.PI;let q=180*Math.acos(O/z)/Math.PI;return q=k<0?90-q:90+q,{center:b.toLngLat(),elevation:f,zoom:L,pitch:q,bearing:j}}calculateCameraOptionsFromCameraLngLatAltRotation(t,o,h,f,y){const b=this.transform.calculateCenterFromCameraLngLatAlt(t,o,h,f);return{center:b.center,elevation:b.elevation,zoom:b.zoom,bearing:h,pitch:f,roll:y}}easeTo(t,o){this._stop(!1,t.easeId),((t=l.e({offset:[0,0],duration:500,easing:l.cn},t)).animate===!1||!t.essential&&F.prefersReducedMotion)&&(t.duration=0);const h=this._getTransformForUpdate(),f=this.getBearing(),y=h.pitch,b=h.roll,S="bearing"in t?this._normalizeBearing(t.bearing,f):f,C="pitch"in t?+t.pitch:y,k="roll"in t?this._normalizeBearing(t.roll,b):b,z="padding"in t?t.padding:h.padding,O=l.P.convert(t.offset);let L,j;t.around&&(L=l.S.convert(t.around),j=h.locationToScreenPoint(L));const q={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},se=this.cameraHelper.handleEaseTo(h,{bearing:S,pitch:C,roll:k,padding:z,around:L,aroundPoint:j,offsetAsPoint:O,offset:t.offset,zoom:t.zoom,center:t.center});return this._rotating=this._rotating||f!==S,this._pitching=this._pitching||C!==y,this._rolling=this._rolling||k!==b,this._padding=!h.isPaddingEqual(z),this._zooming=this._zooming||se.isZooming,this._easeId=t.easeId,this._prepareEase(o,t.noMoveStart,q),this.terrain&&this._prepareElevation(se.elevationCenter),this._ease(oe=>{se.easeFunc(oe),this.terrain&&!t.freezeElevation&&this._updateElevation(oe),this._applyUpdatedTransform(h),this._fireMoveEvents(o)},oe=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(o,oe)},t),this}_prepareEase(t,o,h={}){this._moving=!0,o||h.moving||this.fire(new l.l("movestart",t)),this._zooming&&!h.zooming&&this.fire(new l.l("zoomstart",t)),this._rotating&&!h.rotating&&this.fire(new l.l("rotatestart",t)),this._pitching&&!h.pitching&&this.fire(new l.l("pitchstart",t)),this._rolling&&!h.rolling&&this.fire(new l.l("rollstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const o=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&o!==this._elevationTarget){const h=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(h-(o-(h*t+this._elevationStart))/(1-t)),this._elevationTarget=o}this.transform.setElevation(l.C.number(this._elevationStart,this._elevationTarget,t))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(t){if(!this.terrain&&t.elevation>=0&&t.pitch<=90)return{};const o=t.getCameraLngLat(),h=t.getCameraAltitude(),f=this.terrain?this.terrain.getElevationForLngLatZoom(o,t.zoom):0;if(h<f){const y=this.calculateCameraOptionsFromTo(o,f,t.center,t.elevation);return{pitch:y.pitch,zoom:y.zoom}}return{}}_applyUpdatedTransform(t){const o=[];if(o.push(f=>this._elevateCameraIfInsideTerrain(f)),this.transformCameraUpdate&&o.push(f=>this.transformCameraUpdate(f)),!o.length)return;const h=t.clone();for(const f of o){const y=h.clone(),{center:b,zoom:S,roll:C,pitch:k,bearing:z,elevation:O}=f(y);b&&y.setCenter(b),O!==void 0&&y.setElevation(O),S!==void 0&&y.setZoom(S),C!==void 0&&y.setRoll(C),k!==void 0&&y.setPitch(k),z!==void 0&&y.setBearing(z),h.apply(y)}this.transform.apply(h)}_fireMoveEvents(t){this.fire(new l.l("move",t)),this._zooming&&this.fire(new l.l("zoom",t)),this._rotating&&this.fire(new l.l("rotate",t)),this._pitching&&this.fire(new l.l("pitch",t)),this._rolling&&this.fire(new l.l("roll",t))}_afterEase(t,o){if(this._easeId&&o&&this._easeId===o)return;delete this._easeId;const h=this._zooming,f=this._rotating,y=this._pitching,b=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,h&&this.fire(new l.l("zoomend",t)),f&&this.fire(new l.l("rotateend",t)),y&&this.fire(new l.l("pitchend",t)),b&&this.fire(new l.l("rollend",t)),this.fire(new l.l("moveend",t))}flyTo(t,o){if(!t.essential&&F.prefersReducedMotion){const Fe=l.Q(t,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Fe,o)}this.stop(),t=l.e({offset:[0,0],speed:1.2,curve:1.42,easing:l.cn},t);const h=this._getTransformForUpdate(),f=h.bearing,y=h.pitch,b=h.roll,S=h.padding,C="bearing"in t?this._normalizeBearing(t.bearing,f):f,k="pitch"in t?+t.pitch:y,z="roll"in t?this._normalizeBearing(t.roll,b):b,O="padding"in t?t.padding:h.padding,L=l.P.convert(t.offset);let j=h.centerPoint.add(L);const q=h.screenPointToLocation(j),se=this.cameraHelper.handleFlyTo(h,{bearing:C,pitch:k,roll:z,padding:O,locationAtOffset:q,offsetAsPoint:L,center:t.center,minZoom:t.minZoom,zoom:t.zoom});let oe=t.curve;const ae=Math.max(h.width,h.height),ce=ae/se.scaleOfZoom,pe=se.pixelPathLength;typeof se.scaleOfMinZoom=="number"&&(oe=Math.sqrt(ae/se.scaleOfMinZoom/pe*2));const ue=oe*oe;function ve(Fe){const st=(ce*ce-ae*ae+(Fe?-1:1)*ue*ue*pe*pe)/(2*(Fe?ce:ae)*ue*pe);return Math.log(Math.sqrt(st*st+1)-st)}function be(Fe){return(Math.exp(Fe)-Math.exp(-Fe))/2}function fe(Fe){return(Math.exp(Fe)+Math.exp(-Fe))/2}const Pe=ve(!1);let Oe=function(Fe){return fe(Pe)/fe(Pe+oe*Fe)},Ae=function(Fe){return ae*((fe(Pe)*(be(st=Pe+oe*Fe)/fe(st))-be(Pe))/ue)/pe;var st},Re=(ve(!0)-Pe)/oe;if(Math.abs(pe)<2e-6||!isFinite(Re)){if(Math.abs(ae-ce)<1e-6)return this.easeTo(t,o);const Fe=ce<ae?-1:1;Re=Math.abs(Math.log(ce/ae))/oe,Ae=()=>0,Oe=st=>Math.exp(Fe*oe*st)}return t.duration="duration"in t?+t.duration:1e3*Re/("screenSpeed"in t?+t.screenSpeed/oe:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=f!==C,this._pitching=k!==y,this._rolling=z!==b,this._padding=!h.isPaddingEqual(O),this._prepareEase(o,!1),this.terrain&&this._prepareElevation(se.targetCenter),this._ease(Fe=>{const st=Fe*Re,it=1/Oe(st),Ke=Ae(st);this._rotating&&h.setBearing(l.C.number(f,C,Fe)),this._pitching&&h.setPitch(l.C.number(y,k,Fe)),this._rolling&&h.setRoll(l.C.number(b,z,Fe)),this._padding&&(h.interpolatePadding(S,O,Fe),j=h.centerPoint.add(L)),se.easeFunc(Fe,it,Ke,j),this.terrain&&!t.freezeElevation&&this._updateElevation(Fe),this._applyUpdatedTransform(h),this._fireMoveEvents(o)},()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(o)},t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,o){var h;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const f=this._onEaseEnd;delete this._onEaseEnd,f.call(this,o)}return t||(h=this.handlers)===null||h===void 0||h.stop(!1),this}_ease(t,o,h){h.animate===!1||h.duration===0?(t(1),o()):(this._easeStart=F.now(),this._easeOptions=h,this._onEaseFrame=t,this._onEaseEnd=o,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,o){t=l.aN(t,-180,180);const h=Math.abs(t-o);return Math.abs(t-360-o)<h&&(t-=360),Math.abs(t+360-o)<h&&(t+=360),t}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLatZoom(l.S.convert(t),this.transform.tileZoom):null}}const ic={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Iu{constructor(t=ic){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=o=>{!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"&&o.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=A.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=A.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=A.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){A.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,o){const h=this._map._getUIString(`AttributionControl.${o}`);t.title=h,t.setAttribute("aria-label",h)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map(f=>typeof f!="string"?"":f)):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}const o=this._map.style.sourceCaches;for(const f in o){const y=o[f];if(y.used||y.usedForTerrain){const b=y.getSource();b.attribution&&t.indexOf(b.attribution)<0&&t.push(b.attribution)}}t=t.filter(f=>String(f).trim()),t.sort((f,y)=>f.length-y.length),t=t.filter((f,y)=>{for(let b=y+1;b<t.length;b++)if(t[b].indexOf(f)>=0)return!1;return!0});const h=t.join(" | ");h!==this._attribHTML&&(this._attribHTML=h,t.length?(this._innerContainer.innerHTML=A.sanitize(h),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class $d{constructor(t={}){this._updateCompact=()=>{const o=this._container.children;if(o.length){const h=o[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&h.classList.add("maplibregl-compact"):h.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=A.create("div","maplibregl-ctrl");const o=A.create("a","maplibregl-ctrl-logo");return o.target="_blank",o.rel="noopener nofollow",o.href="https://maplibre.org/",o.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),o.setAttribute("rel","noopener nofollow"),this._container.appendChild(o),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){A.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Em{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const o=++this._id;return this._queue.push({callback:t,id:o,cancelled:!1}),o}remove(t){const o=this._currentlyRunning,h=o?this._queue.concat(o):this._queue;for(const f of h)if(f.id===t)return void(f.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const o=this._currentlyRunning=this._queue;this._queue=[];for(const h of o)if(!h.cancelled&&(h.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Mm=l.aI([{name:"a_pos3d",type:"Int16",components:3}]);class Xy extends l.E{constructor(t){super(),this._lastTilesetChange=F.now(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=t._source.tileSize*2**this.deltaZoom,t.usedForTerrain=!0,t.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,o){this.sourceCache.update(t,o),this._renderableTilesKeys=[];const h={};for(const f of je(t,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:o,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))h[f.key]=!0,this._renderableTilesKeys.push(f.key),this._tiles[f.key]||(f.terrainRttPosMatrix32f=new Float64Array(16),l.bX(f.terrainRttPosMatrix32f,0,l.$,l.$,0,0,1),this._tiles[f.key]=new Si(f,this.tileSize),this._lastTilesetChange=F.now());for(const f in this._tiles)h[f]||delete this._tiles[f]}freeRtt(t){for(const o in this._tiles){const h=this._tiles[o];(!t||h.tileID.equals(t)||h.tileID.isChildOf(t)||t.isChildOf(h.tileID))&&(h.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(t=>this.getTileByID(t))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t,o){return o?this._getTerrainCoordsForTileRanges(t,o):this._getTerrainCoordsForRegularTile(t)}_getTerrainCoordsForRegularTile(t){const o={};for(const h of this._renderableTilesKeys){const f=this._tiles[h].tileID,y=t.clone(),b=l.b9();if(f.canonical.equals(t.canonical))l.bX(b,0,l.$,l.$,0,0,1);else if(f.canonical.isChildOf(t.canonical)){const S=f.canonical.z-t.canonical.z,C=f.canonical.x-(f.canonical.x>>S<<S),k=f.canonical.y-(f.canonical.y>>S<<S),z=l.$>>S;l.bX(b,0,z,z,0,0,1),l.M(b,b,[-C*z,-k*z,0])}else{if(!t.canonical.isChildOf(f.canonical))continue;{const S=t.canonical.z-f.canonical.z,C=t.canonical.x-(t.canonical.x>>S<<S),k=t.canonical.y-(t.canonical.y>>S<<S),z=l.$>>S;l.bX(b,0,l.$,l.$,0,0,1),l.M(b,b,[C*z,k*z,0]),l.N(b,b,[1/2**S,1/2**S,0])}}y.terrainRttPosMatrix32f=new Float32Array(b),o[h]=y}return o}_getTerrainCoordsForTileRanges(t,o){const h={};for(const f of this._renderableTilesKeys){const y=this._tiles[f].tileID;if(!this._isWithinTileRanges(y,o))continue;const b=t.clone(),S=l.b9();if(y.canonical.z===t.canonical.z){const C=t.canonical.x-y.canonical.x,k=t.canonical.y-y.canonical.y;l.bX(S,0,l.$,l.$,0,0,1),l.M(S,S,[C*l.$,k*l.$,0])}else if(y.canonical.z>t.canonical.z){const C=y.canonical.z-t.canonical.z,k=y.canonical.x-(y.canonical.x>>C<<C),z=y.canonical.y-(y.canonical.y>>C<<C),O=t.canonical.x-(y.canonical.x>>C),L=t.canonical.y-(y.canonical.y>>C),j=l.$>>C;l.bX(S,0,j,j,0,0,1),l.M(S,S,[-k*j+O*l.$,-z*j+L*l.$,0])}else{const C=t.canonical.z-y.canonical.z,k=t.canonical.x-(t.canonical.x>>C<<C),z=t.canonical.y-(t.canonical.y>>C<<C),O=(t.canonical.x>>C)-y.canonical.x,L=(t.canonical.y>>C)-y.canonical.y,j=l.$<<C;l.bX(S,0,j,j,0,0,1),l.M(S,S,[k*l.$+O*j,z*l.$+L*j,0])}b.terrainRttPosMatrix32f=new Float32Array(S),h[f]=b}return h}getSourceTile(t,o){const h=this.sourceCache._source;let f=t.overscaledZ-this.deltaZoom;if(f>h.maxzoom&&(f=h.maxzoom),f<h.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(f).key);let y=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!y||!y.dem)&&o)for(;f>=h.minzoom&&(!y||!y.dem);)y=this.sourceCache.getTileByID(t.scaledTo(f--).key);return y}anyTilesAfterTime(t=Date.now()){return this._lastTilesetChange>=t}_isWithinTileRanges(t,o){return o[t.canonical.z]&&t.canonical.x>=o[t.canonical.z].minTileX&&t.canonical.x<=o[t.canonical.z].maxTileX&&t.canonical.y>=o[t.canonical.z].minTileY&&t.canonical.y<=o[t.canonical.z].maxTileY}}class co{constructor(t,o,h){this._meshCache={},this.painter=t,this.sourceCache=new Xy(o),this.options=h,this.exaggeration=typeof h.exaggeration=="number"?h.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,o,h,f=l.$){var y;if(!(o>=0&&o<f&&h>=0&&h<f))return 0;const b=this.getTerrainData(t),S=(y=b.tile)===null||y===void 0?void 0:y.dem;if(!S)return 0;const C=l.cr([],[o/f*l.$,h/f*l.$],b.u_terrain_matrix),k=[C[0]*S.dim,C[1]*S.dim],z=Math.floor(k[0]),O=Math.floor(k[1]),L=k[0]-z,j=k[1]-O;return S.get(z,O)*(1-L)*(1-j)+S.get(z+1,O)*L*(1-j)+S.get(z,O+1)*(1-L)*j+S.get(z+1,O+1)*L*j}getElevationForLngLatZoom(t,o){if(!l.cs(o,t.wrap()))return 0;const{tileID:h,mercatorX:f,mercatorY:y}=this._getOverscaledTileIDFromLngLatZoom(t,o);return this.getElevation(h,f%l.$,y%l.$,l.$)}getElevation(t,o,h,f=l.$){return this.getDEMElevation(t,o,h,f)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const f=this.painter.context,y=new l.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new l.T(f,y,f.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new l.T(f,new l.R({width:1,height:1}),f.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=l.af([])}const o=this.sourceCache.getSourceTile(t,!0);if(o&&o.dem&&(!o.demTexture||o.needsTerrainPrepare)){const f=this.painter.context;o.demTexture=this.painter.getTileTexture(o.dem.stride),o.demTexture?o.demTexture.update(o.dem.getPixels(),{premultiply:!1}):o.demTexture=new l.T(f,o.dem.getPixels(),f.gl.RGBA,{premultiply:!1}),o.demTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),o.needsTerrainPrepare=!1}const h=o&&o+o.tileID.key+t.key;if(h&&!this._demMatrixCache[h]){const f=this.sourceCache.sourceCache._source.maxzoom;let y=t.canonical.z-o.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=f?y=t.canonical.z-f:l.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const b=t.canonical.x-(t.canonical.x>>y<<y),S=t.canonical.y-(t.canonical.y>>y<<y),C=l.ct(new Float64Array(16),[1/(l.$<<y),1/(l.$<<y),0]);l.M(C,C,[b*l.$,S*l.$,0]),this._demMatrixCache[t.key]={matrix:C,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:o&&o.dem&&o.dem.dim||1,u_terrain_matrix:h?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:o&&o.dem&&o.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(o&&o.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:o}}getFramebuffer(t){const o=this.painter,h=o.width/devicePixelRatio,f=o.height/devicePixelRatio;return!this._fbo||this._fbo.width===h&&this._fbo.height===f||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new l.T(o.context,{width:h,height:f,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new l.T(o.context,{width:h,height:f,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=o.context.createFramebuffer(h,f,!0,!1),this._fbo.depthAttachment.set(o.context.createRenderbuffer(o.context.gl.DEPTH_COMPONENT16,h,f))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const o=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let y=0,b=0;y<this._coordsTextureSize;y++)for(let S=0;S<this._coordsTextureSize;S++,b+=4)o[b+0]=255&S,o[b+1]=255&y,o[b+2]=S>>8<<4|y>>8,o[b+3]=0;const h=new l.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(o.buffer)),f=new l.T(t,h,t.gl.RGBA,{premultiply:!1});return f.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=f,f}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const o=new Uint8Array(4),h=this.painter.context,f=h.gl,y=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),b=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),S=Math.round(this.painter.height/devicePixelRatio);h.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),f.readPixels(y,S-b-1,1,1,f.RGBA,f.UNSIGNED_BYTE,o),h.bindFramebuffer.set(null);const C=o[0]+(o[2]>>4<<8),k=o[1]+((15&o[2])<<8),z=this.coordsIndex[255-o[3]],O=z&&this.sourceCache.getTileByID(z);if(!O)return null;const L=this._coordsTextureSize,j=(1<<O.tileID.canonical.z)*L;return new l.a0((O.tileID.canonical.x*L+C)/j+O.tileID.wrap,(O.tileID.canonical.y*L+k)/j,this.getElevation(O.tileID,C,k,L))}depthAtPoint(t){const o=new Uint8Array(4),h=this.painter.context,f=h.gl;return h.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),f.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,f.RGBA,f.UNSIGNED_BYTE,o),h.bindFramebuffer.set(null),(o[0]/16777216+o[1]/65536+o[2]/256+o[3])/256}getTerrainMesh(t){var o;const h=((o=this.painter.style.projection)===null||o===void 0?void 0:o.transitionState)>0,f=h&&t.canonical.y===0,y=h&&t.canonical.y===(1<<t.canonical.z)-1,b=`m_${f?"n":""}_${y?"s":""}`;if(this._meshCache[b])return this._meshCache[b];const S=this.painter.context,C=new l.cu,k=new l.aM,z=this.meshSize,O=l.$/z,L=z*z;for(let fe=0;fe<=z;fe++)for(let Pe=0;Pe<=z;Pe++)C.emplaceBack(Pe*O,fe*O,0);for(let fe=0;fe<L;fe+=z+1)for(let Pe=0;Pe<z;Pe++)k.emplaceBack(Pe+fe,z+Pe+fe+1,z+Pe+fe+2),k.emplaceBack(Pe+fe,z+Pe+fe+2,Pe+fe+1);const j=C.length,q=j+(z+1),se=(z+1)*z,oe=f?l.bg:0,ae=f?0:1,ce=y?l.bh:l.$,pe=y?0:1;for(let fe=0;fe<=z;fe++)C.emplaceBack(fe*O,oe,ae);for(let fe=0;fe<=z;fe++)C.emplaceBack(fe*O,ce,pe);for(let fe=0;fe<z;fe++)k.emplaceBack(se+fe,q+fe,q+fe+1),k.emplaceBack(se+fe,q+fe+1,se+fe+1),k.emplaceBack(0+fe,j+fe+1,j+fe),k.emplaceBack(0+fe,0+fe+1,j+fe+1);const ue=C.length,ve=ue+2*(z+1);for(const fe of[0,1])for(let Pe=0;Pe<=z;Pe++)for(const Oe of[0,1])C.emplaceBack(fe*l.$,Pe*O,Oe);for(let fe=0;fe<2*z;fe+=2)k.emplaceBack(ue+fe,ue+fe+1,ue+fe+3),k.emplaceBack(ue+fe,ue+fe+3,ue+fe+2),k.emplaceBack(ve+fe,ve+fe+3,ve+fe+1),k.emplaceBack(ve+fe,ve+fe+2,ve+fe+3);const be=new Co(S.createVertexBuffer(C,Mm.members),S.createIndexBuffer(k),l.aL.simpleSegment(0,0,C.length,k.length));return this._meshCache[b]=be,be}getMeshFrameDelta(t){return 2*Math.PI*l.bt/Math.pow(2,Math.max(t,0))/5}getMinTileElevationForLngLatZoom(t,o){var h;const{tileID:f}=this._getOverscaledTileIDFromLngLatZoom(t,o);return(h=this.getMinMaxElevation(f).minElevation)!==null&&h!==void 0?h:0}getMinMaxElevation(t){const o=this.getTerrainData(t).tile,h={minElevation:null,maxElevation:null};return o&&o.dem&&(h.minElevation=o.dem.min*this.exaggeration,h.maxElevation=o.dem.max*this.exaggeration),h}_getOverscaledTileIDFromLngLatZoom(t,o){const h=l.a0.fromLngLat(t.wrap()),f=(1<<o)*l.$,y=h.x*f,b=h.y*f,S=Math.floor(y/l.$),C=Math.floor(b/l.$);return{tileID:new l.Z(o,0,o,S,C),mercatorX:y,mercatorY:b}}}class Au{constructor(t,o,h){this._context=t,this._size=o,this._tileSize=h,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const o=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),h=new l.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return h.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),o.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),o.colorAttachment.set(h.texture),{id:t,fbo:o,texture:h,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(o=>t.id!==o),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const o of this._recentlyUsed)if(!this._objects[o].inUse)return this._objects[o];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(t=>!t.inUse)===!1}}const bt={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class It{constructor(t,o){this.painter=t,this.terrain=o,this.pool=new Au(t.context,30,o.sourceCache.tileSize*o.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,o){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter(h=>!t._layers[h].isHidden(o)),this._coordsAscending={};for(const h in t.sourceCaches){this._coordsAscending[h]={};const f=t.sourceCaches[h].getVisibleCoordinates(),y=t.sourceCaches[h].getSource(),b=y instanceof Zr?y.terrainTileRanges:null;for(const S of f){const C=this.terrain.sourceCache.getTerrainCoords(S,b);for(const k in C)this._coordsAscending[h][k]||(this._coordsAscending[h][k]=[]),this._coordsAscending[h][k].push(C[k])}}this._coordsAscendingStr={};for(const h of t._order){const f=t._layers[h],y=f.source;if(bt[f.type]&&!this._coordsAscendingStr[y]){this._coordsAscendingStr[y]={};for(const b in this._coordsAscending[y])this._coordsAscendingStr[y][b]=this._coordsAscending[y][b].map(S=>S.key).sort().join()}}for(const h of this._renderableTiles)for(const f in this._coordsAscendingStr){const y=this._coordsAscendingStr[f][h.tileID.key];y&&y!==h.rttCoords[f]&&(h.rtt=[])}}renderLayer(t,o){if(t.isHidden(this.painter.transform.zoom))return!1;const h=Object.assign(Object.assign({},o),{isRenderingToTexture:!0}),f=t.type,y=this.painter,b=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(bt[f]&&(this._prevType&&bt[this._prevType]||this._stacks.push([]),this._prevType=f,this._stacks[this._stacks.length-1].push(t.id),!b))return!0;if(bt[this._prevType]||bt[f]&&b){this._prevType=f;const S=this._stacks.length-1,C=this._stacks[S]||[];for(const k of this._renderableTiles){if(this.pool.isFull()&&(Dr(this.painter,this.terrain,this._rttTiles,h),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(k),k.rtt[S]){const O=this.pool.getObjectForId(k.rtt[S].id);if(O.stamp===k.rtt[S].stamp){this.pool.useObject(O);continue}}const z=this.pool.getOrCreateFreeObject();this.pool.useObject(z),this.pool.stampObject(z),k.rtt[S]={id:z.id,stamp:z.stamp},y.context.bindFramebuffer.set(z.fbo.framebuffer),y.context.clear({color:l.be.transparent,stencil:0}),y.currentStencilSource=void 0;for(let O=0;O<C.length;O++){const L=y.style._layers[C[O]],j=L.source?this._coordsAscending[L.source][k.tileID.key]:[k.tileID];y.context.viewport.set([0,0,z.fbo.width,z.fbo.height]),y._renderTileClippingMasks(L,j,!0),y.renderLayer(y,y.style.sourceCaches[L.source],L,j,h),L.source&&(k.rttCoords[L.source]=this._coordsAscendingStr[L.source][k.tileID.key])}}return Dr(this.painter,this.terrain,this._rttTiles,h),this._rttTiles=[],this.pool.freeAllObjects(),bt[f]}return!1}}const zu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Ud=E,oc={hash:!1,interactive:!0,bearingSnap:7,attributionControl:ic,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:l.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},Vn={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class km{constructor(t,o,h=!1){this.mousedown=y=>{this.startMove(y,A.mousePos(this.element,y)),A.addEventListener(window,"mousemove",this.mousemove),A.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=y=>{this.move(y,A.mousePos(this.element,y))},this.mouseup=y=>{this._rotatePitchHanlder.dragEnd(y),this.offTemp()},this.touchstart=y=>{y.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=A.touchPos(this.element,y.targetTouches)[0],this.startMove(y,this._startPos),A.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.addEventListener(window,"touchend",this.touchend))},this.touchmove=y=>{y.targetTouches.length!==1?this.reset():(this._lastPos=A.touchPos(this.element,y.targetTouches)[0],this.move(y,this._lastPos))},this.touchend=y=>{y.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=o;const f=new Zy;this._rotatePitchHanlder=new Ra({clickTolerance:3,move:(y,b)=>{const S=o.getBoundingClientRect(),C=new l.P((S.bottom-S.top)/2,(S.right-S.left)/2);return{bearingDelta:l.cm(new l.P(y.x,b.y),b,C),pitchDelta:h?-.5*(b.y-y.y):void 0}},moveStateManager:f,enable:!0,assignEvents:()=>{}}),this.map=t,A.addEventListener(o,"mousedown",this.mousedown),A.addEventListener(o,"touchstart",this.touchstart,{passive:!1}),A.addEventListener(o,"touchcancel",this.reset)}startMove(t,o){this._rotatePitchHanlder.dragStart(t,o),A.disableDrag()}move(t,o){const h=this.map,{bearingDelta:f,pitchDelta:y}=this._rotatePitchHanlder.dragMove(t,o)||{};f&&h.setBearing(h.getBearing()+f),y&&h.setPitch(h.getPitch()+y)}off(){const t=this.element;A.removeEventListener(t,"mousedown",this.mousedown),A.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),A.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.removeEventListener(window,"touchend",this.touchend),A.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){A.enableDrag(),A.removeEventListener(window,"mousemove",this.mousemove),A.removeEventListener(window,"mouseup",this.mouseup),A.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.removeEventListener(window,"touchend",this.touchend)}}let wn;function Im(_,t,o,h=!1){if(h||!o.getCoveringTilesDetailsProvider().allowWorldCopies())return _==null?void 0:_.wrap();const f=new l.S(_.lng,_.lat);if(_=new l.S(_.lng,_.lat),t){const y=new l.S(_.lng-360,_.lat),b=new l.S(_.lng+360,_.lat),S=o.locationToScreenPoint(_).distSqr(t);o.locationToScreenPoint(y).distSqr(t)<S?_=y:o.locationToScreenPoint(b).distSqr(t)<S&&(_=b)}for(;Math.abs(_.lng-o.center.lng)>180;){const y=o.locationToScreenPoint(_);if(y.x>=0&&y.y>=0&&y.x<=o.width&&y.y<=o.height)break;_.lng>o.center.lng?_.lng-=360:_.lng+=360}return _.lng!==f.lng&&o.isPointOnMapSurface(o.locationToScreenPoint(_))?_:f}const Us={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Mr(_,t,o){const h=_.classList;for(const f in Us)h.remove(`maplibregl-${o}-anchor-${f}`);h.add(`maplibregl-${o}-anchor-${t}`)}class Lr extends l.E{constructor(t){if(super(),this._onKeyPress=o=>{const h=o.code,f=o.charCode||o.keyCode;h!=="Space"&&h!=="Enter"&&f!==32&&f!==13||this.togglePopup()},this._onMapClick=o=>{const h=o.originalEvent.target,f=this._element;this._popup&&(h===f||f.contains(h))&&this.togglePopup()},this._update=o=>{if(!this._map)return;const h=this._map.loaded()&&!this._map.isMoving();((o==null?void 0:o.type)==="terrain"||(o==null?void 0:o.type)==="render"&&!h)&&this._map.once("render",this._update),this._lngLat=Im(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let f="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?f=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(f=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let y="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?y="rotateX(0deg)":this._pitchAlignment==="map"&&(y=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||o&&o.type!=="moveend"||(this._pos=this._pos.round()),A.setTransform(this._element,`${Us[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${y} ${f}`),F.frameAsync(new AbortController).then(()=>{this._updateOpacity(o&&o.type==="moveend")}).catch(()=>{})},this._onMove=o=>{if(!this._isDragging){const h=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=h}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new l.l("dragstart"))),this.fire(new l.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new l.l("dragend")),this._state="inactive"},this._addDragHandler=o=>{this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._subpixelPositioning=t&&t.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this.setOpacity(t==null?void 0:t.opacity,t==null?void 0:t.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=l.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=A.create("div");const o=A.createNS("http://www.w3.org/2000/svg","svg"),h=41,f=27;o.setAttributeNS(null,"display","block"),o.setAttributeNS(null,"height",`${h}px`),o.setAttributeNS(null,"width",`${f}px`),o.setAttributeNS(null,"viewBox",`0 0 ${f} ${h}`);const y=A.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"stroke","none"),y.setAttributeNS(null,"stroke-width","1"),y.setAttributeNS(null,"fill","none"),y.setAttributeNS(null,"fill-rule","evenodd");const b=A.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"fill-rule","nonzero");const S=A.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"transform","translate(3.0, 29.0)"),S.setAttributeNS(null,"fill","#000000");const C=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ae of C){const ce=A.createNS("http://www.w3.org/2000/svg","ellipse");ce.setAttributeNS(null,"opacity","0.04"),ce.setAttributeNS(null,"cx","10.5"),ce.setAttributeNS(null,"cy","5.80029008"),ce.setAttributeNS(null,"rx",ae.rx),ce.setAttributeNS(null,"ry",ae.ry),S.appendChild(ce)}const k=A.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"fill",this._color);const z=A.createNS("http://www.w3.org/2000/svg","path");z.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),k.appendChild(z);const O=A.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"opacity","0.25"),O.setAttributeNS(null,"fill","#000000");const L=A.createNS("http://www.w3.org/2000/svg","path");L.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),O.appendChild(L);const j=A.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"transform","translate(6.0, 7.0)"),j.setAttributeNS(null,"fill","#FFFFFF");const q=A.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"transform","translate(8.0, 8.0)");const se=A.createNS("http://www.w3.org/2000/svg","circle");se.setAttributeNS(null,"fill","#000000"),se.setAttributeNS(null,"opacity","0.25"),se.setAttributeNS(null,"cx","5.5"),se.setAttributeNS(null,"cy","5.5"),se.setAttributeNS(null,"r","5.4999962");const oe=A.createNS("http://www.w3.org/2000/svg","circle");oe.setAttributeNS(null,"fill","#FFFFFF"),oe.setAttributeNS(null,"cx","5.5"),oe.setAttributeNS(null,"cy","5.5"),oe.setAttributeNS(null,"r","5.4999962"),q.appendChild(se),q.appendChild(oe),b.appendChild(S),b.appendChild(k),b.appendChild(O),b.appendChild(j),b.appendChild(q),o.appendChild(b),o.setAttributeNS(null,"height",h*this._scale+"px"),o.setAttributeNS(null,"width",f*this._scale+"px"),this._element.appendChild(o),this._offset=l.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",o=>{o.preventDefault()}),this._element.addEventListener("mousedown",o=>{o.preventDefault()}),Mr(this._element,this._anchor,"marker"),t&&t.className)for(const o of t.className.split(" "))this._element.classList.add(o);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),t.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),A.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=l.S.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const f=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[f,-1*(38.1-13.5+f)],"bottom-right":[-f,-1*(38.1-13.5+f)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(t){return this._subpixelPositioning=t,this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var o,h;const f=(o=this._map)===null||o===void 0?void 0:o.terrain,y=this._map.transform.isLocationOccluded(this._lngLat);if(!f||y){const j=y?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==j&&(this._element.style.opacity=j))}if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const b=this._map,S=b.terrain.depthAtPoint(this._pos),C=b.terrain.getElevationForLngLatZoom(this._lngLat,b.transform.tileZoom);if(b.transform.lngLatToCameraDepth(this._lngLat,C)-S<.006)return void(this._element.style.opacity=this._opacity);const k=-this._offset.y/b.transform.pixelsPerMeter,z=Math.sin(b.getPitch()*Math.PI/180)*k,O=b.terrain.depthAtPoint(new l.P(this._pos.x,this._pos.y-this._offset.y)),L=b.transform.lngLatToCameraDepth(this._lngLat,C+z)-O>.006;!((h=this._popup)===null||h===void 0)&&h.isOpen()&&L&&this._popup.remove(),this._element.style.opacity=L?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=l.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,o){return(this._opacity===void 0||t===void 0&&o===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),t!==void 0&&(this._opacity=t),o!==void 0&&(this._opacityWhenCovered=o),this._map&&this._updateOpacity(!0),this}}const Am={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let is=0,os=!1;const Vd={maxWidth:100,unit:"metric"};function Ru(_,t,o){const h=o&&o.maxWidth||100,f=_._container.clientHeight/2,y=_._container.clientWidth/2,b=_.unproject([y-h/2,f]),S=_.unproject([y+h/2,f]),C=Math.round(_.project(S).x-_.project(b).x),k=Math.min(h,C,_._container.clientWidth),z=b.distanceTo(S);if(o&&o.unit==="imperial"){const O=3.2808*z;O>5280?Vs(t,k,O/5280,_._getUIString("ScaleControl.Miles")):Vs(t,k,O,_._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?Vs(t,k,z/1852,_._getUIString("ScaleControl.NauticalMiles")):z>=1e3?Vs(t,k,z/1e3,_._getUIString("ScaleControl.Kilometers")):Vs(t,k,z,_._getUIString("ScaleControl.Meters"))}function Vs(_,t,o,h){const f=function(y){const b=Math.pow(10,`${Math.floor(y)}`.length-1);let S=y/b;return S=S>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:function(C){const k=Math.pow(10,Math.ceil(-Math.log(C)/Math.LN10));return Math.round(C*k)/k}(S),b*S}(o);_.style.width=t*(f/o)+"px",_.innerHTML=`${f}&nbsp;${h}`}const sc={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Zd=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Du(_){if(_){if(typeof _=="number"){const t=Math.round(Math.abs(_)/Math.SQRT2);return{center:new l.P(0,0),top:new l.P(0,_),"top-left":new l.P(t,t),"top-right":new l.P(-t,t),bottom:new l.P(0,-_),"bottom-left":new l.P(t,-t),"bottom-right":new l.P(-t,-t),left:new l.P(_,0),right:new l.P(-_,0)}}if(_ instanceof l.P||Array.isArray(_)){const t=l.P.convert(_);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:l.P.convert(_.center||[0,0]),top:l.P.convert(_.top||[0,0]),"top-left":l.P.convert(_["top-left"]||[0,0]),"top-right":l.P.convert(_["top-right"]||[0,0]),bottom:l.P.convert(_.bottom||[0,0]),"bottom-left":l.P.convert(_["bottom-left"]||[0,0]),"bottom-right":l.P.convert(_["bottom-right"]||[0,0]),left:l.P.convert(_.left||[0,0]),right:l.P.convert(_.right||[0,0])}}return Du(new l.P(0,0))}const Gd=E;m.AJAXError=l.cy,m.Event=l.l,m.Evented=l.E,m.LngLat=l.S,m.MercatorCoordinate=l.a0,m.Point=l.P,m.addProtocol=l.cz,m.config=l.a,m.removeProtocol=l.cA,m.AttributionControl=Iu,m.BoxZoomHandler=zd,m.CanvasSource=Yn,m.CooperativeGesturesHandler=Pm,m.DoubleClickZoomHandler=Mu,m.DragPanHandler=Nd,m.DragRotateHandler=ku,m.EdgeInsets=Ti,m.FullscreenControl=class extends l.E{constructor(_={}){super(),this._onFullscreenChange=()=>{var t;let o=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((t=o==null?void 0:o.shadowRoot)===null||t===void 0)&&t.fullscreenElement;)o=o.shadowRoot.fullscreenElement;o===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,_&&_.container&&(_.container instanceof HTMLElement?this._container=_.container:l.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){A.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const _=this._fullscreenButton=A.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);A.create("span","maplibregl-ctrl-icon",_).setAttribute("aria-hidden","true"),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.title=_}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new l.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new l.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},m.GeoJSONSource=sn,m.GeolocateControl=class extends l.E{constructor(_){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new l.l("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new l.l("geolocate",t)),this._finish()}},this._updateCamera=t=>{const o=new l.S(t.coords.longitude,t.coords.latitude),h=t.coords.accuracy,f=this._map.getBearing(),y=l.e({bearing:f},this.options.fitBoundsOptions),b=Gt.fromLngLat(o,h);this._map.fitBounds(b,y,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const o=new l.S(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=t=>{if(this._map){if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&os)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new l.l("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=A.create("button","maplibregl-ctrl-geolocate",this._container),A.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=t=>{if(this._map){if(t===!1){l.w("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=A.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Lr({element:this._dotElement}),this._circleElement=A.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Lr({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new l.l("trackuserlocationend")),this.fire(new l.l("userlocationlostfocus")))})}},this.options=l.e({},Am,_)}onAdd(_){return this._map=_,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return l._(this,arguments,void 0,function*(t=!1){if(wn!==void 0&&!t)return wn;if(window.navigator.permissions===void 0)return wn=!!window.navigator.geolocation,wn;try{wn=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{wn=!!window.navigator.geolocation}return wn})}().then(t=>this._finishSetupUI(t)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),A.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,is=0,os=!1}_isOutOfMapMaxBounds(_){const t=this._map.getMaxBounds(),o=_.coords;return t&&(o.longitude<t.getWest()||o.longitude>t.getEast()||o.latitude<t.getSouth()||o.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const _=this._map.getBounds(),t=_.getSouthEast(),o=_.getNorthEast(),h=t.distanceTo(o),f=Math.ceil(this._accuracy/(h/this._map._container.clientHeight)*2);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}trigger(){if(!this._setup)return l.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":is--,os=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new l.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.l("trackuserlocationstart")),this.fire(new l.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let _;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),is++,is>1?(_={maximumAge:6e5,timeout:0},os=!0):(_=this.options.positionOptions,os=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,_)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},m.GlobeControl=class{constructor(){this._toggleProjection=()=>{var _;const t=(_=this._map.getProjection())===null||_===void 0?void 0:_.type;this._map.setProjection(t!=="mercator"&&t?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var _;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((_=this._map.getProjection())===null||_===void 0?void 0:_.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(_){return this._map=_,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=A.create("button","maplibregl-ctrl-globe",this._container),A.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){A.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},m.Hash=Ql,m.ImageSource=Zr,m.KeyboardHandler=Oa,m.LngLatBounds=Gt,m.LogoControl=$d,m.Map=class extends Tr{constructor(_){var t,o;l.cv.mark(l.cw.create);const h=Object.assign(Object.assign(Object.assign({},oc),_),{canvasContextAttributes:Object.assign(Object.assign({},oc.canvasContextAttributes),_.canvasContextAttributes)});if(h.minZoom!=null&&h.maxZoom!=null&&h.minZoom>h.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(h.minPitch!=null&&h.maxPitch!=null&&h.minPitch>h.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(h.minPitch!=null&&h.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(h.maxPitch!=null&&h.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const f=new Jr,y=new nu;if(h.minZoom!==void 0&&f.setMinZoom(h.minZoom),h.maxZoom!==void 0&&f.setMaxZoom(h.maxZoom),h.minPitch!==void 0&&f.setMinPitch(h.minPitch),h.maxPitch!==void 0&&f.setMaxPitch(h.maxPitch),h.renderWorldCopies!==void 0&&f.setRenderWorldCopies(h.renderWorldCopies),super(f,y,{bearingSnap:h.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Em,this._controls=[],this._mapId=l.a6(),this._contextLost=S=>{S.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new l.l("webglcontextlost",{originalEvent:S}))},this._contextRestored=S=>{this._setupPainter(),this.resize(),this._update(),this.fire(new l.l("webglcontextrestored",{originalEvent:S}))},this._onMapScroll=S=>{if(S.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=h.interactive,this._maxTileCacheSize=h.maxTileCacheSize,this._maxTileCacheZoomLevels=h.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},h.canvasContextAttributes),this._trackResize=h.trackResize===!0,this._bearingSnap=h.bearingSnap,this._centerClampedToGround=h.centerClampedToGround,this._refreshExpiredTiles=h.refreshExpiredTiles===!0,this._fadeDuration=h.fadeDuration,this._crossSourceCollisions=h.crossSourceCollisions===!0,this._collectResourceTiming=h.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},zu),h.locale),this._clickTolerance=h.clickTolerance,this._overridePixelRatio=h.pixelRatio,this._maxCanvasSize=h.maxCanvasSize,this.transformCameraUpdate=h.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=h.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=re.addThrottleControl(()=>this.isMoving()),this._requestManager=new ge(h.transformRequest),typeof h.container=="string"){if(this._container=document.getElementById(h.container),!this._container)throw new Error(`Container '${h.container}' not found.`)}else{if(!(h.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=h.container}if(h.maxBounds&&this.setMaxBounds(h.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let S=!1;const C=Su(k=>{this._trackResize&&!this._removed&&(this.resize(k),this.redraw())},50);this._resizeObserver=new ResizeObserver(k=>{S?C(k):S=!0}),this._resizeObserver.observe(this._container)}this.handlers=new ns(this,h),this._hash=h.hash&&new Ql(typeof h.hash=="string"&&h.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:h.center,elevation:h.elevation,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch,roll:h.roll}),h.bounds&&(this.resize(),this.fitBounds(h.bounds,l.e({},h.fitBoundsOptions,{duration:0}))));const b=typeof h.style=="string"||((o=(t=h.style)===null||t===void 0?void 0:t.projection)===null||o===void 0?void 0:o.type)!=="globe";this.resize(null,b),this._localIdeographFontFamily=h.localIdeographFontFamily,this._validateStyle=h.validateStyle,h.style&&this.setStyle(h.style,{localIdeographFontFamily:h.localIdeographFontFamily}),h.attributionControl&&this.addControl(new Iu(typeof h.attributionControl=="boolean"?void 0:h.attributionControl)),h.maplibreLogo&&this.addControl(new $d,h.logoPosition),this.on("style.load",()=>{if(b||this._resizeTransform(),this.transform.unmodified){const S=l.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(S)}}),this.on("data",S=>{this._update(S.dataType==="style"),this.fire(new l.l(`${S.dataType}data`,S))}),this.on("dataloading",S=>{this.fire(new l.l(`${S.dataType}dataloading`,S))}),this.on("dataabort",S=>{this.fire(new l.l("sourcedataabort",S))})}_getMapId(){return this._mapId}setGlobalStateProperty(_,t){return this.style.setGlobalStateProperty(_,t),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(_,t){if(t===void 0&&(t=_.getDefaultPosition?_.getDefaultPosition():"top-right"),!_||!_.onAdd)return this.fire(new l.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const o=_.onAdd(this);this._controls.push(_);const h=this._controlPositions[t];return t.indexOf("bottom")!==-1?h.insertBefore(o,h.firstChild):h.appendChild(o),this}removeControl(_){if(!_||!_.onRemove)return this.fire(new l.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(_);return t>-1&&this._controls.splice(t,1),_.onRemove(this),this}hasControl(_){return this._controls.indexOf(_)>-1}calculateCameraOptionsFromTo(_,t,o,h){return h==null&&this.terrain&&(h=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(_,t,o,h)}resize(_,t=!0){const[o,h]=this._containerDimensions(),f=this._getClampedPixelRatio(o,h);if(this._resizeCanvas(o,h,f),this.painter.resize(o,h,f),this.painter.overLimit()){const b=this.painter.context.gl;this._maxCanvasSize=[b.drawingBufferWidth,b.drawingBufferHeight];const S=this._getClampedPixelRatio(o,h);this._resizeCanvas(o,h,S),this.painter.resize(o,h,S)}this._resizeTransform(t);const y=!this._moving;return y&&(this.stop(),this.fire(new l.l("movestart",_)).fire(new l.l("move",_))),this.fire(new l.l("resize",_)),y&&this.fire(new l.l("moveend",_)),this}_resizeTransform(_=!0){var t;const[o,h]=this._containerDimensions();this.transform.resize(o,h,_),(t=this._requestedCameraState)===null||t===void 0||t.resize(o,h,_)}_getClampedPixelRatio(_,t){const{0:o,1:h}=this._maxCanvasSize,f=this.getPixelRatio(),y=_*f,b=t*f;return Math.min(y>o?o/y:1,b>h?h/b:1)*f}getPixelRatio(){var _;return(_=this._overridePixelRatio)!==null&&_!==void 0?_:devicePixelRatio}setPixelRatio(_){this._overridePixelRatio=_,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(_){return this.transform.setMaxBounds(Gt.convert(_)),this._update()}setMinZoom(_){if((_=_??-2)>=-2&&_<=this.transform.maxZoom)return this.transform.setMinZoom(_),this._update(),this.getZoom()<_&&this.setZoom(_),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(_){if((_=_??22)>=this.transform.minZoom)return this.transform.setMaxZoom(_),this._update(),this.getZoom()>_&&this.setZoom(_),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(_){if((_=_??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(_>=0&&_<=this.transform.maxPitch)return this.transform.setMinPitch(_),this._update(),this.getPitch()<_&&this.setPitch(_),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(_){if((_=_??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(_>=this.transform.minPitch)return this.transform.setMaxPitch(_),this._update(),this.getPitch()>_&&this.setPitch(_),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(_){return this.transform.setRenderWorldCopies(_),this._update()}project(_){return this.transform.locationToScreenPoint(l.S.convert(_),this.style&&this.terrain)}unproject(_){return this.transform.screenPointToLocation(l.P.convert(_),this.terrain)}isMoving(){var _;return this._moving||((_=this.handlers)===null||_===void 0?void 0:_.isMoving())}isZooming(){var _;return this._zooming||((_=this.handlers)===null||_===void 0?void 0:_.isZooming())}isRotating(){var _;return this._rotating||((_=this.handlers)===null||_===void 0?void 0:_.isRotating())}_createDelegatedListener(_,t,o){if(_==="mouseenter"||_==="mouseover"){let h=!1;return{layers:t,listener:o,delegates:{mousemove:y=>{const b=t.filter(C=>this.getLayer(C)),S=b.length!==0?this.queryRenderedFeatures(y.point,{layers:b}):[];S.length?h||(h=!0,o.call(this,new ti(_,this,y.originalEvent,{features:S}))):h=!1},mouseout:()=>{h=!1}}}}if(_==="mouseleave"||_==="mouseout"){let h=!1;return{layers:t,listener:o,delegates:{mousemove:b=>{const S=t.filter(C=>this.getLayer(C));(S.length!==0?this.queryRenderedFeatures(b.point,{layers:S}):[]).length?h=!0:h&&(h=!1,o.call(this,new ti(_,this,b.originalEvent)))},mouseout:b=>{h&&(h=!1,o.call(this,new ti(_,this,b.originalEvent)))}}}}{const h=f=>{const y=t.filter(S=>this.getLayer(S)),b=y.length!==0?this.queryRenderedFeatures(f.point,{layers:y}):[];b.length&&(f.features=b,o.call(this,f),delete f.features)};return{layers:t,listener:o,delegates:{[_]:h}}}}_saveDelegatedListener(_,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[_]=this._delegatedListeners[_]||[],this._delegatedListeners[_].push(t)}_removeDelegatedListener(_,t,o){if(!this._delegatedListeners||!this._delegatedListeners[_])return;const h=this._delegatedListeners[_];for(let f=0;f<h.length;f++){const y=h[f];if(y.listener===o&&y.layers.length===t.length&&y.layers.every(b=>t.includes(b))){for(const b in y.delegates)this.off(b,y.delegates[b]);return void h.splice(f,1)}}}on(_,t,o){if(o===void 0)return super.on(_,t);const h=typeof t=="string"?[t]:t,f=this._createDelegatedListener(_,h,o);this._saveDelegatedListener(_,f);for(const y in f.delegates)this.on(y,f.delegates[y]);return{unsubscribe:()=>{this._removeDelegatedListener(_,h,o)}}}once(_,t,o){if(o===void 0)return super.once(_,t);const h=typeof t=="string"?[t]:t,f=this._createDelegatedListener(_,h,o);for(const y in f.delegates){const b=f.delegates[y];f.delegates[y]=(...S)=>{this._removeDelegatedListener(_,h,o),b(...S)}}this._saveDelegatedListener(_,f);for(const y in f.delegates)this.once(y,f.delegates[y]);return this}off(_,t,o){return o===void 0?super.off(_,t):(this._removeDelegatedListener(_,typeof t=="string"?[t]:t,o),this)}queryRenderedFeatures(_,t){if(!this.style)return[];let o;const h=_ instanceof l.P||Array.isArray(_),f=h?_:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(h?{}:_)||{},f instanceof l.P||typeof f[0]=="number")o=[l.P.convert(f)];else{const y=l.P.convert(f[0]),b=l.P.convert(f[1]);o=[y,new l.P(b.x,y.y),b,new l.P(y.x,b.y),y]}return this.style.queryRenderedFeatures(o,t,this.transform)}querySourceFeatures(_,t){return this.style.querySourceFeatures(_,t)}setStyle(_,t){return(t=l.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&_?(this._diffStyle(_,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(_,t))}setTransformRequest(_){return this._requestManager.setTransformRequest(_),this}_getUIString(_){const t=this._locale[_];if(t==null)throw new Error(`Missing UI string '${_}'`);return t}_updateStyle(_,t){var o,h;if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(_,t));const f=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!_)),_?(this.style=new cd(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof _=="string"?this.style.loadURL(_,t,f):this.style.loadJSON(_,t,f),this):((h=(o=this.style)===null||o===void 0?void 0:o.projection)===null||h===void 0||h.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new cd(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(_,t){if(typeof _=="string"){const o=this._requestManager.transformRequest(_,"Style");l.j(o,new AbortController).then(h=>{this._updateDiff(h.data,t)}).catch(h=>{h&&this.fire(new l.k(h))})}else typeof _=="object"&&this._updateDiff(_,t)}_updateDiff(_,t){try{this.style.setState(_,t)&&this._update(!0)}catch(o){l.w(`Unable to perform style diff: ${o.message||o.error||o}.  Rebuilding the style from scratch.`),this._updateStyle(_,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():l.w("There is no style added to the map.")}addSource(_,t){return this._lazyInitEmptyStyle(),this.style.addSource(_,t),this._update(!0)}isSourceLoaded(_){const t=this.style&&this.style.sourceCaches[_];if(t!==void 0)return t.loaded();this.fire(new l.k(new Error(`There is no source with ID '${_}'`)))}setTerrain(_){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),_){const t=this.style.sourceCaches[_.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${_.source}`);this.terrain===null&&t.reload();for(const o in this.style._layers){const h=this.style._layers[o];h.type==="hillshade"&&h.source===_.source&&l.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),h.type==="color-relief"&&h.source===_.source&&l.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new co(this.painter,t,_),this.painter.renderToTexture=new It(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=o=>{var h;o.dataType==="style"?this.terrain.sourceCache.freeRtt():o.dataType==="source"&&o.tile&&(o.sourceId!==_.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((h=o.source)===null||h===void 0?void 0:h.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(o.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new l.l("terrain",{terrain:_})),this}getTerrain(){var _,t;return(t=(_=this.terrain)===null||_===void 0?void 0:_.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const _=this.style&&this.style.sourceCaches;for(const t in _){const o=_[t]._tiles;for(const h in o){const f=o[h];if(f.state!=="loaded"&&f.state!=="errored")return!1}}return!0}removeSource(_){return this.style.removeSource(_),this._update(!0)}getSource(_){return this.style.getSource(_)}setSourceTileLodParams(_,t,o){if(o){const h=this.getSource(o);if(!h)throw new Error(`There is no source with ID "${o}", cannot set LOD parameters`);h.calculateTileZoom=De(Math.max(1,_),Math.max(1,t))}else for(const h in this.style.sourceCaches)this.style.sourceCaches[h].getSource().calculateTileZoom=De(Math.max(1,_),Math.max(1,t));return this._update(!0),this}refreshTiles(_,t){const o=this.style.sourceCaches[_];if(!o)throw new Error(`There is no source cache with ID "${_}", cannot refresh tile`);t===void 0?o.reload(!0):o.refreshTiles(t.map(h=>new l.a3(h.z,h.x,h.y)))}addImage(_,t,o={}){const{pixelRatio:h=1,sdf:f=!1,stretchX:y,stretchY:b,content:S,textFitWidth:C,textFitHeight:k}=o;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||l.b(t))){if(t.width===void 0||t.height===void 0)return this.fire(new l.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:z,height:O,data:L}=t,j=t;return this.style.addImage(_,{data:new l.R({width:z,height:O},new Uint8Array(L)),pixelRatio:h,stretchX:y,stretchY:b,content:S,textFitWidth:C,textFitHeight:k,sdf:f,version:0,userImage:j}),j.onAdd&&j.onAdd(this,_),this}}{const{width:z,height:O,data:L}=F.getImageData(t);this.style.addImage(_,{data:new l.R({width:z,height:O},L),pixelRatio:h,stretchX:y,stretchY:b,content:S,textFitWidth:C,textFitHeight:k,sdf:f,version:0})}}updateImage(_,t){const o=this.style.getImage(_);if(!o)return this.fire(new l.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const h=t instanceof HTMLImageElement||l.b(t)?F.getImageData(t):t,{width:f,height:y,data:b}=h;if(f===void 0||y===void 0)return this.fire(new l.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(f!==o.data.width||y!==o.data.height)return this.fire(new l.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const S=!(t instanceof HTMLImageElement||l.b(t));return o.data.replace(b,S),this.style.updateImage(_,o),this}getImage(_){return this.style.getImage(_)}hasImage(_){return _?!!this.style.getImage(_):(this.fire(new l.k(new Error("Missing required image id"))),!1)}removeImage(_){this.style.removeImage(_)}loadImage(_){return re.getImage(this._requestManager.transformRequest(_,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(_,t){return this._lazyInitEmptyStyle(),this.style.addLayer(_,t),this._update(!0)}moveLayer(_,t){return this.style.moveLayer(_,t),this._update(!0)}removeLayer(_){return this.style.removeLayer(_),this._update(!0)}getLayer(_){return this.style.getLayer(_)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(_,t,o){return this.style.setLayerZoomRange(_,t,o),this._update(!0)}setFilter(_,t,o={}){return this.style.setFilter(_,t,o),this._update(!0)}getFilter(_){return this.style.getFilter(_)}setPaintProperty(_,t,o,h={}){return this.style.setPaintProperty(_,t,o,h),this._update(!0)}getPaintProperty(_,t){return this.style.getPaintProperty(_,t)}setLayoutProperty(_,t,o,h={}){return this.style.setLayoutProperty(_,t,o,h),this._update(!0)}getLayoutProperty(_,t){return this.style.getLayoutProperty(_,t)}setGlyphs(_,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(_,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(_,t,o={}){return this._lazyInitEmptyStyle(),this.style.addSprite(_,t,o,h=>{h||this._update(!0)}),this}removeSprite(_){return this._lazyInitEmptyStyle(),this.style.removeSprite(_),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(_,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(_,t,o=>{o||this._update(!0)}),this}setLight(_,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(_,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(_,t={}){return this._lazyInitEmptyStyle(),this.style.setSky(_,t),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(_,t){return this.style.setFeatureState(_,t),this._update()}removeFeatureState(_,t){return this.style.removeFeatureState(_,t),this._update()}getFeatureState(_){return this.style.getFeatureState(_)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let _=0,t=0;return this._container&&(_=this._container.clientWidth||400,t=this._container.clientHeight||300),[_,t]}_setupContainer(){const _=this._container;_.classList.add("maplibregl-map");const t=this._canvasContainer=A.create("div","maplibregl-canvas-container",_);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=A.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const o=this._containerDimensions(),h=this._getClampedPixelRatio(o[0],o[1]);this._resizeCanvas(o[0],o[1],h);const f=this._controlContainer=A.create("div","maplibregl-control-container",_),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(b=>{y[b]=A.create("div",`maplibregl-ctrl-${b} `,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(_,t,o){this._canvas.width=Math.floor(o*_),this._canvas.height=Math.floor(o*t),this._canvas.style.width=`${_}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const _=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let t=null;this._canvas.addEventListener("webglcontextcreationerror",h=>{t={requestedAttributes:_},h&&(t.statusMessage=h.statusMessage,t.type=h.type)},{once:!0});let o=null;if(o=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,_):this._canvas.getContext("webgl2",_)||this._canvas.getContext("webgl",_),!o){const h="Failed to initialize WebGL";throw t?(t.message=h,new Error(JSON.stringify(t))):new Error(h)}this.painter=new Pi(o,this.transform),X.testSupport(o)}migrateProjection(_,t){super.migrateProjection(_,t),this.painter.transform=_,this.fire(new l.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(_){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||_,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(_){return this._update(),this._renderTaskQueue.add(_)}_cancelRenderFrame(_){this._renderTaskQueue.remove(_)}_render(_){var t,o,h,f,y;const b=this._idleTriggered?this._fadeDuration:0,S=((t=this.style.projection)===null||t===void 0?void 0:t.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(_),this._removed)return;let C=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const O=this.transform.zoom,L=F.now();this.style.zoomHistory.update(O,L);const j=new l.F(O,{now:L,fadeDuration:b,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition(),globalState:this.style.getGlobalState()}),q=j.crossFadingFactor();q===1&&q===this._crossFadingFactor||(C=!0,this._crossFadingFactor=q),this.style.update(j)}const k=((o=this.style.projection)===null||o===void 0?void 0:o.transitionState)>0!==S;(h=this.style.projection)===null||h===void 0||h.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((f=this.style.projection)===null||f===void 0?void 0:f.transitionState,(y=this.style.projection)===null||y===void 0?void 0:y.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||k)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,b,this._crossSourceCollisions,k),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:b,showPadding:this.showPadding}),this.fire(new l.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,l.cv.mark(l.cw.load),this.fire(new l.l("load"))),this.style&&(this.style.hasTransitions()||C)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const z=this._sourcesDirty||this._styleDirty||this._placementDirty;return z||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new l.l("idle")),!this._loaded||this._fullyLoaded||z||(this._fullyLoaded=!0,l.cv.mark(l.cw.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var _;this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),re.removeThrottleControl(this._imageQueueHandle),(_=this._resizeObserver)===null||_===void 0||_.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t!=null&&t.loseContext&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),A.remove(this._canvasContainer),A.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),l.cv.clearMetrics(),this._removed=!0,this.fire(new l.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,F.frame(this._frameRequest,_=>{l.cv.frame(_),this._frameRequest=null;try{this._render(_)}catch(t){if(!l.cx(t)&&!function(o){return o.message===Td}(t))throw t}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(_){this._showTileBoundaries!==_&&(this._showTileBoundaries=_,this._update())}get showPadding(){return!!this._showPadding}set showPadding(_){this._showPadding!==_&&(this._showPadding=_,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(_){this._showCollisionBoxes!==_&&(this._showCollisionBoxes=_,_?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(_){this._showOverdrawInspector!==_&&(this._showOverdrawInspector=_,this._update())}get repaint(){return!!this._repaint}set repaint(_){this._repaint!==_&&(this._repaint=_,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(_){this._vertices=_,this._update()}get version(){return Ud}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(_){return this._lazyInitEmptyStyle(),this.style.setProjection(_),this._update(!0)}},m.MapMouseEvent=ti,m.MapTouchEvent=ji,m.MapWheelEvent=Ad,m.Marker=Lr,m.NavigationControl=class{constructor(_){this._updateZoomButtons=()=>{const t=this._map.getZoom(),o=t===this._map.getMaxZoom(),h=t===this._map.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=h,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",h.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(t,o)=>{const h=this._map._getUIString(`NavigationControl.${o}`);t.title=h,t.setAttribute("aria-label",h)},this.options=l.e({},Vn,_),this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),A.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),A.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=A.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new km(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){A.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(_,t){const o=A.create("button",_,this._container);return o.type="button",o.addEventListener("click",t),o}},m.Popup=class extends l.E{constructor(_){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&A.remove(this._content),this._container&&(A.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new l.l("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=A.create("div","maplibregl-popup",this._map.getContainer()),this._tip=A.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const b of this.options.className.split(" "))this._container.classList.add(b);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=Im(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!t)return;const o=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationToScreenPoint(this._lngLat));let h=this.options.anchor;const f=Du(this.options.offset);if(!h){const b=this._container.offsetWidth,S=this._container.offsetHeight;let C;C=o.y+f.bottom.y<S?["top"]:o.y>this._map.transform.height-S?["bottom"]:[],o.x<b/2?C.push("left"):o.x>this._map.transform.width-b/2&&C.push("right"),h=C.length===0?"bottom":C.join("-")}let y=o.add(f[h]);this.options.subpixelPositioning||(y=y.round()),A.setTransform(this._container,`${Us[h]} translate(${y.x}px,${y.y}px)`),Mr(this._container,h,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=l.e(Object.create(sc),_)}addTo(_){return this._map&&this.remove(),this._map=_,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new l.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(_){return this._lngLat=l.S.convert(_),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(_){return this.setDOMContent(document.createTextNode(_))}setHTML(_){const t=document.createDocumentFragment(),o=document.createElement("body");let h;for(o.innerHTML=_;h=o.firstChild,h;)t.appendChild(h);return this.setDOMContent(t)}getMaxWidth(){var _;return(_=this._container)===null||_===void 0?void 0:_.style.maxWidth}setMaxWidth(_){return this.options.maxWidth=_,this._update(),this}setDOMContent(_){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=A.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(_),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(_){return this._container&&this._container.classList.add(_),this}removeClassName(_){return this._container&&this._container.classList.remove(_),this}setOffset(_){return this.options.offset=_,this._update(),this}toggleClassName(_){if(this._container)return this._container.classList.toggle(_)}setSubpixelPositioning(_){this.options.subpixelPositioning=_}_createCloseButton(){this.options.closeButton&&(this._closeButton=A.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const _=this._container.querySelector(Zd);_&&_.focus()}},m.RasterDEMTileSource=Sr,m.RasterTileSource=Nn,m.ScaleControl=class{constructor(_){this._onMove=()=>{Ru(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,Ru(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Vd),_)}getDefaultPosition(){return"bottom-left"}onAdd(_){return this._map=_,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-scale",_.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){A.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},m.ScrollZoomHandler=Cm,m.Style=cd,m.TerrainControl=class{constructor(_){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=_}onAdd(_){return this._map=_,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=A.create("button","maplibregl-ctrl-terrain",this._container),A.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){A.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},m.TwoFingersTouchPitchHandler=Ld,m.TwoFingersTouchRotateHandler=Dd,m.TwoFingersTouchZoomHandler=lo,m.TwoFingersTouchZoomRotateHandler=Bd,m.VectorTileSource=Yr,m.VideoSource=no,m.addSourceType=(_,t)=>l._(void 0,void 0,void 0,function*(){if(Bn(_))throw new Error(`A source type called "${_}" already exists.`);((o,h)=>{Yo[o]=h})(_,t)}),m.clearPrewarmedResources=function(){const _=At;_&&(_.isPreloaded()&&_.numActive()===1?(_.release(pt),At=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},m.createTileMesh=sd,m.getMaxParallelImageRequests=function(){return l.a.MAX_PARALLEL_IMAGE_REQUESTS},m.getRTLTextPluginStatus=function(){return Qr().getRTLTextPluginStatus()},m.getVersion=function(){return Gd},m.getWorkerCount=function(){return Ct.workerCount},m.getWorkerUrl=function(){return l.a.WORKER_URL},m.importScriptInWorkers=function(_){return gt().broadcast("IS",_)},m.prewarm=function(){nr().acquire(pt)},m.setMaxParallelImageRequests=function(_){l.a.MAX_PARALLEL_IMAGE_REQUESTS=_},m.setRTLTextPlugin=function(_,t){return Qr().setRTLTextPlugin(_,t)},m.setWorkerCount=function(_){Ct.workerCount=_},m.setWorkerUrl=function(_){l.a.WORKER_URL=_}});var g=i;return g})})(Hk);var kN=Hk.exports;const Hg=yb(kN);function Wg(e,r){return e==null||r==null?NaN:e<r?-1:e>r?1:e>=r?0:NaN}function IN(e,r){return e==null||r==null?NaN:r<e?-1:r>e?1:r>=e?0:NaN}function qk(e){let r,i,c;e.length!==2?(r=Wg,i=(l,E)=>Wg(e(l),E),c=(l,E)=>e(l)-E):(r=e===Wg||e===IN?e:AN,i=e,c=e);function d(l,E,P=0,R=l.length){if(P<R){if(r(E,E)!==0)return R;do{const N=P+R>>>1;i(l[N],E)<0?P=N+1:R=N}while(P<R)}return P}function g(l,E,P=0,R=l.length){if(P<R){if(r(E,E)!==0)return R;do{const N=P+R>>>1;i(l[N],E)<=0?P=N+1:R=N}while(P<R)}return P}function m(l,E,P=0,R=l.length){const N=d(l,E,P,R-1);return N>P&&c(l[N-1],E)>-c(l[N],E)?N-1:N}return{left:d,center:m,right:g}}function AN(){return 0}function zN(e){return e===null?NaN:+e}const RN=qk(Wg),DN=RN.right;qk(zN).center;const LN=Math.sqrt(50),ON=Math.sqrt(10),FN=Math.sqrt(2);function k_(e,r,i){const c=(r-e)/Math.max(0,i),d=Math.floor(Math.log10(c)),g=c/Math.pow(10,d),m=g>=LN?10:g>=ON?5:g>=FN?2:1;let l,E,P;return d<0?(P=Math.pow(10,-d)/m,l=Math.round(e*P),E=Math.round(r*P),l/P<e&&++l,E/P>r&&--E,P=-P):(P=Math.pow(10,d)*m,l=Math.round(e/P),E=Math.round(r/P),l*P<e&&++l,E*P>r&&--E),E<l&&.5<=i&&i<2?k_(e,r,i*2):[l,E,P]}function NN(e,r,i){if(r=+r,e=+e,i=+i,!(i>0))return[];if(e===r)return[e];const c=r<e,[d,g,m]=c?k_(r,e,i):k_(e,r,i);if(!(g>=d))return[];const l=g-d+1,E=new Array(l);if(c)if(m<0)for(let P=0;P<l;++P)E[P]=(g-P)/-m;else for(let P=0;P<l;++P)E[P]=(g-P)*m;else if(m<0)for(let P=0;P<l;++P)E[P]=(d+P)/-m;else for(let P=0;P<l;++P)E[P]=(d+P)*m;return E}function Jx(e,r,i){return r=+r,e=+e,i=+i,k_(e,r,i)[2]}function BN(e,r,i){r=+r,e=+e,i=+i;const c=r<e,d=c?Jx(r,e,i):Jx(e,r,i);return(c?-1:1)*(d<0?1/-d:d)}function jN(e,r){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(r).domain(e);break}return this}function Dw(e,r,i){e.prototype=r.prototype=i,i.constructor=e}function Xk(e,r){var i=Object.create(e.prototype);for(var c in r)i[c]=r[c];return i}function Rp(){}var dp=.7,I_=1/dp,wh="\\s*([+-]?\\d+)\\s*",fp="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Cs="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",$N=/^#([0-9a-f]{3,8})$/,UN=new RegExp(`^rgb\\(${wh},${wh},${wh}\\)$`),VN=new RegExp(`^rgb\\(${Cs},${Cs},${Cs}\\)$`),ZN=new RegExp(`^rgba\\(${wh},${wh},${wh},${fp}\\)$`),GN=new RegExp(`^rgba\\(${Cs},${Cs},${Cs},${fp}\\)$`),HN=new RegExp(`^hsl\\(${fp},${Cs},${Cs}\\)$`),WN=new RegExp(`^hsla\\(${fp},${Cs},${Cs},${fp}\\)$`),PT={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Dw(Rp,pp,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:ET,formatHex:ET,formatHex8:qN,formatHsl:XN,formatRgb:MT,toString:MT});function ET(){return this.rgb().formatHex()}function qN(){return this.rgb().formatHex8()}function XN(){return Kk(this).formatHsl()}function MT(){return this.rgb().formatRgb()}function pp(e){var r,i;return e=(e+"").trim().toLowerCase(),(r=$N.exec(e))?(i=r[1].length,r=parseInt(r[1],16),i===6?kT(r):i===3?new Ai(r>>8&15|r>>4&240,r>>4&15|r&240,(r&15)<<4|r&15,1):i===8?vg(r>>24&255,r>>16&255,r>>8&255,(r&255)/255):i===4?vg(r>>12&15|r>>8&240,r>>8&15|r>>4&240,r>>4&15|r&240,((r&15)<<4|r&15)/255):null):(r=UN.exec(e))?new Ai(r[1],r[2],r[3],1):(r=VN.exec(e))?new Ai(r[1]*255/100,r[2]*255/100,r[3]*255/100,1):(r=ZN.exec(e))?vg(r[1],r[2],r[3],r[4]):(r=GN.exec(e))?vg(r[1]*255/100,r[2]*255/100,r[3]*255/100,r[4]):(r=HN.exec(e))?zT(r[1],r[2]/100,r[3]/100,1):(r=WN.exec(e))?zT(r[1],r[2]/100,r[3]/100,r[4]):PT.hasOwnProperty(e)?kT(PT[e]):e==="transparent"?new Ai(NaN,NaN,NaN,0):null}function kT(e){return new Ai(e>>16&255,e>>8&255,e&255,1)}function vg(e,r,i,c){return c<=0&&(e=r=i=NaN),new Ai(e,r,i,c)}function KN(e){return e instanceof Rp||(e=pp(e)),e?(e=e.rgb(),new Ai(e.r,e.g,e.b,e.opacity)):new Ai}function eb(e,r,i,c){return arguments.length===1?KN(e):new Ai(e,r,i,c??1)}function Ai(e,r,i,c){this.r=+e,this.g=+r,this.b=+i,this.opacity=+c}Dw(Ai,eb,Xk(Rp,{brighter(e){return e=e==null?I_:Math.pow(I_,e),new Ai(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?dp:Math.pow(dp,e),new Ai(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ai(Oc(this.r),Oc(this.g),Oc(this.b),A_(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:IT,formatHex:IT,formatHex8:YN,formatRgb:AT,toString:AT}));function IT(){return`#${Tc(this.r)}${Tc(this.g)}${Tc(this.b)}`}function YN(){return`#${Tc(this.r)}${Tc(this.g)}${Tc(this.b)}${Tc((isNaN(this.opacity)?1:this.opacity)*255)}`}function AT(){const e=A_(this.opacity);return`${e===1?"rgb(":"rgba("}${Oc(this.r)}, ${Oc(this.g)}, ${Oc(this.b)}${e===1?")":`, ${e})`}`}function A_(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Oc(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Tc(e){return e=Oc(e),(e<16?"0":"")+e.toString(16)}function zT(e,r,i,c){return c<=0?e=r=i=NaN:i<=0||i>=1?e=r=NaN:r<=0&&(e=NaN),new Zo(e,r,i,c)}function Kk(e){if(e instanceof Zo)return new Zo(e.h,e.s,e.l,e.opacity);if(e instanceof Rp||(e=pp(e)),!e)return new Zo;if(e instanceof Zo)return e;e=e.rgb();var r=e.r/255,i=e.g/255,c=e.b/255,d=Math.min(r,i,c),g=Math.max(r,i,c),m=NaN,l=g-d,E=(g+d)/2;return l?(r===g?m=(i-c)/l+(i<c)*6:i===g?m=(c-r)/l+2:m=(r-i)/l+4,l/=E<.5?g+d:2-g-d,m*=60):l=E>0&&E<1?0:m,new Zo(m,l,E,e.opacity)}function QN(e,r,i,c){return arguments.length===1?Kk(e):new Zo(e,r,i,c??1)}function Zo(e,r,i,c){this.h=+e,this.s=+r,this.l=+i,this.opacity=+c}Dw(Zo,QN,Xk(Rp,{brighter(e){return e=e==null?I_:Math.pow(I_,e),new Zo(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?dp:Math.pow(dp,e),new Zo(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,r=isNaN(e)||isNaN(this.s)?0:this.s,i=this.l,c=i+(i<.5?i:1-i)*r,d=2*i-c;return new Ai(x0(e>=240?e-240:e+120,d,c),x0(e,d,c),x0(e<120?e+240:e-120,d,c),this.opacity)},clamp(){return new Zo(RT(this.h),xg(this.s),xg(this.l),A_(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=A_(this.opacity);return`${e===1?"hsl(":"hsla("}${RT(this.h)}, ${xg(this.s)*100}%, ${xg(this.l)*100}%${e===1?")":`, ${e})`}`}}));function RT(e){return e=(e||0)%360,e<0?e+360:e}function xg(e){return Math.max(0,Math.min(1,e||0))}function x0(e,r,i){return(e<60?r+(i-r)*e/60:e<180?i:e<240?r+(i-r)*(240-e)/60:r)*255}const Lw=e=>()=>e;function JN(e,r){return function(i){return e+i*r}}function eB(e,r,i){return e=Math.pow(e,i),r=Math.pow(r,i)-e,i=1/i,function(c){return Math.pow(e+c*r,i)}}function tB(e){return(e=+e)==1?Yk:function(r,i){return i-r?eB(r,i,e):Lw(isNaN(r)?i:r)}}function Yk(e,r){var i=r-e;return i?JN(e,i):Lw(isNaN(e)?r:e)}const DT=function e(r){var i=tB(r);function c(d,g){var m=i((d=eb(d)).r,(g=eb(g)).r),l=i(d.g,g.g),E=i(d.b,g.b),P=Yk(d.opacity,g.opacity);return function(R){return d.r=m(R),d.g=l(R),d.b=E(R),d.opacity=P(R),d+""}}return c.gamma=e,c}(1);function rB(e,r){r||(r=[]);var i=e?Math.min(r.length,e.length):0,c=r.slice(),d;return function(g){for(d=0;d<i;++d)c[d]=e[d]*(1-g)+r[d]*g;return c}}function nB(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function iB(e,r){var i=r?r.length:0,c=e?Math.min(i,e.length):0,d=new Array(c),g=new Array(i),m;for(m=0;m<c;++m)d[m]=Ow(e[m],r[m]);for(;m<i;++m)g[m]=r[m];return function(l){for(m=0;m<c;++m)g[m]=d[m](l);return g}}function oB(e,r){var i=new Date;return e=+e,r=+r,function(c){return i.setTime(e*(1-c)+r*c),i}}function z_(e,r){return e=+e,r=+r,function(i){return e*(1-i)+r*i}}function sB(e,r){var i={},c={},d;(e===null||typeof e!="object")&&(e={}),(r===null||typeof r!="object")&&(r={});for(d in r)d in e?i[d]=Ow(e[d],r[d]):c[d]=r[d];return function(g){for(d in i)c[d]=i[d](g);return c}}var tb=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,b0=new RegExp(tb.source,"g");function aB(e){return function(){return e}}function lB(e){return function(r){return e(r)+""}}function cB(e,r){var i=tb.lastIndex=b0.lastIndex=0,c,d,g,m=-1,l=[],E=[];for(e=e+"",r=r+"";(c=tb.exec(e))&&(d=b0.exec(r));)(g=d.index)>i&&(g=r.slice(i,g),l[m]?l[m]+=g:l[++m]=g),(c=c[0])===(d=d[0])?l[m]?l[m]+=d:l[++m]=d:(l[++m]=null,E.push({i:m,x:z_(c,d)})),i=b0.lastIndex;return i<r.length&&(g=r.slice(i),l[m]?l[m]+=g:l[++m]=g),l.length<2?E[0]?lB(E[0].x):aB(r):(r=E.length,function(P){for(var R=0,N;R<r;++R)l[(N=E[R]).i]=N.x(P);return l.join("")})}function Ow(e,r){var i=typeof r,c;return r==null||i==="boolean"?Lw(r):(i==="number"?z_:i==="string"?(c=pp(r))?(r=c,DT):cB:r instanceof pp?DT:r instanceof Date?oB:nB(r)?rB:Array.isArray(r)?iB:typeof r.valueOf!="function"&&typeof r.toString!="function"||isNaN(r)?sB:z_)(e,r)}function uB(e,r){return e=+e,r=+r,function(i){return Math.round(e*(1-i)+r*i)}}function hB(e){return function(){return e}}function dB(e){return+e}var LT=[0,1];function dh(e){return e}function rb(e,r){return(r-=e=+e)?function(i){return(i-e)/r}:hB(isNaN(r)?NaN:.5)}function fB(e,r){var i;return e>r&&(i=e,e=r,r=i),function(c){return Math.max(e,Math.min(r,c))}}function pB(e,r,i){var c=e[0],d=e[1],g=r[0],m=r[1];return d<c?(c=rb(d,c),g=i(m,g)):(c=rb(c,d),g=i(g,m)),function(l){return g(c(l))}}function mB(e,r,i){var c=Math.min(e.length,r.length)-1,d=new Array(c),g=new Array(c),m=-1;for(e[c]<e[0]&&(e=e.slice().reverse(),r=r.slice().reverse());++m<c;)d[m]=rb(e[m],e[m+1]),g[m]=i(r[m],r[m+1]);return function(l){var E=DN(e,l,1,c)-1;return g[E](d[E](l))}}function gB(e,r){return r.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function _B(){var e=LT,r=LT,i=Ow,c,d,g,m=dh,l,E,P;function R(){var F=Math.min(e.length,r.length);return m!==dh&&(m=fB(e[0],e[F-1])),l=F>2?mB:pB,E=P=null,N}function N(F){return F==null||isNaN(F=+F)?g:(E||(E=l(e.map(c),r,i)))(c(m(F)))}return N.invert=function(F){return m(d((P||(P=l(r,e.map(c),z_)))(F)))},N.domain=function(F){return arguments.length?(e=Array.from(F,dB),R()):e.slice()},N.range=function(F){return arguments.length?(r=Array.from(F),R()):r.slice()},N.rangeRound=function(F){return r=Array.from(F),i=uB,R()},N.clamp=function(F){return arguments.length?(m=F?!0:dh,R()):m!==dh},N.interpolate=function(F){return arguments.length?(i=F,R()):i},N.unknown=function(F){return arguments.length?(g=F,N):g},function(F,A){return c=F,d=A,R()}}function yB(){return _B()(dh,dh)}function vB(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function R_(e,r){if((i=(e=r?e.toExponential(r-1):e.toExponential()).indexOf("e"))<0)return null;var i,c=e.slice(0,i);return[c.length>1?c[0]+c.slice(2):c,+e.slice(i+1)]}function Uh(e){return e=R_(Math.abs(e)),e?e[1]:NaN}function xB(e,r){return function(i,c){for(var d=i.length,g=[],m=0,l=e[0],E=0;d>0&&l>0&&(E+l+1>c&&(l=Math.max(1,c-E)),g.push(i.substring(d-=l,d+l)),!((E+=l+1)>c));)l=e[m=(m+1)%e.length];return g.reverse().join(r)}}function bB(e){return function(r){return r.replace(/[0-9]/g,function(i){return e[+i]})}}var wB=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function D_(e){if(!(r=wB.exec(e)))throw new Error("invalid format: "+e);var r;return new Fw({fill:r[1],align:r[2],sign:r[3],symbol:r[4],zero:r[5],width:r[6],comma:r[7],precision:r[8]&&r[8].slice(1),trim:r[9],type:r[10]})}D_.prototype=Fw.prototype;function Fw(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Fw.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function SB(e){e:for(var r=e.length,i=1,c=-1,d;i<r;++i)switch(e[i]){case".":c=d=i;break;case"0":c===0&&(c=i),d=i;break;default:if(!+e[i])break e;c>0&&(c=0);break}return c>0?e.slice(0,c)+e.slice(d+1):e}var Qk;function TB(e,r){var i=R_(e,r);if(!i)return e+"";var c=i[0],d=i[1],g=d-(Qk=Math.max(-8,Math.min(8,Math.floor(d/3)))*3)+1,m=c.length;return g===m?c:g>m?c+new Array(g-m+1).join("0"):g>0?c.slice(0,g)+"."+c.slice(g):"0."+new Array(1-g).join("0")+R_(e,Math.max(0,r+g-1))[0]}function OT(e,r){var i=R_(e,r);if(!i)return e+"";var c=i[0],d=i[1];return d<0?"0."+new Array(-d).join("0")+c:c.length>d+1?c.slice(0,d+1)+"."+c.slice(d+1):c+new Array(d-c.length+2).join("0")}const FT={"%":(e,r)=>(e*100).toFixed(r),b:e=>Math.round(e).toString(2),c:e=>e+"",d:vB,e:(e,r)=>e.toExponential(r),f:(e,r)=>e.toFixed(r),g:(e,r)=>e.toPrecision(r),o:e=>Math.round(e).toString(8),p:(e,r)=>OT(e*100,r),r:OT,s:TB,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function NT(e){return e}var BT=Array.prototype.map,jT=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function CB(e){var r=e.grouping===void 0||e.thousands===void 0?NT:xB(BT.call(e.grouping,Number),e.thousands+""),i=e.currency===void 0?"":e.currency[0]+"",c=e.currency===void 0?"":e.currency[1]+"",d=e.decimal===void 0?".":e.decimal+"",g=e.numerals===void 0?NT:bB(BT.call(e.numerals,String)),m=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",E=e.nan===void 0?"NaN":e.nan+"";function P(N){N=D_(N);var F=N.fill,A=N.align,X=N.sign,Z=N.symbol,ee=N.zero,H=N.width,U=N.comma,W=N.precision,re=N.trim,ge=N.type;ge==="n"?(U=!0,ge="g"):FT[ge]||(W===void 0&&(W=12),re=!0,ge="g"),(ee||F==="0"&&A==="=")&&(ee=!0,F="0",A="=");var Te=Z==="$"?i:Z==="#"&&/[boxX]/.test(ge)?"0"+ge.toLowerCase():"",xe=Z==="$"?c:/[%p]/.test(ge)?m:"",ze=FT[ge],Ne=/[defgprs%]/.test(ge);W=W===void 0?6:/[gprs]/.test(ge)?Math.max(1,Math.min(21,W)):Math.max(0,Math.min(20,W));function Ie($e){var et=Te,ot=xe,qe,ht,dt;if(ge==="c")ot=ze($e)+ot,$e="";else{$e=+$e;var wt=$e<0||1/$e<0;if($e=isNaN($e)?E:ze(Math.abs($e),W),re&&($e=SB($e)),wt&&+$e==0&&X!=="+"&&(wt=!1),et=(wt?X==="("?X:l:X==="-"||X==="("?"":X)+et,ot=(ge==="s"?jT[8+Qk/3]:"")+ot+(wt&&X==="("?")":""),Ne){for(qe=-1,ht=$e.length;++qe<ht;)if(dt=$e.charCodeAt(qe),48>dt||dt>57){ot=(dt===46?d+$e.slice(qe+1):$e.slice(qe))+ot,$e=$e.slice(0,qe);break}}}U&&!ee&&($e=r($e,1/0));var Ze=et.length+$e.length+ot.length,He=Ze<H?new Array(H-Ze+1).join(F):"";switch(U&&ee&&($e=r(He+$e,He.length?H-ot.length:1/0),He=""),A){case"<":$e=et+$e+ot+He;break;case"=":$e=et+He+$e+ot;break;case"^":$e=He.slice(0,Ze=He.length>>1)+et+$e+ot+He.slice(Ze);break;default:$e=He+et+$e+ot;break}return g($e)}return Ie.toString=function(){return N+""},Ie}function R(N,F){var A=P((N=D_(N),N.type="f",N)),X=Math.max(-8,Math.min(8,Math.floor(Uh(F)/3)))*3,Z=Math.pow(10,-X),ee=jT[8+X/3];return function(H){return A(Z*H)+ee}}return{format:P,formatPrefix:R}}var bg,Jk,eI;PB({thousands:",",grouping:[3],currency:["$",""]});function PB(e){return bg=CB(e),Jk=bg.format,eI=bg.formatPrefix,bg}function EB(e){return Math.max(0,-Uh(Math.abs(e)))}function MB(e,r){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Uh(r)/3)))*3-Uh(Math.abs(e)))}function kB(e,r){return e=Math.abs(e),r=Math.abs(r)-e,Math.max(0,Uh(r)-Uh(e))+1}function IB(e,r,i,c){var d=BN(e,r,i),g;switch(c=D_(c??",f"),c.type){case"s":{var m=Math.max(Math.abs(e),Math.abs(r));return c.precision==null&&!isNaN(g=MB(d,m))&&(c.precision=g),eI(c,m)}case"":case"e":case"g":case"p":case"r":{c.precision==null&&!isNaN(g=kB(d,Math.max(Math.abs(e),Math.abs(r))))&&(c.precision=g-(c.type==="e"));break}case"f":case"%":{c.precision==null&&!isNaN(g=EB(d))&&(c.precision=g-(c.type==="%")*2);break}}return Jk(c)}function AB(e){var r=e.domain;return e.ticks=function(i){var c=r();return NN(c[0],c[c.length-1],i??10)},e.tickFormat=function(i,c){var d=r();return IB(d[0],d[d.length-1],i??10,c)},e.nice=function(i){i==null&&(i=10);var c=r(),d=0,g=c.length-1,m=c[d],l=c[g],E,P,R=10;for(l<m&&(P=m,m=l,l=P,P=d,d=g,g=P);R-- >0;){if(P=Jx(m,l,i),P===E)return c[d]=m,c[g]=l,r(c);if(P>0)m=Math.floor(m/P)*P,l=Math.ceil(l/P)*P;else if(P<0)m=Math.ceil(m*P)/P,l=Math.floor(l*P)/P;else break;E=P}return e},e}function tI(){var e=yB();return e.copy=function(){return gB(e,tI())},jN.apply(e,arguments),AB(e)}const gy=(e,r)=>{switch(r){case"median-sale-price":return e.median_sale_price||0;case"median-list-price":return e.median_list_price||0;case"median-dom":return e.median_dom||0;case"inventory":return e.inventory||0;case"new-listings":return e.new_listings||0;case"homes-sold":return e.homes_sold||0;case"sale-to-list-ratio":return e.avg_sale_to_list_ratio||0;case"homes-sold-above-list":return e.sold_above_list||0;case"off-market-2-weeks":return e.off_market_in_two_weeks||0;default:return 0}},qg=(e,r)=>{const i=gy(e,r);switch(r){case"median-sale-price":case"median-list-price":return`$${i.toLocaleString()}`;case"median-dom":return`${i} days`;case"sale-to-list-ratio":return`${(i*100).toFixed(1)}%`;case"homes-sold-above-list":case"off-market-2-weeks":return`${i}%`;default:return i.toString()}};function zB(e){const r=new Hg.Map({container:e,center:[-98.5795,39.8283],zoom:5,minZoom:3,maxZoom:12,maxBounds:[[-180,-85],[180,85]],attributionControl:!1,style:{version:8,sources:{"carto-light":{type:"raster",tiles:["https://a.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}{r}.png","https://b.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}{r}.png","https://c.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}{r}.png","https://d.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}{r}.png"],tileSize:256},"carto-light-labels":{type:"raster",tiles:["https://a.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}{r}.png","https://b.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}{r}.png","https://c.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}{r}.png","https://d.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}{r}.png"],tileSize:256}},layers:[{id:"background",type:"background",paint:{"background-color":"#f8f9fa"}},{id:"carto-light-layer",type:"raster",source:"carto-light",minzoom:0,maxzoom:18},{id:"carto-light-labels-layer",type:"raster",source:"carto-light-labels",minzoom:0,maxzoom:18}]}});r.addControl(new Hg.NavigationControl({visualizePitch:!1}),"top-right"),r.addControl(new Hg.AttributionControl({customAttribution:" <a href='https://carto.com/attributions'>CARTO</a>",compact:!0}),"bottom-left"),r.scrollZoom.setWheelZoomRate(.5);const i=.25;let c=r.getZoom();function d(){const g=r.getZoom();!r.isMoving()&&Math.abs(g-c)>1e-6&&(c=Math.round(g/i)*i,r.zoomTo(c,{duration:0}))}return r.on("moveend",d),r.on("wheel",()=>{clearTimeout(d._t),d._t=setTimeout(d,80)}),r}const RB=zB;function DB(){const e=Y.useRef(null),[r,i]=Y.useState(!1),[c,d]=Y.useState({phase:"idle",processed:0,total:0});Y.useEffect(()=>{try{const l="/workers/data-processor.js";console.log("Attempting to create worker from:",l),fetch(l,{method:"HEAD"}).then(E=>{if(E.ok){console.log("Worker file found, creating worker");try{e.current=new Worker(l),e.current.onmessage=P=>{const{type:R,data:N,error:F}=P.data;switch(console.log("Worker message:",R,N),R){case"PROGRESS":d(N);break;case"ERROR":console.error("Worker error:",F),i(!1);break}},e.current.onerror=P=>{console.warn("Web worker failed, falling back to main thread:",P),e.current=null},console.log("Worker created successfully")}catch(P){console.warn("Failed to create worker:",P),e.current=null}}else console.warn("Worker file not found, using main thread"),e.current=null}).catch(E=>{console.warn("Cannot check worker file:",E,"using main thread"),e.current=null})}catch(l){console.warn("Web worker not supported, using main thread:",l),e.current=null}return()=>{e.current&&(console.log("Terminating worker"),e.current.terminate())}},[]);const g=Y.useCallback(async l=>new Promise(async(E,P)=>{if(e.current){console.log("Processing data with web worker");const R=Math.random().toString(36);i(!0);const N=F=>{var A,X;F.data.id===R&&(console.log("Worker response:",F.data.type),F.data.type.includes("SUCCESS")?((A=e.current)==null||A.removeEventListener("message",N),i(!1),E(F.data.data)):F.data.type.includes("ERROR")&&((X=e.current)==null||X.removeEventListener("message",N),i(!1),P(new Error(F.data.error))))};e.current.addEventListener("message",N),e.current.postMessage({...l,id:R})}else{console.log("Processing data on main thread (fallback)");try{i(!0);const R=await m(l);i(!1),E(R)}catch(R){i(!1),P(R)}}}),[]),m=async l=>{var R,N;const{type:E,data:P}=l;if(E==="LOAD_AND_PROCESS_DATA"){const{urls:F,selectedMetric:A}=P;console.log("Main thread: Loading ZIP data from:",F.zipData);const X=await fetch(F.zipData);if(!X.ok)throw new Error(`Failed to fetch ZIP data: ${X.status}`);const Z=await X.arrayBuffer();console.log("Main thread: ZIP data loaded, size:",Z.byteLength);const ee=await Qx(()=>Promise.resolve().then(()=>BC),void 0),H=ee.ungzip(new Uint8Array(Z),{to:"string"}),U=JSON.parse(H);console.log("Main thread: ZIP data parsed, entries:",Object.keys(U).length),console.log("Main thread: Loading cities data from:",F.citiesData);const W=await fetch(F.citiesData);if(!W.ok)throw new Error(`Failed to fetch cities data: ${W.status}`);const re=await W.arrayBuffer(),ge=ee.ungzip(new Uint8Array(re),{to:"string"}),Te={},xe=ge.split(`
`);console.log("Main thread: Processing cities CSV, lines:",xe.length);for(let Ne=1;Ne<xe.length;Ne++){const Ie=xe[Ne].split(",");if(Ie.length>=10){const $e=(R=Ie[0])==null?void 0:R.trim(),et=(N=Ie[6])==null?void 0:N.trim(),ot=Ie[8]?parseFloat(Ie[8].trim()):void 0,qe=Ie[9]?parseFloat(Ie[9].trim()):void 0;$e&&et&&(Te[$e]={city:et,latitude:ot,longitude:qe})}}const ze=Object.values(U).map(Ne=>{const $e={"median-sale-price":"median_sale_price","median-list-price":"median_list_price","median-dom":"median_dom",inventory:"inventory","new-listings":"new_listings","homes-sold":"homes_sold","sale-to-list-ratio":"sale_to_list_ratio","homes-sold-above-list":"homes_sold_above_list","off-market-2-weeks":"off_market_in_2_weeks"}[A]||A;return Ne[$e]||0}).filter(Ne=>Ne>0).sort((Ne,Ie)=>Ne-Ie);return{zipData:U,citiesData:Te,metricValues:ze,bounds:{min:ze[0]||0,max:ze[ze.length-1]||0}}}else if(E==="PROCESS_GEOJSON"){const{geojsonArrayBuffer:F,zipData:A,selectedMetric:X}=P,ee=(await Qx(()=>Promise.resolve().then(()=>BC),void 0)).ungzip(new Uint8Array(F),{to:"string"}),H=JSON.parse(ee);return H.features&&(H.features=H.features.map(U=>{var re,ge;const W=((re=U.properties)==null?void 0:re.ZCTA5CE10)||((ge=U.properties)==null?void 0:ge.zipCode);if(W&&A[W]){const Te=A[W],xe=gy(Te,X);return{...U,properties:{...U.properties,zipCode:W,metricValue:xe}}}return null}).filter(Boolean)),H}throw new Error(`Unsupported message type: ${E}`)};return{processData:g,isLoading:r,progress:c}}function LB({selectedMetric:e,onZipSelect:r,searchZip:i}){const c=Y.useRef(null),d=Y.useRef(null),[g,m]=Y.useState(!1),[l,E]=Y.useState({}),[P,R]=Y.useState({}),[N,F]=Y.useState(null),[A,X]=Y.useState(null),[Z,ee]=Y.useState(!1),[H,U]=Y.useState(null),W=Y.useRef(!1),{processData:re,isLoading:ge,progress:Te}=DB();return Y.useEffect(()=>{if(!c.current)return;const xe=new IntersectionObserver(ze=>{const[Ne]=ze;if(Ne.isIntersecting){const Ie=Ne.boundingClientRect;Ie.width>0&&Ie.height>0&&(console.log("Container ready, dimensions:",Ie.width,"x",Ie.height),ee(!0),xe.disconnect())}},{threshold:.1});return xe.observe(c.current),()=>xe.disconnect()},[]),Y.useEffect(()=>{if(!(!c.current||d.current||!Z)){console.log("Initializing map...");try{d.current=RB(c.current),d.current.on("load",()=>{console.log("Map loaded successfully"),m(!0)}),d.current.on("error",xe=>{console.error("Map error:",xe),U("Map initialization error")})}catch(xe){console.error("Failed to initialize map:",xe),U("Failed to initialize map")}return()=>{d.current&&(d.current.remove(),d.current=null)}}},[Z]),Y.useEffect(()=>{if(!g)return;(async()=>{try{console.log("Starting data loading process..."),U(null);const ze=await re({type:"LOAD_AND_PROCESS_DATA",data:{urls:{zipData:"https://cdn.jsdelivr.net/gh/Jasperc2024/Domapus@main/public/data/zip-data.json.gz",citiesData:"https://cdn.jsdelivr.net/gh/Jasperc2024/Domapus@main/public/data/zip-city-mapping.csv.gz"},selectedMetric:e}});if(!ze||!ze.zipData)throw new Error("No data received from processing");if(console.log("Data processing completed successfully"),E(ze.zipData),R(ze.citiesData),ze.metricValues.length>0){const Ne=tI().domain([ze.bounds.min,ze.bounds.max]).range(["#FFF9B0","#2E0B59"]).interpolate(()=>Ie=>{const $e=["#FFF9B0","#FFA873","#E84C61","#922C7E","#2E0B59"],et=Math.floor(Ie*($e.length-1)),ot=Math.min(et+1,$e.length-1),qe=Ie*($e.length-1)-et,ht=$e[et],dt=$e[ot],wt=parseInt(ht.slice(1,3),16),Ze=parseInt(ht.slice(3,5),16),He=parseInt(ht.slice(5,7),16),pt=parseInt(dt.slice(1,3),16),Ct=parseInt(dt.slice(3,5),16),ut=parseInt(dt.slice(5,7),16),At=Math.round(wt+(pt-wt)*qe),kt=Math.round(Ze+(Ct-Ze)*qe),nr=Math.round(He+(ut-He)*qe);return`#${At.toString(16).padStart(2,"0")}${kt.toString(16).padStart(2,"0")}${nr.toString(16).padStart(2,"0")}`});F(()=>Ne),console.log("Color scale created")}}catch(ze){console.error("Failed to load data:",ze),U(ze instanceof Error?ze.message:"Failed to load data"),E({}),R({})}})()},[g,e,re]),Y.useEffect(()=>{if(!d.current||!g||!N||Object.keys(l).length===0||W.current)return;const xe=async()=>{var Ne,Ie,$e,et,ot;try{console.log("Loading GeoJSON data...");const qe=await fetch("https://cdn.jsdelivr.net/gh/Jasperc2024/Domapus@main/public/data/us-zip-codes.geojson.gz");if(!qe.ok)throw new Error(`Failed to fetch GeoJSON: ${qe.status}`);const ht=await qe.arrayBuffer();console.log("GeoJSON loaded, size:",ht.byteLength);const dt=await re({type:"PROCESS_GEOJSON",data:{geojsonArrayBuffer:ht,zipData:l,selectedMetric:e}});console.log("GeoJSON processed, features:",(Ne=dt.features)==null?void 0:Ne.length),(Ie=d.current)!=null&&Ie.getSource("zip-codes")||(($e=d.current)==null||$e.addSource("zip-codes",{type:"geojson",data:dt,lineMetrics:!0}),(et=d.current)==null||et.addLayer({id:"zip-codes-fill",type:"fill",source:"zip-codes",paint:{"fill-color":["case",["has","metricValue"],["interpolate",["linear"],["get","metricValue"],...OB(N,l,e)],"rgba(200, 200, 200, 0.1)"],"fill-opacity":.7}}),(ot=d.current)==null||ot.addLayer({id:"zip-codes-border",type:"line",source:"zip-codes",paint:{"line-color":"rgba(255, 255, 255, 0.8)","line-width":2}}),W.current=!0,console.log("ZIP code layers added successfully"),ze())}catch(qe){console.error("Error loading GeoJSON:",qe),U("Failed to load map layers")}},ze=()=>{if(!d.current)return;let Ne=null;d.current.on("mouseenter","zip-codes-fill",Ie=>{var $e;if(d.current&&(d.current.getCanvas().style.cursor="pointer",Ie.features&&Ie.features[0])){const ot=($e=Ie.features[0].properties)==null?void 0:$e.zipCode;if(ot&&l[ot]){X(ot),Ne&&Ne.remove();const qe=Ie.lngLat,ht=l[ot],dt=P[ot];Ne=new Hg.Popup({closeButton:!1,closeOnClick:!1,className:"zip-tooltip",offset:[0,-10]}).setLngLat(qe).setHTML(`
                  <div class="p-2 bg-white rounded shadow-lg border">
                    <div class="font-semibold text-sm">${ot}</div>
                    <div class="text-xs text-gray-600">${(dt==null?void 0:dt.city)||"Unknown"}</div>
                    <div class="text-xs mt-1">${qg(ht,e)}</div>
                  </div>
                `).addTo(d.current)}}}),d.current.on("mouseleave","zip-codes-fill",()=>{d.current&&(d.current.getCanvas().style.cursor="",X(null),Ne&&(Ne.remove(),Ne=null))}),d.current.on("click","zip-codes-fill",Ie=>{var $e;if(Ie.features&&Ie.features[0]){const ot=($e=Ie.features[0].properties)==null?void 0:$e.zipCode;if(ot&&l[ot]){const qe=l[ot],ht=P[ot];Ne&&Ne.remove();const dt={...qe,zipCode:ot,city:(ht==null?void 0:ht.city)||qe.city||"Unknown",county:ht==null?void 0:ht.county,latitude:ht==null?void 0:ht.latitude,longitude:ht==null?void 0:ht.longitude,parent_metro:qe.parent_metro,state:qe.state_name||"Unknown"};r(dt)}}})};xe()},[g,N,l,P,e,r,re]),Y.useEffect(()=>{if(!d.current||!i||!P[i])return;const xe=P[i];if(xe.latitude&&xe.longitude&&(d.current.flyTo({center:[xe.longitude,xe.latitude],zoom:10,duration:1e3}),l[i])){const ze={...l[i],zipCode:i,city:xe.city||"Unknown",county:xe.county,latitude:xe.latitude,longitude:xe.longitude,parent_metro:l[i].parent_metro,state:l[i].state_name||"Unknown"};r(ze)}},[i,P,l,r]),ye.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[ye.jsx("div",{ref:c,className:"w-full h-full",style:{minHeight:"400px"}}),(ge||!g)&&ye.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-white/80 z-10",children:ye.jsxs("div",{className:"text-center space-y-4",children:[ye.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),ye.jsx("div",{className:"space-y-1",children:ye.jsxs("p",{className:"text-sm font-medium",children:[Te.phase==="idle"&&"Initializing...",Te.phase==="loading_zip_data"&&"Loading ZIP data...",Te.phase==="processing_zip_data"&&"Processing ZIP data...",Te.phase==="loading_cities_data"&&"Loading cities data...",Te.phase==="processing_data"&&"Processing data...",Te.phase==="geojson"&&"Processing map layers..."]})})]})})]})}function OB(e,r,i){const c=Object.values(r).map(m=>gy(m,i)).filter(m=>m>0).sort((m,l)=>m-l);if(c.length===0)return[0,"#cccccc"];const d=[],g=["#FFF9B0","#FFA873","#E84C61","#922C7E","#2E0B59"];for(let m=0;m<g.length;m++){const l=c[Math.floor((c.length-1)*(m/(g.length-1)))];d.push(l,g[m])}return d}const rI=Y.forwardRef(({className:e,...r},i)=>ye.jsx("div",{ref:i,className:Kr("rounded-lg border bg-card text-card-foreground shadow-sm",e),...r}));rI.displayName="Card";const nI=Y.forwardRef(({className:e,...r},i)=>ye.jsx("div",{ref:i,className:Kr("flex flex-col space-y-1.5 p-6",e),...r}));nI.displayName="CardHeader";const iI=Y.forwardRef(({className:e,...r},i)=>ye.jsx("h3",{ref:i,className:Kr("text-2xl font-semibold leading-none tracking-tight",e),...r}));iI.displayName="CardTitle";const FB=Y.forwardRef(({className:e,...r},i)=>ye.jsx("p",{ref:i,className:Kr("text-sm text-muted-foreground",e),...r}));FB.displayName="CardDescription";const oI=Y.forwardRef(({className:e,...r},i)=>ye.jsx("div",{ref:i,className:Kr("p-6 pt-0",e),...r}));oI.displayName="CardContent";const NB=Y.forwardRef(({className:e,...r},i)=>ye.jsx("div",{ref:i,className:Kr("flex items-center p-6 pt-0",e),...r}));NB.displayName="CardFooter";function $T(e,[r,i]){return Math.min(i,Math.max(r,e))}var BB=Y.createContext(void 0);function jB(e){const r=Y.useContext(BB);return e||r||"ltr"}var w0=0;function $B(){Y.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??UT()),document.body.insertAdjacentElement("beforeend",e[1]??UT()),w0++,()=>{w0===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(r=>r.remove()),w0--}},[])}function UT(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var S0="focusScope.autoFocusOnMount",T0="focusScope.autoFocusOnUnmount",VT={bubbles:!1,cancelable:!0},UB="FocusScope",sI=Y.forwardRef((e,r)=>{const{loop:i=!1,trapped:c=!1,onMountAutoFocus:d,onUnmountAutoFocus:g,...m}=e,[l,E]=Y.useState(null),P=qo(d),R=qo(g),N=Y.useRef(null),F=on(r,Z=>E(Z)),A=Y.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;Y.useEffect(()=>{if(c){let Z=function(W){if(A.paused||!l)return;const re=W.target;l.contains(re)?N.current=re:Wa(N.current,{select:!0})},ee=function(W){if(A.paused||!l)return;const re=W.relatedTarget;re!==null&&(l.contains(re)||Wa(N.current,{select:!0}))},H=function(W){if(document.activeElement===document.body)for(const ge of W)ge.removedNodes.length>0&&Wa(l)};document.addEventListener("focusin",Z),document.addEventListener("focusout",ee);const U=new MutationObserver(H);return l&&U.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",Z),document.removeEventListener("focusout",ee),U.disconnect()}}},[c,l,A.paused]),Y.useEffect(()=>{if(l){GT.add(A);const Z=document.activeElement;if(!l.contains(Z)){const H=new CustomEvent(S0,VT);l.addEventListener(S0,P),l.dispatchEvent(H),H.defaultPrevented||(VB(qB(aI(l)),{select:!0}),document.activeElement===Z&&Wa(l))}return()=>{l.removeEventListener(S0,P),setTimeout(()=>{const H=new CustomEvent(T0,VT);l.addEventListener(T0,R),l.dispatchEvent(H),H.defaultPrevented||Wa(Z??document.body,{select:!0}),l.removeEventListener(T0,R),GT.remove(A)},0)}}},[l,P,R,A]);const X=Y.useCallback(Z=>{if(!i&&!c||A.paused)return;const ee=Z.key==="Tab"&&!Z.altKey&&!Z.ctrlKey&&!Z.metaKey,H=document.activeElement;if(ee&&H){const U=Z.currentTarget,[W,re]=ZB(U);W&&re?!Z.shiftKey&&H===re?(Z.preventDefault(),i&&Wa(W,{select:!0})):Z.shiftKey&&H===W&&(Z.preventDefault(),i&&Wa(re,{select:!0})):H===U&&Z.preventDefault()}},[i,c,A.paused]);return ye.jsx(wr.div,{tabIndex:-1,...m,ref:F,onKeyDown:X})});sI.displayName=UB;function VB(e,{select:r=!1}={}){const i=document.activeElement;for(const c of e)if(Wa(c,{select:r}),document.activeElement!==i)return}function ZB(e){const r=aI(e),i=ZT(r,e),c=ZT(r.reverse(),e);return[i,c]}function aI(e){const r=[],i=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:c=>{const d=c.tagName==="INPUT"&&c.type==="hidden";return c.disabled||c.hidden||d?NodeFilter.FILTER_SKIP:c.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;i.nextNode();)r.push(i.currentNode);return r}function ZT(e,r){for(const i of e)if(!GB(i,{upTo:r}))return i}function GB(e,{upTo:r}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(r!==void 0&&e===r)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function HB(e){return e instanceof HTMLInputElement&&"select"in e}function Wa(e,{select:r=!1}={}){if(e&&e.focus){const i=document.activeElement;e.focus({preventScroll:!0}),e!==i&&HB(e)&&r&&e.select()}}var GT=WB();function WB(){let e=[];return{add(r){const i=e[0];r!==i&&(i==null||i.pause()),e=HT(e,r),e.unshift(r)},remove(r){var i;e=HT(e,r),(i=e[0])==null||i.resume()}}}function HT(e,r){const i=[...e],c=i.indexOf(r);return c!==-1&&i.splice(c,1),i}function qB(e){return e.filter(r=>r.tagName!=="A")}function XB(e){const r=Y.useRef({value:e,previous:e});return Y.useMemo(()=>(r.current.value!==e&&(r.current.previous=r.current.value,r.current.value=e),r.current.previous),[e])}var KB=function(e){if(typeof document>"u")return null;var r=Array.isArray(e)?e[0]:e;return r.ownerDocument.body},Xu=new WeakMap,wg=new WeakMap,Sg={},C0=0,lI=function(e){return e&&(e.host||lI(e.parentNode))},YB=function(e,r){return r.map(function(i){if(e.contains(i))return i;var c=lI(i);return c&&e.contains(c)?c:(console.error("aria-hidden",i,"in not contained inside",e,". Doing nothing"),null)}).filter(function(i){return!!i})},QB=function(e,r,i,c){var d=YB(r,Array.isArray(e)?e:[e]);Sg[i]||(Sg[i]=new WeakMap);var g=Sg[i],m=[],l=new Set,E=new Set(d),P=function(N){!N||l.has(N)||(l.add(N),P(N.parentNode))};d.forEach(P);var R=function(N){!N||E.has(N)||Array.prototype.forEach.call(N.children,function(F){if(l.has(F))R(F);else try{var A=F.getAttribute(c),X=A!==null&&A!=="false",Z=(Xu.get(F)||0)+1,ee=(g.get(F)||0)+1;Xu.set(F,Z),g.set(F,ee),m.push(F),Z===1&&X&&wg.set(F,!0),ee===1&&F.setAttribute(i,"true"),X||F.setAttribute(c,"true")}catch(H){console.error("aria-hidden: cannot operate on ",F,H)}})};return R(r),l.clear(),C0++,function(){m.forEach(function(N){var F=Xu.get(N)-1,A=g.get(N)-1;Xu.set(N,F),g.set(N,A),F||(wg.has(N)||N.removeAttribute(c),wg.delete(N)),A||N.removeAttribute(i)}),C0--,C0||(Xu=new WeakMap,Xu=new WeakMap,wg=new WeakMap,Sg={})}},JB=function(e,r,i){i===void 0&&(i="data-aria-hidden");var c=Array.from(Array.isArray(e)?e:[e]),d=KB(e);return d?(c.push.apply(c,Array.from(d.querySelectorAll("[aria-live], script"))),QB(c,d,i,"aria-hidden")):function(){return null}},vs=function(){return vs=Object.assign||function(r){for(var i,c=1,d=arguments.length;c<d;c++){i=arguments[c];for(var g in i)Object.prototype.hasOwnProperty.call(i,g)&&(r[g]=i[g])}return r},vs.apply(this,arguments)};function cI(e,r){var i={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&r.indexOf(c)<0&&(i[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)r.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(i[c[d]]=e[c[d]]);return i}function e6(e,r,i){if(i||arguments.length===2)for(var c=0,d=r.length,g;c<d;c++)(g||!(c in r))&&(g||(g=Array.prototype.slice.call(r,0,c)),g[c]=r[c]);return e.concat(g||Array.prototype.slice.call(r))}var Xg="right-scroll-bar-position",Kg="width-before-scroll-bar",t6="with-scroll-bars-hidden",r6="--removed-body-scroll-bar-size";function P0(e,r){return typeof e=="function"?e(r):e&&(e.current=r),e}function n6(e,r){var i=Y.useState(function(){return{value:e,callback:r,facade:{get current(){return i.value},set current(c){var d=i.value;d!==c&&(i.value=c,i.callback(c,d))}}}})[0];return i.callback=r,i.facade}var i6=typeof window<"u"?Y.useLayoutEffect:Y.useEffect,WT=new WeakMap;function o6(e,r){var i=n6(null,function(c){return e.forEach(function(d){return P0(d,c)})});return i6(function(){var c=WT.get(i);if(c){var d=new Set(c),g=new Set(e),m=i.current;d.forEach(function(l){g.has(l)||P0(l,null)}),g.forEach(function(l){d.has(l)||P0(l,m)})}WT.set(i,e)},[e]),i}function s6(e){return e}function a6(e,r){r===void 0&&(r=s6);var i=[],c=!1,d={read:function(){if(c)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return i.length?i[i.length-1]:e},useMedium:function(g){var m=r(g,c);return i.push(m),function(){i=i.filter(function(l){return l!==m})}},assignSyncMedium:function(g){for(c=!0;i.length;){var m=i;i=[],m.forEach(g)}i={push:function(l){return g(l)},filter:function(){return i}}},assignMedium:function(g){c=!0;var m=[];if(i.length){var l=i;i=[],l.forEach(g),m=i}var E=function(){var R=m;m=[],R.forEach(g)},P=function(){return Promise.resolve().then(E)};P(),i={push:function(R){m.push(R),P()},filter:function(R){return m=m.filter(R),i}}}};return d}function l6(e){e===void 0&&(e={});var r=a6(null);return r.options=vs({async:!0,ssr:!1},e),r}var uI=function(e){var r=e.sideCar,i=cI(e,["sideCar"]);if(!r)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var c=r.read();if(!c)throw new Error("Sidecar medium not found");return Y.createElement(c,vs({},i))};uI.isSideCarExport=!0;function c6(e,r){return e.useMedium(r),uI}var hI=l6(),E0=function(){},_y=Y.forwardRef(function(e,r){var i=Y.useRef(null),c=Y.useState({onScrollCapture:E0,onWheelCapture:E0,onTouchMoveCapture:E0}),d=c[0],g=c[1],m=e.forwardProps,l=e.children,E=e.className,P=e.removeScrollBar,R=e.enabled,N=e.shards,F=e.sideCar,A=e.noRelative,X=e.noIsolation,Z=e.inert,ee=e.allowPinchZoom,H=e.as,U=H===void 0?"div":H,W=e.gapMode,re=cI(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),ge=F,Te=o6([i,r]),xe=vs(vs({},re),d);return Y.createElement(Y.Fragment,null,R&&Y.createElement(ge,{sideCar:hI,removeScrollBar:P,shards:N,noRelative:A,noIsolation:X,inert:Z,setCallbacks:g,allowPinchZoom:!!ee,lockRef:i,gapMode:W}),m?Y.cloneElement(Y.Children.only(l),vs(vs({},xe),{ref:Te})):Y.createElement(U,vs({},xe,{className:E,ref:Te}),l))});_y.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};_y.classNames={fullWidth:Kg,zeroRight:Xg};var u6=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function h6(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var r=u6();return r&&e.setAttribute("nonce",r),e}function d6(e,r){e.styleSheet?e.styleSheet.cssText=r:e.appendChild(document.createTextNode(r))}function f6(e){var r=document.head||document.getElementsByTagName("head")[0];r.appendChild(e)}var p6=function(){var e=0,r=null;return{add:function(i){e==0&&(r=h6())&&(d6(r,i),f6(r)),e++},remove:function(){e--,!e&&r&&(r.parentNode&&r.parentNode.removeChild(r),r=null)}}},m6=function(){var e=p6();return function(r,i){Y.useEffect(function(){return e.add(r),function(){e.remove()}},[r&&i])}},dI=function(){var e=m6(),r=function(i){var c=i.styles,d=i.dynamic;return e(c,d),null};return r},g6={left:0,top:0,right:0,gap:0},M0=function(e){return parseInt(e||"",10)||0},_6=function(e){var r=window.getComputedStyle(document.body),i=r[e==="padding"?"paddingLeft":"marginLeft"],c=r[e==="padding"?"paddingTop":"marginTop"],d=r[e==="padding"?"paddingRight":"marginRight"];return[M0(i),M0(c),M0(d)]},y6=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return g6;var r=_6(e),i=document.documentElement.clientWidth,c=window.innerWidth;return{left:r[0],top:r[1],right:r[2],gap:Math.max(0,c-i+r[2]-r[0])}},v6=dI(),Sh="data-scroll-locked",x6=function(e,r,i,c){var d=e.left,g=e.top,m=e.right,l=e.gap;return i===void 0&&(i="margin"),`
  .`.concat(t6,` {
   overflow: hidden `).concat(c,`;
   padding-right: `).concat(l,"px ").concat(c,`;
  }
  body[`).concat(Sh,`] {
    overflow: hidden `).concat(c,`;
    overscroll-behavior: contain;
    `).concat([r&&"position: relative ".concat(c,";"),i==="margin"&&`
    padding-left: `.concat(d,`px;
    padding-top: `).concat(g,`px;
    padding-right: `).concat(m,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(c,`;
    `),i==="padding"&&"padding-right: ".concat(l,"px ").concat(c,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Xg,` {
    right: `).concat(l,"px ").concat(c,`;
  }
  
  .`).concat(Kg,` {
    margin-right: `).concat(l,"px ").concat(c,`;
  }
  
  .`).concat(Xg," .").concat(Xg,` {
    right: 0 `).concat(c,`;
  }
  
  .`).concat(Kg," .").concat(Kg,` {
    margin-right: 0 `).concat(c,`;
  }
  
  body[`).concat(Sh,`] {
    `).concat(r6,": ").concat(l,`px;
  }
`)},qT=function(){var e=parseInt(document.body.getAttribute(Sh)||"0",10);return isFinite(e)?e:0},b6=function(){Y.useEffect(function(){return document.body.setAttribute(Sh,(qT()+1).toString()),function(){var e=qT()-1;e<=0?document.body.removeAttribute(Sh):document.body.setAttribute(Sh,e.toString())}},[])},w6=function(e){var r=e.noRelative,i=e.noImportant,c=e.gapMode,d=c===void 0?"margin":c;b6();var g=Y.useMemo(function(){return y6(d)},[d]);return Y.createElement(v6,{styles:x6(g,!r,d,i?"":"!important")})},nb=!1;if(typeof window<"u")try{var Tg=Object.defineProperty({},"passive",{get:function(){return nb=!0,!0}});window.addEventListener("test",Tg,Tg),window.removeEventListener("test",Tg,Tg)}catch{nb=!1}var Ku=nb?{passive:!1}:!1,S6=function(e){return e.tagName==="TEXTAREA"},fI=function(e,r){if(!(e instanceof Element))return!1;var i=window.getComputedStyle(e);return i[r]!=="hidden"&&!(i.overflowY===i.overflowX&&!S6(e)&&i[r]==="visible")},T6=function(e){return fI(e,"overflowY")},C6=function(e){return fI(e,"overflowX")},XT=function(e,r){var i=r.ownerDocument,c=r;do{typeof ShadowRoot<"u"&&c instanceof ShadowRoot&&(c=c.host);var d=pI(e,c);if(d){var g=mI(e,c),m=g[1],l=g[2];if(m>l)return!0}c=c.parentNode}while(c&&c!==i.body);return!1},P6=function(e){var r=e.scrollTop,i=e.scrollHeight,c=e.clientHeight;return[r,i,c]},E6=function(e){var r=e.scrollLeft,i=e.scrollWidth,c=e.clientWidth;return[r,i,c]},pI=function(e,r){return e==="v"?T6(r):C6(r)},mI=function(e,r){return e==="v"?P6(r):E6(r)},M6=function(e,r){return e==="h"&&r==="rtl"?-1:1},k6=function(e,r,i,c,d){var g=M6(e,window.getComputedStyle(r).direction),m=g*c,l=i.target,E=r.contains(l),P=!1,R=m>0,N=0,F=0;do{if(!l)break;var A=mI(e,l),X=A[0],Z=A[1],ee=A[2],H=Z-ee-g*X;(X||H)&&pI(e,l)&&(N+=H,F+=X);var U=l.parentNode;l=U&&U.nodeType===Node.DOCUMENT_FRAGMENT_NODE?U.host:U}while(!E&&l!==document.body||E&&(r.contains(l)||r===l));return(R&&Math.abs(N)<1||!R&&Math.abs(F)<1)&&(P=!0),P},Cg=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},KT=function(e){return[e.deltaX,e.deltaY]},YT=function(e){return e&&"current"in e?e.current:e},I6=function(e,r){return e[0]===r[0]&&e[1]===r[1]},A6=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},z6=0,Yu=[];function R6(e){var r=Y.useRef([]),i=Y.useRef([0,0]),c=Y.useRef(),d=Y.useState(z6++)[0],g=Y.useState(dI)[0],m=Y.useRef(e);Y.useEffect(function(){m.current=e},[e]),Y.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(d));var Z=e6([e.lockRef.current],(e.shards||[]).map(YT),!0).filter(Boolean);return Z.forEach(function(ee){return ee.classList.add("allow-interactivity-".concat(d))}),function(){document.body.classList.remove("block-interactivity-".concat(d)),Z.forEach(function(ee){return ee.classList.remove("allow-interactivity-".concat(d))})}}},[e.inert,e.lockRef.current,e.shards]);var l=Y.useCallback(function(Z,ee){if("touches"in Z&&Z.touches.length===2||Z.type==="wheel"&&Z.ctrlKey)return!m.current.allowPinchZoom;var H=Cg(Z),U=i.current,W="deltaX"in Z?Z.deltaX:U[0]-H[0],re="deltaY"in Z?Z.deltaY:U[1]-H[1],ge,Te=Z.target,xe=Math.abs(W)>Math.abs(re)?"h":"v";if("touches"in Z&&xe==="h"&&Te.type==="range")return!1;var ze=XT(xe,Te);if(!ze)return!0;if(ze?ge=xe:(ge=xe==="v"?"h":"v",ze=XT(xe,Te)),!ze)return!1;if(!c.current&&"changedTouches"in Z&&(W||re)&&(c.current=ge),!ge)return!0;var Ne=c.current||ge;return k6(Ne,ee,Z,Ne==="h"?W:re)},[]),E=Y.useCallback(function(Z){var ee=Z;if(!(!Yu.length||Yu[Yu.length-1]!==g)){var H="deltaY"in ee?KT(ee):Cg(ee),U=r.current.filter(function(ge){return ge.name===ee.type&&(ge.target===ee.target||ee.target===ge.shadowParent)&&I6(ge.delta,H)})[0];if(U&&U.should){ee.cancelable&&ee.preventDefault();return}if(!U){var W=(m.current.shards||[]).map(YT).filter(Boolean).filter(function(ge){return ge.contains(ee.target)}),re=W.length>0?l(ee,W[0]):!m.current.noIsolation;re&&ee.cancelable&&ee.preventDefault()}}},[]),P=Y.useCallback(function(Z,ee,H,U){var W={name:Z,delta:ee,target:H,should:U,shadowParent:D6(H)};r.current.push(W),setTimeout(function(){r.current=r.current.filter(function(re){return re!==W})},1)},[]),R=Y.useCallback(function(Z){i.current=Cg(Z),c.current=void 0},[]),N=Y.useCallback(function(Z){P(Z.type,KT(Z),Z.target,l(Z,e.lockRef.current))},[]),F=Y.useCallback(function(Z){P(Z.type,Cg(Z),Z.target,l(Z,e.lockRef.current))},[]);Y.useEffect(function(){return Yu.push(g),e.setCallbacks({onScrollCapture:N,onWheelCapture:N,onTouchMoveCapture:F}),document.addEventListener("wheel",E,Ku),document.addEventListener("touchmove",E,Ku),document.addEventListener("touchstart",R,Ku),function(){Yu=Yu.filter(function(Z){return Z!==g}),document.removeEventListener("wheel",E,Ku),document.removeEventListener("touchmove",E,Ku),document.removeEventListener("touchstart",R,Ku)}},[]);var A=e.removeScrollBar,X=e.inert;return Y.createElement(Y.Fragment,null,X?Y.createElement(g,{styles:A6(d)}):null,A?Y.createElement(w6,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function D6(e){for(var r=null;e!==null;)e instanceof ShadowRoot&&(r=e.host,e=e.host),e=e.parentNode;return r}const L6=c6(hI,R6);var gI=Y.forwardRef(function(e,r){return Y.createElement(_y,vs({},e,{ref:r,sideCar:L6}))});gI.classNames=_y.classNames;var O6=[" ","Enter","ArrowUp","ArrowDown"],F6=[" ","Enter"],Vc="Select",[yy,vy,N6]=hM(Vc),[Yh,yU]=Ip(Vc,[N6,ly]),xy=ly(),[B6,El]=Yh(Vc),[j6,$6]=Yh(Vc),_I=e=>{const{__scopeSelect:r,children:i,open:c,defaultOpen:d,onOpenChange:g,value:m,defaultValue:l,onValueChange:E,dir:P,name:R,autoComplete:N,disabled:F,required:A,form:X}=e,Z=xy(r),[ee,H]=Y.useState(null),[U,W]=Y.useState(null),[re,ge]=Y.useState(!1),Te=jB(P),[xe,ze]=Fx({prop:c,defaultProp:d??!1,onChange:g,caller:Vc}),[Ne,Ie]=Fx({prop:m,defaultProp:l,onChange:E,caller:Vc}),$e=Y.useRef(null),et=ee?X||!!ee.closest("form"):!0,[ot,qe]=Y.useState(new Set),ht=Array.from(ot).map(dt=>dt.props.value).join(";");return ye.jsx(XF,{...Z,children:ye.jsxs(B6,{required:A,scope:r,trigger:ee,onTriggerChange:H,valueNode:U,onValueNodeChange:W,valueNodeHasChildren:re,onValueNodeHasChildrenChange:ge,contentId:xw(),value:Ne,onValueChange:Ie,open:xe,onOpenChange:ze,dir:Te,triggerPointerDownPosRef:$e,disabled:F,children:[ye.jsx(yy.Provider,{scope:r,children:ye.jsx(j6,{scope:e.__scopeSelect,onNativeOptionAdd:Y.useCallback(dt=>{qe(wt=>new Set(wt).add(dt))},[]),onNativeOptionRemove:Y.useCallback(dt=>{qe(wt=>{const Ze=new Set(wt);return Ze.delete(dt),Ze})},[]),children:i})}),et?ye.jsxs($I,{"aria-hidden":!0,required:A,tabIndex:-1,name:R,autoComplete:N,value:Ne,onChange:dt=>Ie(dt.target.value),disabled:F,form:X,children:[Ne===void 0?ye.jsx("option",{value:""}):null,Array.from(ot)]},ht):null]})})};_I.displayName=Vc;var yI="SelectTrigger",vI=Y.forwardRef((e,r)=>{const{__scopeSelect:i,disabled:c=!1,...d}=e,g=xy(i),m=El(yI,i),l=m.disabled||c,E=on(r,m.onTriggerChange),P=vy(i),R=Y.useRef("touch"),[N,F,A]=VI(Z=>{const ee=P().filter(W=>!W.disabled),H=ee.find(W=>W.value===m.value),U=ZI(ee,Z,H);U!==void 0&&m.onValueChange(U.value)}),X=Z=>{l||(m.onOpenChange(!0),A()),Z&&(m.triggerPointerDownPosRef.current={x:Math.round(Z.pageX),y:Math.round(Z.pageY)})};return ye.jsx(yk,{asChild:!0,...g,children:ye.jsx(wr.button,{type:"button",role:"combobox","aria-controls":m.contentId,"aria-expanded":m.open,"aria-required":m.required,"aria-autocomplete":"none",dir:m.dir,"data-state":m.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":UI(m.value)?"":void 0,...d,ref:E,onClick:ar(d.onClick,Z=>{Z.currentTarget.focus(),R.current!=="mouse"&&X(Z)}),onPointerDown:ar(d.onPointerDown,Z=>{R.current=Z.pointerType;const ee=Z.target;ee.hasPointerCapture(Z.pointerId)&&ee.releasePointerCapture(Z.pointerId),Z.button===0&&Z.ctrlKey===!1&&Z.pointerType==="mouse"&&(X(Z),Z.preventDefault())}),onKeyDown:ar(d.onKeyDown,Z=>{const ee=N.current!=="";!(Z.ctrlKey||Z.altKey||Z.metaKey)&&Z.key.length===1&&F(Z.key),!(ee&&Z.key===" ")&&O6.includes(Z.key)&&(X(),Z.preventDefault())})})})});vI.displayName=yI;var xI="SelectValue",bI=Y.forwardRef((e,r)=>{const{__scopeSelect:i,className:c,style:d,children:g,placeholder:m="",...l}=e,E=El(xI,i),{onValueNodeHasChildrenChange:P}=E,R=g!==void 0,N=on(r,E.onValueNodeChange);return Kn(()=>{P(R)},[P,R]),ye.jsx(wr.span,{...l,ref:N,style:{pointerEvents:"none"},children:UI(E.value)?ye.jsx(ye.Fragment,{children:m}):g})});bI.displayName=xI;var U6="SelectIcon",wI=Y.forwardRef((e,r)=>{const{__scopeSelect:i,children:c,...d}=e;return ye.jsx(wr.span,{"aria-hidden":!0,...d,ref:r,children:c||""})});wI.displayName=U6;var V6="SelectPortal",SI=e=>ye.jsx(pw,{asChild:!0,...e});SI.displayName=V6;var Zc="SelectContent",TI=Y.forwardRef((e,r)=>{const i=El(Zc,e.__scopeSelect),[c,d]=Y.useState();if(Kn(()=>{d(new DocumentFragment)},[]),!i.open){const g=c;return g?Kc.createPortal(ye.jsx(CI,{scope:e.__scopeSelect,children:ye.jsx(yy.Slot,{scope:e.__scopeSelect,children:ye.jsx("div",{children:e.children})})}),g):null}return ye.jsx(PI,{...e,ref:r})});TI.displayName=Zc;var Fo=10,[CI,Ml]=Yh(Zc),Z6="SelectContentImpl",G6=ap("SelectContent.RemoveScroll"),PI=Y.forwardRef((e,r)=>{const{__scopeSelect:i,position:c="item-aligned",onCloseAutoFocus:d,onEscapeKeyDown:g,onPointerDownOutside:m,side:l,sideOffset:E,align:P,alignOffset:R,arrowPadding:N,collisionBoundary:F,collisionPadding:A,sticky:X,hideWhenDetached:Z,avoidCollisions:ee,...H}=e,U=El(Zc,i),[W,re]=Y.useState(null),[ge,Te]=Y.useState(null),xe=on(r,gt=>re(gt)),[ze,Ne]=Y.useState(null),[Ie,$e]=Y.useState(null),et=vy(i),[ot,qe]=Y.useState(!1),ht=Y.useRef(!1);Y.useEffect(()=>{if(W)return JB(W)},[W]),$B();const dt=Y.useCallback(gt=>{const[sr,...Vt]=et().map(Qt=>Qt.ref.current),[tr]=Vt.slice(-1),Dt=document.activeElement;for(const Qt of gt)if(Qt===Dt||(Qt==null||Qt.scrollIntoView({block:"nearest"}),Qt===sr&&ge&&(ge.scrollTop=0),Qt===tr&&ge&&(ge.scrollTop=ge.scrollHeight),Qt==null||Qt.focus(),document.activeElement!==Dt))return},[et,ge]),wt=Y.useCallback(()=>dt([ze,W]),[dt,ze,W]);Y.useEffect(()=>{ot&&wt()},[ot,wt]);const{onOpenChange:Ze,triggerPointerDownPosRef:He}=U;Y.useEffect(()=>{if(W){let gt={x:0,y:0};const sr=tr=>{var Dt,Qt;gt={x:Math.abs(Math.round(tr.pageX)-(((Dt=He.current)==null?void 0:Dt.x)??0)),y:Math.abs(Math.round(tr.pageY)-(((Qt=He.current)==null?void 0:Qt.y)??0))}},Vt=tr=>{gt.x<=10&&gt.y<=10?tr.preventDefault():W.contains(tr.target)||Ze(!1),document.removeEventListener("pointermove",sr),He.current=null};return He.current!==null&&(document.addEventListener("pointermove",sr),document.addEventListener("pointerup",Vt,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",sr),document.removeEventListener("pointerup",Vt,{capture:!0})}}},[W,Ze,He]),Y.useEffect(()=>{const gt=()=>Ze(!1);return window.addEventListener("blur",gt),window.addEventListener("resize",gt),()=>{window.removeEventListener("blur",gt),window.removeEventListener("resize",gt)}},[Ze]);const[pt,Ct]=VI(gt=>{const sr=et().filter(Dt=>!Dt.disabled),Vt=sr.find(Dt=>Dt.ref.current===document.activeElement),tr=ZI(sr,gt,Vt);tr&&setTimeout(()=>tr.ref.current.focus())}),ut=Y.useCallback((gt,sr,Vt)=>{const tr=!ht.current&&!Vt;(U.value!==void 0&&U.value===sr||tr)&&(Ne(gt),tr&&(ht.current=!0))},[U.value]),At=Y.useCallback(()=>W==null?void 0:W.focus(),[W]),kt=Y.useCallback((gt,sr,Vt)=>{const tr=!ht.current&&!Vt;(U.value!==void 0&&U.value===sr||tr)&&$e(gt)},[U.value]),nr=c==="popper"?ib:EI,dr=nr===ib?{side:l,sideOffset:E,align:P,alignOffset:R,arrowPadding:N,collisionBoundary:F,collisionPadding:A,sticky:X,hideWhenDetached:Z,avoidCollisions:ee}:{};return ye.jsx(CI,{scope:i,content:W,viewport:ge,onViewportChange:Te,itemRefCallback:ut,selectedItem:ze,onItemLeave:At,itemTextRefCallback:kt,focusSelectedItem:wt,selectedItemText:Ie,position:c,isPositioned:ot,searchRef:pt,children:ye.jsx(gI,{as:G6,allowPinchZoom:!0,children:ye.jsx(sI,{asChild:!0,trapped:U.open,onMountAutoFocus:gt=>{gt.preventDefault()},onUnmountAutoFocus:ar(d,gt=>{var sr;(sr=U.trigger)==null||sr.focus({preventScroll:!0}),gt.preventDefault()}),children:ye.jsx(ry,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:g,onPointerDownOutside:m,onFocusOutside:gt=>gt.preventDefault(),onDismiss:()=>U.onOpenChange(!1),children:ye.jsx(nr,{role:"listbox",id:U.contentId,"data-state":U.open?"open":"closed",dir:U.dir,onContextMenu:gt=>gt.preventDefault(),...H,...dr,onPlaced:()=>qe(!0),ref:xe,style:{display:"flex",flexDirection:"column",outline:"none",...H.style},onKeyDown:ar(H.onKeyDown,gt=>{const sr=gt.ctrlKey||gt.altKey||gt.metaKey;if(gt.key==="Tab"&&gt.preventDefault(),!sr&&gt.key.length===1&&Ct(gt.key),["ArrowUp","ArrowDown","Home","End"].includes(gt.key)){let tr=et().filter(Dt=>!Dt.disabled).map(Dt=>Dt.ref.current);if(["ArrowUp","End"].includes(gt.key)&&(tr=tr.slice().reverse()),["ArrowUp","ArrowDown"].includes(gt.key)){const Dt=gt.target,Qt=tr.indexOf(Dt);tr=tr.slice(Qt+1)}setTimeout(()=>dt(tr)),gt.preventDefault()}})})})})})})});PI.displayName=Z6;var H6="SelectItemAlignedPosition",EI=Y.forwardRef((e,r)=>{const{__scopeSelect:i,onPlaced:c,...d}=e,g=El(Zc,i),m=Ml(Zc,i),[l,E]=Y.useState(null),[P,R]=Y.useState(null),N=on(r,xe=>R(xe)),F=vy(i),A=Y.useRef(!1),X=Y.useRef(!0),{viewport:Z,selectedItem:ee,selectedItemText:H,focusSelectedItem:U}=m,W=Y.useCallback(()=>{if(g.trigger&&g.valueNode&&l&&P&&Z&&ee&&H){const xe=g.trigger.getBoundingClientRect(),ze=P.getBoundingClientRect(),Ne=g.valueNode.getBoundingClientRect(),Ie=H.getBoundingClientRect();if(g.dir!=="rtl"){const Dt=Ie.left-ze.left,Qt=Ne.left-Dt,Gt=xe.left-Qt,Rr=xe.width+Gt,Yr=Math.max(Rr,ze.width),Nn=window.innerWidth-Fo,Sr=$T(Qt,[Fo,Math.max(Fo,Nn-Yr)]);l.style.minWidth=Rr+"px",l.style.left=Sr+"px"}else{const Dt=ze.right-Ie.right,Qt=window.innerWidth-Ne.right-Dt,Gt=window.innerWidth-xe.right-Qt,Rr=xe.width+Gt,Yr=Math.max(Rr,ze.width),Nn=window.innerWidth-Fo,Sr=$T(Qt,[Fo,Math.max(Fo,Nn-Yr)]);l.style.minWidth=Rr+"px",l.style.right=Sr+"px"}const $e=F(),et=window.innerHeight-Fo*2,ot=Z.scrollHeight,qe=window.getComputedStyle(P),ht=parseInt(qe.borderTopWidth,10),dt=parseInt(qe.paddingTop,10),wt=parseInt(qe.borderBottomWidth,10),Ze=parseInt(qe.paddingBottom,10),He=ht+dt+ot+Ze+wt,pt=Math.min(ee.offsetHeight*5,He),Ct=window.getComputedStyle(Z),ut=parseInt(Ct.paddingTop,10),At=parseInt(Ct.paddingBottom,10),kt=xe.top+xe.height/2-Fo,nr=et-kt,dr=ee.offsetHeight/2,gt=ee.offsetTop+dr,sr=ht+dt+gt,Vt=He-sr;if(sr<=kt){const Dt=$e.length>0&&ee===$e[$e.length-1].ref.current;l.style.bottom="0px";const Qt=P.clientHeight-Z.offsetTop-Z.offsetHeight,Gt=Math.max(nr,dr+(Dt?At:0)+Qt+wt),Rr=sr+Gt;l.style.height=Rr+"px"}else{const Dt=$e.length>0&&ee===$e[0].ref.current;l.style.top="0px";const Gt=Math.max(kt,ht+Z.offsetTop+(Dt?ut:0)+dr)+Vt;l.style.height=Gt+"px",Z.scrollTop=sr-kt+Z.offsetTop}l.style.margin=`${Fo}px 0`,l.style.minHeight=pt+"px",l.style.maxHeight=et+"px",c==null||c(),requestAnimationFrame(()=>A.current=!0)}},[F,g.trigger,g.valueNode,l,P,Z,ee,H,g.dir,c]);Kn(()=>W(),[W]);const[re,ge]=Y.useState();Kn(()=>{P&&ge(window.getComputedStyle(P).zIndex)},[P]);const Te=Y.useCallback(xe=>{xe&&X.current===!0&&(W(),U==null||U(),X.current=!1)},[W,U]);return ye.jsx(q6,{scope:i,contentWrapper:l,shouldExpandOnScrollRef:A,onScrollButtonChange:Te,children:ye.jsx("div",{ref:E,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:re},children:ye.jsx(wr.div,{...d,ref:N,style:{boxSizing:"border-box",maxHeight:"100%",...d.style}})})})});EI.displayName=H6;var W6="SelectPopperPosition",ib=Y.forwardRef((e,r)=>{const{__scopeSelect:i,align:c="start",collisionPadding:d=Fo,...g}=e,m=xy(i);return ye.jsx(vk,{...m,...g,ref:r,align:c,collisionPadding:d,style:{boxSizing:"border-box",...g.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});ib.displayName=W6;var[q6,Nw]=Yh(Zc,{}),ob="SelectViewport",MI=Y.forwardRef((e,r)=>{const{__scopeSelect:i,nonce:c,...d}=e,g=Ml(ob,i),m=Nw(ob,i),l=on(r,g.onViewportChange),E=Y.useRef(0);return ye.jsxs(ye.Fragment,{children:[ye.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:c}),ye.jsx(yy.Slot,{scope:i,children:ye.jsx(wr.div,{"data-radix-select-viewport":"",role:"presentation",...d,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...d.style},onScroll:ar(d.onScroll,P=>{const R=P.currentTarget,{contentWrapper:N,shouldExpandOnScrollRef:F}=m;if(F!=null&&F.current&&N){const A=Math.abs(E.current-R.scrollTop);if(A>0){const X=window.innerHeight-Fo*2,Z=parseFloat(N.style.minHeight),ee=parseFloat(N.style.height),H=Math.max(Z,ee);if(H<X){const U=H+A,W=Math.min(X,U),re=U-W;N.style.height=W+"px",N.style.bottom==="0px"&&(R.scrollTop=re>0?re:0,N.style.justifyContent="flex-end")}}}E.current=R.scrollTop})})})]})});MI.displayName=ob;var kI="SelectGroup",[X6,K6]=Yh(kI),Y6=Y.forwardRef((e,r)=>{const{__scopeSelect:i,...c}=e,d=xw();return ye.jsx(X6,{scope:i,id:d,children:ye.jsx(wr.div,{role:"group","aria-labelledby":d,...c,ref:r})})});Y6.displayName=kI;var II="SelectLabel",AI=Y.forwardRef((e,r)=>{const{__scopeSelect:i,...c}=e,d=K6(II,i);return ye.jsx(wr.div,{id:d.id,...c,ref:r})});AI.displayName=II;var L_="SelectItem",[Q6,zI]=Yh(L_),RI=Y.forwardRef((e,r)=>{const{__scopeSelect:i,value:c,disabled:d=!1,textValue:g,...m}=e,l=El(L_,i),E=Ml(L_,i),P=l.value===c,[R,N]=Y.useState(g??""),[F,A]=Y.useState(!1),X=on(r,U=>{var W;return(W=E.itemRefCallback)==null?void 0:W.call(E,U,c,d)}),Z=xw(),ee=Y.useRef("touch"),H=()=>{d||(l.onValueChange(c),l.onOpenChange(!1))};if(c==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return ye.jsx(Q6,{scope:i,value:c,disabled:d,textId:Z,isSelected:P,onItemTextChange:Y.useCallback(U=>{N(W=>W||((U==null?void 0:U.textContent)??"").trim())},[]),children:ye.jsx(yy.ItemSlot,{scope:i,value:c,disabled:d,textValue:R,children:ye.jsx(wr.div,{role:"option","aria-labelledby":Z,"data-highlighted":F?"":void 0,"aria-selected":P&&F,"data-state":P?"checked":"unchecked","aria-disabled":d||void 0,"data-disabled":d?"":void 0,tabIndex:d?void 0:-1,...m,ref:X,onFocus:ar(m.onFocus,()=>A(!0)),onBlur:ar(m.onBlur,()=>A(!1)),onClick:ar(m.onClick,()=>{ee.current!=="mouse"&&H()}),onPointerUp:ar(m.onPointerUp,()=>{ee.current==="mouse"&&H()}),onPointerDown:ar(m.onPointerDown,U=>{ee.current=U.pointerType}),onPointerMove:ar(m.onPointerMove,U=>{var W;ee.current=U.pointerType,d?(W=E.onItemLeave)==null||W.call(E):ee.current==="mouse"&&U.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ar(m.onPointerLeave,U=>{var W;U.currentTarget===document.activeElement&&((W=E.onItemLeave)==null||W.call(E))}),onKeyDown:ar(m.onKeyDown,U=>{var re;((re=E.searchRef)==null?void 0:re.current)!==""&&U.key===" "||(F6.includes(U.key)&&H(),U.key===" "&&U.preventDefault())})})})})});RI.displayName=L_;var Mf="SelectItemText",DI=Y.forwardRef((e,r)=>{const{__scopeSelect:i,className:c,style:d,...g}=e,m=El(Mf,i),l=Ml(Mf,i),E=zI(Mf,i),P=$6(Mf,i),[R,N]=Y.useState(null),F=on(r,H=>N(H),E.onItemTextChange,H=>{var U;return(U=l.itemTextRefCallback)==null?void 0:U.call(l,H,E.value,E.disabled)}),A=R==null?void 0:R.textContent,X=Y.useMemo(()=>ye.jsx("option",{value:E.value,disabled:E.disabled,children:A},E.value),[E.disabled,E.value,A]),{onNativeOptionAdd:Z,onNativeOptionRemove:ee}=P;return Kn(()=>(Z(X),()=>ee(X)),[Z,ee,X]),ye.jsxs(ye.Fragment,{children:[ye.jsx(wr.span,{id:E.textId,...g,ref:F}),E.isSelected&&m.valueNode&&!m.valueNodeHasChildren?Kc.createPortal(g.children,m.valueNode):null]})});DI.displayName=Mf;var LI="SelectItemIndicator",OI=Y.forwardRef((e,r)=>{const{__scopeSelect:i,...c}=e;return zI(LI,i).isSelected?ye.jsx(wr.span,{"aria-hidden":!0,...c,ref:r}):null});OI.displayName=LI;var sb="SelectScrollUpButton",FI=Y.forwardRef((e,r)=>{const i=Ml(sb,e.__scopeSelect),c=Nw(sb,e.__scopeSelect),[d,g]=Y.useState(!1),m=on(r,c.onScrollButtonChange);return Kn(()=>{if(i.viewport&&i.isPositioned){let l=function(){const P=E.scrollTop>0;g(P)};const E=i.viewport;return l(),E.addEventListener("scroll",l),()=>E.removeEventListener("scroll",l)}},[i.viewport,i.isPositioned]),d?ye.jsx(BI,{...e,ref:m,onAutoScroll:()=>{const{viewport:l,selectedItem:E}=i;l&&E&&(l.scrollTop=l.scrollTop-E.offsetHeight)}}):null});FI.displayName=sb;var ab="SelectScrollDownButton",NI=Y.forwardRef((e,r)=>{const i=Ml(ab,e.__scopeSelect),c=Nw(ab,e.__scopeSelect),[d,g]=Y.useState(!1),m=on(r,c.onScrollButtonChange);return Kn(()=>{if(i.viewport&&i.isPositioned){let l=function(){const P=E.scrollHeight-E.clientHeight,R=Math.ceil(E.scrollTop)<P;g(R)};const E=i.viewport;return l(),E.addEventListener("scroll",l),()=>E.removeEventListener("scroll",l)}},[i.viewport,i.isPositioned]),d?ye.jsx(BI,{...e,ref:m,onAutoScroll:()=>{const{viewport:l,selectedItem:E}=i;l&&E&&(l.scrollTop=l.scrollTop+E.offsetHeight)}}):null});NI.displayName=ab;var BI=Y.forwardRef((e,r)=>{const{__scopeSelect:i,onAutoScroll:c,...d}=e,g=Ml("SelectScrollButton",i),m=Y.useRef(null),l=vy(i),E=Y.useCallback(()=>{m.current!==null&&(window.clearInterval(m.current),m.current=null)},[]);return Y.useEffect(()=>()=>E(),[E]),Kn(()=>{var R;const P=l().find(N=>N.ref.current===document.activeElement);(R=P==null?void 0:P.ref.current)==null||R.scrollIntoView({block:"nearest"})},[l]),ye.jsx(wr.div,{"aria-hidden":!0,...d,ref:r,style:{flexShrink:0,...d.style},onPointerDown:ar(d.onPointerDown,()=>{m.current===null&&(m.current=window.setInterval(c,50))}),onPointerMove:ar(d.onPointerMove,()=>{var P;(P=g.onItemLeave)==null||P.call(g),m.current===null&&(m.current=window.setInterval(c,50))}),onPointerLeave:ar(d.onPointerLeave,()=>{E()})})}),J6="SelectSeparator",jI=Y.forwardRef((e,r)=>{const{__scopeSelect:i,...c}=e;return ye.jsx(wr.div,{"aria-hidden":!0,...c,ref:r})});jI.displayName=J6;var lb="SelectArrow",ej=Y.forwardRef((e,r)=>{const{__scopeSelect:i,...c}=e,d=xy(i),g=El(lb,i),m=Ml(lb,i);return g.open&&m.position==="popper"?ye.jsx(xk,{...d,...c,ref:r}):null});ej.displayName=lb;var tj="SelectBubbleInput",$I=Y.forwardRef(({__scopeSelect:e,value:r,...i},c)=>{const d=Y.useRef(null),g=on(c,d),m=XB(r);return Y.useEffect(()=>{const l=d.current;if(!l)return;const E=window.HTMLSelectElement.prototype,R=Object.getOwnPropertyDescriptor(E,"value").set;if(m!==r&&R){const N=new Event("change",{bubbles:!0});R.call(l,r),l.dispatchEvent(N)}},[m,r]),ye.jsx(wr.select,{...i,style:{...gM,...i.style},ref:g,defaultValue:r})});$I.displayName=tj;function UI(e){return e===""||e===void 0}function VI(e){const r=qo(e),i=Y.useRef(""),c=Y.useRef(0),d=Y.useCallback(m=>{const l=i.current+m;r(l),function E(P){i.current=P,window.clearTimeout(c.current),P!==""&&(c.current=window.setTimeout(()=>E(""),1e3))}(l)},[r]),g=Y.useCallback(()=>{i.current="",window.clearTimeout(c.current)},[]);return Y.useEffect(()=>()=>window.clearTimeout(c.current),[]),[i,d,g]}function ZI(e,r,i){const d=r.length>1&&Array.from(r).every(P=>P===r[0])?r[0]:r,g=i?e.indexOf(i):-1;let m=rj(e,Math.max(g,0));d.length===1&&(m=m.filter(P=>P!==i));const E=m.find(P=>P.textValue.toLowerCase().startsWith(d.toLowerCase()));return E!==i?E:void 0}function rj(e,r){return e.map((i,c)=>e[(r+c)%e.length])}var nj=_I,GI=vI,ij=bI,oj=wI,sj=SI,HI=TI,aj=MI,WI=AI,qI=RI,lj=DI,cj=OI,XI=FI,KI=NI,YI=jI;const uj=nj,hj=ij,QI=Y.forwardRef(({className:e,children:r,...i},c)=>ye.jsxs(GI,{ref:c,className:Kr("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...i,children:[r,ye.jsx(oj,{asChild:!0,children:ye.jsx(jM,{className:"h-4 w-4 opacity-50"})})]}));QI.displayName=GI.displayName;const JI=Y.forwardRef(({className:e,...r},i)=>ye.jsx(XI,{ref:i,className:Kr("flex cursor-default items-center justify-center py-1",e),...r,children:ye.jsx(c5,{className:"h-4 w-4"})}));JI.displayName=XI.displayName;const eA=Y.forwardRef(({className:e,...r},i)=>ye.jsx(KI,{ref:i,className:Kr("flex cursor-default items-center justify-center py-1",e),...r,children:ye.jsx(jM,{className:"h-4 w-4"})}));eA.displayName=KI.displayName;const tA=Y.forwardRef(({className:e,children:r,position:i="popper",...c},d)=>ye.jsx(sj,{children:ye.jsxs(HI,{ref:d,className:Kr("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",i==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:i,...c,children:[ye.jsx(JI,{}),ye.jsx(aj,{className:Kr("p-1",i==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),ye.jsx(eA,{})]})}));tA.displayName=HI.displayName;const dj=Y.forwardRef(({className:e,...r},i)=>ye.jsx(WI,{ref:i,className:Kr("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...r}));dj.displayName=WI.displayName;const rA=Y.forwardRef(({className:e,children:r,...i},c)=>ye.jsxs(qI,{ref:c,className:Kr("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...i,children:[ye.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:ye.jsx(cj,{children:ye.jsx(l5,{className:"h-4 w-4"})})}),ye.jsx(lj,{children:r})]}));rA.displayName=qI.displayName;const fj=Y.forwardRef(({className:e,...r},i)=>ye.jsx(YI,{ref:i,className:Kr("-mx-1 my-1 h-px bg-muted",e),...r}));fj.displayName=YI.displayName;const nA={"median-sale-price":"Median Sale Price","median-list-price":"Median List Price","median-dom":"Median Days on Market",inventory:"Inventory","new-listings":"New Listings","homes-sold":"Homes Sold","sale-to-list-ratio":"Sale-to-List Price Ratio","homes-sold-above-list":"% Homes Sold Above List","off-market-2-weeks":"% Off-Market in 2 Weeks"};function QT({selectedMetric:e,onMetricChange:r}){return ye.jsxs("div",{className:"bg-dashboard-panel border border-dashboard-border rounded-lg p-3 shadow-sm",children:[ye.jsx("label",{className:"block text-sm font-medium text-dashboard-text-secondary mb-2",children:"Visualization Metric"}),ye.jsxs(uj,{value:e,onValueChange:r,children:[ye.jsx(QI,{className:"w-64","aria-label":"Select visualization metric",children:ye.jsx(hj,{placeholder:"Select a metric"})}),ye.jsx(tA,{className:"z-[9999]",children:Object.entries(nA).map(([i,c])=>ye.jsx(rA,{value:i,children:c},i))})]})]})}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const pj=4,JT=0,eC=1,mj=2;function Qh(e){let r=e.length;for(;--r>=0;)e[r]=0}const gj=0,iA=1,_j=2,yj=3,vj=258,Bw=29,Dp=256,mp=Dp+1+Bw,Th=30,jw=19,oA=2*mp+1,Cc=15,k0=16,xj=7,$w=256,sA=16,aA=17,lA=18,cb=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Yg=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),bj=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),cA=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),wj=512,Qs=new Array((mp+2)*2);Qh(Qs);const $f=new Array(Th*2);Qh($f);const gp=new Array(wj);Qh(gp);const _p=new Array(vj-yj+1);Qh(_p);const Uw=new Array(Bw);Qh(Uw);const O_=new Array(Th);Qh(O_);function I0(e,r,i,c,d){this.static_tree=e,this.extra_bits=r,this.extra_base=i,this.elems=c,this.max_length=d,this.has_stree=e&&e.length}let uA,hA,dA;function A0(e,r){this.dyn_tree=e,this.max_code=0,this.stat_desc=r}const fA=e=>e<256?gp[e]:gp[256+(e>>>7)],yp=(e,r)=>{e.pending_buf[e.pending++]=r&255,e.pending_buf[e.pending++]=r>>>8&255},zi=(e,r,i)=>{e.bi_valid>k0-i?(e.bi_buf|=r<<e.bi_valid&65535,yp(e,e.bi_buf),e.bi_buf=r>>k0-e.bi_valid,e.bi_valid+=i-k0):(e.bi_buf|=r<<e.bi_valid&65535,e.bi_valid+=i)},xs=(e,r,i)=>{zi(e,i[r*2],i[r*2+1])},pA=(e,r)=>{let i=0;do i|=e&1,e>>>=1,i<<=1;while(--r>0);return i>>>1},Sj=e=>{e.bi_valid===16?(yp(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},Tj=(e,r)=>{const i=r.dyn_tree,c=r.max_code,d=r.stat_desc.static_tree,g=r.stat_desc.has_stree,m=r.stat_desc.extra_bits,l=r.stat_desc.extra_base,E=r.stat_desc.max_length;let P,R,N,F,A,X,Z=0;for(F=0;F<=Cc;F++)e.bl_count[F]=0;for(i[e.heap[e.heap_max]*2+1]=0,P=e.heap_max+1;P<oA;P++)R=e.heap[P],F=i[i[R*2+1]*2+1]+1,F>E&&(F=E,Z++),i[R*2+1]=F,!(R>c)&&(e.bl_count[F]++,A=0,R>=l&&(A=m[R-l]),X=i[R*2],e.opt_len+=X*(F+A),g&&(e.static_len+=X*(d[R*2+1]+A)));if(Z!==0){do{for(F=E-1;e.bl_count[F]===0;)F--;e.bl_count[F]--,e.bl_count[F+1]+=2,e.bl_count[E]--,Z-=2}while(Z>0);for(F=E;F!==0;F--)for(R=e.bl_count[F];R!==0;)N=e.heap[--P],!(N>c)&&(i[N*2+1]!==F&&(e.opt_len+=(F-i[N*2+1])*i[N*2],i[N*2+1]=F),R--)}},mA=(e,r,i)=>{const c=new Array(Cc+1);let d=0,g,m;for(g=1;g<=Cc;g++)d=d+i[g-1]<<1,c[g]=d;for(m=0;m<=r;m++){let l=e[m*2+1];l!==0&&(e[m*2]=pA(c[l]++,l))}},Cj=()=>{let e,r,i,c,d;const g=new Array(Cc+1);for(i=0,c=0;c<Bw-1;c++)for(Uw[c]=i,e=0;e<1<<cb[c];e++)_p[i++]=c;for(_p[i-1]=c,d=0,c=0;c<16;c++)for(O_[c]=d,e=0;e<1<<Yg[c];e++)gp[d++]=c;for(d>>=7;c<Th;c++)for(O_[c]=d<<7,e=0;e<1<<Yg[c]-7;e++)gp[256+d++]=c;for(r=0;r<=Cc;r++)g[r]=0;for(e=0;e<=143;)Qs[e*2+1]=8,e++,g[8]++;for(;e<=255;)Qs[e*2+1]=9,e++,g[9]++;for(;e<=279;)Qs[e*2+1]=7,e++,g[7]++;for(;e<=287;)Qs[e*2+1]=8,e++,g[8]++;for(mA(Qs,mp+1,g),e=0;e<Th;e++)$f[e*2+1]=5,$f[e*2]=pA(e,5);uA=new I0(Qs,cb,Dp+1,mp,Cc),hA=new I0($f,Yg,0,Th,Cc),dA=new I0(new Array(0),bj,0,jw,xj)},gA=e=>{let r;for(r=0;r<mp;r++)e.dyn_ltree[r*2]=0;for(r=0;r<Th;r++)e.dyn_dtree[r*2]=0;for(r=0;r<jw;r++)e.bl_tree[r*2]=0;e.dyn_ltree[$w*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},_A=e=>{e.bi_valid>8?yp(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},tC=(e,r,i,c)=>{const d=r*2,g=i*2;return e[d]<e[g]||e[d]===e[g]&&c[r]<=c[i]},z0=(e,r,i)=>{const c=e.heap[i];let d=i<<1;for(;d<=e.heap_len&&(d<e.heap_len&&tC(r,e.heap[d+1],e.heap[d],e.depth)&&d++,!tC(r,c,e.heap[d],e.depth));)e.heap[i]=e.heap[d],i=d,d<<=1;e.heap[i]=c},rC=(e,r,i)=>{let c,d,g=0,m,l;if(e.sym_next!==0)do c=e.pending_buf[e.sym_buf+g++]&255,c+=(e.pending_buf[e.sym_buf+g++]&255)<<8,d=e.pending_buf[e.sym_buf+g++],c===0?xs(e,d,r):(m=_p[d],xs(e,m+Dp+1,r),l=cb[m],l!==0&&(d-=Uw[m],zi(e,d,l)),c--,m=fA(c),xs(e,m,i),l=Yg[m],l!==0&&(c-=O_[m],zi(e,c,l)));while(g<e.sym_next);xs(e,$w,r)},ub=(e,r)=>{const i=r.dyn_tree,c=r.stat_desc.static_tree,d=r.stat_desc.has_stree,g=r.stat_desc.elems;let m,l,E=-1,P;for(e.heap_len=0,e.heap_max=oA,m=0;m<g;m++)i[m*2]!==0?(e.heap[++e.heap_len]=E=m,e.depth[m]=0):i[m*2+1]=0;for(;e.heap_len<2;)P=e.heap[++e.heap_len]=E<2?++E:0,i[P*2]=1,e.depth[P]=0,e.opt_len--,d&&(e.static_len-=c[P*2+1]);for(r.max_code=E,m=e.heap_len>>1;m>=1;m--)z0(e,i,m);P=g;do m=e.heap[1],e.heap[1]=e.heap[e.heap_len--],z0(e,i,1),l=e.heap[1],e.heap[--e.heap_max]=m,e.heap[--e.heap_max]=l,i[P*2]=i[m*2]+i[l*2],e.depth[P]=(e.depth[m]>=e.depth[l]?e.depth[m]:e.depth[l])+1,i[m*2+1]=i[l*2+1]=P,e.heap[1]=P++,z0(e,i,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],Tj(e,r),mA(i,E,e.bl_count)},nC=(e,r,i)=>{let c,d=-1,g,m=r[0*2+1],l=0,E=7,P=4;for(m===0&&(E=138,P=3),r[(i+1)*2+1]=65535,c=0;c<=i;c++)g=m,m=r[(c+1)*2+1],!(++l<E&&g===m)&&(l<P?e.bl_tree[g*2]+=l:g!==0?(g!==d&&e.bl_tree[g*2]++,e.bl_tree[sA*2]++):l<=10?e.bl_tree[aA*2]++:e.bl_tree[lA*2]++,l=0,d=g,m===0?(E=138,P=3):g===m?(E=6,P=3):(E=7,P=4))},iC=(e,r,i)=>{let c,d=-1,g,m=r[0*2+1],l=0,E=7,P=4;for(m===0&&(E=138,P=3),c=0;c<=i;c++)if(g=m,m=r[(c+1)*2+1],!(++l<E&&g===m)){if(l<P)do xs(e,g,e.bl_tree);while(--l!==0);else g!==0?(g!==d&&(xs(e,g,e.bl_tree),l--),xs(e,sA,e.bl_tree),zi(e,l-3,2)):l<=10?(xs(e,aA,e.bl_tree),zi(e,l-3,3)):(xs(e,lA,e.bl_tree),zi(e,l-11,7));l=0,d=g,m===0?(E=138,P=3):g===m?(E=6,P=3):(E=7,P=4)}},Pj=e=>{let r;for(nC(e,e.dyn_ltree,e.l_desc.max_code),nC(e,e.dyn_dtree,e.d_desc.max_code),ub(e,e.bl_desc),r=jw-1;r>=3&&e.bl_tree[cA[r]*2+1]===0;r--);return e.opt_len+=3*(r+1)+5+5+4,r},Ej=(e,r,i,c)=>{let d;for(zi(e,r-257,5),zi(e,i-1,5),zi(e,c-4,4),d=0;d<c;d++)zi(e,e.bl_tree[cA[d]*2+1],3);iC(e,e.dyn_ltree,r-1),iC(e,e.dyn_dtree,i-1)},Mj=e=>{let r=4093624447,i;for(i=0;i<=31;i++,r>>>=1)if(r&1&&e.dyn_ltree[i*2]!==0)return JT;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return eC;for(i=32;i<Dp;i++)if(e.dyn_ltree[i*2]!==0)return eC;return JT};let oC=!1;const kj=e=>{oC||(Cj(),oC=!0),e.l_desc=new A0(e.dyn_ltree,uA),e.d_desc=new A0(e.dyn_dtree,hA),e.bl_desc=new A0(e.bl_tree,dA),e.bi_buf=0,e.bi_valid=0,gA(e)},yA=(e,r,i,c)=>{zi(e,(gj<<1)+(c?1:0),3),_A(e),yp(e,i),yp(e,~i),i&&e.pending_buf.set(e.window.subarray(r,r+i),e.pending),e.pending+=i},Ij=e=>{zi(e,iA<<1,3),xs(e,$w,Qs),Sj(e)},Aj=(e,r,i,c)=>{let d,g,m=0;e.level>0?(e.strm.data_type===mj&&(e.strm.data_type=Mj(e)),ub(e,e.l_desc),ub(e,e.d_desc),m=Pj(e),d=e.opt_len+3+7>>>3,g=e.static_len+3+7>>>3,g<=d&&(d=g)):d=g=i+5,i+4<=d&&r!==-1?yA(e,r,i,c):e.strategy===pj||g===d?(zi(e,(iA<<1)+(c?1:0),3),rC(e,Qs,$f)):(zi(e,(_j<<1)+(c?1:0),3),Ej(e,e.l_desc.max_code+1,e.d_desc.max_code+1,m+1),rC(e,e.dyn_ltree,e.dyn_dtree)),gA(e),c&&_A(e)},zj=(e,r,i)=>(e.pending_buf[e.sym_buf+e.sym_next++]=r,e.pending_buf[e.sym_buf+e.sym_next++]=r>>8,e.pending_buf[e.sym_buf+e.sym_next++]=i,r===0?e.dyn_ltree[i*2]++:(e.matches++,r--,e.dyn_ltree[(_p[i]+Dp+1)*2]++,e.dyn_dtree[fA(r)*2]++),e.sym_next===e.sym_end);var Rj=kj,Dj=yA,Lj=Aj,Oj=zj,Fj=Ij,Nj={_tr_init:Rj,_tr_stored_block:Dj,_tr_flush_block:Lj,_tr_tally:Oj,_tr_align:Fj};const Bj=(e,r,i,c)=>{let d=e&65535|0,g=e>>>16&65535|0,m=0;for(;i!==0;){m=i>2e3?2e3:i,i-=m;do d=d+r[c++]|0,g=g+d|0;while(--m);d%=65521,g%=65521}return d|g<<16|0};var vp=Bj;const jj=()=>{let e,r=[];for(var i=0;i<256;i++){e=i;for(var c=0;c<8;c++)e=e&1?3988292384^e>>>1:e>>>1;r[i]=e}return r},$j=new Uint32Array(jj()),Uj=(e,r,i,c)=>{const d=$j,g=c+i;e^=-1;for(let m=c;m<g;m++)e=e>>>8^d[(e^r[m])&255];return e^-1};var Ln=Uj,Gc={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Lp={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Vj,_tr_stored_block:hb,_tr_flush_block:Zj,_tr_tally:gl,_tr_align:Gj}=Nj,{Z_NO_FLUSH:_l,Z_PARTIAL_FLUSH:Hj,Z_FULL_FLUSH:Wj,Z_FINISH:mo,Z_BLOCK:sC,Z_OK:Wn,Z_STREAM_END:aC,Z_STREAM_ERROR:Ps,Z_DATA_ERROR:qj,Z_BUF_ERROR:R0,Z_DEFAULT_COMPRESSION:Xj,Z_FILTERED:Kj,Z_HUFFMAN_ONLY:Pg,Z_RLE:Yj,Z_FIXED:Qj,Z_DEFAULT_STRATEGY:Jj,Z_UNKNOWN:e8,Z_DEFLATED:by}=Lp,t8=9,r8=15,n8=8,i8=29,o8=256,db=o8+1+i8,s8=30,a8=19,l8=2*db+1,c8=15,ur=3,al=258,Es=al+ur+1,u8=32,Vh=42,Vw=57,fb=69,pb=73,mb=91,gb=103,Pc=113,kf=666,vi=1,Jh=2,Hc=3,ed=4,h8=3,Ec=(e,r)=>(e.msg=Gc[r],r),lC=e=>e*2-(e>4?9:0),Qa=e=>{let r=e.length;for(;--r>=0;)e[r]=0},d8=e=>{let r,i,c,d=e.w_size;r=e.hash_size,c=r;do i=e.head[--c],e.head[c]=i>=d?i-d:0;while(--r);r=d,c=r;do i=e.prev[--c],e.prev[c]=i>=d?i-d:0;while(--r)};let f8=(e,r,i)=>(r<<e.hash_shift^i)&e.hash_mask,yl=f8;const Wi=e=>{const r=e.state;let i=r.pending;i>e.avail_out&&(i=e.avail_out),i!==0&&(e.output.set(r.pending_buf.subarray(r.pending_out,r.pending_out+i),e.next_out),e.next_out+=i,r.pending_out+=i,e.total_out+=i,e.avail_out-=i,r.pending-=i,r.pending===0&&(r.pending_out=0))},Yi=(e,r)=>{Zj(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,r),e.block_start=e.strstart,Wi(e.strm)},gr=(e,r)=>{e.pending_buf[e.pending++]=r},Sf=(e,r)=>{e.pending_buf[e.pending++]=r>>>8&255,e.pending_buf[e.pending++]=r&255},_b=(e,r,i,c)=>{let d=e.avail_in;return d>c&&(d=c),d===0?0:(e.avail_in-=d,r.set(e.input.subarray(e.next_in,e.next_in+d),i),e.state.wrap===1?e.adler=vp(e.adler,r,d,i):e.state.wrap===2&&(e.adler=Ln(e.adler,r,d,i)),e.next_in+=d,e.total_in+=d,d)},vA=(e,r)=>{let i=e.max_chain_length,c=e.strstart,d,g,m=e.prev_length,l=e.nice_match;const E=e.strstart>e.w_size-Es?e.strstart-(e.w_size-Es):0,P=e.window,R=e.w_mask,N=e.prev,F=e.strstart+al;let A=P[c+m-1],X=P[c+m];e.prev_length>=e.good_match&&(i>>=2),l>e.lookahead&&(l=e.lookahead);do if(d=r,!(P[d+m]!==X||P[d+m-1]!==A||P[d]!==P[c]||P[++d]!==P[c+1])){c+=2,d++;do;while(P[++c]===P[++d]&&P[++c]===P[++d]&&P[++c]===P[++d]&&P[++c]===P[++d]&&P[++c]===P[++d]&&P[++c]===P[++d]&&P[++c]===P[++d]&&P[++c]===P[++d]&&c<F);if(g=al-(F-c),c=F-al,g>m){if(e.match_start=r,m=g,g>=l)break;A=P[c+m-1],X=P[c+m]}}while((r=N[r&R])>E&&--i!==0);return m<=e.lookahead?m:e.lookahead},Zh=e=>{const r=e.w_size;let i,c,d;do{if(c=e.window_size-e.lookahead-e.strstart,e.strstart>=r+(r-Es)&&(e.window.set(e.window.subarray(r,r+r-c),0),e.match_start-=r,e.strstart-=r,e.block_start-=r,e.insert>e.strstart&&(e.insert=e.strstart),d8(e),c+=r),e.strm.avail_in===0)break;if(i=_b(e.strm,e.window,e.strstart+e.lookahead,c),e.lookahead+=i,e.lookahead+e.insert>=ur)for(d=e.strstart-e.insert,e.ins_h=e.window[d],e.ins_h=yl(e,e.ins_h,e.window[d+1]);e.insert&&(e.ins_h=yl(e,e.ins_h,e.window[d+ur-1]),e.prev[d&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=d,d++,e.insert--,!(e.lookahead+e.insert<ur)););}while(e.lookahead<Es&&e.strm.avail_in!==0)},xA=(e,r)=>{let i=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,c,d,g,m=0,l=e.strm.avail_in;do{if(c=65535,g=e.bi_valid+42>>3,e.strm.avail_out<g||(g=e.strm.avail_out-g,d=e.strstart-e.block_start,c>d+e.strm.avail_in&&(c=d+e.strm.avail_in),c>g&&(c=g),c<i&&(c===0&&r!==mo||r===_l||c!==d+e.strm.avail_in)))break;m=r===mo&&c===d+e.strm.avail_in?1:0,hb(e,0,0,m),e.pending_buf[e.pending-4]=c,e.pending_buf[e.pending-3]=c>>8,e.pending_buf[e.pending-2]=~c,e.pending_buf[e.pending-1]=~c>>8,Wi(e.strm),d&&(d>c&&(d=c),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+d),e.strm.next_out),e.strm.next_out+=d,e.strm.avail_out-=d,e.strm.total_out+=d,e.block_start+=d,c-=d),c&&(_b(e.strm,e.strm.output,e.strm.next_out,c),e.strm.next_out+=c,e.strm.avail_out-=c,e.strm.total_out+=c)}while(m===0);return l-=e.strm.avail_in,l&&(l>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=l&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-l,e.strm.next_in),e.strstart),e.strstart+=l,e.insert+=l>e.w_size-e.insert?e.w_size-e.insert:l),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),m?ed:r!==_l&&r!==mo&&e.strm.avail_in===0&&e.strstart===e.block_start?Jh:(g=e.window_size-e.strstart,e.strm.avail_in>g&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,g+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),g>e.strm.avail_in&&(g=e.strm.avail_in),g&&(_b(e.strm,e.window,e.strstart,g),e.strstart+=g,e.insert+=g>e.w_size-e.insert?e.w_size-e.insert:g),e.high_water<e.strstart&&(e.high_water=e.strstart),g=e.bi_valid+42>>3,g=e.pending_buf_size-g>65535?65535:e.pending_buf_size-g,i=g>e.w_size?e.w_size:g,d=e.strstart-e.block_start,(d>=i||(d||r===mo)&&r!==_l&&e.strm.avail_in===0&&d<=g)&&(c=d>g?g:d,m=r===mo&&e.strm.avail_in===0&&c===d?1:0,hb(e,e.block_start,c,m),e.block_start+=c,Wi(e.strm)),m?Hc:vi)},D0=(e,r)=>{let i,c;for(;;){if(e.lookahead<Es){if(Zh(e),e.lookahead<Es&&r===_l)return vi;if(e.lookahead===0)break}if(i=0,e.lookahead>=ur&&(e.ins_h=yl(e,e.ins_h,e.window[e.strstart+ur-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),i!==0&&e.strstart-i<=e.w_size-Es&&(e.match_length=vA(e,i)),e.match_length>=ur)if(c=gl(e,e.strstart-e.match_start,e.match_length-ur),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=ur){e.match_length--;do e.strstart++,e.ins_h=yl(e,e.ins_h,e.window[e.strstart+ur-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=yl(e,e.ins_h,e.window[e.strstart+1]);else c=gl(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(c&&(Yi(e,!1),e.strm.avail_out===0))return vi}return e.insert=e.strstart<ur-1?e.strstart:ur-1,r===mo?(Yi(e,!0),e.strm.avail_out===0?Hc:ed):e.sym_next&&(Yi(e,!1),e.strm.avail_out===0)?vi:Jh},Qu=(e,r)=>{let i,c,d;for(;;){if(e.lookahead<Es){if(Zh(e),e.lookahead<Es&&r===_l)return vi;if(e.lookahead===0)break}if(i=0,e.lookahead>=ur&&(e.ins_h=yl(e,e.ins_h,e.window[e.strstart+ur-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=ur-1,i!==0&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-Es&&(e.match_length=vA(e,i),e.match_length<=5&&(e.strategy===Kj||e.match_length===ur&&e.strstart-e.match_start>4096)&&(e.match_length=ur-1)),e.prev_length>=ur&&e.match_length<=e.prev_length){d=e.strstart+e.lookahead-ur,c=gl(e,e.strstart-1-e.prev_match,e.prev_length-ur),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=d&&(e.ins_h=yl(e,e.ins_h,e.window[e.strstart+ur-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=ur-1,e.strstart++,c&&(Yi(e,!1),e.strm.avail_out===0))return vi}else if(e.match_available){if(c=gl(e,0,e.window[e.strstart-1]),c&&Yi(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return vi}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(c=gl(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<ur-1?e.strstart:ur-1,r===mo?(Yi(e,!0),e.strm.avail_out===0?Hc:ed):e.sym_next&&(Yi(e,!1),e.strm.avail_out===0)?vi:Jh},p8=(e,r)=>{let i,c,d,g;const m=e.window;for(;;){if(e.lookahead<=al){if(Zh(e),e.lookahead<=al&&r===_l)return vi;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=ur&&e.strstart>0&&(d=e.strstart-1,c=m[d],c===m[++d]&&c===m[++d]&&c===m[++d])){g=e.strstart+al;do;while(c===m[++d]&&c===m[++d]&&c===m[++d]&&c===m[++d]&&c===m[++d]&&c===m[++d]&&c===m[++d]&&c===m[++d]&&d<g);e.match_length=al-(g-d),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=ur?(i=gl(e,1,e.match_length-ur),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=gl(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(Yi(e,!1),e.strm.avail_out===0))return vi}return e.insert=0,r===mo?(Yi(e,!0),e.strm.avail_out===0?Hc:ed):e.sym_next&&(Yi(e,!1),e.strm.avail_out===0)?vi:Jh},m8=(e,r)=>{let i;for(;;){if(e.lookahead===0&&(Zh(e),e.lookahead===0)){if(r===_l)return vi;break}if(e.match_length=0,i=gl(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(Yi(e,!1),e.strm.avail_out===0))return vi}return e.insert=0,r===mo?(Yi(e,!0),e.strm.avail_out===0?Hc:ed):e.sym_next&&(Yi(e,!1),e.strm.avail_out===0)?vi:Jh};function fs(e,r,i,c,d){this.good_length=e,this.max_lazy=r,this.nice_length=i,this.max_chain=c,this.func=d}const If=[new fs(0,0,0,0,xA),new fs(4,4,8,4,D0),new fs(4,5,16,8,D0),new fs(4,6,32,32,D0),new fs(4,4,16,16,Qu),new fs(8,16,32,32,Qu),new fs(8,16,128,128,Qu),new fs(8,32,128,256,Qu),new fs(32,128,258,1024,Qu),new fs(32,258,258,4096,Qu)],g8=e=>{e.window_size=2*e.w_size,Qa(e.head),e.max_lazy_match=If[e.level].max_lazy,e.good_match=If[e.level].good_length,e.nice_match=If[e.level].nice_length,e.max_chain_length=If[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=ur-1,e.match_available=0,e.ins_h=0};function _8(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=by,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(l8*2),this.dyn_dtree=new Uint16Array((2*s8+1)*2),this.bl_tree=new Uint16Array((2*a8+1)*2),Qa(this.dyn_ltree),Qa(this.dyn_dtree),Qa(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(c8+1),this.heap=new Uint16Array(2*db+1),Qa(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*db+1),Qa(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Op=e=>{if(!e)return 1;const r=e.state;return!r||r.strm!==e||r.status!==Vh&&r.status!==Vw&&r.status!==fb&&r.status!==pb&&r.status!==mb&&r.status!==gb&&r.status!==Pc&&r.status!==kf?1:0},bA=e=>{if(Op(e))return Ec(e,Ps);e.total_in=e.total_out=0,e.data_type=e8;const r=e.state;return r.pending=0,r.pending_out=0,r.wrap<0&&(r.wrap=-r.wrap),r.status=r.wrap===2?Vw:r.wrap?Vh:Pc,e.adler=r.wrap===2?0:1,r.last_flush=-2,Vj(r),Wn},wA=e=>{const r=bA(e);return r===Wn&&g8(e.state),r},y8=(e,r)=>Op(e)||e.state.wrap!==2?Ps:(e.state.gzhead=r,Wn),SA=(e,r,i,c,d,g)=>{if(!e)return Ps;let m=1;if(r===Xj&&(r=6),c<0?(m=0,c=-c):c>15&&(m=2,c-=16),d<1||d>t8||i!==by||c<8||c>15||r<0||r>9||g<0||g>Qj||c===8&&m!==1)return Ec(e,Ps);c===8&&(c=9);const l=new _8;return e.state=l,l.strm=e,l.status=Vh,l.wrap=m,l.gzhead=null,l.w_bits=c,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=d+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+ur-1)/ur),l.window=new Uint8Array(l.w_size*2),l.head=new Uint16Array(l.hash_size),l.prev=new Uint16Array(l.w_size),l.lit_bufsize=1<<d+6,l.pending_buf_size=l.lit_bufsize*4,l.pending_buf=new Uint8Array(l.pending_buf_size),l.sym_buf=l.lit_bufsize,l.sym_end=(l.lit_bufsize-1)*3,l.level=r,l.strategy=g,l.method=i,wA(e)},v8=(e,r)=>SA(e,r,by,r8,n8,Jj),x8=(e,r)=>{if(Op(e)||r>sC||r<0)return e?Ec(e,Ps):Ps;const i=e.state;if(!e.output||e.avail_in!==0&&!e.input||i.status===kf&&r!==mo)return Ec(e,e.avail_out===0?R0:Ps);const c=i.last_flush;if(i.last_flush=r,i.pending!==0){if(Wi(e),e.avail_out===0)return i.last_flush=-1,Wn}else if(e.avail_in===0&&lC(r)<=lC(c)&&r!==mo)return Ec(e,R0);if(i.status===kf&&e.avail_in!==0)return Ec(e,R0);if(i.status===Vh&&i.wrap===0&&(i.status=Pc),i.status===Vh){let d=by+(i.w_bits-8<<4)<<8,g=-1;if(i.strategy>=Pg||i.level<2?g=0:i.level<6?g=1:i.level===6?g=2:g=3,d|=g<<6,i.strstart!==0&&(d|=u8),d+=31-d%31,Sf(i,d),i.strstart!==0&&(Sf(i,e.adler>>>16),Sf(i,e.adler&65535)),e.adler=1,i.status=Pc,Wi(e),i.pending!==0)return i.last_flush=-1,Wn}if(i.status===Vw){if(e.adler=0,gr(i,31),gr(i,139),gr(i,8),i.gzhead)gr(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),gr(i,i.gzhead.time&255),gr(i,i.gzhead.time>>8&255),gr(i,i.gzhead.time>>16&255),gr(i,i.gzhead.time>>24&255),gr(i,i.level===9?2:i.strategy>=Pg||i.level<2?4:0),gr(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(gr(i,i.gzhead.extra.length&255),gr(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=Ln(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=fb;else if(gr(i,0),gr(i,0),gr(i,0),gr(i,0),gr(i,0),gr(i,i.level===9?2:i.strategy>=Pg||i.level<2?4:0),gr(i,h8),i.status=Pc,Wi(e),i.pending!==0)return i.last_flush=-1,Wn}if(i.status===fb){if(i.gzhead.extra){let d=i.pending,g=(i.gzhead.extra.length&65535)-i.gzindex;for(;i.pending+g>i.pending_buf_size;){let l=i.pending_buf_size-i.pending;if(i.pending_buf.set(i.gzhead.extra.subarray(i.gzindex,i.gzindex+l),i.pending),i.pending=i.pending_buf_size,i.gzhead.hcrc&&i.pending>d&&(e.adler=Ln(e.adler,i.pending_buf,i.pending-d,d)),i.gzindex+=l,Wi(e),i.pending!==0)return i.last_flush=-1,Wn;d=0,g-=l}let m=new Uint8Array(i.gzhead.extra);i.pending_buf.set(m.subarray(i.gzindex,i.gzindex+g),i.pending),i.pending+=g,i.gzhead.hcrc&&i.pending>d&&(e.adler=Ln(e.adler,i.pending_buf,i.pending-d,d)),i.gzindex=0}i.status=pb}if(i.status===pb){if(i.gzhead.name){let d=i.pending,g;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>d&&(e.adler=Ln(e.adler,i.pending_buf,i.pending-d,d)),Wi(e),i.pending!==0)return i.last_flush=-1,Wn;d=0}i.gzindex<i.gzhead.name.length?g=i.gzhead.name.charCodeAt(i.gzindex++)&255:g=0,gr(i,g)}while(g!==0);i.gzhead.hcrc&&i.pending>d&&(e.adler=Ln(e.adler,i.pending_buf,i.pending-d,d)),i.gzindex=0}i.status=mb}if(i.status===mb){if(i.gzhead.comment){let d=i.pending,g;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>d&&(e.adler=Ln(e.adler,i.pending_buf,i.pending-d,d)),Wi(e),i.pending!==0)return i.last_flush=-1,Wn;d=0}i.gzindex<i.gzhead.comment.length?g=i.gzhead.comment.charCodeAt(i.gzindex++)&255:g=0,gr(i,g)}while(g!==0);i.gzhead.hcrc&&i.pending>d&&(e.adler=Ln(e.adler,i.pending_buf,i.pending-d,d))}i.status=gb}if(i.status===gb){if(i.gzhead.hcrc){if(i.pending+2>i.pending_buf_size&&(Wi(e),i.pending!==0))return i.last_flush=-1,Wn;gr(i,e.adler&255),gr(i,e.adler>>8&255),e.adler=0}if(i.status=Pc,Wi(e),i.pending!==0)return i.last_flush=-1,Wn}if(e.avail_in!==0||i.lookahead!==0||r!==_l&&i.status!==kf){let d=i.level===0?xA(i,r):i.strategy===Pg?m8(i,r):i.strategy===Yj?p8(i,r):If[i.level].func(i,r);if((d===Hc||d===ed)&&(i.status=kf),d===vi||d===Hc)return e.avail_out===0&&(i.last_flush=-1),Wn;if(d===Jh&&(r===Hj?Gj(i):r!==sC&&(hb(i,0,0,!1),r===Wj&&(Qa(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),Wi(e),e.avail_out===0))return i.last_flush=-1,Wn}return r!==mo?Wn:i.wrap<=0?aC:(i.wrap===2?(gr(i,e.adler&255),gr(i,e.adler>>8&255),gr(i,e.adler>>16&255),gr(i,e.adler>>24&255),gr(i,e.total_in&255),gr(i,e.total_in>>8&255),gr(i,e.total_in>>16&255),gr(i,e.total_in>>24&255)):(Sf(i,e.adler>>>16),Sf(i,e.adler&65535)),Wi(e),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?Wn:aC)},b8=e=>{if(Op(e))return Ps;const r=e.state.status;return e.state=null,r===Pc?Ec(e,qj):Wn},w8=(e,r)=>{let i=r.length;if(Op(e))return Ps;const c=e.state,d=c.wrap;if(d===2||d===1&&c.status!==Vh||c.lookahead)return Ps;if(d===1&&(e.adler=vp(e.adler,r,i,0)),c.wrap=0,i>=c.w_size){d===0&&(Qa(c.head),c.strstart=0,c.block_start=0,c.insert=0);let E=new Uint8Array(c.w_size);E.set(r.subarray(i-c.w_size,i),0),r=E,i=c.w_size}const g=e.avail_in,m=e.next_in,l=e.input;for(e.avail_in=i,e.next_in=0,e.input=r,Zh(c);c.lookahead>=ur;){let E=c.strstart,P=c.lookahead-(ur-1);do c.ins_h=yl(c,c.ins_h,c.window[E+ur-1]),c.prev[E&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=E,E++;while(--P);c.strstart=E,c.lookahead=ur-1,Zh(c)}return c.strstart+=c.lookahead,c.block_start=c.strstart,c.insert=c.lookahead,c.lookahead=0,c.match_length=c.prev_length=ur-1,c.match_available=0,e.next_in=m,e.input=l,e.avail_in=g,c.wrap=d,Wn};var S8=v8,T8=SA,C8=wA,P8=bA,E8=y8,M8=x8,k8=b8,I8=w8,A8="pako deflate (from Nodeca project)",Uf={deflateInit:S8,deflateInit2:T8,deflateReset:C8,deflateResetKeep:P8,deflateSetHeader:E8,deflate:M8,deflateEnd:k8,deflateSetDictionary:I8,deflateInfo:A8};const z8=(e,r)=>Object.prototype.hasOwnProperty.call(e,r);var R8=function(e){const r=Array.prototype.slice.call(arguments,1);for(;r.length;){const i=r.shift();if(i){if(typeof i!="object")throw new TypeError(i+"must be non-object");for(const c in i)z8(i,c)&&(e[c]=i[c])}}return e},D8=e=>{let r=0;for(let c=0,d=e.length;c<d;c++)r+=e[c].length;const i=new Uint8Array(r);for(let c=0,d=0,g=e.length;c<g;c++){let m=e[c];i.set(m,d),d+=m.length}return i},wy={assign:R8,flattenChunks:D8};let TA=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{TA=!1}const xp=new Uint8Array(256);for(let e=0;e<256;e++)xp[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;xp[254]=xp[254]=1;var L8=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let r,i,c,d,g,m=e.length,l=0;for(d=0;d<m;d++)i=e.charCodeAt(d),(i&64512)===55296&&d+1<m&&(c=e.charCodeAt(d+1),(c&64512)===56320&&(i=65536+(i-55296<<10)+(c-56320),d++)),l+=i<128?1:i<2048?2:i<65536?3:4;for(r=new Uint8Array(l),g=0,d=0;g<l;d++)i=e.charCodeAt(d),(i&64512)===55296&&d+1<m&&(c=e.charCodeAt(d+1),(c&64512)===56320&&(i=65536+(i-55296<<10)+(c-56320),d++)),i<128?r[g++]=i:i<2048?(r[g++]=192|i>>>6,r[g++]=128|i&63):i<65536?(r[g++]=224|i>>>12,r[g++]=128|i>>>6&63,r[g++]=128|i&63):(r[g++]=240|i>>>18,r[g++]=128|i>>>12&63,r[g++]=128|i>>>6&63,r[g++]=128|i&63);return r};const O8=(e,r)=>{if(r<65534&&e.subarray&&TA)return String.fromCharCode.apply(null,e.length===r?e:e.subarray(0,r));let i="";for(let c=0;c<r;c++)i+=String.fromCharCode(e[c]);return i};var F8=(e,r)=>{const i=r||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,r));let c,d;const g=new Array(i*2);for(d=0,c=0;c<i;){let m=e[c++];if(m<128){g[d++]=m;continue}let l=xp[m];if(l>4){g[d++]=65533,c+=l-1;continue}for(m&=l===2?31:l===3?15:7;l>1&&c<i;)m=m<<6|e[c++]&63,l--;if(l>1){g[d++]=65533;continue}m<65536?g[d++]=m:(m-=65536,g[d++]=55296|m>>10&1023,g[d++]=56320|m&1023)}return O8(g,d)},N8=(e,r)=>{r=r||e.length,r>e.length&&(r=e.length);let i=r-1;for(;i>=0&&(e[i]&192)===128;)i--;return i<0||i===0?r:i+xp[e[i]]>r?i:r},bp={string2buf:L8,buf2string:F8,utf8border:N8};function B8(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var CA=B8;const PA=Object.prototype.toString,{Z_NO_FLUSH:j8,Z_SYNC_FLUSH:$8,Z_FULL_FLUSH:U8,Z_FINISH:V8,Z_OK:F_,Z_STREAM_END:Z8,Z_DEFAULT_COMPRESSION:G8,Z_DEFAULT_STRATEGY:H8,Z_DEFLATED:W8}=Lp;function Fp(e){this.options=wy.assign({level:G8,method:W8,chunkSize:16384,windowBits:15,memLevel:8,strategy:H8},e||{});let r=this.options;r.raw&&r.windowBits>0?r.windowBits=-r.windowBits:r.gzip&&r.windowBits>0&&r.windowBits<16&&(r.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new CA,this.strm.avail_out=0;let i=Uf.deflateInit2(this.strm,r.level,r.method,r.windowBits,r.memLevel,r.strategy);if(i!==F_)throw new Error(Gc[i]);if(r.header&&Uf.deflateSetHeader(this.strm,r.header),r.dictionary){let c;if(typeof r.dictionary=="string"?c=bp.string2buf(r.dictionary):PA.call(r.dictionary)==="[object ArrayBuffer]"?c=new Uint8Array(r.dictionary):c=r.dictionary,i=Uf.deflateSetDictionary(this.strm,c),i!==F_)throw new Error(Gc[i]);this._dict_set=!0}}Fp.prototype.push=function(e,r){const i=this.strm,c=this.options.chunkSize;let d,g;if(this.ended)return!1;for(r===~~r?g=r:g=r===!0?V8:j8,typeof e=="string"?i.input=bp.string2buf(e):PA.call(e)==="[object ArrayBuffer]"?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;){if(i.avail_out===0&&(i.output=new Uint8Array(c),i.next_out=0,i.avail_out=c),(g===$8||g===U8)&&i.avail_out<=6){this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;continue}if(d=Uf.deflate(i,g),d===Z8)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),d=Uf.deflateEnd(this.strm),this.onEnd(d),this.ended=!0,d===F_;if(i.avail_out===0){this.onData(i.output);continue}if(g>0&&i.next_out>0){this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;continue}if(i.avail_in===0)break}return!0};Fp.prototype.onData=function(e){this.chunks.push(e)};Fp.prototype.onEnd=function(e){e===F_&&(this.result=wy.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Zw(e,r){const i=new Fp(r);if(i.push(e,!0),i.err)throw i.msg||Gc[i.err];return i.result}function q8(e,r){return r=r||{},r.raw=!0,Zw(e,r)}function X8(e,r){return r=r||{},r.gzip=!0,Zw(e,r)}var K8=Fp,Y8=Zw,Q8=q8,J8=X8,e$={Deflate:K8,deflate:Y8,deflateRaw:Q8,gzip:J8};const Eg=16209,t$=16191;var r$=function(r,i){let c,d,g,m,l,E,P,R,N,F,A,X,Z,ee,H,U,W,re,ge,Te,xe,ze,Ne,Ie;const $e=r.state;c=r.next_in,Ne=r.input,d=c+(r.avail_in-5),g=r.next_out,Ie=r.output,m=g-(i-r.avail_out),l=g+(r.avail_out-257),E=$e.dmax,P=$e.wsize,R=$e.whave,N=$e.wnext,F=$e.window,A=$e.hold,X=$e.bits,Z=$e.lencode,ee=$e.distcode,H=(1<<$e.lenbits)-1,U=(1<<$e.distbits)-1;e:do{X<15&&(A+=Ne[c++]<<X,X+=8,A+=Ne[c++]<<X,X+=8),W=Z[A&H];t:for(;;){if(re=W>>>24,A>>>=re,X-=re,re=W>>>16&255,re===0)Ie[g++]=W&65535;else if(re&16){ge=W&65535,re&=15,re&&(X<re&&(A+=Ne[c++]<<X,X+=8),ge+=A&(1<<re)-1,A>>>=re,X-=re),X<15&&(A+=Ne[c++]<<X,X+=8,A+=Ne[c++]<<X,X+=8),W=ee[A&U];r:for(;;){if(re=W>>>24,A>>>=re,X-=re,re=W>>>16&255,re&16){if(Te=W&65535,re&=15,X<re&&(A+=Ne[c++]<<X,X+=8,X<re&&(A+=Ne[c++]<<X,X+=8)),Te+=A&(1<<re)-1,Te>E){r.msg="invalid distance too far back",$e.mode=Eg;break e}if(A>>>=re,X-=re,re=g-m,Te>re){if(re=Te-re,re>R&&$e.sane){r.msg="invalid distance too far back",$e.mode=Eg;break e}if(xe=0,ze=F,N===0){if(xe+=P-re,re<ge){ge-=re;do Ie[g++]=F[xe++];while(--re);xe=g-Te,ze=Ie}}else if(N<re){if(xe+=P+N-re,re-=N,re<ge){ge-=re;do Ie[g++]=F[xe++];while(--re);if(xe=0,N<ge){re=N,ge-=re;do Ie[g++]=F[xe++];while(--re);xe=g-Te,ze=Ie}}}else if(xe+=N-re,re<ge){ge-=re;do Ie[g++]=F[xe++];while(--re);xe=g-Te,ze=Ie}for(;ge>2;)Ie[g++]=ze[xe++],Ie[g++]=ze[xe++],Ie[g++]=ze[xe++],ge-=3;ge&&(Ie[g++]=ze[xe++],ge>1&&(Ie[g++]=ze[xe++]))}else{xe=g-Te;do Ie[g++]=Ie[xe++],Ie[g++]=Ie[xe++],Ie[g++]=Ie[xe++],ge-=3;while(ge>2);ge&&(Ie[g++]=Ie[xe++],ge>1&&(Ie[g++]=Ie[xe++]))}}else if(re&64){r.msg="invalid distance code",$e.mode=Eg;break e}else{W=ee[(W&65535)+(A&(1<<re)-1)];continue r}break}}else if(re&64)if(re&32){$e.mode=t$;break e}else{r.msg="invalid literal/length code",$e.mode=Eg;break e}else{W=Z[(W&65535)+(A&(1<<re)-1)];continue t}break}}while(c<d&&g<l);ge=X>>3,c-=ge,X-=ge<<3,A&=(1<<X)-1,r.next_in=c,r.next_out=g,r.avail_in=c<d?5+(d-c):5-(c-d),r.avail_out=g<l?257+(l-g):257-(g-l),$e.hold=A,$e.bits=X};const Ju=15,cC=852,uC=592,hC=0,L0=1,dC=2,n$=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),i$=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),o$=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),s$=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),a$=(e,r,i,c,d,g,m,l)=>{const E=l.bits;let P=0,R=0,N=0,F=0,A=0,X=0,Z=0,ee=0,H=0,U=0,W,re,ge,Te,xe,ze=null,Ne;const Ie=new Uint16Array(Ju+1),$e=new Uint16Array(Ju+1);let et=null,ot,qe,ht;for(P=0;P<=Ju;P++)Ie[P]=0;for(R=0;R<c;R++)Ie[r[i+R]]++;for(A=E,F=Ju;F>=1&&Ie[F]===0;F--);if(A>F&&(A=F),F===0)return d[g++]=1<<24|64<<16|0,d[g++]=1<<24|64<<16|0,l.bits=1,0;for(N=1;N<F&&Ie[N]===0;N++);for(A<N&&(A=N),ee=1,P=1;P<=Ju;P++)if(ee<<=1,ee-=Ie[P],ee<0)return-1;if(ee>0&&(e===hC||F!==1))return-1;for($e[1]=0,P=1;P<Ju;P++)$e[P+1]=$e[P]+Ie[P];for(R=0;R<c;R++)r[i+R]!==0&&(m[$e[r[i+R]]++]=R);if(e===hC?(ze=et=m,Ne=20):e===L0?(ze=n$,et=i$,Ne=257):(ze=o$,et=s$,Ne=0),U=0,R=0,P=N,xe=g,X=A,Z=0,ge=-1,H=1<<A,Te=H-1,e===L0&&H>cC||e===dC&&H>uC)return 1;for(;;){ot=P-Z,m[R]+1<Ne?(qe=0,ht=m[R]):m[R]>=Ne?(qe=et[m[R]-Ne],ht=ze[m[R]-Ne]):(qe=96,ht=0),W=1<<P-Z,re=1<<X,N=re;do re-=W,d[xe+(U>>Z)+re]=ot<<24|qe<<16|ht|0;while(re!==0);for(W=1<<P-1;U&W;)W>>=1;if(W!==0?(U&=W-1,U+=W):U=0,R++,--Ie[P]===0){if(P===F)break;P=r[i+m[R]]}if(P>A&&(U&Te)!==ge){for(Z===0&&(Z=A),xe+=N,X=P-Z,ee=1<<X;X+Z<F&&(ee-=Ie[X+Z],!(ee<=0));)X++,ee<<=1;if(H+=1<<X,e===L0&&H>cC||e===dC&&H>uC)return 1;ge=U&Te,d[ge]=A<<24|X<<16|xe-g|0}}return U!==0&&(d[xe+U]=P-Z<<24|64<<16|0),l.bits=A,0};var Vf=a$;const l$=0,EA=1,MA=2,{Z_FINISH:fC,Z_BLOCK:c$,Z_TREES:Mg,Z_OK:Wc,Z_STREAM_END:u$,Z_NEED_DICT:h$,Z_STREAM_ERROR:xo,Z_DATA_ERROR:kA,Z_MEM_ERROR:IA,Z_BUF_ERROR:d$,Z_DEFLATED:pC}=Lp,Sy=16180,mC=16181,gC=16182,_C=16183,yC=16184,vC=16185,xC=16186,bC=16187,wC=16188,SC=16189,N_=16190,qs=16191,O0=16192,TC=16193,F0=16194,CC=16195,PC=16196,EC=16197,MC=16198,kg=16199,Ig=16200,kC=16201,IC=16202,AC=16203,zC=16204,RC=16205,N0=16206,DC=16207,LC=16208,Ur=16209,AA=16210,zA=16211,f$=852,p$=592,m$=15,g$=m$,OC=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function _$(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Yc=e=>{if(!e)return 1;const r=e.state;return!r||r.strm!==e||r.mode<Sy||r.mode>zA?1:0},RA=e=>{if(Yc(e))return xo;const r=e.state;return e.total_in=e.total_out=r.total=0,e.msg="",r.wrap&&(e.adler=r.wrap&1),r.mode=Sy,r.last=0,r.havedict=0,r.flags=-1,r.dmax=32768,r.head=null,r.hold=0,r.bits=0,r.lencode=r.lendyn=new Int32Array(f$),r.distcode=r.distdyn=new Int32Array(p$),r.sane=1,r.back=-1,Wc},DA=e=>{if(Yc(e))return xo;const r=e.state;return r.wsize=0,r.whave=0,r.wnext=0,RA(e)},LA=(e,r)=>{let i;if(Yc(e))return xo;const c=e.state;return r<0?(i=0,r=-r):(i=(r>>4)+5,r<48&&(r&=15)),r&&(r<8||r>15)?xo:(c.window!==null&&c.wbits!==r&&(c.window=null),c.wrap=i,c.wbits=r,DA(e))},OA=(e,r)=>{if(!e)return xo;const i=new _$;e.state=i,i.strm=e,i.window=null,i.mode=Sy;const c=LA(e,r);return c!==Wc&&(e.state=null),c},y$=e=>OA(e,g$);let FC=!0,B0,j0;const v$=e=>{if(FC){B0=new Int32Array(512),j0=new Int32Array(32);let r=0;for(;r<144;)e.lens[r++]=8;for(;r<256;)e.lens[r++]=9;for(;r<280;)e.lens[r++]=7;for(;r<288;)e.lens[r++]=8;for(Vf(EA,e.lens,0,288,B0,0,e.work,{bits:9}),r=0;r<32;)e.lens[r++]=5;Vf(MA,e.lens,0,32,j0,0,e.work,{bits:5}),FC=!1}e.lencode=B0,e.lenbits=9,e.distcode=j0,e.distbits=5},FA=(e,r,i,c)=>{let d;const g=e.state;return g.window===null&&(g.wsize=1<<g.wbits,g.wnext=0,g.whave=0,g.window=new Uint8Array(g.wsize)),c>=g.wsize?(g.window.set(r.subarray(i-g.wsize,i),0),g.wnext=0,g.whave=g.wsize):(d=g.wsize-g.wnext,d>c&&(d=c),g.window.set(r.subarray(i-c,i-c+d),g.wnext),c-=d,c?(g.window.set(r.subarray(i-c,i),0),g.wnext=c,g.whave=g.wsize):(g.wnext+=d,g.wnext===g.wsize&&(g.wnext=0),g.whave<g.wsize&&(g.whave+=d))),0},x$=(e,r)=>{let i,c,d,g,m,l,E,P,R,N,F,A,X,Z,ee=0,H,U,W,re,ge,Te,xe,ze;const Ne=new Uint8Array(4);let Ie,$e;const et=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Yc(e)||!e.output||!e.input&&e.avail_in!==0)return xo;i=e.state,i.mode===qs&&(i.mode=O0),m=e.next_out,d=e.output,E=e.avail_out,g=e.next_in,c=e.input,l=e.avail_in,P=i.hold,R=i.bits,N=l,F=E,ze=Wc;e:for(;;)switch(i.mode){case Sy:if(i.wrap===0){i.mode=O0;break}for(;R<16;){if(l===0)break e;l--,P+=c[g++]<<R,R+=8}if(i.wrap&2&&P===35615){i.wbits===0&&(i.wbits=15),i.check=0,Ne[0]=P&255,Ne[1]=P>>>8&255,i.check=Ln(i.check,Ne,2,0),P=0,R=0,i.mode=mC;break}if(i.head&&(i.head.done=!1),!(i.wrap&1)||(((P&255)<<8)+(P>>8))%31){e.msg="incorrect header check",i.mode=Ur;break}if((P&15)!==pC){e.msg="unknown compression method",i.mode=Ur;break}if(P>>>=4,R-=4,xe=(P&15)+8,i.wbits===0&&(i.wbits=xe),xe>15||xe>i.wbits){e.msg="invalid window size",i.mode=Ur;break}i.dmax=1<<i.wbits,i.flags=0,e.adler=i.check=1,i.mode=P&512?SC:qs,P=0,R=0;break;case mC:for(;R<16;){if(l===0)break e;l--,P+=c[g++]<<R,R+=8}if(i.flags=P,(i.flags&255)!==pC){e.msg="unknown compression method",i.mode=Ur;break}if(i.flags&57344){e.msg="unknown header flags set",i.mode=Ur;break}i.head&&(i.head.text=P>>8&1),i.flags&512&&i.wrap&4&&(Ne[0]=P&255,Ne[1]=P>>>8&255,i.check=Ln(i.check,Ne,2,0)),P=0,R=0,i.mode=gC;case gC:for(;R<32;){if(l===0)break e;l--,P+=c[g++]<<R,R+=8}i.head&&(i.head.time=P),i.flags&512&&i.wrap&4&&(Ne[0]=P&255,Ne[1]=P>>>8&255,Ne[2]=P>>>16&255,Ne[3]=P>>>24&255,i.check=Ln(i.check,Ne,4,0)),P=0,R=0,i.mode=_C;case _C:for(;R<16;){if(l===0)break e;l--,P+=c[g++]<<R,R+=8}i.head&&(i.head.xflags=P&255,i.head.os=P>>8),i.flags&512&&i.wrap&4&&(Ne[0]=P&255,Ne[1]=P>>>8&255,i.check=Ln(i.check,Ne,2,0)),P=0,R=0,i.mode=yC;case yC:if(i.flags&1024){for(;R<16;){if(l===0)break e;l--,P+=c[g++]<<R,R+=8}i.length=P,i.head&&(i.head.extra_len=P),i.flags&512&&i.wrap&4&&(Ne[0]=P&255,Ne[1]=P>>>8&255,i.check=Ln(i.check,Ne,2,0)),P=0,R=0}else i.head&&(i.head.extra=null);i.mode=vC;case vC:if(i.flags&1024&&(A=i.length,A>l&&(A=l),A&&(i.head&&(xe=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(c.subarray(g,g+A),xe)),i.flags&512&&i.wrap&4&&(i.check=Ln(i.check,c,A,g)),l-=A,g+=A,i.length-=A),i.length))break e;i.length=0,i.mode=xC;case xC:if(i.flags&2048){if(l===0)break e;A=0;do xe=c[g+A++],i.head&&xe&&i.length<65536&&(i.head.name+=String.fromCharCode(xe));while(xe&&A<l);if(i.flags&512&&i.wrap&4&&(i.check=Ln(i.check,c,A,g)),l-=A,g+=A,xe)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=bC;case bC:if(i.flags&4096){if(l===0)break e;A=0;do xe=c[g+A++],i.head&&xe&&i.length<65536&&(i.head.comment+=String.fromCharCode(xe));while(xe&&A<l);if(i.flags&512&&i.wrap&4&&(i.check=Ln(i.check,c,A,g)),l-=A,g+=A,xe)break e}else i.head&&(i.head.comment=null);i.mode=wC;case wC:if(i.flags&512){for(;R<16;){if(l===0)break e;l--,P+=c[g++]<<R,R+=8}if(i.wrap&4&&P!==(i.check&65535)){e.msg="header crc mismatch",i.mode=Ur;break}P=0,R=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=qs;break;case SC:for(;R<32;){if(l===0)break e;l--,P+=c[g++]<<R,R+=8}e.adler=i.check=OC(P),P=0,R=0,i.mode=N_;case N_:if(i.havedict===0)return e.next_out=m,e.avail_out=E,e.next_in=g,e.avail_in=l,i.hold=P,i.bits=R,h$;e.adler=i.check=1,i.mode=qs;case qs:if(r===c$||r===Mg)break e;case O0:if(i.last){P>>>=R&7,R-=R&7,i.mode=N0;break}for(;R<3;){if(l===0)break e;l--,P+=c[g++]<<R,R+=8}switch(i.last=P&1,P>>>=1,R-=1,P&3){case 0:i.mode=TC;break;case 1:if(v$(i),i.mode=kg,r===Mg){P>>>=2,R-=2;break e}break;case 2:i.mode=PC;break;case 3:e.msg="invalid block type",i.mode=Ur}P>>>=2,R-=2;break;case TC:for(P>>>=R&7,R-=R&7;R<32;){if(l===0)break e;l--,P+=c[g++]<<R,R+=8}if((P&65535)!==(P>>>16^65535)){e.msg="invalid stored block lengths",i.mode=Ur;break}if(i.length=P&65535,P=0,R=0,i.mode=F0,r===Mg)break e;case F0:i.mode=CC;case CC:if(A=i.length,A){if(A>l&&(A=l),A>E&&(A=E),A===0)break e;d.set(c.subarray(g,g+A),m),l-=A,g+=A,E-=A,m+=A,i.length-=A;break}i.mode=qs;break;case PC:for(;R<14;){if(l===0)break e;l--,P+=c[g++]<<R,R+=8}if(i.nlen=(P&31)+257,P>>>=5,R-=5,i.ndist=(P&31)+1,P>>>=5,R-=5,i.ncode=(P&15)+4,P>>>=4,R-=4,i.nlen>286||i.ndist>30){e.msg="too many length or distance symbols",i.mode=Ur;break}i.have=0,i.mode=EC;case EC:for(;i.have<i.ncode;){for(;R<3;){if(l===0)break e;l--,P+=c[g++]<<R,R+=8}i.lens[et[i.have++]]=P&7,P>>>=3,R-=3}for(;i.have<19;)i.lens[et[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,Ie={bits:i.lenbits},ze=Vf(l$,i.lens,0,19,i.lencode,0,i.work,Ie),i.lenbits=Ie.bits,ze){e.msg="invalid code lengths set",i.mode=Ur;break}i.have=0,i.mode=MC;case MC:for(;i.have<i.nlen+i.ndist;){for(;ee=i.lencode[P&(1<<i.lenbits)-1],H=ee>>>24,U=ee>>>16&255,W=ee&65535,!(H<=R);){if(l===0)break e;l--,P+=c[g++]<<R,R+=8}if(W<16)P>>>=H,R-=H,i.lens[i.have++]=W;else{if(W===16){for($e=H+2;R<$e;){if(l===0)break e;l--,P+=c[g++]<<R,R+=8}if(P>>>=H,R-=H,i.have===0){e.msg="invalid bit length repeat",i.mode=Ur;break}xe=i.lens[i.have-1],A=3+(P&3),P>>>=2,R-=2}else if(W===17){for($e=H+3;R<$e;){if(l===0)break e;l--,P+=c[g++]<<R,R+=8}P>>>=H,R-=H,xe=0,A=3+(P&7),P>>>=3,R-=3}else{for($e=H+7;R<$e;){if(l===0)break e;l--,P+=c[g++]<<R,R+=8}P>>>=H,R-=H,xe=0,A=11+(P&127),P>>>=7,R-=7}if(i.have+A>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=Ur;break}for(;A--;)i.lens[i.have++]=xe}}if(i.mode===Ur)break;if(i.lens[256]===0){e.msg="invalid code -- missing end-of-block",i.mode=Ur;break}if(i.lenbits=9,Ie={bits:i.lenbits},ze=Vf(EA,i.lens,0,i.nlen,i.lencode,0,i.work,Ie),i.lenbits=Ie.bits,ze){e.msg="invalid literal/lengths set",i.mode=Ur;break}if(i.distbits=6,i.distcode=i.distdyn,Ie={bits:i.distbits},ze=Vf(MA,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,Ie),i.distbits=Ie.bits,ze){e.msg="invalid distances set",i.mode=Ur;break}if(i.mode=kg,r===Mg)break e;case kg:i.mode=Ig;case Ig:if(l>=6&&E>=258){e.next_out=m,e.avail_out=E,e.next_in=g,e.avail_in=l,i.hold=P,i.bits=R,r$(e,F),m=e.next_out,d=e.output,E=e.avail_out,g=e.next_in,c=e.input,l=e.avail_in,P=i.hold,R=i.bits,i.mode===qs&&(i.back=-1);break}for(i.back=0;ee=i.lencode[P&(1<<i.lenbits)-1],H=ee>>>24,U=ee>>>16&255,W=ee&65535,!(H<=R);){if(l===0)break e;l--,P+=c[g++]<<R,R+=8}if(U&&!(U&240)){for(re=H,ge=U,Te=W;ee=i.lencode[Te+((P&(1<<re+ge)-1)>>re)],H=ee>>>24,U=ee>>>16&255,W=ee&65535,!(re+H<=R);){if(l===0)break e;l--,P+=c[g++]<<R,R+=8}P>>>=re,R-=re,i.back+=re}if(P>>>=H,R-=H,i.back+=H,i.length=W,U===0){i.mode=RC;break}if(U&32){i.back=-1,i.mode=qs;break}if(U&64){e.msg="invalid literal/length code",i.mode=Ur;break}i.extra=U&15,i.mode=kC;case kC:if(i.extra){for($e=i.extra;R<$e;){if(l===0)break e;l--,P+=c[g++]<<R,R+=8}i.length+=P&(1<<i.extra)-1,P>>>=i.extra,R-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=IC;case IC:for(;ee=i.distcode[P&(1<<i.distbits)-1],H=ee>>>24,U=ee>>>16&255,W=ee&65535,!(H<=R);){if(l===0)break e;l--,P+=c[g++]<<R,R+=8}if(!(U&240)){for(re=H,ge=U,Te=W;ee=i.distcode[Te+((P&(1<<re+ge)-1)>>re)],H=ee>>>24,U=ee>>>16&255,W=ee&65535,!(re+H<=R);){if(l===0)break e;l--,P+=c[g++]<<R,R+=8}P>>>=re,R-=re,i.back+=re}if(P>>>=H,R-=H,i.back+=H,U&64){e.msg="invalid distance code",i.mode=Ur;break}i.offset=W,i.extra=U&15,i.mode=AC;case AC:if(i.extra){for($e=i.extra;R<$e;){if(l===0)break e;l--,P+=c[g++]<<R,R+=8}i.offset+=P&(1<<i.extra)-1,P>>>=i.extra,R-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=Ur;break}i.mode=zC;case zC:if(E===0)break e;if(A=F-E,i.offset>A){if(A=i.offset-A,A>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=Ur;break}A>i.wnext?(A-=i.wnext,X=i.wsize-A):X=i.wnext-A,A>i.length&&(A=i.length),Z=i.window}else Z=d,X=m-i.offset,A=i.length;A>E&&(A=E),E-=A,i.length-=A;do d[m++]=Z[X++];while(--A);i.length===0&&(i.mode=Ig);break;case RC:if(E===0)break e;d[m++]=i.length,E--,i.mode=Ig;break;case N0:if(i.wrap){for(;R<32;){if(l===0)break e;l--,P|=c[g++]<<R,R+=8}if(F-=E,e.total_out+=F,i.total+=F,i.wrap&4&&F&&(e.adler=i.check=i.flags?Ln(i.check,d,F,m-F):vp(i.check,d,F,m-F)),F=E,i.wrap&4&&(i.flags?P:OC(P))!==i.check){e.msg="incorrect data check",i.mode=Ur;break}P=0,R=0}i.mode=DC;case DC:if(i.wrap&&i.flags){for(;R<32;){if(l===0)break e;l--,P+=c[g++]<<R,R+=8}if(i.wrap&4&&P!==(i.total&4294967295)){e.msg="incorrect length check",i.mode=Ur;break}P=0,R=0}i.mode=LC;case LC:ze=u$;break e;case Ur:ze=kA;break e;case AA:return IA;case zA:default:return xo}return e.next_out=m,e.avail_out=E,e.next_in=g,e.avail_in=l,i.hold=P,i.bits=R,(i.wsize||F!==e.avail_out&&i.mode<Ur&&(i.mode<N0||r!==fC))&&FA(e,e.output,e.next_out,F-e.avail_out),N-=e.avail_in,F-=e.avail_out,e.total_in+=N,e.total_out+=F,i.total+=F,i.wrap&4&&F&&(e.adler=i.check=i.flags?Ln(i.check,d,F,e.next_out-F):vp(i.check,d,F,e.next_out-F)),e.data_type=i.bits+(i.last?64:0)+(i.mode===qs?128:0)+(i.mode===kg||i.mode===F0?256:0),(N===0&&F===0||r===fC)&&ze===Wc&&(ze=d$),ze},b$=e=>{if(Yc(e))return xo;let r=e.state;return r.window&&(r.window=null),e.state=null,Wc},w$=(e,r)=>{if(Yc(e))return xo;const i=e.state;return i.wrap&2?(i.head=r,r.done=!1,Wc):xo},S$=(e,r)=>{const i=r.length;let c,d,g;return Yc(e)||(c=e.state,c.wrap!==0&&c.mode!==N_)?xo:c.mode===N_&&(d=1,d=vp(d,r,i,0),d!==c.check)?kA:(g=FA(e,r,i,i),g?(c.mode=AA,IA):(c.havedict=1,Wc))};var T$=DA,C$=LA,P$=RA,E$=y$,M$=OA,k$=x$,I$=b$,A$=w$,z$=S$,R$="pako inflate (from Nodeca project)",Js={inflateReset:T$,inflateReset2:C$,inflateResetKeep:P$,inflateInit:E$,inflateInit2:M$,inflate:k$,inflateEnd:I$,inflateGetHeader:A$,inflateSetDictionary:z$,inflateInfo:R$};function D$(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var L$=D$;const NA=Object.prototype.toString,{Z_NO_FLUSH:O$,Z_FINISH:F$,Z_OK:wp,Z_STREAM_END:$0,Z_NEED_DICT:U0,Z_STREAM_ERROR:N$,Z_DATA_ERROR:NC,Z_MEM_ERROR:B$}=Lp;function Np(e){this.options=wy.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const r=this.options;r.raw&&r.windowBits>=0&&r.windowBits<16&&(r.windowBits=-r.windowBits,r.windowBits===0&&(r.windowBits=-15)),r.windowBits>=0&&r.windowBits<16&&!(e&&e.windowBits)&&(r.windowBits+=32),r.windowBits>15&&r.windowBits<48&&(r.windowBits&15||(r.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new CA,this.strm.avail_out=0;let i=Js.inflateInit2(this.strm,r.windowBits);if(i!==wp)throw new Error(Gc[i]);if(this.header=new L$,Js.inflateGetHeader(this.strm,this.header),r.dictionary&&(typeof r.dictionary=="string"?r.dictionary=bp.string2buf(r.dictionary):NA.call(r.dictionary)==="[object ArrayBuffer]"&&(r.dictionary=new Uint8Array(r.dictionary)),r.raw&&(i=Js.inflateSetDictionary(this.strm,r.dictionary),i!==wp)))throw new Error(Gc[i])}Np.prototype.push=function(e,r){const i=this.strm,c=this.options.chunkSize,d=this.options.dictionary;let g,m,l;if(this.ended)return!1;for(r===~~r?m=r:m=r===!0?F$:O$,NA.call(e)==="[object ArrayBuffer]"?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;){for(i.avail_out===0&&(i.output=new Uint8Array(c),i.next_out=0,i.avail_out=c),g=Js.inflate(i,m),g===U0&&d&&(g=Js.inflateSetDictionary(i,d),g===wp?g=Js.inflate(i,m):g===NC&&(g=U0));i.avail_in>0&&g===$0&&i.state.wrap>0&&e[i.next_in]!==0;)Js.inflateReset(i),g=Js.inflate(i,m);switch(g){case N$:case NC:case U0:case B$:return this.onEnd(g),this.ended=!0,!1}if(l=i.avail_out,i.next_out&&(i.avail_out===0||g===$0))if(this.options.to==="string"){let E=bp.utf8border(i.output,i.next_out),P=i.next_out-E,R=bp.buf2string(i.output,E);i.next_out=P,i.avail_out=c-P,P&&i.output.set(i.output.subarray(E,E+P),0),this.onData(R)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(!(g===wp&&l===0)){if(g===$0)return g=Js.inflateEnd(this.strm),this.onEnd(g),this.ended=!0,!0;if(i.avail_in===0)break}}return!0};Np.prototype.onData=function(e){this.chunks.push(e)};Np.prototype.onEnd=function(e){e===wp&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=wy.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Gw(e,r){const i=new Np(r);if(i.push(e),i.err)throw i.msg||Gc[i.err];return i.result}function j$(e,r){return r=r||{},r.raw=!0,Gw(e,r)}var $$=Np,U$=Gw,V$=j$,Z$=Gw,G$={Inflate:$$,inflate:U$,inflateRaw:V$,ungzip:Z$};const{Deflate:H$,deflate:W$,deflateRaw:q$,gzip:X$}=e$,{Inflate:K$,inflate:Y$,inflateRaw:Q$,ungzip:J$}=G$;var BA=H$,jA=W$,$A=q$,UA=X$,VA=K$,ZA=Y$,GA=Q$,HA=J$,WA=Lp,qA={Deflate:BA,deflate:jA,deflateRaw:$A,gzip:UA,Inflate:VA,inflate:ZA,inflateRaw:GA,ungzip:HA,constants:WA};const BC=Object.freeze(Object.defineProperty({__proto__:null,Deflate:BA,Inflate:VA,constants:WA,default:qA,deflate:jA,deflateRaw:$A,gzip:UA,inflate:ZA,inflateRaw:GA,ungzip:HA},Symbol.toStringTag,{value:"Module"}));function eU({selectedMetric:e,exportOptions:r}){const[i,c]=Y.useState(0),[d,g]=Y.useState([]);Y.useEffect(()=>{(async()=>{try{const F=await(await fetch("https://cdn.jsdelivr.net/gh/Jasperc2024/Domapus@main/public/data/zip-data.json.gz")).arrayBuffer(),A=qA.ungzip(new Uint8Array(F),{to:"string"}),X=JSON.parse(A);let Z=X;r&&(r.regionScope==="state"&&r.selectedState?Z=Object.fromEntries(Object.entries(X).filter(([,H])=>H.state===r.selectedState)):r.regionScope==="metro"&&r.selectedMetro&&(Z=Object.fromEntries(Object.entries(X).filter(([,H])=>H.parent_metro===r.selectedMetro)))),c(Object.keys(Z).length);const ee=Object.values(Z).map(H=>gy(H,e)).filter(H=>H>0).sort((H,U)=>H-U);g(ee)}catch(N){console.error("Error loading legend data:",N),c(2e4),g([])}})()},[e,r]);const m=()=>{if(d.length===0)return{min:"No data",max:"No data",quintiles:[]};const R=d[0],N=d[d.length-1],F=[];for(let A=0;A<=4;A++){const X=Math.floor((d.length-1)*(A/4));F.push(d[X])}return{min:qg({[e.replace("-","_")]:R},e),max:qg({[e.replace("-","_")]:N},e),quintiles:F.map(A=>qg({[e.replace("-","_")]:A},e))}},{min:l,max:E,quintiles:P}=m();return ye.jsxs(rI,{className:"bg-dashboard-panel border-dashboard-border shadow-sm",children:[ye.jsx(nI,{className:"pb-2",children:ye.jsx(iI,{className:"text-sm font-medium text-dashboard-text-primary",children:nA[e]})}),ye.jsx(oI,{className:"pt-0",children:ye.jsxs("div",{className:"space-y-3",children:[ye.jsxs("div",{className:"relative",children:[ye.jsx("div",{className:"h-4 rounded-lg",style:{background:"linear-gradient(to right, #FFF9B0, #FFA873, #E84C61, #922C7E, #2E0B59)"}}),ye.jsxs("div",{className:"flex justify-between text-xs text-dashboard-text-secondary mt-1",children:[ye.jsx("span",{children:l}),ye.jsx("span",{children:E})]})]}),ye.jsx("div",{className:"grid grid-cols-5 gap-1 text-xs",children:P.map((R,N)=>{const F=["#FFF9B0","#FFA873","#E84C61","#922C7E","#2E0B59"];return ye.jsxs("div",{className:"text-center",children:[ye.jsx("div",{className:"w-3 h-3 rounded mx-auto mb-1",style:{backgroundColor:F[N]}}),ye.jsx("span",{className:"text-dashboard-text-secondary text-[10px]",children:R})]},N)})}),ye.jsxs("div",{className:"text-xs text-dashboard-text-secondary text-center pt-2 border-t border-dashboard-border",children:["Showing ",i.toLocaleString()," ZIP codes"]})]})})]})}const tU=NM("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),B_=Y.forwardRef(({className:e,variant:r,size:i,asChild:c=!1,...d},g)=>{const m=c?m3:"button";return ye.jsx(m,{className:Kr(tU({variant:r,size:i,className:e})),ref:g,...d})});B_.displayName="Button";const XA=Y.forwardRef(({className:e,type:r,...i},c)=>ye.jsx("input",{type:r,className:Kr("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:c,...i}));XA.displayName="Input";const rU=(e,r)=>{const[i,c]=Y.useState();return Y.useCallback((...g)=>{i&&clearTimeout(i);const m=setTimeout(()=>{e(...g)},r);c(m)},[e,r,i])};function jC({onSearch:e}){const[r,i]=Y.useState(""),c=rU(m=>{m.trim()&&m.length>=3&&e(m.trim())},300),d=m=>{const l=m.target.value;i(l),c(l)},g=m=>{m.preventDefault(),r.trim()&&e(r.trim())};return ye.jsx("div",{className:"bg-dashboard-panel border border-dashboard-border rounded-lg p-3 shadow-sm",children:ye.jsxs("form",{onSubmit:g,className:"flex items-center space-x-2",children:[ye.jsxs("div",{className:"relative flex-1",children:[ye.jsx(d5,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-dashboard-text-secondary"}),ye.jsx(XA,{type:"text",placeholder:"Enter ZIP code...",value:r,onChange:d,className:"pl-10 w-48",maxLength:5,"aria-label":"Search for ZIP code"})]}),ye.jsx(B_,{type:"submit",variant:"outline",size:"sm","aria-label":"Search for ZIP code",children:"Search"})]})})}function nU({lastUpdated:e}){const r=i=>{if(!i)return"July 1, 2025";try{return new Date(i).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch{return"July 1, 2025"}};return ye.jsxs("div",{className:"flex items-center space-x-2 bg-dashboard-panel border border-dashboard-border rounded-lg px-3 py-2 shadow-sm",children:[ye.jsx(a5,{className:"h-4 w-4 text-dashboard-text-secondary"}),ye.jsxs("span",{className:"text-sm text-dashboard-text-secondary",children:["Updated: ",r(e||"")]})]})}const V0=768;function iU(){const[e,r]=Y.useState(void 0);return Y.useEffect(()=>{const i=window.matchMedia(`(max-width: ${V0-1}px)`),c=()=>{r(window.innerWidth<V0)};return i.addEventListener("change",c),r(window.innerWidth<V0),()=>i.removeEventListener("change",c)},[]),!!e}function oU({selectedMetric:e,onMetricChange:r,onSearch:i,lastUpdated:c}){const d=iU();return ye.jsxs("div",{className:"flex items-center justify-between p-2 sm:p-4 bg-dashboard-panel border-b border-dashboard-border",children:[ye.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-6",children:[ye.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>window.location.reload(),title:"Click to reload page",children:[ye.jsx("img",{src:"/Domapus/apple-touch-icon.png",alt:"Domapus Logo",className:"h-8 w-8 sm:h-10 sm:w-10",width:"40",height:"40",loading:"eager",decoding:"sync"}),ye.jsxs("div",{className:"flex flex-col",children:[ye.jsx("h1",{className:"text-lg sm:text-xl font-bold text-dashboard-text-primary leading-tight",children:"Domapus"}),ye.jsx("p",{className:"text-xs sm:text-sm text-dashboard-text-secondary leading-tight",children:"U.S. Housing Market Dashboard"})]})]}),!d&&ye.jsx(QT,{selectedMetric:e,onMetricChange:r})]}),ye.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[!d&&ye.jsx(jC,{onSearch:i}),!d&&ye.jsx(nU,{lastUpdated:c}),ye.jsx(B_,{variant:"outline",size:"sm",asChild:!0,className:"hidden sm:flex",children:ye.jsxs("a",{href:"https://github.com/Jasperc2024/Domapus",target:"_blank",rel:"noopener noreferrer","aria-label":"View project on GitHub",className:"flex items-center space-x-2",children:[ye.jsx(u5,{className:"h-4 w-4","aria-hidden":"true"}),ye.jsx("span",{children:"GitHub"})]})}),ye.jsx(B_,{variant:"default",size:"sm",asChild:!0,className:"hidden sm:flex bg-pink-600 hover:bg-pink-700 text-white",children:ye.jsxs("a",{href:"https://buymeacoffee.com/JasperC",target:"_blank",rel:"noopener noreferrer","aria-label":"Support this project by sponsoring",className:"flex items-center space-x-2",children:[ye.jsx(h5,{className:"h-4 w-4","aria-hidden":"true"}),ye.jsx("span",{children:"Sponsor"})]})})]}),d&&ye.jsx("div",{className:"fixed bottom-4 left-4 right-4 z-[1001] bg-dashboard-panel border border-dashboard-border rounded-lg p-3 shadow-lg",children:ye.jsxs("div",{className:"space-y-3",children:[ye.jsx(QT,{selectedMetric:e,onMetricChange:r}),ye.jsx(jC,{onSearch:i})]})})]})}const sU=ft.lazy(()=>Qx(()=>import("./Sidebar-PT1EW82B.js").then(e=>e.S),[]).then(e=>({default:e.Sidebar})));function aU(){const[e,r]=Y.useState("median-sale-price"),[i,c]=Y.useState(null),[d,g]=Y.useState(""),[m,l]=Y.useState(!1),[E,P]=Y.useState(!1),[R,N]=Y.useState("");Y.useEffect(()=>{N("2025-07-01")},[]);const F=ee=>{c(ee),l(!0),P(!1)},A=ee=>{g(ee)},X=()=>{l(!1),c(null)},Z=()=>{P(!E)};return ye.jsxs("div",{className:"w-full h-screen bg-dashboard-bg overflow-hidden flex flex-col",children:[ye.jsx(oU,{selectedMetric:e,onMetricChange:r,onSearch:A,lastUpdated:R}),ye.jsxs("div",{className:"flex flex-1 relative",children:[ye.jsx(Y.Suspense,{fallback:ye.jsx("div",{className:"p-4 text-sm text-muted",children:"Loading sidebar..."}),children:ye.jsx(sU,{isOpen:m,isCollapsed:E,zipData:i,onClose:X,onToggleCollapse:Z})}),ye.jsxs("div",{className:`flex-1 relative transition-all duration-300 ${m?E?"ml-16":"ml-96":"ml-0"}`,children:[ye.jsx("div",{className:"absolute inset-0",children:ye.jsx(LB,{selectedMetric:e,onZipSelect:F,searchZip:d})}),ye.jsx("div",{className:"absolute bottom-4 right-4 w-72 z-[1000] pointer-events-auto",children:ye.jsx(eU,{selectedMetric:e})}),ye.jsxs("div",{className:"absolute top-4 right-4 flex flex-col space-y-2 z-[1000] pointer-events-auto",children:[d&&ye.jsxs("div",{className:"bg-primary text-primary-foreground px-3 py-2 rounded-lg shadow-lg text-sm",children:["Searching for: ",d]}),i&&ye.jsxs("div",{className:"bg-accent text-accent-foreground px-3 py-2 rounded-lg shadow-lg text-sm",children:["Selected: ",i.zipCode]})]})]})]})]})}const lU=()=>ye.jsx(aU,{}),cU=()=>{const e=Zk();return Y.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),ye.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:ye.jsxs("div",{className:"text-center",children:[ye.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),ye.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),ye.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},uU=new F4,hU=()=>ye.jsx(B4,{client:uU,children:ye.jsxs(f4,{children:[ye.jsx(X5,{}),ye.jsx(EO,{}),ye.jsx(PN,{basename:"/Domapus",children:ye.jsxs(SN,{children:[ye.jsx(Kx,{path:"/",element:ye.jsx(lU,{})}),ye.jsx(Kx,{path:"*",element:ye.jsx(cU,{})})]})})]})});class dU extends ft.Component{constructor(r){super(r),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(r,i){console.error("Error Boundary Caught:",r,i)}render(){return this.state.hasError?ye.jsx("h2",{children:"Something went wrong. Please reload the page."}):this.props.children}}lM(document.getElementById("root")).render(ye.jsx(dU,{children:ye.jsx(hU,{})}));export{tI as A,B_ as B,l5 as C,Hg as D,qg as E,d5 as F,OR as G,yb as H,XA as I,BC as J,wr as P,uj as S,f5 as X,Qx as _,Kr as a,NM as b,Pl as c,Ip as d,hM as e,ar as f,on as g,jB as h,Fx as i,ye as j,qo as k,mw as l,XB as m,UF as n,rI as o,nI as p,iI as q,Y as r,oI as s,QI as t,xw as u,hj as v,tA as w,rA as x,qA as y,gy as z};
