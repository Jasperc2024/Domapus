(function(){"use strict";function X(i){let t=i.length;for(;--t>=0;)i[t]=0}const xt=3,wt=258,pe=29,_t=256+1+pe,be=30,pt=512,bt=new Array((_t+2)*2);X(bt);const gt=new Array(be*2);X(gt);const mt=new Array(pt);X(mt);const kt=new Array(wt-xt+1);X(kt);const Et=new Array(pe);X(Et);const yt=new Array(be);X(yt);var ae=(i,t,e,a)=>{let l=i&65535|0,n=i>>>16&65535|0,f=0;for(;e!==0;){f=e>2e3?2e3:e,e-=f;do l=l+t[a++]|0,n=n+l|0;while(--f);l%=65521,n%=65521}return l|n<<16|0};const vt=()=>{let i,t=[];for(var e=0;e<256;e++){i=e;for(var a=0;a<8;a++)i=i&1?3988292384^i>>>1:i>>>1;t[e]=i}return t},St=new Uint32Array(vt());var D=(i,t,e,a)=>{const l=St,n=a+e;i^=-1;for(let f=a;f<n;f++)i=i>>>8^l[(i^t[f])&255];return i^-1},se={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ge={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const Mt=(i,t)=>Object.prototype.hasOwnProperty.call(i,t);var At=function(i){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const e=t.shift();if(e){if(typeof e!="object")throw new TypeError(e+"must be non-object");for(const a in e)Mt(e,a)&&(i[a]=e[a])}}return i},Rt=i=>{let t=0;for(let a=0,l=i.length;a<l;a++)t+=i[a].length;const e=new Uint8Array(t);for(let a=0,l=0,n=i.length;a<n;a++){let f=i[a];e.set(f,l),l+=f.length}return e},me={assign:At,flattenChunks:Rt};let ke=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{ke=!1}const F=new Uint8Array(256);for(let i=0;i<256;i++)F[i]=i>=252?6:i>=248?5:i>=240?4:i>=224?3:i>=192?2:1;F[254]=F[254]=1;var Bt=i=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(i);let t,e,a,l,n,f=i.length,r=0;for(l=0;l<f;l++)e=i.charCodeAt(l),(e&64512)===55296&&l+1<f&&(a=i.charCodeAt(l+1),(a&64512)===56320&&(e=65536+(e-55296<<10)+(a-56320),l++)),r+=e<128?1:e<2048?2:e<65536?3:4;for(t=new Uint8Array(r),n=0,l=0;n<r;l++)e=i.charCodeAt(l),(e&64512)===55296&&l+1<f&&(a=i.charCodeAt(l+1),(a&64512)===56320&&(e=65536+(e-55296<<10)+(a-56320),l++)),e<128?t[n++]=e:e<2048?(t[n++]=192|e>>>6,t[n++]=128|e&63):e<65536?(t[n++]=224|e>>>12,t[n++]=128|e>>>6&63,t[n++]=128|e&63):(t[n++]=240|e>>>18,t[n++]=128|e>>>12&63,t[n++]=128|e>>>6&63,t[n++]=128|e&63);return t};const Dt=(i,t)=>{if(t<65534&&i.subarray&&ke)return String.fromCharCode.apply(null,i.length===t?i:i.subarray(0,t));let e="";for(let a=0;a<t;a++)e+=String.fromCharCode(i[a]);return e};var Ot=(i,t)=>{const e=t||i.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(i.subarray(0,t));let a,l;const n=new Array(e*2);for(l=0,a=0;a<e;){let f=i[a++];if(f<128){n[l++]=f;continue}let r=F[f];if(r>4){n[l++]=65533,a+=r-1;continue}for(f&=r===2?31:r===3?15:7;r>1&&a<e;)f=f<<6|i[a++]&63,r--;if(r>1){n[l++]=65533;continue}f<65536?n[l++]=f:(f-=65536,n[l++]=55296|f>>10&1023,n[l++]=56320|f&1023)}return Dt(n,l)},Tt=(i,t)=>{t=t||i.length,t>i.length&&(t=i.length);let e=t-1;for(;e>=0&&(i[e]&192)===128;)e--;return e<0||e===0?t:e+F[i[e]]>t?e:t},oe={string2buf:Bt,buf2string:Ot,utf8border:Tt};function It(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Ct=It;const G=16209,Nt=16191;var Xt=function(t,e){let a,l,n,f,r,d,s,o,p,u,c,w,y,g,x,k,m,h,S,R,_,M,v,b;const E=t.state;a=t.next_in,v=t.input,l=a+(t.avail_in-5),n=t.next_out,b=t.output,f=n-(e-t.avail_out),r=n+(t.avail_out-257),d=E.dmax,s=E.wsize,o=E.whave,p=E.wnext,u=E.window,c=E.hold,w=E.bits,y=E.lencode,g=E.distcode,x=(1<<E.lenbits)-1,k=(1<<E.distbits)-1;e:do{w<15&&(c+=v[a++]<<w,w+=8,c+=v[a++]<<w,w+=8),m=y[c&x];t:for(;;){if(h=m>>>24,c>>>=h,w-=h,h=m>>>16&255,h===0)b[n++]=m&65535;else if(h&16){S=m&65535,h&=15,h&&(w<h&&(c+=v[a++]<<w,w+=8),S+=c&(1<<h)-1,c>>>=h,w-=h),w<15&&(c+=v[a++]<<w,w+=8,c+=v[a++]<<w,w+=8),m=g[c&k];i:for(;;){if(h=m>>>24,c>>>=h,w-=h,h=m>>>16&255,h&16){if(R=m&65535,h&=15,w<h&&(c+=v[a++]<<w,w+=8,w<h&&(c+=v[a++]<<w,w+=8)),R+=c&(1<<h)-1,R>d){t.msg="invalid distance too far back",E.mode=G;break e}if(c>>>=h,w-=h,h=n-f,R>h){if(h=R-h,h>o&&E.sane){t.msg="invalid distance too far back",E.mode=G;break e}if(_=0,M=u,p===0){if(_+=s-h,h<S){S-=h;do b[n++]=u[_++];while(--h);_=n-R,M=b}}else if(p<h){if(_+=s+p-h,h-=p,h<S){S-=h;do b[n++]=u[_++];while(--h);if(_=0,p<S){h=p,S-=h;do b[n++]=u[_++];while(--h);_=n-R,M=b}}}else if(_+=p-h,h<S){S-=h;do b[n++]=u[_++];while(--h);_=n-R,M=b}for(;S>2;)b[n++]=M[_++],b[n++]=M[_++],b[n++]=M[_++],S-=3;S&&(b[n++]=M[_++],S>1&&(b[n++]=M[_++]))}else{_=n-R;do b[n++]=b[_++],b[n++]=b[_++],b[n++]=b[_++],S-=3;while(S>2);S&&(b[n++]=b[_++],S>1&&(b[n++]=b[_++]))}}else if((h&64)===0){m=g[(m&65535)+(c&(1<<h)-1)];continue i}else{t.msg="invalid distance code",E.mode=G;break e}break}}else if((h&64)===0){m=y[(m&65535)+(c&(1<<h)-1)];continue t}else if(h&32){E.mode=Nt;break e}else{t.msg="invalid literal/length code",E.mode=G;break e}break}}while(a<l&&n<r);S=w>>3,a-=S,w-=S<<3,c&=(1<<w)-1,t.next_in=a,t.next_out=n,t.avail_in=a<l?5+(l-a):5-(a-l),t.avail_out=n<r?257+(r-n):257-(n-r),E.hold=c,E.bits=w};const Y=15,Ee=852,ye=592,ve=0,re=1,Se=2,Yt=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Zt=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),zt=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Ft=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var U=(i,t,e,a,l,n,f,r)=>{const d=r.bits;let s=0,o=0,p=0,u=0,c=0,w=0,y=0,g=0,x=0,k=0,m,h,S,R,_,M=null,v;const b=new Uint16Array(Y+1),E=new Uint16Array(Y+1);let N=null,ut,ie,ne;for(s=0;s<=Y;s++)b[s]=0;for(o=0;o<a;o++)b[t[e+o]]++;for(c=d,u=Y;u>=1&&b[u]===0;u--);if(c>u&&(c=u),u===0)return l[n++]=1<<24|64<<16|0,l[n++]=1<<24|64<<16|0,r.bits=1,0;for(p=1;p<u&&b[p]===0;p++);for(c<p&&(c=p),g=1,s=1;s<=Y;s++)if(g<<=1,g-=b[s],g<0)return-1;if(g>0&&(i===ve||u!==1))return-1;for(E[1]=0,s=1;s<Y;s++)E[s+1]=E[s]+b[s];for(o=0;o<a;o++)t[e+o]!==0&&(f[E[t[e+o]]++]=o);if(i===ve?(M=N=f,v=20):i===re?(M=Yt,N=Zt,v=257):(M=zt,N=Ft,v=0),k=0,o=0,s=p,_=n,w=c,y=0,S=-1,x=1<<c,R=x-1,i===re&&x>Ee||i===Se&&x>ye)return 1;for(;;){ut=s-y,f[o]+1<v?(ie=0,ne=f[o]):f[o]>=v?(ie=N[f[o]-v],ne=M[f[o]-v]):(ie=96,ne=0),m=1<<s-y,h=1<<w,p=h;do h-=m,l[_+(k>>y)+h]=ut<<24|ie<<16|ne|0;while(h!==0);for(m=1<<s-1;k&m;)m>>=1;if(m!==0?(k&=m-1,k+=m):k=0,o++,--b[s]===0){if(s===u)break;s=t[e+f[o]]}if(s>c&&(k&R)!==S){for(y===0&&(y=c),_+=p,w=s-y,g=1<<w;w+y<u&&(g-=b[w+y],!(g<=0));)w++,g<<=1;if(x+=1<<w,i===re&&x>Ee||i===Se&&x>ye)return 1;S=k&R,l[S]=c<<24|w<<16|_-n|0}}return k!==0&&(l[_+k]=s-y<<24|64<<16|0),r.bits=c,0};const Ut=0,Me=1,Ae=2,{Z_FINISH:Re,Z_BLOCK:Lt,Z_TREES:j,Z_OK:I,Z_STREAM_END:$t,Z_NEED_DICT:Pt,Z_STREAM_ERROR:B,Z_DATA_ERROR:Be,Z_MEM_ERROR:De,Z_BUF_ERROR:Ht,Z_DEFLATED:Oe}=ge,K=16180,Te=16181,Ie=16182,Ce=16183,Ne=16184,Xe=16185,Ye=16186,Ze=16187,ze=16188,Fe=16189,J=16190,O=16191,le=16192,Ue=16193,fe=16194,Le=16195,$e=16196,Pe=16197,He=16198,V=16199,W=16200,Ge=16201,je=16202,Ke=16203,Je=16204,Ve=16205,ce=16206,We=16207,qe=16208,A=16209,Qe=16210,et=16211,Gt=852,jt=592,Kt=15,tt=i=>(i>>>24&255)+(i>>>8&65280)+((i&65280)<<8)+((i&255)<<24);function Jt(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const C=i=>{if(!i)return 1;const t=i.state;return!t||t.strm!==i||t.mode<K||t.mode>et?1:0},it=i=>{if(C(i))return B;const t=i.state;return i.total_in=i.total_out=t.total=0,i.msg="",t.wrap&&(i.adler=t.wrap&1),t.mode=K,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(Gt),t.distcode=t.distdyn=new Int32Array(jt),t.sane=1,t.back=-1,I},nt=i=>{if(C(i))return B;const t=i.state;return t.wsize=0,t.whave=0,t.wnext=0,it(i)},at=(i,t)=>{let e;if(C(i))return B;const a=i.state;return t<0?(e=0,t=-t):(e=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?B:(a.window!==null&&a.wbits!==t&&(a.window=null),a.wrap=e,a.wbits=t,nt(i))},st=(i,t)=>{if(!i)return B;const e=new Jt;i.state=e,e.strm=i,e.window=null,e.mode=K;const a=at(i,t);return a!==I&&(i.state=null),a},Vt=i=>st(i,Kt);let ot=!0,he,de;const Wt=i=>{if(ot){he=new Int32Array(512),de=new Int32Array(32);let t=0;for(;t<144;)i.lens[t++]=8;for(;t<256;)i.lens[t++]=9;for(;t<280;)i.lens[t++]=7;for(;t<288;)i.lens[t++]=8;for(U(Me,i.lens,0,288,he,0,i.work,{bits:9}),t=0;t<32;)i.lens[t++]=5;U(Ae,i.lens,0,32,de,0,i.work,{bits:5}),ot=!1}i.lencode=he,i.lenbits=9,i.distcode=de,i.distbits=5},rt=(i,t,e,a)=>{let l;const n=i.state;return n.window===null&&(n.wsize=1<<n.wbits,n.wnext=0,n.whave=0,n.window=new Uint8Array(n.wsize)),a>=n.wsize?(n.window.set(t.subarray(e-n.wsize,e),0),n.wnext=0,n.whave=n.wsize):(l=n.wsize-n.wnext,l>a&&(l=a),n.window.set(t.subarray(e-a,e-a+l),n.wnext),a-=l,a?(n.window.set(t.subarray(e-a,e),0),n.wnext=a,n.whave=n.wsize):(n.wnext+=l,n.wnext===n.wsize&&(n.wnext=0),n.whave<n.wsize&&(n.whave+=l))),0},qt=(i,t)=>{let e,a,l,n,f,r,d,s,o,p,u,c,w,y,g=0,x,k,m,h,S,R,_,M;const v=new Uint8Array(4);let b,E;const N=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(C(i)||!i.output||!i.input&&i.avail_in!==0)return B;e=i.state,e.mode===O&&(e.mode=le),f=i.next_out,l=i.output,d=i.avail_out,n=i.next_in,a=i.input,r=i.avail_in,s=e.hold,o=e.bits,p=r,u=d,M=I;e:for(;;)switch(e.mode){case K:if(e.wrap===0){e.mode=le;break}for(;o<16;){if(r===0)break e;r--,s+=a[n++]<<o,o+=8}if(e.wrap&2&&s===35615){e.wbits===0&&(e.wbits=15),e.check=0,v[0]=s&255,v[1]=s>>>8&255,e.check=D(e.check,v,2,0),s=0,o=0,e.mode=Te;break}if(e.head&&(e.head.done=!1),!(e.wrap&1)||(((s&255)<<8)+(s>>8))%31){i.msg="incorrect header check",e.mode=A;break}if((s&15)!==Oe){i.msg="unknown compression method",e.mode=A;break}if(s>>>=4,o-=4,_=(s&15)+8,e.wbits===0&&(e.wbits=_),_>15||_>e.wbits){i.msg="invalid window size",e.mode=A;break}e.dmax=1<<e.wbits,e.flags=0,i.adler=e.check=1,e.mode=s&512?Fe:O,s=0,o=0;break;case Te:for(;o<16;){if(r===0)break e;r--,s+=a[n++]<<o,o+=8}if(e.flags=s,(e.flags&255)!==Oe){i.msg="unknown compression method",e.mode=A;break}if(e.flags&57344){i.msg="unknown header flags set",e.mode=A;break}e.head&&(e.head.text=s>>8&1),e.flags&512&&e.wrap&4&&(v[0]=s&255,v[1]=s>>>8&255,e.check=D(e.check,v,2,0)),s=0,o=0,e.mode=Ie;case Ie:for(;o<32;){if(r===0)break e;r--,s+=a[n++]<<o,o+=8}e.head&&(e.head.time=s),e.flags&512&&e.wrap&4&&(v[0]=s&255,v[1]=s>>>8&255,v[2]=s>>>16&255,v[3]=s>>>24&255,e.check=D(e.check,v,4,0)),s=0,o=0,e.mode=Ce;case Ce:for(;o<16;){if(r===0)break e;r--,s+=a[n++]<<o,o+=8}e.head&&(e.head.xflags=s&255,e.head.os=s>>8),e.flags&512&&e.wrap&4&&(v[0]=s&255,v[1]=s>>>8&255,e.check=D(e.check,v,2,0)),s=0,o=0,e.mode=Ne;case Ne:if(e.flags&1024){for(;o<16;){if(r===0)break e;r--,s+=a[n++]<<o,o+=8}e.length=s,e.head&&(e.head.extra_len=s),e.flags&512&&e.wrap&4&&(v[0]=s&255,v[1]=s>>>8&255,e.check=D(e.check,v,2,0)),s=0,o=0}else e.head&&(e.head.extra=null);e.mode=Xe;case Xe:if(e.flags&1024&&(c=e.length,c>r&&(c=r),c&&(e.head&&(_=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(a.subarray(n,n+c),_)),e.flags&512&&e.wrap&4&&(e.check=D(e.check,a,c,n)),r-=c,n+=c,e.length-=c),e.length))break e;e.length=0,e.mode=Ye;case Ye:if(e.flags&2048){if(r===0)break e;c=0;do _=a[n+c++],e.head&&_&&e.length<65536&&(e.head.name+=String.fromCharCode(_));while(_&&c<r);if(e.flags&512&&e.wrap&4&&(e.check=D(e.check,a,c,n)),r-=c,n+=c,_)break e}else e.head&&(e.head.name=null);e.length=0,e.mode=Ze;case Ze:if(e.flags&4096){if(r===0)break e;c=0;do _=a[n+c++],e.head&&_&&e.length<65536&&(e.head.comment+=String.fromCharCode(_));while(_&&c<r);if(e.flags&512&&e.wrap&4&&(e.check=D(e.check,a,c,n)),r-=c,n+=c,_)break e}else e.head&&(e.head.comment=null);e.mode=ze;case ze:if(e.flags&512){for(;o<16;){if(r===0)break e;r--,s+=a[n++]<<o,o+=8}if(e.wrap&4&&s!==(e.check&65535)){i.msg="header crc mismatch",e.mode=A;break}s=0,o=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),i.adler=e.check=0,e.mode=O;break;case Fe:for(;o<32;){if(r===0)break e;r--,s+=a[n++]<<o,o+=8}i.adler=e.check=tt(s),s=0,o=0,e.mode=J;case J:if(e.havedict===0)return i.next_out=f,i.avail_out=d,i.next_in=n,i.avail_in=r,e.hold=s,e.bits=o,Pt;i.adler=e.check=1,e.mode=O;case O:if(t===Lt||t===j)break e;case le:if(e.last){s>>>=o&7,o-=o&7,e.mode=ce;break}for(;o<3;){if(r===0)break e;r--,s+=a[n++]<<o,o+=8}switch(e.last=s&1,s>>>=1,o-=1,s&3){case 0:e.mode=Ue;break;case 1:if(Wt(e),e.mode=V,t===j){s>>>=2,o-=2;break e}break;case 2:e.mode=$e;break;case 3:i.msg="invalid block type",e.mode=A}s>>>=2,o-=2;break;case Ue:for(s>>>=o&7,o-=o&7;o<32;){if(r===0)break e;r--,s+=a[n++]<<o,o+=8}if((s&65535)!==(s>>>16^65535)){i.msg="invalid stored block lengths",e.mode=A;break}if(e.length=s&65535,s=0,o=0,e.mode=fe,t===j)break e;case fe:e.mode=Le;case Le:if(c=e.length,c){if(c>r&&(c=r),c>d&&(c=d),c===0)break e;l.set(a.subarray(n,n+c),f),r-=c,n+=c,d-=c,f+=c,e.length-=c;break}e.mode=O;break;case $e:for(;o<14;){if(r===0)break e;r--,s+=a[n++]<<o,o+=8}if(e.nlen=(s&31)+257,s>>>=5,o-=5,e.ndist=(s&31)+1,s>>>=5,o-=5,e.ncode=(s&15)+4,s>>>=4,o-=4,e.nlen>286||e.ndist>30){i.msg="too many length or distance symbols",e.mode=A;break}e.have=0,e.mode=Pe;case Pe:for(;e.have<e.ncode;){for(;o<3;){if(r===0)break e;r--,s+=a[n++]<<o,o+=8}e.lens[N[e.have++]]=s&7,s>>>=3,o-=3}for(;e.have<19;)e.lens[N[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,b={bits:e.lenbits},M=U(Ut,e.lens,0,19,e.lencode,0,e.work,b),e.lenbits=b.bits,M){i.msg="invalid code lengths set",e.mode=A;break}e.have=0,e.mode=He;case He:for(;e.have<e.nlen+e.ndist;){for(;g=e.lencode[s&(1<<e.lenbits)-1],x=g>>>24,k=g>>>16&255,m=g&65535,!(x<=o);){if(r===0)break e;r--,s+=a[n++]<<o,o+=8}if(m<16)s>>>=x,o-=x,e.lens[e.have++]=m;else{if(m===16){for(E=x+2;o<E;){if(r===0)break e;r--,s+=a[n++]<<o,o+=8}if(s>>>=x,o-=x,e.have===0){i.msg="invalid bit length repeat",e.mode=A;break}_=e.lens[e.have-1],c=3+(s&3),s>>>=2,o-=2}else if(m===17){for(E=x+3;o<E;){if(r===0)break e;r--,s+=a[n++]<<o,o+=8}s>>>=x,o-=x,_=0,c=3+(s&7),s>>>=3,o-=3}else{for(E=x+7;o<E;){if(r===0)break e;r--,s+=a[n++]<<o,o+=8}s>>>=x,o-=x,_=0,c=11+(s&127),s>>>=7,o-=7}if(e.have+c>e.nlen+e.ndist){i.msg="invalid bit length repeat",e.mode=A;break}for(;c--;)e.lens[e.have++]=_}}if(e.mode===A)break;if(e.lens[256]===0){i.msg="invalid code -- missing end-of-block",e.mode=A;break}if(e.lenbits=9,b={bits:e.lenbits},M=U(Me,e.lens,0,e.nlen,e.lencode,0,e.work,b),e.lenbits=b.bits,M){i.msg="invalid literal/lengths set",e.mode=A;break}if(e.distbits=6,e.distcode=e.distdyn,b={bits:e.distbits},M=U(Ae,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,b),e.distbits=b.bits,M){i.msg="invalid distances set",e.mode=A;break}if(e.mode=V,t===j)break e;case V:e.mode=W;case W:if(r>=6&&d>=258){i.next_out=f,i.avail_out=d,i.next_in=n,i.avail_in=r,e.hold=s,e.bits=o,Xt(i,u),f=i.next_out,l=i.output,d=i.avail_out,n=i.next_in,a=i.input,r=i.avail_in,s=e.hold,o=e.bits,e.mode===O&&(e.back=-1);break}for(e.back=0;g=e.lencode[s&(1<<e.lenbits)-1],x=g>>>24,k=g>>>16&255,m=g&65535,!(x<=o);){if(r===0)break e;r--,s+=a[n++]<<o,o+=8}if(k&&(k&240)===0){for(h=x,S=k,R=m;g=e.lencode[R+((s&(1<<h+S)-1)>>h)],x=g>>>24,k=g>>>16&255,m=g&65535,!(h+x<=o);){if(r===0)break e;r--,s+=a[n++]<<o,o+=8}s>>>=h,o-=h,e.back+=h}if(s>>>=x,o-=x,e.back+=x,e.length=m,k===0){e.mode=Ve;break}if(k&32){e.back=-1,e.mode=O;break}if(k&64){i.msg="invalid literal/length code",e.mode=A;break}e.extra=k&15,e.mode=Ge;case Ge:if(e.extra){for(E=e.extra;o<E;){if(r===0)break e;r--,s+=a[n++]<<o,o+=8}e.length+=s&(1<<e.extra)-1,s>>>=e.extra,o-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=je;case je:for(;g=e.distcode[s&(1<<e.distbits)-1],x=g>>>24,k=g>>>16&255,m=g&65535,!(x<=o);){if(r===0)break e;r--,s+=a[n++]<<o,o+=8}if((k&240)===0){for(h=x,S=k,R=m;g=e.distcode[R+((s&(1<<h+S)-1)>>h)],x=g>>>24,k=g>>>16&255,m=g&65535,!(h+x<=o);){if(r===0)break e;r--,s+=a[n++]<<o,o+=8}s>>>=h,o-=h,e.back+=h}if(s>>>=x,o-=x,e.back+=x,k&64){i.msg="invalid distance code",e.mode=A;break}e.offset=m,e.extra=k&15,e.mode=Ke;case Ke:if(e.extra){for(E=e.extra;o<E;){if(r===0)break e;r--,s+=a[n++]<<o,o+=8}e.offset+=s&(1<<e.extra)-1,s>>>=e.extra,o-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){i.msg="invalid distance too far back",e.mode=A;break}e.mode=Je;case Je:if(d===0)break e;if(c=u-d,e.offset>c){if(c=e.offset-c,c>e.whave&&e.sane){i.msg="invalid distance too far back",e.mode=A;break}c>e.wnext?(c-=e.wnext,w=e.wsize-c):w=e.wnext-c,c>e.length&&(c=e.length),y=e.window}else y=l,w=f-e.offset,c=e.length;c>d&&(c=d),d-=c,e.length-=c;do l[f++]=y[w++];while(--c);e.length===0&&(e.mode=W);break;case Ve:if(d===0)break e;l[f++]=e.length,d--,e.mode=W;break;case ce:if(e.wrap){for(;o<32;){if(r===0)break e;r--,s|=a[n++]<<o,o+=8}if(u-=d,i.total_out+=u,e.total+=u,e.wrap&4&&u&&(i.adler=e.check=e.flags?D(e.check,l,u,f-u):ae(e.check,l,u,f-u)),u=d,e.wrap&4&&(e.flags?s:tt(s))!==e.check){i.msg="incorrect data check",e.mode=A;break}s=0,o=0}e.mode=We;case We:if(e.wrap&&e.flags){for(;o<32;){if(r===0)break e;r--,s+=a[n++]<<o,o+=8}if(e.wrap&4&&s!==(e.total&4294967295)){i.msg="incorrect length check",e.mode=A;break}s=0,o=0}e.mode=qe;case qe:M=$t;break e;case A:M=Be;break e;case Qe:return De;case et:default:return B}return i.next_out=f,i.avail_out=d,i.next_in=n,i.avail_in=r,e.hold=s,e.bits=o,(e.wsize||u!==i.avail_out&&e.mode<A&&(e.mode<ce||t!==Re))&&rt(i,i.output,i.next_out,u-i.avail_out),p-=i.avail_in,u-=i.avail_out,i.total_in+=p,i.total_out+=u,e.total+=u,e.wrap&4&&u&&(i.adler=e.check=e.flags?D(e.check,l,u,i.next_out-u):ae(e.check,l,u,i.next_out-u)),i.data_type=e.bits+(e.last?64:0)+(e.mode===O?128:0)+(e.mode===V||e.mode===fe?256:0),(p===0&&u===0||t===Re)&&M===I&&(M=Ht),M},Qt=i=>{if(C(i))return B;let t=i.state;return t.window&&(t.window=null),i.state=null,I},ei=(i,t)=>{if(C(i))return B;const e=i.state;return(e.wrap&2)===0?B:(e.head=t,t.done=!1,I)},ti=(i,t)=>{const e=t.length;let a,l,n;return C(i)||(a=i.state,a.wrap!==0&&a.mode!==J)?B:a.mode===J&&(l=1,l=ae(l,t,e,0),l!==a.check)?Be:(n=rt(i,t,e,e),n?(a.mode=Qe,De):(a.havedict=1,I))};var ii=nt,ni=at,ai=it,si=Vt,oi=st,ri=qt,li=Qt,fi=ei,ci=ti,hi="pako inflate (from Nodeca project)",T={inflateReset:ii,inflateReset2:ni,inflateResetKeep:ai,inflateInit:si,inflateInit2:oi,inflate:ri,inflateEnd:li,inflateGetHeader:fi,inflateSetDictionary:ci,inflateInfo:hi};function di(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var ui=di;const lt=Object.prototype.toString,{Z_NO_FLUSH:xi,Z_FINISH:wi,Z_OK:L,Z_STREAM_END:ue,Z_NEED_DICT:xe,Z_STREAM_ERROR:_i,Z_DATA_ERROR:ft,Z_MEM_ERROR:pi}=ge;function q(i){this.options=me.assign({chunkSize:1024*64,windowBits:15,to:""},i||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(i&&i.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ct,this.strm.avail_out=0;let e=T.inflateInit2(this.strm,t.windowBits);if(e!==L)throw new Error(se[e]);if(this.header=new ui,T.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=oe.string2buf(t.dictionary):lt.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(e=T.inflateSetDictionary(this.strm,t.dictionary),e!==L)))throw new Error(se[e])}q.prototype.push=function(i,t){const e=this.strm,a=this.options.chunkSize,l=this.options.dictionary;let n,f,r;if(this.ended)return!1;for(t===~~t?f=t:f=t===!0?wi:xi,lt.call(i)==="[object ArrayBuffer]"?e.input=new Uint8Array(i):e.input=i,e.next_in=0,e.avail_in=e.input.length;;){for(e.avail_out===0&&(e.output=new Uint8Array(a),e.next_out=0,e.avail_out=a),n=T.inflate(e,f),n===xe&&l&&(n=T.inflateSetDictionary(e,l),n===L?n=T.inflate(e,f):n===ft&&(n=xe));e.avail_in>0&&n===ue&&e.state.wrap>0&&i[e.next_in]!==0;)T.inflateReset(e),n=T.inflate(e,f);switch(n){case _i:case ft:case xe:case pi:return this.onEnd(n),this.ended=!0,!1}if(r=e.avail_out,e.next_out&&(e.avail_out===0||n===ue))if(this.options.to==="string"){let d=oe.utf8border(e.output,e.next_out),s=e.next_out-d,o=oe.buf2string(e.output,d);e.next_out=s,e.avail_out=a-s,s&&e.output.set(e.output.subarray(d,d+s),0),this.onData(o)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(!(n===L&&r===0)){if(n===ue)return n=T.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,!0;if(e.avail_in===0)break}}return!0},q.prototype.onData=function(i){this.chunks.push(i)},q.prototype.onEnd=function(i){i===L&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=me.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};function bi(i,t){const e=new q(t);if(e.push(i),e.err)throw e.msg||se[e.err];return e.result}var gi=bi,mi={inflate:gi};const{inflate:ki}=mi;var Ei=ki;function ct(i,t,e=0,a=i.length-1,l=yi){for(;a>e;){if(a-e>600){const d=a-e+1,s=t-e+1,o=Math.log(d),p=.5*Math.exp(2*o/3),u=.5*Math.sqrt(o*p*(d-p)/d)*(s-d/2<0?-1:1),c=Math.max(e,Math.floor(t-s*p/d+u)),w=Math.min(a,Math.floor(t+(d-s)*p/d+u));ct(i,t,c,w,l)}const n=i[t];let f=e,r=a;for($(i,e,t),l(i[a],n)>0&&$(i,e,a);f<r;){for($(i,f,r),f++,r--;l(i[f],n)<0;)f++;for(;l(i[r],n)>0;)r--}l(i[e],n)===0?$(i,e,r):(r++,$(i,r,a)),r<=t&&(e=r+1),t<=r&&(a=r-1)}}function $(i,t,e){const a=i[t];i[t]=i[e],i[e]=a}function yi(i,t){return i<t?-1:i>t?1:0}class vi{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(t){let e=this.data;const a=[];if(!ee(t,e))return a;const l=this.toBBox,n=[];for(;e;){for(let f=0;f<e.children.length;f++){const r=e.children[f],d=e.leaf?l(r):r;ee(t,d)&&(e.leaf?a.push(r):_e(t,d)?this._all(r,a):n.push(r))}e=n.pop()}return a}collides(t){let e=this.data;if(!ee(t,e))return!1;const a=[];for(;e;){for(let l=0;l<e.children.length;l++){const n=e.children[l],f=e.leaf?this.toBBox(n):n;if(ee(t,f)){if(e.leaf||_e(t,f))return!0;a.push(n)}}e=a.pop()}return!1}load(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(let a=0;a<t.length;a++)this.insert(t[a]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=e;else if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){const a=this.data;this.data=e,e=a}this._insert(e,this.data.height-e.height-1,!0)}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=z([]),this}remove(t,e){if(!t)return this;let a=this.data;const l=this.toBBox(t),n=[],f=[];let r,d,s;for(;a||n.length;){if(a||(a=n.pop(),d=n[n.length-1],r=f.pop(),s=!0),a.leaf){const o=Si(t,a.children,e);if(o!==-1)return a.children.splice(o,1),n.push(a),this._condense(n),this}!s&&!a.leaf&&_e(a,l)?(n.push(a),f.push(r),r=0,d=a,a=a.children[0]):d?(r++,a=d.children[r],s=!1):a=null}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){const a=[];for(;t;)t.leaf?e.push(...t.children):a.push(...t.children),t=a.pop();return e}_build(t,e,a,l){const n=a-e+1;let f=this._maxEntries,r;if(n<=f)return r=z(t.slice(e,a+1)),Z(r,this.toBBox),r;l||(l=Math.ceil(Math.log(n)/Math.log(f)),f=Math.ceil(n/Math.pow(f,l-1))),r=z([]),r.leaf=!1,r.height=l;const d=Math.ceil(n/f),s=d*Math.ceil(Math.sqrt(f));ht(t,e,a,s,this.compareMinX);for(let o=e;o<=a;o+=s){const p=Math.min(o+s-1,a);ht(t,o,p,d,this.compareMinY);for(let u=o;u<=p;u+=d){const c=Math.min(u+d-1,p);r.children.push(this._build(t,u,c,l-1))}}return Z(r,this.toBBox),r}_chooseSubtree(t,e,a,l){for(;l.push(e),!(e.leaf||l.length-1===a);){let n=1/0,f=1/0,r;for(let d=0;d<e.children.length;d++){const s=e.children[d],o=we(s),p=Ri(t,s)-o;p<f?(f=p,n=o<n?o:n,r=s):p===f&&o<n&&(n=o,r=s)}e=r||e.children[0]}return e}_insert(t,e,a){const l=a?t:this.toBBox(t),n=[],f=this._chooseSubtree(l,this.data,e,n);for(f.children.push(t),H(f,l);e>=0&&n[e].children.length>this._maxEntries;)this._split(n,e),e--;this._adjustParentBBoxes(l,n,e)}_split(t,e){const a=t[e],l=a.children.length,n=this._minEntries;this._chooseSplitAxis(a,n,l);const f=this._chooseSplitIndex(a,n,l),r=z(a.children.splice(f,a.children.length-f));r.height=a.height,r.leaf=a.leaf,Z(a,this.toBBox),Z(r,this.toBBox),e?t[e-1].children.push(r):this._splitRoot(a,r)}_splitRoot(t,e){this.data=z([t,e]),this.data.height=t.height+1,this.data.leaf=!1,Z(this.data,this.toBBox)}_chooseSplitIndex(t,e,a){let l,n=1/0,f=1/0;for(let r=e;r<=a-e;r++){const d=P(t,0,r,this.toBBox),s=P(t,r,a,this.toBBox),o=Bi(d,s),p=we(d)+we(s);o<n?(n=o,l=r,f=p<f?p:f):o===n&&p<f&&(f=p,l=r)}return l||a-e}_chooseSplitAxis(t,e,a){const l=t.leaf?this.compareMinX:Mi,n=t.leaf?this.compareMinY:Ai,f=this._allDistMargin(t,e,a,l),r=this._allDistMargin(t,e,a,n);f<r&&t.children.sort(l)}_allDistMargin(t,e,a,l){t.children.sort(l);const n=this.toBBox,f=P(t,0,e,n),r=P(t,a-e,a,n);let d=Q(f)+Q(r);for(let s=e;s<a-e;s++){const o=t.children[s];H(f,t.leaf?n(o):o),d+=Q(f)}for(let s=a-e-1;s>=e;s--){const o=t.children[s];H(r,t.leaf?n(o):o),d+=Q(r)}return d}_adjustParentBBoxes(t,e,a){for(let l=a;l>=0;l--)H(e[l],t)}_condense(t){for(let e=t.length-1,a;e>=0;e--)t[e].children.length===0?e>0?(a=t[e-1].children,a.splice(a.indexOf(t[e]),1)):this.clear():Z(t[e],this.toBBox)}}function Si(i,t,e){if(!e)return t.indexOf(i);for(let a=0;a<t.length;a++)if(e(i,t[a]))return a;return-1}function Z(i,t){P(i,0,i.children.length,t,i)}function P(i,t,e,a,l){l||(l=z(null)),l.minX=1/0,l.minY=1/0,l.maxX=-1/0,l.maxY=-1/0;for(let n=t;n<e;n++){const f=i.children[n];H(l,i.leaf?a(f):f)}return l}function H(i,t){return i.minX=Math.min(i.minX,t.minX),i.minY=Math.min(i.minY,t.minY),i.maxX=Math.max(i.maxX,t.maxX),i.maxY=Math.max(i.maxY,t.maxY),i}function Mi(i,t){return i.minX-t.minX}function Ai(i,t){return i.minY-t.minY}function we(i){return(i.maxX-i.minX)*(i.maxY-i.minY)}function Q(i){return i.maxX-i.minX+(i.maxY-i.minY)}function Ri(i,t){return(Math.max(t.maxX,i.maxX)-Math.min(t.minX,i.minX))*(Math.max(t.maxY,i.maxY)-Math.min(t.minY,i.minY))}function Bi(i,t){const e=Math.max(i.minX,t.minX),a=Math.max(i.minY,t.minY),l=Math.min(i.maxX,t.maxX),n=Math.min(i.maxY,t.maxY);return Math.max(0,l-e)*Math.max(0,n-a)}function _e(i,t){return i.minX<=t.minX&&i.minY<=t.minY&&t.maxX<=i.maxX&&t.maxY<=i.maxY}function ee(i,t){return t.minX<=i.maxX&&t.minY<=i.maxY&&t.maxX>=i.minX&&t.maxY>=i.minY}function z(i){return{children:i,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function ht(i,t,e,a,l){const n=[t,e];for(;n.length;){if(e=n.pop(),t=n.pop(),e-t<=a)continue;const f=t+Math.ceil((e-t)/a/2)*a;ct(i,f,t,e,l),n.push(t,f,f,e)}}let te=null;function dt(i,t){if(!i)return 0;const e=i[t];return typeof e=="number"&&isFinite(e)?e:0}let Di=null,Oi={};function Ti(i,t=7){const e=[...i].sort((n,f)=>n-f),a=Math.ceil(e.length/t),l=[];for(let n=1;n<t;n++)l.push(e[n*a]??e[e.length-1]);return l}self.onmessage=async i=>{const{id:t,type:e,data:a}=i.data;te&&te.abort(),te=new AbortController;const l=te.signal;try{switch(e){case"LOAD_AND_PROCESS_DATA":{const{url:n,selectedMetric:f}=a;self.postMessage({type:"PROGRESS",data:{phase:"Fetching market data..."}});const r=await fetch(n,{signal:l});if(!r.ok)throw new Error(`Fetch failed: ${r.status}`);const d=await r.arrayBuffer();let s;const o=r.headers.get("content-encoding")||"";try{if(o.includes("gzip"))try{s=JSON.parse(new TextDecoder().decode(d))}catch{const x=Ei(new Uint8Array(d),{to:"string"});s=JSON.parse(x)}else s=JSON.parse(new TextDecoder().decode(d))}catch(x){throw new Error("Failed to parse JSON: "+x.message)}const{last_updated_utc:p,zip_codes:u}=s;if(!u)throw new Error("Missing zip_codes data");self.postMessage({type:"PROGRESS",data:{phase:"Indexing ZIP codes..."}});const c={},w=[],y=Object.entries(u);for(let x=0;x<y.length;x++){if(l.aborted)return;const[k,m]=y[x];m.zipCode=k,c[k]=m;const h=dt(m,f);h>0&&w.push(h),x%2e3===0&&self.postMessage({type:"PROGRESS",data:{phase:"Indexing ZIP codes...",processed:x,total:y.length}})}const g={min:Math.min(...w),max:Math.max(...w)};self.postMessage({type:"DATA_PROCESSED",id:t,data:{zip_codes:c,last_updated_utc:p,bounds:g}});break}case"PROCESS_GEOJSON":{const{geojson:n,zipData:f,selectedMetric:r,viewport:d}=a;if(!n?.features)throw new Error("Invalid GeoJSON");self.postMessage({type:"PROGRESS",data:{phase:"Building spatial index..."}});const s=new vi,o=[];for(let y of n.features){if(l.aborted)return;const g=y.properties?.ZCTA5CE20;if(!g||!f[g])continue;const[x,k,m,h]=Ii(y);s.insert({minX:x,minY:k,maxX:m,maxY:h,feature:y}),Oi[g]=y,o.push(y)}Di=s,self.postMessage({type:"PROGRESS",data:{phase:"Filtering viewport..."}});const p=d?s.search(d).map(y=>y.feature):o,u=p.map(y=>dt(f[y.properties.ZCTA5CE20],r)),c=Ti(u),w=["step",["get","metricValue"],"#FFF9B0",...c.flatMap((y,g)=>[y,Ci(g)])];self.postMessage({type:"GEOJSON_PROCESSED",id:t,data:{type:"FeatureCollection",features:p,bucketExpression:w}});break}default:throw new Error(`Unknown type: ${e}`)}}catch(n){l.aborted||(console.error("[Worker] Error:",n),self.postMessage({type:"ERROR",id:t,error:n instanceof Error?n.message:"Unknown error"}))}};function Ii(i){if(i.geometry.type==="Polygon"){const t=i.geometry.coordinates.flat(2),e=t.filter((l,n)=>n%2===0),a=t.filter((l,n)=>n%2===0?void 0:t[n]);return[Math.min(...e),Math.min(...a),Math.max(...e),Math.max(...a)]}else if(i.geometry.type==="MultiPolygon"){const t=i.geometry.coordinates.flat(3),e=t.filter((l,n)=>n%2===0),a=t.filter((l,n)=>n%2===0?void 0:t[n]);return[Math.min(...e),Math.min(...a),Math.max(...e),Math.max(...a)]}return[0,0,0,0]}function Ci(i){const t=["#FFF9B0","#FFE066","#FFB347","#FF7F50","#E84C61","#AD1457","#2E0B59"];return t[i]||t[t.length-1]}})();
